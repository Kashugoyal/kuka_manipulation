(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    690294,      13436]
NotebookOptionsPosition[    683401,      13331]
NotebookOutlinePosition[    683780,      13347]
CellTagsIndexPosition[    683737,      13344]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 StyleBox["Library of functions written to accompany the algorithms described \
in ",
  FontSize->36,
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["Modern Robotics: Mechanics, Planning, and Control",
  FontSize->36,
  FontSlant->"Italic",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox[".",
  FontSize->36,
  FontColor->RGBColor[0, 0, 1]]
}], "Title",
 CellChangeTimes->{{3.658271341588306*^9, 3.6582713456457853`*^9}, {
   3.675528750549493*^9, 3.675528779907896*^9}, {3.675529226872184*^9, 
   3.67552922870382*^9}, {3.675529362176085*^9, 3.675529365448338*^9}, 
   3.675529396890761*^9, {3.676205646014924*^9, 3.6762056476708612`*^9}, {
   3.6935033748198347`*^9, 3.6935033793448424`*^9}, {3.6935034321395426`*^9, 
   3.693503451701378*^9}, {3.6935037319956045`*^9, 
   3.693503736833613*^9}},ExpressionUUID->"e7cfe95e-298d-457d-957b-\
ff9911294e26"],

Cell[TextData[{
 StyleBox["Author: Huan Weng, Mikhail Todes\nFunctions also available in: \
Python, MATLAB\n\n",
  FontSize->18,
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["Notes:\n",
  FontSize->18,
  FontWeight->"Bold",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["Before using any of the functions in this library, each chapter\
\[CloseCurlyQuote]s cell needs to be evaluated. This can be done as a whole \
by highlighting everything (Ctrl + A) and then evaluating (Shift + Enter). \n\
\nDouble click on the tabs at the side of each chapter to expand and view the \
code.\n\nAt the start of each function is a description of what it does as \
well as an example showing how to use it.\nQuick tip: If you see a small T \
after braces, it means the transpose of that vector. This can be done the \
same way as accessing Greek letters in Mathematica. Press the Esc key, type \
\[OpenCurlyDoubleQuote]tr\[CloseCurlyDoubleQuote], and then press the Esc key \
again.",
  FontSize->18,
  FontColor->RGBColor[0, 0, 1]],
 StyleBox[" ",
  FontSize->18,
  FontWeight->"Bold",
  FontColor->RGBColor[0, 0, 1]]
}], "Title",
 CellChangeTimes->{{3.658271341588306*^9, 3.6582713456457853`*^9}, {
   3.675528750549493*^9, 3.675528779907896*^9}, {3.675529226872184*^9, 
   3.67552922870382*^9}, {3.675529362176085*^9, 3.675529365448338*^9}, 
   3.675529396890761*^9, {3.676205646014924*^9, 3.676205711454337*^9}, {
   3.676205798666971*^9, 3.676205801603088*^9}, {3.6786303129136467`*^9, 
   3.678630314739846*^9}, 3.682543797297825*^9, {3.6832314306368*^9, 
   3.683231490482093*^9}, {3.683231539283634*^9, 3.683231632134388*^9}, {
   3.683232465039819*^9, 3.6832324695390797`*^9}, {3.683232533035797*^9, 
   3.683232573144146*^9}, {3.693503187861879*^9, 3.6935031908664856`*^9}, {
   3.693503224815956*^9, 3.693503229366966*^9}, {3.6935032898728704`*^9, 
   3.6935032928096757`*^9}, {3.693503339469767*^9, 
   3.6935033477241817`*^9}},ExpressionUUID->"d2337993-7423-4e05-9447-\
abdfac8d7163"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6755319110417843`*^9, 3.675531927048277*^9}, {
   3.675531958735077*^9, 3.675532032779791*^9}, {3.6755321540719852`*^9, 
   3.675532155394449*^9}, 3.67559226134205*^9, {3.675596340559066*^9, 
   3.675596342576479*^9}, {3.678095916353695*^9, 3.678095936057015*^9}, {
   3.689123258998646*^9, 3.6891232618786497`*^9}, {3.689123343863774*^9, 
   3.68912340346986*^9}, {3.6899070280953193`*^9, 3.689907162011979*^9}, {
   3.6899072391353903`*^9, 3.6899072597645698`*^9}, {3.6899073047291417`*^9, 
   3.689907368236774*^9}, 3.6899076067024136`*^9, {3.689908335780114*^9, 
   3.6899083377722282`*^9}, 3.6899083909262686`*^9, 3.6899086294909134`*^9, {
   3.689908788995037*^9, 3.689908816402604*^9}, {3.690385644196001*^9, 
   3.690385648357239*^9}, {3.690853037932588*^9, 3.690853051641118*^9}, {
   3.6908533565816717`*^9, 
   3.6908533662967834`*^9}},ExpressionUUID->"bab12d50-9abb-4e85-a7da-\
39851997309e"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["BASIC HELPER FUNCTIONS",
 FontSize->24,
 FontWeight->"Bold",
 FontColor->RGBColor[0, 0, 1]]], "Title",
 CellChangeTimes->{{3.6755319110417843`*^9, 3.675531927048277*^9}, {
   3.675531958735077*^9, 3.67553201284205*^9}, {3.6756152664138308`*^9, 
   3.675615299230091*^9}, {3.6761156821135902`*^9, 3.676115684953891*^9}, 
   3.6908532331593294`*^9},ExpressionUUID->"224bb695-bf40-4c13-8525-\
133cad19cf77"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"NearZero", "[", "s_", "]"}], ":", "\[IndentingNewLine]", "  ", 
     RowBox[{"Takes", " ", "a", " ", 
      RowBox[{"scalar", ".", "\[IndentingNewLine]", "Checks"}], " ", "if", 
      " ", "the", " ", "scalar", " ", "is", " ", "small", " ", "enough", " ", 
      "to", " ", "be", " ", 
      RowBox[{"neglected", "."}]}]}], "\[IndentingNewLine]", ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Example", ":", "\[IndentingNewLine]", "Input", ":", " ", "judge"}], " ",
      "=", " ", 
     RowBox[{
      RowBox[{"NearZero", "[", 
       RowBox[{"-", 
        SuperscriptBox["10", 
         RowBox[{"-", "7"}]]}], "]"}], "\[IndentingNewLine]", 
      RowBox[{"Output", ":", " ", "True"}]}]}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"NearZero", "[", "s_", "]"}], ":=", 
    RowBox[{
     RowBox[{"Abs", "[", "s", "]"}], "<", 
     SuperscriptBox["10", 
      RowBox[{"-", "6"}]]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6755319110417843`*^9, 3.675531927048277*^9}, {
   3.675531958735077*^9, 3.675532032779791*^9}, {3.6755321540719852`*^9, 
   3.675532155394449*^9}, 3.67559226134205*^9, {3.675596340559066*^9, 
   3.675596342576479*^9}, {3.678095916353695*^9, 3.678095936057015*^9}, {
   3.689123258998646*^9, 3.6891232618786497`*^9}, {3.689123343863774*^9, 
   3.68912340346986*^9}, {3.6899075896464376`*^9, 3.689907596066805*^9}, {
   3.689907651688987*^9, 3.689907656250248*^9}, {3.689908341024414*^9, 
   3.6899083422934866`*^9}, {3.6899083849099245`*^9, 3.689908387394067*^9}, {
   3.689908830571415*^9, 3.6899088323495164`*^9}, 3.6908533275993333`*^9, 
   3.690854954790098*^9, {3.6924691057816725`*^9, 3.6924691282329273`*^9}, {
   3.6924695971960073`*^9, 3.6924695974456077`*^9}, {3.69309949985518*^9, 
   3.6930995081881924`*^9}, 3.6931533609456143`*^9, {3.6932376898099833`*^9, 
   3.6932377248320446`*^9}, 3.693237810912996*^9, 3.6935352191572638`*^9, 
   3.6935353437081375`*^9},ExpressionUUID->"b11b96a9-dd81-4951-b7a9-\
0e0d3045f55a"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["CHAPTER  3: RIGID-BODY MOTION",
 FontSize->24,
 FontWeight->"Bold",
 FontColor->RGBColor[0, 0, 1]]], "Title",
 CellChangeTimes->{{3.6755319110417843`*^9, 3.675531927048277*^9}, {
  3.675531958735077*^9, 3.67553201284205*^9}, {3.6756152664138308`*^9, 
  3.675615299230091*^9}, {3.6761156821135902`*^9, 
  3.676115684953891*^9}},ExpressionUUID->"14fdbee6-d553-44d5-bcf8-\
0520985f8d0c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"RotInv", "[", "R_", "]"}], ":", "\[IndentingNewLine]", "  ", 
     RowBox[{"Takes", " ", "a", " ", "3", "x3", " ", "rotation", " ", 
      RowBox[{"matrix", ".", "\[IndentingNewLine]", "Returns"}], " ", "the", 
      " ", "inverse", " ", 
      RowBox[{
       RowBox[{"(", "transpose", ")"}], "."}]}]}], "\[IndentingNewLine]", ";",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Example", ":", "\[IndentingNewLine]", "Input", ":", " ", "invR"}], " ", 
     "=", " ", 
     RowBox[{
      RowBox[{"RotInv", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "}"}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Output", ":", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}]}]}]}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"RotInv", "[", "R_", "]"}], ":=", 
    RowBox[{"R", "\[Transpose]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6755319110417843`*^9, 3.675531927048277*^9}, {
   3.675531958735077*^9, 3.675532032779791*^9}, {3.6755321540719852`*^9, 
   3.675532155394449*^9}, 3.67559226134205*^9, {3.675596340559066*^9, 
   3.675596342576479*^9}, {3.678095916353695*^9, 3.678095936057015*^9}, {
   3.689123258998646*^9, 3.6891232618786497`*^9}, {3.689123343863774*^9, 
   3.68912340346986*^9}, {3.6899075896464376`*^9, 3.689907596066805*^9}, {
   3.689907651688987*^9, 3.689907656250248*^9}, {3.689908341024414*^9, 
   3.6899083422934866`*^9}, {3.6899083849099245`*^9, 3.689908387394067*^9}, {
   3.689908830571415*^9, 3.6899088323495164`*^9}, {3.6924695941854005`*^9, 
   3.692469595786604*^9}, {3.69315336961923*^9, 
   3.6931533840804553`*^9}},ExpressionUUID->"0ad70c06-facc-4d0a-af6d-\
a84a9c827263"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"VecToso3", "[", "omg_", "]"}], ":", "\[IndentingNewLine]", 
     "   ", 
     RowBox[{
      RowBox[{"Takes", " ", "a", " ", "3"}], "-", 
      RowBox[{"vector", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"angular", " ", "velocity"}], ")"}], ".", 
        "\[IndentingNewLine]", "Returns"}], " ", "the", " ", "skew", " ", 
       "symmetric", " ", "matrix", " ", "in", " ", 
       RowBox[{"so3", "."}]}]}]}], "\[IndentingNewLine]", ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Example", ":", "\[IndentingNewLine]", "Input", ":", " ", "so3mat"}], 
     " ", "=", " ", 
     RowBox[{
      RowBox[{"VecToso3", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "1", "}"}], ",", 
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", "3", "}"}]}], "}"}], "]"}], "\[IndentingNewLine]", 
      RowBox[{"Output", ":", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", "3"}], ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "0", ",", 
           RowBox[{"-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "1", ",", "0"}], "}"}]}], "}"}]}]}]}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"VecToso3", "[", "omg_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", 
         RowBox[{"omg", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"omg", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"omg", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "1"}], "]"}], "]"}], ",", "0", ",", 
        RowBox[{"-", 
         RowBox[{"omg", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"omg", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"omg", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "0"}], "}"}]}], "}"}]}],
    "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6755319110417843`*^9, 3.675531927048277*^9}, {
   3.675531958735077*^9, 3.675532032779791*^9}, {3.6755321540719852`*^9, 
   3.675532176089467*^9}, {3.6755325631830273`*^9, 3.6755326462949533`*^9}, {
   3.6755327460483017`*^9, 3.675532746848569*^9}, {3.675533015887747*^9, 
   3.6755331043631153`*^9}, {3.675533262027841*^9, 3.6755332644293537`*^9}, 
   3.675592257047958*^9, 3.675594217872285*^9, {3.67559635411017*^9, 
   3.6755963639568*^9}, {3.678095931635499*^9, 3.678095941539589*^9}, {
   3.6899090930844297`*^9, 3.6899091025809727`*^9}, {3.690311308636998*^9, 
   3.690311353117509*^9}, {3.6924695914339933`*^9, 3.6924695919799943`*^9}, {
   3.693153395140875*^9, 
   3.6931533983700805`*^9}},ExpressionUUID->"e97ad251-9fef-48cf-81ac-\
5d5c66f5db15"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"so3ToVec", "[", "so3mat_", "]"}], ":", "\[IndentingNewLine]", 
     "   ", 
     RowBox[{
      RowBox[{"Takes", " ", "a", " ", "3", "x3", " ", "skew"}], "-", 
      RowBox[{"symmetric", " ", "matrix", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"an", " ", "element", " ", "of", " ", "so", 
          RowBox[{"(", "3", ")"}]}], ")"}], ".", "\[IndentingNewLine]", 
        "Returns"}], " ", "the", " ", "corresponding", " ", "vector", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"angular", " ", "velocity"}], ")"}], "."}]}]}]}], 
    "\[IndentingNewLine]", ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Example", ":", "\[IndentingNewLine]", "Input", ":", " ", "omg"}], " ", 
     "=", " ", 
     RowBox[{
      RowBox[{"so3ToVec", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", "3"}], ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "0", ",", 
           RowBox[{"-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "1", ",", "0"}], "}"}]}], "}"}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Output", ":", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "1", "}"}], ",", 
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", "3", "}"}]}], "}"}]}]}]}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"so3ToVec", "[", "so3mat_", "]"}], ":=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"so3mat", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"so3mat", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", 
        RowBox[{"so3mat", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], "}"}], 
     "\[Transpose]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.675533307004715*^9, 3.67553330945144*^9}, 
   3.675592067518145*^9, {3.675592113013286*^9, 3.675592115100141*^9}, {
   3.675592155090198*^9, 3.675592250827938*^9}, {3.67559229043678*^9, 
   3.6755922914617233`*^9}, 3.675594212914967*^9, {3.67559639441064*^9, 
   3.675596396661991*^9}, {3.67809595187551*^9, 3.678095953534129*^9}, 
   3.6903174557842903`*^9, {3.6924692013473115`*^9, 3.69246920470912*^9}, {
   3.692469587930587*^9, 3.692469588462988*^9}, {3.6931534028160877`*^9, 
   3.693153405171692*^9}},ExpressionUUID->"bcd4406f-0d5f-4c93-a7c5-\
78e8b31e17a4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"AxisAng3", "[", "expc3_", "]"}], ":", "\[IndentingNewLine]", 
     "   ", 
     RowBox[{
      RowBox[{"Takes", " ", "A", " ", "3"}], "-", 
      RowBox[{
      "vector", " ", "of", " ", "exponential", " ", "coordinates", " ", "for",
        " ", 
       RowBox[{"rotation", ".", " ", "\[IndentingNewLine]", "Returns"}], " ", 
       "unit", " ", "rotation", " ", "axis", " ", "omghat", " ", "and", " ", 
       "the", " ", "corresponding", " ", "rotation", " ", "angle", " ", 
       RowBox[{"theta", ".", "\[IndentingNewLine]", "The"}], " ", "first", 
       " ", "element", " ", "of", " ", "the", " ", "output", " ", "is", " ", 
       "the", " ", "unit", " ", "rotation", " ", "axis", " ", "column", " ", 
       "vector", " ", 
       RowBox[{"(", "omghat", ")"}], " ", "and", " ", "the", " ", "second", 
       " ", "element", " ", "is", " ", 
       RowBox[{"theta", "."}]}]}]}], "\[IndentingNewLine]", ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Example", ":", "\[IndentingNewLine]", "Input", ":", " ", 
      RowBox[{"{", 
       RowBox[{"omghat", ",", "theta"}], "}"}]}], " ", "=", " ", 
     RowBox[{
      RowBox[{"AxisAng3", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3"}], "}"}], "}"}], "\[Transpose]"}], 
       "]"}], "//", 
      RowBox[{"N", "\[IndentingNewLine]", 
       RowBox[{"Output", ":", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "0.2672612419124244", "}"}], ",", 
            RowBox[{"{", "0.5345224838248488", "}"}], ",", 
            RowBox[{"{", "0.8017837257372732", "}"}]}], "}"}], ",", 
          "3.7416573867739413"}], "}"}]}]}]}]}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"AxisAng3", "[", "expc3_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"expc3", "/", 
       RowBox[{"Norm", "[", "expc3", "]"}]}], ",", 
      RowBox[{"Norm", "[", "expc3", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.675533307004715*^9, 3.67553330945144*^9}, 
   3.675592067518145*^9, {3.675592113013286*^9, 3.675592115100141*^9}, {
   3.675592155090198*^9, 3.675592250827938*^9}, {3.67559229043678*^9, 
   3.6755922914617233`*^9}, 3.6755923257071743`*^9, {3.675592392796273*^9, 
   3.6755924786666107`*^9}, {3.675592636879244*^9, 3.675592662642579*^9}, {
   3.675592692874652*^9, 3.675592696674159*^9}, 3.675594207807824*^9, 
   3.675596301390246*^9, 3.678095963162088*^9, 3.690855047324808*^9, {
   3.692469216534156*^9, 3.692469257502246*^9}, {3.692469585962983*^9, 
   3.692469586399784*^9}, {3.693153412924906*^9, 
   3.6931534155613103`*^9}},ExpressionUUID->"45d60fcc-3d47-4d05-9e09-\
870eba0440a4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MatrixExp3", "[", "so3mat", "]"}], ":", "\[IndentingNewLine]", 
      "  ", 
      RowBox[{"Takes", " ", "a", " ", "so", 
       RowBox[{"(", "3", ")"}], " ", "representation", " ", "of", " ", 
       "exponential", " ", 
       RowBox[{"coordinates", ".", "\[IndentingNewLine]", "Returns"}], " ", 
       "R", " ", "in", " ", "SO", 
       RowBox[{"(", "3", ")"}], " ", "that", " ", "is", " ", "achieved", " ", 
       "by", " ", "rotating", " ", "about", " ", "omghat", " ", "by", " ", 
       "theta", " ", "from", " ", "an", " ", "initial", " ", "orientation", 
       " ", "R"}]}], "=", 
     RowBox[{"I", "."}]}], "\[IndentingNewLine]", ";", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"Example", ":", "\[IndentingNewLine]", "Input", ":", " ", "R"}], 
     " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"MatrixExp3", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "3"}], ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "0", ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "2"}], ",", "1", ",", "0"}], "}"}]}], "}"}], "]"}], "//",
        "N"}], "//", 
      RowBox[{"MatrixForm", "\[IndentingNewLine]", 
       RowBox[{"Output", ":", " ", 
        TagBox[
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {
             RowBox[{"-", "0.6949205576413118"}], "0.7135209905277876", 
             "0.08929285886191213"},
            {
             RowBox[{"-", "0.1920069727919994"}], 
             RowBox[{"-", "0.3037850443394705"}], "0.9331923538236468"},
            {"0.6929781677417701", "0.6313496993837178", "0.34810747783026474"}
           },
           
           GridBoxAlignment->{
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.7]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
         Function[BoxForm`e$, 
          MatrixForm[BoxForm`e$]]]}]}]}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MatrixExp3", "[", "so3mat_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"omgtheta", ",", "omghat", ",", "theta", ",", "omgmat"}], 
       "}"}], ",", 
      RowBox[{
       RowBox[{"omgtheta", "=", 
        RowBox[{"so3ToVec", "[", "so3mat", "]"}]}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"NearZero", "[", 
          RowBox[{"Norm", "[", "omgtheta", "]"}], "]"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"IdentityMatrix", "[", "3", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"omghat", ",", " ", "theta"}], "}"}], " ", "=", " ", 
           RowBox[{"AxisAng3", "[", "omgtheta", "]"}]}], ";", 
          RowBox[{"omgmat", "=", 
           RowBox[{"so3mat", "/", "theta"}]}], ";", 
          RowBox[{"Return", "[", 
           RowBox[{
            RowBox[{"IdentityMatrix", "[", "3", "]"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", "theta", "]"}], "*", "omgmat"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"Cos", "[", "theta", "]"}]}], ")"}], "*", 
             RowBox[{"omgmat", ".", "omgmat"}]}]}], "]"}]}]}], "]"}]}]}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.675533307004715*^9, 3.67553330945144*^9}, 
   3.675592067518145*^9, {3.675592113013286*^9, 3.675592115100141*^9}, {
   3.675592155090198*^9, 3.675592250827938*^9}, {3.67559229043678*^9, 
   3.6755922914617233`*^9}, 3.6755923257071743`*^9, {3.675592392796273*^9, 
   3.6755924786666107`*^9}, {3.675592636879244*^9, 3.675592662642579*^9}, {
   3.675592750871451*^9, 3.675592760234817*^9}, {3.675592843016467*^9, 
   3.6755928498639193`*^9}, {3.675593005317328*^9, 3.675593006955986*^9}, {
   3.675593085055738*^9, 3.675593106872654*^9}, {3.6755931552286654`*^9, 
   3.675593202588101*^9}, {3.675593410152174*^9, 3.675593425469223*^9}, {
   3.675593463962451*^9, 3.675593465912236*^9}, 3.675594202040379*^9, {
   3.675596420655054*^9, 3.675596421318139*^9}, {3.675601785945984*^9, 
   3.67560180540821*^9}, 3.678095974651895*^9, {3.690316962755663*^9, 
   3.6903169900622253`*^9}, {3.6903172083078814`*^9, 
   3.6903172210359006`*^9}, {3.6903172543599486`*^9, 3.690317258029954*^9}, 
   3.6903174800323267`*^9, 3.69031752418739*^9, {3.6903175690344543`*^9, 
   3.690317574912464*^9}, {3.6903176062325087`*^9, 3.6903176407495584`*^9}, {
   3.6903176838896227`*^9, 3.6903178122478094`*^9}, {3.6903180723051853`*^9, 
   3.690318133493273*^9}, 3.690318291203499*^9, {3.6903224954192677`*^9, 
   3.690322523167308*^9}, 3.6903234267162743`*^9, {3.6904637546239395`*^9, 
   3.690463885817773*^9}, {3.6904644441695704`*^9, 3.690464456852393*^9}, 
   3.690464502773274*^9, 3.690855052820299*^9, {3.6924692693512707`*^9, 
   3.692469274767481*^9}, {3.6924693061159534`*^9, 3.6924693872389235`*^9}, {
   3.6924694605604925`*^9, 3.692469471100115*^9}, {3.6924695772459645`*^9, 
   3.692469581071972*^9}, 3.693099528992228*^9, {3.693153426200529*^9, 
   3.693153431613739*^9}, {3.6931906954047346`*^9, 3.6931906968555374`*^9}, {
   3.6932378420506506`*^9, 
   3.6932378557786746`*^9}},ExpressionUUID->"11ebb8ac-f942-4e18-819a-\
593a4d888b21"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"MatrixLog3", "[", "R_", "]"}], ":", "\[IndentingNewLine]", "  ", 
     RowBox[{"Takes", " ", "R", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"rotation", " ", "matrix"}], ")"}], ".", 
       "\[IndentingNewLine]", "Returns"}], " ", "the", " ", "corresponding", 
      " ", "so", 
      RowBox[{"(", "3", ")"}], " ", "representation", " ", "of", " ", 
      "exponential", " ", 
      RowBox[{"coordinates", "."}]}]}], "  ", "\[IndentingNewLine]", ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Example", ":", "\[IndentingNewLine]", "Input", ":", " ", "so3mat"}], 
     " ", "=", " ", 
     RowBox[{
      RowBox[{"MatrixLog3", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "}"}], "]"}], "//", 
      RowBox[{"N", "\[IndentingNewLine]", 
       RowBox[{"Output", ":", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1.2091995761561452", "}"}], ",", 
          RowBox[{"{", "1.2091995761561452", "}"}], ",", 
          RowBox[{"{", "1.2091995761561452", "}"}]}], "}"}]}]}]}]}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MatrixLog3", "[", "R_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"acosinput", ",", "theta", ",", "omgmat"}], "}"}], ",", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"NearZero", "[", 
         RowBox[{"Norm", "[", 
          RowBox[{"R", "-", 
           RowBox[{"IdentityMatrix", "[", "3", "]"}]}], "]"}], "]"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"NearZero", "[", 
         RowBox[{
          RowBox[{"Tr", "[", "R", "]"}], "+", "1"}], "]"}], ",", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{"NearZero", "[", 
            RowBox[{
             RowBox[{"R", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "3"}], "]"}], "]"}], "+", "1"}], "]"}], 
           "]"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"VecToso3", "[", 
            RowBox[{
             RowBox[{"1", "/", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"2", 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"R", "[", 
                   RowBox[{"[", 
                    RowBox[{"3", ",", "3"}], "]"}], "]"}]}], ")"}]}], "]"}]}],
              "*", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"R", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", 
                 RowBox[{"R", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "3"}], "]"}], "]"}], ",", 
                 RowBox[{"1", "+", 
                  RowBox[{"R", "[", 
                   RowBox[{"[", 
                    RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], "}"}], "}"}], 
              "\[Transpose]"}], "*", "Pi"}], "]"}], "]"}], ",", 
          RowBox[{"Not", "[", 
           RowBox[{"NearZero", "[", 
            RowBox[{
             RowBox[{"R", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "2"}], "]"}], "]"}], "+", "1"}], "]"}], 
           "]"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"VecToso3", "[", 
            RowBox[{
             RowBox[{"1", "/", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"2", 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"R", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ")"}]}], "]"}]}],
              "*", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"R", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
                 RowBox[{"1", "+", 
                  RowBox[{"R", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ",", 
                 RowBox[{"R", "[", 
                  RowBox[{"[", 
                   RowBox[{"3", ",", "2"}], "]"}], "]"}]}], "}"}], "}"}], 
              "\[Transpose]"}], "*", "Pi"}], "]"}], "]"}], ",", "True", ",", 
          RowBox[{"Return", "[", 
           RowBox[{"VecToso3", "[", 
            RowBox[{
             RowBox[{"1", "/", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"2", 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"R", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ")"}]}], "]"}]}],
              "*", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"1", "+", 
                  RowBox[{"R", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
                 RowBox[{"R", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{"R", "[", 
                  RowBox[{"[", 
                   RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "}"}], "}"}], 
              "\[Transpose]"}], "*", "Pi"}], "]"}], "]"}]}], "]"}], ",", 
        "True", ",", 
        RowBox[{
         RowBox[{"acosinput", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Tr", "[", "R", "]"}], "-", "1"}], ")"}], "/", "2"}]}], 
         ";", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"acosinput", ">", "1"}], ",", 
           RowBox[{"acosinput", "=", "1"}], ",", 
           RowBox[{"acosinput", "<", 
            RowBox[{"-", "1"}]}], ",", 
           RowBox[{"acosinput", "=", 
            RowBox[{"-", "1"}]}]}], "]"}], ";", 
         RowBox[{"theta", "=", 
          RowBox[{"ArcCos", "[", "acosinput", "]"}]}], ";", 
         RowBox[{"omgmat", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"R", "-", 
             RowBox[{"R", "\[Transpose]"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", "*", 
             RowBox[{"Sin", "[", "theta", "]"}]}], ")"}]}]}], ";", 
         RowBox[{"Return", "[", 
          RowBox[{"theta", "*", "omgmat"}], "]"}]}]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.675533307004715*^9, 3.67553330945144*^9}, 
   3.675592067518145*^9, {3.675592113013286*^9, 3.675592115100141*^9}, {
   3.675592155090198*^9, 3.675592250827938*^9}, {3.67559229043678*^9, 
   3.6755922914617233`*^9}, 3.6755923257071743`*^9, {3.675592392796273*^9, 
   3.6755924786666107`*^9}, {3.675592636879244*^9, 3.675592662642579*^9}, {
   3.675592750871451*^9, 3.675592760234817*^9}, {3.675592843016467*^9, 
   3.6755928498639193`*^9}, {3.675593005317328*^9, 3.675593006955986*^9}, {
   3.675593085055738*^9, 3.675593106872654*^9}, {3.6755931552286654`*^9, 
   3.675593202588101*^9}, {3.675593410152174*^9, 3.675593425469223*^9}, {
   3.675593463962451*^9, 3.675593465912236*^9}, {3.675594236154458*^9, 
   3.6755942477744513`*^9}, {3.675594364598016*^9, 3.675594367233914*^9}, {
   3.675594505282823*^9, 3.675594524684219*^9}, {3.675594705253235*^9, 
   3.67559470565687*^9}, {3.675594770197138*^9, 3.6755948067599487`*^9}, {
   3.67559486980615*^9, 3.6755949272469254`*^9}, {3.675594959952829*^9, 
   3.675594966081294*^9}, {3.675595073310274*^9, 3.675595099122567*^9}, {
   3.675595166588663*^9, 3.675595198087933*^9}, {3.675596440163121*^9, 
   3.6755964490162983`*^9}, {3.678095978175391*^9, 3.6780960120591097`*^9}, {
   3.678096058570084*^9, 3.6780960634875927`*^9}, {3.6891019372217746`*^9, 
   3.6891019477417893`*^9}, {3.6891019827579947`*^9, 
   3.6891019945970225`*^9}, {3.689102332695384*^9, 3.689102355379416*^9}, {
   3.6891027087439213`*^9, 3.6891027302559524`*^9}, {3.689102760787996*^9, 
   3.689102778300021*^9}, {3.6891028165060754`*^9, 3.6891028176160765`*^9}, {
   3.6891237737294703`*^9, 3.6891237973465033`*^9}, {3.6893784218629103`*^9, 
   3.689378540730709*^9}, {3.6903271275408573`*^9, 3.690327157925967*^9}, {
   3.690327234969596*^9, 3.6903273112797165`*^9}, {3.6903274962807355`*^9, 
   3.6903275154157643`*^9}, {3.690327571555847*^9, 3.6903276193499165`*^9}, {
   3.690327703624699*^9, 3.6903277763308063`*^9}, {3.6903278574919267`*^9, 
   3.6903278942929816`*^9}, {3.690327925553028*^9, 3.690328017523163*^9}, {
   3.6903280623929653`*^9, 3.6903280918630085`*^9}, {3.69032817462913*^9, 
   3.690328176119132*^9}, {3.69032859247474*^9, 3.6903285980217485`*^9}, {
   3.6903826145646625`*^9, 3.6903826159218645`*^9}, {3.6903827301920657`*^9, 
   3.690382788520568*^9}, {3.6903830758070974`*^9, 3.6903832624287715`*^9}, {
   3.690383355359087*^9, 3.6903834242210255`*^9}, {3.690383556687602*^9, 
   3.6903837399190826`*^9}, {3.6903839021183596`*^9, 3.690383908328715*^9}, 
   3.690384008237429*^9, {3.6903841024418173`*^9, 3.6903842061487494`*^9}, {
   3.6903843524911194`*^9, 3.6903844570981026`*^9}, {3.690384517418553*^9, 
   3.690384559520961*^9}, {3.6903846244256735`*^9, 3.690384682787011*^9}, {
   3.69038482823133*^9, 3.6903848739139433`*^9}, {3.6903849852783127`*^9, 
   3.6903851187249455`*^9}, {3.690385186941847*^9, 3.690385236173663*^9}, 
   3.690385377774762*^9, 3.6903856761338277`*^9, {3.6903857777206383`*^9, 
   3.6903858065702877`*^9}, {3.690385836747014*^9, 3.690385916871597*^9}, {
   3.6903876830276155`*^9, 3.6903878015853963`*^9}, {3.692469395272942*^9, 
   3.6924693997741513`*^9}, {3.6924694371828403`*^9, 
   3.6924694808031335`*^9}, {3.6924695752349577`*^9, 
   3.6924695754533577`*^9}, {3.693099531904233*^9, 3.69309953504824*^9}, {
   3.6931534401157537`*^9, 3.69315344379736*^9}, {3.693237872143103*^9, 
   3.6932378825795217`*^9}},ExpressionUUID->"3fb73430-e8c5-4a1c-bd0f-\
45ffc49a9eb7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"RpToTrans", "[", 
      RowBox[{"R_", ",", "p_"}], "]"}], ":", "\[IndentingNewLine]", "  ", 
     RowBox[{
     "Takes", " ", "rotation", " ", "matrix", " ", "R", " ", "and", " ", 
      "position", " ", 
      RowBox[{"p", ".", "\[IndentingNewLine]", "Returns"}], " ", 
      "corresponding", " ", "homogeneous", " ", "transformation", " ", 
      "matrix", " ", "T", " ", "in", " ", "SE", 
      RowBox[{
       RowBox[{"(", "3", ")"}], "."}]}]}], "\[IndentingNewLine]", ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Example", ":", "\[IndentingNewLine]", "Input", ":", " ", "T"}], 
     " ", "=", " ", 
     RowBox[{
      RowBox[{"RpToTrans", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "5"}], "}"}], "}"}], 
         "\[Transpose]"}]}], "]"}], "//", 
      RowBox[{"MatrixForm", "\[IndentingNewLine]", 
       RowBox[{"Output", ":", " ", 
        TagBox[
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {"1", "0", "0", "1"},
            {"0", "0", 
             RowBox[{"-", "1"}], "2"},
            {"0", "1", "0", "5"},
            {"0", "0", "0", "1"}
           },
           
           GridBoxAlignment->{
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.7]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
         Function[BoxForm`e$, 
          MatrixForm[BoxForm`e$]]]}]}]}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"RpToTrans", "[", 
     RowBox[{"R_", ",", "p_"}], "]"}], ":=", 
    RowBox[{"ArrayFlatten", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"R", ",", "p"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654107438701495*^9, 3.6541075770931664`*^9}, {
   3.6541076103152647`*^9, 3.654107726674172*^9}, {3.654107800327899*^9, 
   3.654107805926005*^9}, {3.654107842157054*^9, 3.654107956534466*^9}, {
   3.6541080276373253`*^9, 3.654108039845397*^9}, {3.654108208328875*^9, 
   3.654108267778264*^9}, {3.654108316603101*^9, 3.65410832858707*^9}, {
   3.654122072990996*^9, 3.654122200142358*^9}, {3.654122232524707*^9, 
   3.6541222637488813`*^9}, {3.654122372486209*^9, 3.65412253592478*^9}, {
   3.654122571686759*^9, 3.654122685636675*^9}, {3.654122740902017*^9, 
   3.6541228215630703`*^9}, {3.654122865671712*^9, 3.654122935620612*^9}, {
   3.654123032181581*^9, 3.6541230914473333`*^9}, {3.654123152783122*^9, 
   3.6541232043612537`*^9}, {3.654123304611115*^9, 3.654123341073502*^9}, {
   3.654123502235703*^9, 3.654123578362132*^9}, {3.654123664279245*^9, 
   3.654123683195951*^9}, {3.6541237878998413`*^9, 3.6541238249788847`*^9}, {
   3.654123940392714*^9, 3.654123947510108*^9}, {3.654124026309593*^9, 
   3.654124026885428*^9}, 3.6541241152729683`*^9, 3.654124170343902*^9, {
   3.6541246995439568`*^9, 3.654124712871656*^9}, {3.6541251843297157`*^9, 
   3.654125231518578*^9}, {3.6541254856851683`*^9, 3.65412548908077*^9}, {
   3.654125547742125*^9, 3.654125551165526*^9}, {3.654125930807577*^9, 
   3.654126007244483*^9}, {3.654126127665163*^9, 3.654126191634789*^9}, {
   3.654126236482831*^9, 3.654126250153975*^9}, {3.6541262848658533`*^9, 
   3.654126288991514*^9}, {3.654126323055903*^9, 3.654126399729628*^9}, {
   3.654126435349374*^9, 3.654126447266036*^9}, {3.654126530077552*^9, 
   3.6541265937421*^9}, {3.654126679867402*^9, 3.6541267650289497`*^9}, {
   3.6541267969631968`*^9, 3.654126798410089*^9}, {3.654126829860013*^9, 
   3.654126881359337*^9}, {3.6541269393824577`*^9, 3.654126959132009*^9}, {
   3.654127079773924*^9, 3.654127194954756*^9}, {3.654127229244482*^9, 
   3.654127253953713*^9}, {3.6541278694900227`*^9, 3.654127878663176*^9}, {
   3.654127969775614*^9, 3.6541279938293123`*^9}, {3.654128051763153*^9, 
   3.654128134016169*^9}, {3.654128326830834*^9, 3.654128326972948*^9}, {
   3.654182305132535*^9, 3.654182317491791*^9}, {3.65418238746202*^9, 
   3.654182511491269*^9}, {3.654182551115921*^9, 3.654182559209998*^9}, {
   3.6541826265390177`*^9, 3.654182732425318*^9}, {3.654182795218339*^9, 
   3.654182802306821*^9}, {3.654182858360195*^9, 3.654182976637673*^9}, {
   3.65418309291822*^9, 3.6541831115452337`*^9}, {3.654183280620055*^9, 
   3.654183381285778*^9}, {3.6541834216733217`*^9, 3.65418343026462*^9}, {
   3.65418347398075*^9, 3.654183479016459*^9}, {3.654183517743698*^9, 
   3.654183590244978*^9}, {3.654183629340012*^9, 3.654183659551435*^9}, {
   3.654183828746057*^9, 3.654183869187777*^9}, {3.654183918271063*^9, 
   3.6541839184304667`*^9}, {3.654206461375032*^9, 3.6542064948942213`*^9}, {
   3.6542065261576433`*^9, 3.654206710642645*^9}, {3.65420685898112*^9, 
   3.654206859498214*^9}, {3.654206912388175*^9, 3.6542069199221067`*^9}, {
   3.654206956850091*^9, 3.654206957769821*^9}, {3.6542070885864773`*^9, 
   3.6542070905801163`*^9}, {3.6542071861274023`*^9, 3.654207197287834*^9}, {
   3.654207355631957*^9, 3.65420737546005*^9}, {3.654207422116619*^9, 
   3.6542074295958633`*^9}, {3.654207513008601*^9, 3.654207622631179*^9}, {
   3.6542077902321663`*^9, 3.6542079082040863`*^9}, {3.654208112675095*^9, 
   3.6542082406765347`*^9}, {3.654208390436673*^9, 3.654208437282127*^9}, {
   3.654208729398788*^9, 3.6542088242969923`*^9}, {3.654208875181876*^9, 
   3.6542089105814543`*^9}, {3.654209036563011*^9, 3.654209042056604*^9}, {
   3.654209131808134*^9, 3.654209211748107*^9}, {3.654277910558556*^9, 
   3.654277962902483*^9}, {3.6542785554956903`*^9, 3.654278555764879*^9}, {
   3.6542801407928543`*^9, 3.654280145647377*^9}, {3.654280336511973*^9, 
   3.654280388661951*^9}, {3.654735519742467*^9, 3.654735526212496*^9}, {
   3.654736711632904*^9, 3.654736744359725*^9}, {3.654736840726715*^9, 
   3.6547369027091503`*^9}, {3.6547369619155817`*^9, 3.65473711893006*^9}, 
   3.654737215212165*^9, {3.6547372623430433`*^9, 3.654737301717353*^9}, {
   3.654737434898181*^9, 3.654737445769989*^9}, {3.654737593349925*^9, 
   3.654737893647337*^9}, {3.654737938282483*^9, 3.654737939560112*^9}, {
   3.654737995469615*^9, 3.65473804382544*^9}, {3.65473814244207*^9, 
   3.65473826286047*^9}, {3.654738473301898*^9, 3.654738519313912*^9}, {
   3.654738551955141*^9, 3.654738559351729*^9}, {3.654738599129403*^9, 
   3.654738599566987*^9}, {3.654738653005966*^9, 3.654738704434928*^9}, {
   3.654738885183668*^9, 3.654738922018218*^9}, {3.654739011880048*^9, 
   3.65473910917871*^9}, {3.654739159170903*^9, 3.654739162120161*^9}, {
   3.6547393230277576`*^9, 3.6547393764227123`*^9}, {3.654739415181912*^9, 
   3.65473942023728*^9}, {3.654739453135948*^9, 3.654739679965816*^9}, {
   3.654739718627033*^9, 3.6547397334487553`*^9}, {3.654739765385715*^9, 
   3.654739851694334*^9}, {3.654739889466123*^9, 3.654740005071364*^9}, {
   3.6547400491757*^9, 3.654740154008595*^9}, 3.654740216700787*^9, {
   3.654740314399178*^9, 3.6547403286014967`*^9}, 3.6547403850818996`*^9, {
   3.654740521314966*^9, 3.654740541208376*^9}, {3.65474063388687*^9, 
   3.654740654515286*^9}, {3.654740701345427*^9, 3.654740810460566*^9}, {
   3.654740848239312*^9, 3.654741082783293*^9}, {3.654741274225429*^9, 
   3.65474127713437*^9}, 3.654741426789631*^9, {3.6547414571147537`*^9, 
   3.654741569824174*^9}, {3.654741604551594*^9, 3.65474161887015*^9}, {
   3.6547416933496304`*^9, 3.654741709459137*^9}, {3.654741935230948*^9, 
   3.654741945307493*^9}, {3.6547830386167917`*^9, 3.654783105454197*^9}, {
   3.6547832406606083`*^9, 3.6547832525310373`*^9}, {3.654783794511154*^9, 
   3.654783837663447*^9}, {3.65478390359721*^9, 3.654783909803577*^9}, {
   3.654783989474423*^9, 3.654784403124803*^9}, {3.654784520313846*^9, 
   3.654784622329711*^9}, {3.6547847231449842`*^9, 3.654784727983326*^9}, {
   3.654785122876478*^9, 3.654785187751635*^9}, {3.654785255283667*^9, 
   3.654785472044736*^9}, {3.654785554330287*^9, 3.6547855634367*^9}, {
   3.6547858133842907`*^9, 3.654785842420493*^9}, {3.654785988696732*^9, 
   3.654785999313698*^9}, {3.654786083383224*^9, 3.654786083827299*^9}, {
   3.654799998454865*^9, 3.654800009014682*^9}, 3.654800058896707*^9, {
   3.6548001027328*^9, 3.654800173381201*^9}, {3.654800206111162*^9, 
   3.654800346038969*^9}, {3.654800415767541*^9, 3.654800685527397*^9}, {
   3.654800717895743*^9, 3.6548007259529123`*^9}, {3.6548007560240192`*^9, 
   3.654800892868227*^9}, {3.654800961067473*^9, 3.6548010443125353`*^9}, {
   3.654801144205307*^9, 3.6548013970409203`*^9}, {3.654801447723054*^9, 
   3.6548014700938597`*^9}, {3.654801562889327*^9, 3.6548017505389137`*^9}, {
   3.6548017965315866`*^9, 3.654801838591158*^9}, {3.654801925163512*^9, 
   3.654801957336872*^9}, {3.654802037838778*^9, 3.654802097667626*^9}, {
   3.6548021338675137`*^9, 3.654802151746142*^9}, {3.6548021938035927`*^9, 
   3.65480226557542*^9}, {3.6548023434469347`*^9, 3.6548024564595747`*^9}, {
   3.654802493167995*^9, 3.654802498462143*^9}, {3.654802632969117*^9, 
   3.654802636326886*^9}, {3.6548026864101667`*^9, 3.6548027624957323`*^9}, {
   3.654802812209731*^9, 3.6548030159498*^9}, {3.6548066359524317`*^9, 
   3.654806720935005*^9}, {3.654806751992766*^9, 3.6548067587144833`*^9}, {
   3.654806821497799*^9, 3.654806889382121*^9}, {3.654807006283039*^9, 
   3.654807210369132*^9}, {3.654807340425975*^9, 3.6548074184588003`*^9}, {
   3.6548074913193197`*^9, 3.654807699931301*^9}, 3.6548078200861998`*^9, {
   3.654807890939335*^9, 3.65480791502777*^9}, {3.654807960842239*^9, 
   3.6548080712336483`*^9}, {3.654808128338978*^9, 3.6548081799548407`*^9}, {
   3.6548101758929577`*^9, 3.654810330104765*^9}, {3.654810401423953*^9, 
   3.654810408457419*^9}, {3.6548104718702717`*^9, 3.6548106690676603`*^9}, {
   3.6548107121438303`*^9, 3.6548108463298893`*^9}, {3.654810878513033*^9, 
   3.6548109250220337`*^9}, {3.654810973064028*^9, 3.6548109963255377`*^9}, {
   3.654811065383171*^9, 3.65481111435124*^9}, {3.6548111568410273`*^9, 
   3.654811165569319*^9}, {3.654811202562601*^9, 3.654811649746052*^9}, {
   3.657067656153129*^9, 3.657067660941557*^9}, {3.6570766750689*^9, 
   3.657076677028944*^9}, {3.658274451899232*^9, 3.6582744912918463`*^9}, {
   3.6583703518545094`*^9, 3.65837035300604*^9}, {3.675595275623045*^9, 
   3.6755952858059273`*^9}, {3.675595499994834*^9, 3.675595501887823*^9}, {
   3.675595686331749*^9, 3.6755956966706448`*^9}, {3.6755964730817327`*^9, 
   3.6755964735643463`*^9}, 3.6780960195594473`*^9, {3.67809610144601*^9, 
   3.678096106509063*^9}, {3.6903930166606817`*^9, 3.6903930437642317`*^9}, 
   3.6908550580671806`*^9, {3.6924695059439898`*^9, 3.692469512604602*^9}, {
   3.6924695713499475`*^9, 3.692469571601548*^9}, {3.6931534485241685`*^9, 
   3.693153450645772*^9}},ExpressionUUID->"5b0bdc63-0ffd-4a46-9d87-\
f0f901c02c48"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"TransToRp", "[", "T_", "]"}], ":", "\[IndentingNewLine]", "  ", 
     
     RowBox[{
     "Takes", " ", "transformation", " ", "matrix", " ", "T", " ", "in", " ", 
      "SE", 
      RowBox[{
       RowBox[{"(", "3", ")"}], ".", "\[IndentingNewLine]", "Returns"}], " ", 
      "R"}], ":", " ", 
     RowBox[{"the", " ", "corresponding", " ", "rotation", " ", "matrix"}]}], 
    ",", "\[IndentingNewLine]", "           ", 
    RowBox[{
     RowBox[{"p", ":", " ", 
      RowBox[{"the", " ", "corresponding", " ", "position", " ", 
       RowBox[{"vector", ".", " ", "\[IndentingNewLine]", "The"}], " ", 
       "first", " ", "element", " ", "of", " ", "the", " ", "output", " ", 
       "is", " ", "the", " ", "rotation", " ", "matrix", " ", "and", " ", 
       "the", " ", "second", " ", "is", " ", "the", " ", "position", " ", 
       RowBox[{"vector", "."}]}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Example", ":", "\[IndentingNewLine]", "Input", ":", " ", 
       RowBox[{"{", 
        RowBox[{"R", ",", "p"}], "}"}]}], " ", "=", " ", 
      RowBox[{
       RowBox[{"TransToRp", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}], "]"}],
        "\[IndentingNewLine]", 
       RowBox[{"Output", ":", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", 
              RowBox[{"-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "3", "}"}]}], "}"}]}], "}"}]}]}]}]}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TransToRp", "[", "T_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"T", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"1", ";;", "3"}], ",", 
         RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"T", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}], "}"}], 
       "\[Transpose]"}]}], "}"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654107438701495*^9, 3.6541075770931664`*^9}, {
   3.6541076103152647`*^9, 3.654107726674172*^9}, {3.654107800327899*^9, 
   3.654107805926005*^9}, {3.654107842157054*^9, 3.654107956534466*^9}, {
   3.6541080276373253`*^9, 3.654108039845397*^9}, {3.654108208328875*^9, 
   3.654108267778264*^9}, {3.654108316603101*^9, 3.65410832858707*^9}, {
   3.654122072990996*^9, 3.654122200142358*^9}, {3.654122232524707*^9, 
   3.6541222637488813`*^9}, {3.654122372486209*^9, 3.65412253592478*^9}, {
   3.654122571686759*^9, 3.654122685636675*^9}, {3.654122740902017*^9, 
   3.6541228215630703`*^9}, {3.654122865671712*^9, 3.654122935620612*^9}, {
   3.654123032181581*^9, 3.6541230914473333`*^9}, {3.654123152783122*^9, 
   3.6541232043612537`*^9}, {3.654123304611115*^9, 3.654123341073502*^9}, {
   3.654123502235703*^9, 3.654123578362132*^9}, {3.654123664279245*^9, 
   3.654123683195951*^9}, {3.6541237878998413`*^9, 3.6541238249788847`*^9}, {
   3.654123940392714*^9, 3.654123947510108*^9}, {3.654124026309593*^9, 
   3.654124026885428*^9}, 3.6541241152729683`*^9, 3.654124170343902*^9, {
   3.6541246995439568`*^9, 3.654124712871656*^9}, {3.6541251843297157`*^9, 
   3.654125231518578*^9}, {3.6541254856851683`*^9, 3.65412548908077*^9}, {
   3.654125547742125*^9, 3.654125551165526*^9}, {3.654125930807577*^9, 
   3.654126007244483*^9}, {3.654126127665163*^9, 3.654126191634789*^9}, {
   3.654126236482831*^9, 3.654126250153975*^9}, {3.6541262848658533`*^9, 
   3.654126288991514*^9}, {3.654126323055903*^9, 3.654126399729628*^9}, {
   3.654126435349374*^9, 3.654126447266036*^9}, {3.654126530077552*^9, 
   3.6541265937421*^9}, {3.654126679867402*^9, 3.6541267650289497`*^9}, {
   3.6541267969631968`*^9, 3.654126798410089*^9}, {3.654126829860013*^9, 
   3.654126881359337*^9}, {3.6541269393824577`*^9, 3.654126959132009*^9}, {
   3.654127079773924*^9, 3.654127194954756*^9}, {3.654127229244482*^9, 
   3.654127253953713*^9}, {3.6541278694900227`*^9, 3.654127878663176*^9}, {
   3.654127969775614*^9, 3.6541279938293123`*^9}, {3.654128051763153*^9, 
   3.654128134016169*^9}, {3.654128326830834*^9, 3.654128326972948*^9}, {
   3.654182305132535*^9, 3.654182317491791*^9}, {3.65418238746202*^9, 
   3.654182511491269*^9}, {3.654182551115921*^9, 3.654182559209998*^9}, {
   3.6541826265390177`*^9, 3.654182732425318*^9}, {3.654182795218339*^9, 
   3.654182802306821*^9}, {3.654182858360195*^9, 3.654182976637673*^9}, {
   3.65418309291822*^9, 3.6541831115452337`*^9}, {3.654183280620055*^9, 
   3.654183381285778*^9}, {3.6541834216733217`*^9, 3.65418343026462*^9}, {
   3.65418347398075*^9, 3.654183479016459*^9}, {3.654183517743698*^9, 
   3.654183590244978*^9}, {3.654183629340012*^9, 3.654183659551435*^9}, {
   3.654183828746057*^9, 3.654183869187777*^9}, {3.654183918271063*^9, 
   3.6541839184304667`*^9}, {3.654206461375032*^9, 3.6542064948942213`*^9}, {
   3.6542065261576433`*^9, 3.654206710642645*^9}, {3.65420685898112*^9, 
   3.654206859498214*^9}, {3.654206912388175*^9, 3.6542069199221067`*^9}, {
   3.654206956850091*^9, 3.654206957769821*^9}, {3.6542070885864773`*^9, 
   3.6542070905801163`*^9}, {3.6542071861274023`*^9, 3.654207197287834*^9}, {
   3.654207355631957*^9, 3.65420737546005*^9}, {3.654207422116619*^9, 
   3.6542074295958633`*^9}, {3.654207513008601*^9, 3.654207622631179*^9}, {
   3.6542077902321663`*^9, 3.6542079082040863`*^9}, {3.654208112675095*^9, 
   3.6542082406765347`*^9}, {3.654208390436673*^9, 3.654208437282127*^9}, {
   3.654208729398788*^9, 3.6542088242969923`*^9}, {3.654208875181876*^9, 
   3.6542089105814543`*^9}, {3.654209036563011*^9, 3.654209042056604*^9}, {
   3.654209131808134*^9, 3.654209211748107*^9}, {3.654277910558556*^9, 
   3.654277962902483*^9}, {3.6542785554956903`*^9, 3.654278555764879*^9}, {
   3.6542801407928543`*^9, 3.654280145647377*^9}, {3.654280336511973*^9, 
   3.654280388661951*^9}, {3.654735519742467*^9, 3.654735526212496*^9}, {
   3.654736711632904*^9, 3.654736744359725*^9}, {3.654736840726715*^9, 
   3.6547369027091503`*^9}, {3.6547369619155817`*^9, 3.65473711893006*^9}, 
   3.654737215212165*^9, {3.6547372623430433`*^9, 3.654737301717353*^9}, {
   3.654737434898181*^9, 3.654737445769989*^9}, {3.654737593349925*^9, 
   3.654737893647337*^9}, {3.654737938282483*^9, 3.654737939560112*^9}, {
   3.654737995469615*^9, 3.65473804382544*^9}, {3.65473814244207*^9, 
   3.65473826286047*^9}, {3.654738473301898*^9, 3.654738519313912*^9}, {
   3.654738551955141*^9, 3.654738559351729*^9}, {3.654738599129403*^9, 
   3.654738599566987*^9}, {3.654738653005966*^9, 3.654738704434928*^9}, {
   3.654738885183668*^9, 3.654738922018218*^9}, {3.654739011880048*^9, 
   3.65473910917871*^9}, {3.654739159170903*^9, 3.654739162120161*^9}, {
   3.6547393230277576`*^9, 3.6547393764227123`*^9}, {3.654739415181912*^9, 
   3.65473942023728*^9}, {3.654739453135948*^9, 3.654739679965816*^9}, {
   3.654739718627033*^9, 3.6547397334487553`*^9}, {3.654739765385715*^9, 
   3.654739851694334*^9}, {3.654739889466123*^9, 3.654740005071364*^9}, {
   3.6547400491757*^9, 3.654740154008595*^9}, 3.654740216700787*^9, {
   3.654740314399178*^9, 3.6547403286014967`*^9}, 3.6547403850818996`*^9, {
   3.654740521314966*^9, 3.654740541208376*^9}, {3.65474063388687*^9, 
   3.654740654515286*^9}, {3.654740701345427*^9, 3.654740810460566*^9}, {
   3.654740848239312*^9, 3.654741082783293*^9}, {3.654741274225429*^9, 
   3.65474127713437*^9}, 3.654741426789631*^9, {3.6547414571147537`*^9, 
   3.654741569824174*^9}, {3.654741604551594*^9, 3.65474161887015*^9}, {
   3.6547416933496304`*^9, 3.654741709459137*^9}, {3.654741935230948*^9, 
   3.654741945307493*^9}, {3.6547830386167917`*^9, 3.654783105454197*^9}, {
   3.6547832406606083`*^9, 3.6547832525310373`*^9}, {3.654783794511154*^9, 
   3.654783837663447*^9}, {3.65478390359721*^9, 3.654783909803577*^9}, {
   3.654783989474423*^9, 3.654784403124803*^9}, {3.654784520313846*^9, 
   3.654784622329711*^9}, {3.6547847231449842`*^9, 3.654784727983326*^9}, {
   3.654785122876478*^9, 3.654785187751635*^9}, {3.654785255283667*^9, 
   3.654785472044736*^9}, {3.654785554330287*^9, 3.6547855634367*^9}, {
   3.6547858133842907`*^9, 3.654785842420493*^9}, {3.654785988696732*^9, 
   3.654785999313698*^9}, {3.654786083383224*^9, 3.654786083827299*^9}, {
   3.654799998454865*^9, 3.654800009014682*^9}, 3.654800058896707*^9, {
   3.6548001027328*^9, 3.654800173381201*^9}, {3.654800206111162*^9, 
   3.654800346038969*^9}, {3.654800415767541*^9, 3.654800685527397*^9}, {
   3.654800717895743*^9, 3.6548007259529123`*^9}, {3.6548007560240192`*^9, 
   3.654800892868227*^9}, {3.654800961067473*^9, 3.6548010443125353`*^9}, {
   3.654801144205307*^9, 3.6548013970409203`*^9}, {3.654801447723054*^9, 
   3.6548014700938597`*^9}, {3.654801562889327*^9, 3.6548017505389137`*^9}, {
   3.6548017965315866`*^9, 3.654801838591158*^9}, {3.654801925163512*^9, 
   3.654801957336872*^9}, {3.654802037838778*^9, 3.654802097667626*^9}, {
   3.6548021338675137`*^9, 3.654802151746142*^9}, {3.6548021938035927`*^9, 
   3.65480226557542*^9}, {3.6548023434469347`*^9, 3.6548024564595747`*^9}, {
   3.654802493167995*^9, 3.654802498462143*^9}, {3.654802632969117*^9, 
   3.654802636326886*^9}, {3.6548026864101667`*^9, 3.6548027624957323`*^9}, {
   3.654802812209731*^9, 3.6548030159498*^9}, {3.6548066359524317`*^9, 
   3.654806720935005*^9}, {3.654806751992766*^9, 3.6548067587144833`*^9}, {
   3.654806821497799*^9, 3.654806889382121*^9}, {3.654807006283039*^9, 
   3.654807210369132*^9}, {3.654807340425975*^9, 3.6548074184588003`*^9}, {
   3.6548074913193197`*^9, 3.654807699931301*^9}, 3.6548078200861998`*^9, {
   3.654807890939335*^9, 3.65480791502777*^9}, {3.654807960842239*^9, 
   3.6548080712336483`*^9}, {3.654808128338978*^9, 3.6548081799548407`*^9}, {
   3.6548101758929577`*^9, 3.654810330104765*^9}, {3.654810401423953*^9, 
   3.654810408457419*^9}, {3.6548104718702717`*^9, 3.6548106690676603`*^9}, {
   3.6548107121438303`*^9, 3.6548108463298893`*^9}, {3.654810878513033*^9, 
   3.6548109250220337`*^9}, {3.654810973064028*^9, 3.6548109963255377`*^9}, {
   3.654811065383171*^9, 3.65481111435124*^9}, {3.6548111568410273`*^9, 
   3.654811165569319*^9}, {3.654811202562601*^9, 3.654811649746052*^9}, {
   3.657067656153129*^9, 3.657067660941557*^9}, {3.6570766750689*^9, 
   3.657076677028944*^9}, {3.658274451899232*^9, 3.6582744912918463`*^9}, {
   3.6583703518545094`*^9, 3.65837035300604*^9}, {3.6755959567829027`*^9, 
   3.675595965979847*^9}, {3.67559603247852*^9, 3.675596033012048*^9}, {
   3.675596680132864*^9, 3.6755966912919407`*^9}, {3.678096115211194*^9, 
   3.6780961185043497`*^9}, {3.690393628363669*^9, 3.6903936548561845`*^9}, 
   3.6908550611099367`*^9, {3.6924695183676157`*^9, 3.6924695606541176`*^9}, {
   3.6931534607233896`*^9, 
   3.6931534623769927`*^9}},ExpressionUUID->"fa9443b0-6014-44bc-b671-\
11d2996df7a0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"TransInv", "[", "T_", "]"}], ":", "\[IndentingNewLine]", "  ", 
     RowBox[{"Takes", " ", "T", " ", "a", " ", "transformation", " ", 
      RowBox[{"matrix", ".", "\[IndentingNewLine]", "Returns"}], " ", "its", 
      " ", 
      RowBox[{"inverse", ".", "\[IndentingNewLine]", "Used"}], " ", "the", 
      " ", "structure", " ", "of", " ", "transformation", " ", "matrices", 
      " ", "to", " ", "avoid", " ", "taking", " ", "a", " ", "matrix", " ", 
      "inverse"}]}], ",", 
    RowBox[{
     RowBox[{"for", " ", 
      RowBox[{"efficiency", "."}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Example", ":", "\[IndentingNewLine]", "Input", ":", " ", "invT"}], " ",
       "=", " ", 
      RowBox[{
       RowBox[{"TransInv", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}], "]"}],
        "//", 
       RowBox[{"MatrixForm", "\[IndentingNewLine]", 
        RowBox[{"Output", ":", " ", 
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"1", "0", "0", "0"},
             {"0", "0", "1", 
              RowBox[{"-", "3"}]},
             {"0", 
              RowBox[{"-", "1"}], "0", "0"},
             {"0", "0", "0", "1"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]]}]}]}]}]}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TransInv", "[", "T_", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"ArrayFlatten", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"T", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"1", ";;", "3"}], ",", 
             RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], "\[Transpose]"}], ",", 
         
         RowBox[{"-", 
          RowBox[{
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"1", ";;", "3"}], ",", 
               RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], "\[Transpose]"}], 
           ".", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"T", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}], "}"}], 
            "\[Transpose]"}]}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654107438701495*^9, 3.6541075770931664`*^9}, {
   3.6541076103152647`*^9, 3.654107726674172*^9}, {3.654107800327899*^9, 
   3.654107805926005*^9}, {3.654107842157054*^9, 3.654107956534466*^9}, {
   3.6541080276373253`*^9, 3.654108039845397*^9}, {3.654108208328875*^9, 
   3.654108267778264*^9}, {3.654108316603101*^9, 3.65410832858707*^9}, {
   3.654122072990996*^9, 3.654122200142358*^9}, {3.654122232524707*^9, 
   3.6541222637488813`*^9}, {3.654122372486209*^9, 3.65412253592478*^9}, {
   3.654122571686759*^9, 3.654122685636675*^9}, {3.654122740902017*^9, 
   3.6541228215630703`*^9}, {3.654122865671712*^9, 3.654122935620612*^9}, {
   3.654123032181581*^9, 3.6541230914473333`*^9}, {3.654123152783122*^9, 
   3.6541232043612537`*^9}, {3.654123304611115*^9, 3.654123341073502*^9}, {
   3.654123502235703*^9, 3.654123578362132*^9}, {3.654123664279245*^9, 
   3.654123683195951*^9}, {3.6541237878998413`*^9, 3.6541238249788847`*^9}, {
   3.654123940392714*^9, 3.654123947510108*^9}, {3.654124026309593*^9, 
   3.654124026885428*^9}, 3.6541241152729683`*^9, 3.654124170343902*^9, {
   3.6541246995439568`*^9, 3.654124712871656*^9}, {3.6541251843297157`*^9, 
   3.654125231518578*^9}, {3.6541254856851683`*^9, 3.65412548908077*^9}, {
   3.654125547742125*^9, 3.654125551165526*^9}, {3.654125930807577*^9, 
   3.654126007244483*^9}, {3.654126127665163*^9, 3.654126191634789*^9}, {
   3.654126236482831*^9, 3.654126250153975*^9}, {3.6541262848658533`*^9, 
   3.654126288991514*^9}, {3.654126323055903*^9, 3.654126399729628*^9}, {
   3.654126435349374*^9, 3.654126447266036*^9}, {3.654126530077552*^9, 
   3.6541265937421*^9}, {3.654126679867402*^9, 3.6541267650289497`*^9}, {
   3.6541267969631968`*^9, 3.654126798410089*^9}, {3.654126829860013*^9, 
   3.654126881359337*^9}, {3.6541269393824577`*^9, 3.654126959132009*^9}, {
   3.654127079773924*^9, 3.654127194954756*^9}, {3.654127229244482*^9, 
   3.654127253953713*^9}, {3.6541278694900227`*^9, 3.654127878663176*^9}, {
   3.654127969775614*^9, 3.6541279938293123`*^9}, {3.654128051763153*^9, 
   3.654128134016169*^9}, {3.654128326830834*^9, 3.654128326972948*^9}, {
   3.654182305132535*^9, 3.654182317491791*^9}, {3.65418238746202*^9, 
   3.654182511491269*^9}, {3.654182551115921*^9, 3.654182559209998*^9}, {
   3.6541826265390177`*^9, 3.654182732425318*^9}, {3.654182795218339*^9, 
   3.654182802306821*^9}, {3.654182858360195*^9, 3.654182976637673*^9}, {
   3.65418309291822*^9, 3.6541831115452337`*^9}, {3.654183280620055*^9, 
   3.654183381285778*^9}, {3.6541834216733217`*^9, 3.65418343026462*^9}, {
   3.65418347398075*^9, 3.654183479016459*^9}, {3.654183517743698*^9, 
   3.654183590244978*^9}, {3.654183629340012*^9, 3.654183659551435*^9}, {
   3.654183828746057*^9, 3.654183869187777*^9}, {3.654183918271063*^9, 
   3.6541839184304667`*^9}, {3.654206461375032*^9, 3.6542064948942213`*^9}, {
   3.6542065261576433`*^9, 3.654206710642645*^9}, {3.65420685898112*^9, 
   3.654206859498214*^9}, {3.654206912388175*^9, 3.6542069199221067`*^9}, {
   3.654206956850091*^9, 3.654206957769821*^9}, {3.6542070885864773`*^9, 
   3.6542070905801163`*^9}, {3.6542071861274023`*^9, 3.654207197287834*^9}, {
   3.654207355631957*^9, 3.65420737546005*^9}, {3.654207422116619*^9, 
   3.6542074295958633`*^9}, {3.654207513008601*^9, 3.654207622631179*^9}, {
   3.6542077902321663`*^9, 3.6542079082040863`*^9}, {3.654208112675095*^9, 
   3.6542082406765347`*^9}, {3.654208390436673*^9, 3.654208437282127*^9}, {
   3.654208729398788*^9, 3.6542088242969923`*^9}, {3.654208875181876*^9, 
   3.6542089105814543`*^9}, {3.654209036563011*^9, 3.654209042056604*^9}, {
   3.654209131808134*^9, 3.654209211748107*^9}, {3.654277910558556*^9, 
   3.654277962902483*^9}, {3.6542785554956903`*^9, 3.654278555764879*^9}, {
   3.6542801407928543`*^9, 3.654280145647377*^9}, {3.654280336511973*^9, 
   3.654280388661951*^9}, {3.654735519742467*^9, 3.654735526212496*^9}, {
   3.654736711632904*^9, 3.654736744359725*^9}, {3.654736840726715*^9, 
   3.6547369027091503`*^9}, {3.6547369619155817`*^9, 3.65473711893006*^9}, 
   3.654737215212165*^9, {3.6547372623430433`*^9, 3.654737301717353*^9}, {
   3.654737434898181*^9, 3.654737445769989*^9}, {3.654737593349925*^9, 
   3.654737893647337*^9}, {3.654737938282483*^9, 3.654737939560112*^9}, {
   3.654737995469615*^9, 3.65473804382544*^9}, {3.65473814244207*^9, 
   3.65473826286047*^9}, {3.654738473301898*^9, 3.654738519313912*^9}, {
   3.654738551955141*^9, 3.654738559351729*^9}, {3.654738599129403*^9, 
   3.654738599566987*^9}, {3.654738653005966*^9, 3.654738704434928*^9}, {
   3.654738885183668*^9, 3.654738922018218*^9}, {3.654739011880048*^9, 
   3.65473910917871*^9}, {3.654739159170903*^9, 3.654739162120161*^9}, {
   3.6547393230277576`*^9, 3.6547393764227123`*^9}, {3.654739415181912*^9, 
   3.65473942023728*^9}, {3.654739453135948*^9, 3.654739679965816*^9}, {
   3.654739718627033*^9, 3.6547397334487553`*^9}, {3.654739765385715*^9, 
   3.654739851694334*^9}, {3.654739889466123*^9, 3.654740005071364*^9}, {
   3.6547400491757*^9, 3.654740154008595*^9}, 3.654740216700787*^9, {
   3.654740314399178*^9, 3.6547403286014967`*^9}, 3.6547403850818996`*^9, {
   3.654740521314966*^9, 3.654740541208376*^9}, {3.65474063388687*^9, 
   3.654740654515286*^9}, {3.654740701345427*^9, 3.654740810460566*^9}, {
   3.654740848239312*^9, 3.654741082783293*^9}, {3.654741274225429*^9, 
   3.65474127713437*^9}, 3.654741426789631*^9, {3.6547414571147537`*^9, 
   3.654741569824174*^9}, {3.654741604551594*^9, 3.65474161887015*^9}, {
   3.6547416933496304`*^9, 3.654741709459137*^9}, {3.654741935230948*^9, 
   3.654741945307493*^9}, {3.6547830386167917`*^9, 3.654783105454197*^9}, {
   3.6547832406606083`*^9, 3.6547832525310373`*^9}, {3.654783794511154*^9, 
   3.654783837663447*^9}, {3.65478390359721*^9, 3.654783909803577*^9}, {
   3.654783989474423*^9, 3.654784403124803*^9}, {3.654784520313846*^9, 
   3.654784622329711*^9}, {3.6547847231449842`*^9, 3.654784727983326*^9}, {
   3.654785122876478*^9, 3.654785187751635*^9}, {3.654785255283667*^9, 
   3.654785472044736*^9}, {3.654785554330287*^9, 3.6547855634367*^9}, {
   3.6547858133842907`*^9, 3.654785842420493*^9}, {3.654785988696732*^9, 
   3.654785999313698*^9}, {3.654786083383224*^9, 3.654786083827299*^9}, {
   3.654799998454865*^9, 3.654800009014682*^9}, 3.654800058896707*^9, {
   3.6548001027328*^9, 3.654800173381201*^9}, {3.654800206111162*^9, 
   3.654800346038969*^9}, {3.654800415767541*^9, 3.654800685527397*^9}, {
   3.654800717895743*^9, 3.6548007259529123`*^9}, {3.6548007560240192`*^9, 
   3.654800892868227*^9}, {3.654800961067473*^9, 3.6548010443125353`*^9}, {
   3.654801144205307*^9, 3.6548013970409203`*^9}, {3.654801447723054*^9, 
   3.6548014700938597`*^9}, {3.654801562889327*^9, 3.6548017505389137`*^9}, {
   3.6548017965315866`*^9, 3.654801838591158*^9}, {3.654801925163512*^9, 
   3.654801957336872*^9}, {3.654802037838778*^9, 3.654802097667626*^9}, {
   3.6548021338675137`*^9, 3.654802151746142*^9}, {3.6548021938035927`*^9, 
   3.65480226557542*^9}, {3.6548023434469347`*^9, 3.6548024564595747`*^9}, {
   3.654802493167995*^9, 3.654802498462143*^9}, {3.654802632969117*^9, 
   3.654802636326886*^9}, {3.6548026864101667`*^9, 3.6548027624957323`*^9}, {
   3.654802812209731*^9, 3.6548030159498*^9}, {3.6548066359524317`*^9, 
   3.654806720935005*^9}, {3.654806751992766*^9, 3.6548067587144833`*^9}, {
   3.654806821497799*^9, 3.654806889382121*^9}, {3.654807006283039*^9, 
   3.654807210369132*^9}, {3.654807340425975*^9, 3.6548074184588003`*^9}, {
   3.6548074913193197`*^9, 3.654807699931301*^9}, 3.6548078200861998`*^9, {
   3.654807890939335*^9, 3.65480791502777*^9}, {3.654807960842239*^9, 
   3.6548080712336483`*^9}, {3.654808128338978*^9, 3.6548081799548407`*^9}, {
   3.6548101758929577`*^9, 3.654810330104765*^9}, {3.654810401423953*^9, 
   3.654810408457419*^9}, {3.6548104718702717`*^9, 3.6548106690676603`*^9}, {
   3.6548107121438303`*^9, 3.6548108463298893`*^9}, {3.654810878513033*^9, 
   3.6548109250220337`*^9}, {3.654810973064028*^9, 3.6548109963255377`*^9}, {
   3.654811065383171*^9, 3.65481111435124*^9}, {3.6548111568410273`*^9, 
   3.654811165569319*^9}, {3.654811202562601*^9, 3.654811649746052*^9}, {
   3.657067656153129*^9, 3.657067660941557*^9}, {3.6570766750689*^9, 
   3.657076677028944*^9}, {3.658274451899232*^9, 3.6582744912918463`*^9}, {
   3.6583703518545094`*^9, 3.65837035300604*^9}, {3.675596758956827*^9, 
   3.675596816647419*^9}, {3.6755968603462763`*^9, 3.675596904061962*^9}, {
   3.675596971182308*^9, 3.675596988729371*^9}, {3.6780961229623423`*^9, 
   3.6780961264717283`*^9}, 3.690855031117347*^9, 3.690855063558672*^9, {
   3.692469609729433*^9, 3.6924696294652824`*^9}, {3.6931534681178026`*^9, 
   3.693153470005406*^9}},ExpressionUUID->"0d5adffd-00b3-4fd2-a2d9-\
c7b72cbcf88d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"VecTose3", "[", "V_", "]"}], ":", "\[IndentingNewLine]", "   ", 
     
     RowBox[{
      RowBox[{"Takes", " ", "a", " ", "6"}], "-", 
      RowBox[{"vector", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"representing", " ", "a", " ", "spatial", " ", "velocity"}], 
         ")"}], ".", "\[IndentingNewLine]", "Returns"}], " ", "the", " ", 
       "corresponding", " ", "4", "x4", " ", "se", 
       RowBox[{"(", "3", ")"}], " ", "matrix"}]}]}], "\[IndentingNewLine]", 
    ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Example", ":", "\[IndentingNewLine]", "Input", ":", " ", "se3mat"}], 
     " ", "=", " ", 
     RowBox[{
      RowBox[{"VecTose3", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6"}], 
          "}"}], "}"}], "\[Transpose]"}], "]"}], "//", 
      RowBox[{"MatrixForm", "\[IndentingNewLine]", 
       RowBox[{"Output", ":", " ", 
        TagBox[
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {"0", 
             RowBox[{"-", "3"}], "2", "4"},
            {"3", "0", 
             RowBox[{"-", "1"}], "5"},
            {
             RowBox[{"-", "2"}], "1", "0", "6"},
            {"0", "0", "0", "0"}
           },
           
           GridBoxAlignment->{
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.7]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
         Function[BoxForm`e$, 
          MatrixForm[BoxForm`e$]]]}]}]}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"VecTose3", "[", "V_", "]"}], ":=", 
    RowBox[{"ArrayFlatten", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"VecToso3", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"V", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"1", ";;", "3"}], ",", "1"}], "]"}], "]"}], "}"}], 
           "\[Transpose]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"V", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"4", ";;", "6"}], ",", "1"}], "]"}], "]"}], "}"}], 
          "\[Transpose]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654107438701495*^9, 3.6541075770931664`*^9}, {
   3.6541076103152647`*^9, 3.654107726674172*^9}, {3.654107800327899*^9, 
   3.654107805926005*^9}, {3.654107842157054*^9, 3.654107956534466*^9}, {
   3.6541080276373253`*^9, 3.654108039845397*^9}, {3.654108208328875*^9, 
   3.654108267778264*^9}, {3.654108316603101*^9, 3.65410832858707*^9}, {
   3.654122072990996*^9, 3.654122200142358*^9}, {3.654122232524707*^9, 
   3.6541222637488813`*^9}, {3.654122372486209*^9, 3.65412253592478*^9}, {
   3.654122571686759*^9, 3.654122685636675*^9}, {3.654122740902017*^9, 
   3.6541228215630703`*^9}, {3.654122865671712*^9, 3.654122935620612*^9}, {
   3.654123032181581*^9, 3.6541230914473333`*^9}, {3.654123152783122*^9, 
   3.6541232043612537`*^9}, {3.654123304611115*^9, 3.654123341073502*^9}, {
   3.654123502235703*^9, 3.654123578362132*^9}, {3.654123664279245*^9, 
   3.654123683195951*^9}, {3.6541237878998413`*^9, 3.6541238249788847`*^9}, {
   3.654123940392714*^9, 3.654123947510108*^9}, {3.654124026309593*^9, 
   3.654124026885428*^9}, 3.6541241152729683`*^9, 3.654124170343902*^9, {
   3.6541246995439568`*^9, 3.654124712871656*^9}, {3.6541251843297157`*^9, 
   3.654125231518578*^9}, {3.6541254856851683`*^9, 3.65412548908077*^9}, {
   3.654125547742125*^9, 3.654125551165526*^9}, {3.654125930807577*^9, 
   3.654126007244483*^9}, {3.654126127665163*^9, 3.654126191634789*^9}, {
   3.654126236482831*^9, 3.654126250153975*^9}, {3.6541262848658533`*^9, 
   3.654126288991514*^9}, {3.654126323055903*^9, 3.654126399729628*^9}, {
   3.654126435349374*^9, 3.654126447266036*^9}, {3.654126530077552*^9, 
   3.6541265937421*^9}, {3.654126679867402*^9, 3.6541267650289497`*^9}, {
   3.6541267969631968`*^9, 3.654126798410089*^9}, {3.654126829860013*^9, 
   3.654126881359337*^9}, {3.6541269393824577`*^9, 3.654126959132009*^9}, {
   3.654127079773924*^9, 3.654127194954756*^9}, {3.654127229244482*^9, 
   3.654127253953713*^9}, {3.6541278694900227`*^9, 3.654127878663176*^9}, {
   3.654127969775614*^9, 3.6541279938293123`*^9}, {3.654128051763153*^9, 
   3.654128134016169*^9}, {3.654128326830834*^9, 3.654128326972948*^9}, {
   3.654182305132535*^9, 3.654182317491791*^9}, {3.65418238746202*^9, 
   3.654182511491269*^9}, {3.654182551115921*^9, 3.654182559209998*^9}, {
   3.6541826265390177`*^9, 3.654182732425318*^9}, {3.654182795218339*^9, 
   3.654182802306821*^9}, {3.654182858360195*^9, 3.654182976637673*^9}, {
   3.65418309291822*^9, 3.6541831115452337`*^9}, {3.654183280620055*^9, 
   3.654183381285778*^9}, {3.6541834216733217`*^9, 3.65418343026462*^9}, {
   3.65418347398075*^9, 3.654183479016459*^9}, {3.654183517743698*^9, 
   3.654183590244978*^9}, {3.654183629340012*^9, 3.654183659551435*^9}, {
   3.654183828746057*^9, 3.654183869187777*^9}, {3.654183918271063*^9, 
   3.6541839184304667`*^9}, {3.654206461375032*^9, 3.6542064948942213`*^9}, {
   3.6542065261576433`*^9, 3.654206710642645*^9}, {3.65420685898112*^9, 
   3.654206859498214*^9}, {3.654206912388175*^9, 3.6542069199221067`*^9}, {
   3.654206956850091*^9, 3.654206957769821*^9}, {3.6542070885864773`*^9, 
   3.6542070905801163`*^9}, {3.6542071861274023`*^9, 3.654207197287834*^9}, {
   3.654207355631957*^9, 3.65420737546005*^9}, {3.654207422116619*^9, 
   3.6542074295958633`*^9}, {3.654207513008601*^9, 3.654207622631179*^9}, {
   3.6542077902321663`*^9, 3.6542079082040863`*^9}, {3.654208112675095*^9, 
   3.6542082406765347`*^9}, {3.654208390436673*^9, 3.654208437282127*^9}, {
   3.654208729398788*^9, 3.6542088242969923`*^9}, {3.654208875181876*^9, 
   3.6542089105814543`*^9}, {3.654209036563011*^9, 3.654209042056604*^9}, {
   3.654209131808134*^9, 3.654209211748107*^9}, {3.654277910558556*^9, 
   3.654277962902483*^9}, {3.6542785554956903`*^9, 3.654278555764879*^9}, {
   3.6542801407928543`*^9, 3.654280145647377*^9}, {3.654280336511973*^9, 
   3.654280388661951*^9}, {3.654735519742467*^9, 3.654735526212496*^9}, {
   3.654736711632904*^9, 3.654736744359725*^9}, {3.654736840726715*^9, 
   3.6547369027091503`*^9}, {3.6547369619155817`*^9, 3.65473711893006*^9}, 
   3.654737215212165*^9, {3.6547372623430433`*^9, 3.654737301717353*^9}, {
   3.654737434898181*^9, 3.654737445769989*^9}, {3.654737593349925*^9, 
   3.654737893647337*^9}, {3.654737938282483*^9, 3.654737939560112*^9}, {
   3.654737995469615*^9, 3.65473804382544*^9}, {3.65473814244207*^9, 
   3.65473826286047*^9}, {3.654738473301898*^9, 3.654738519313912*^9}, {
   3.654738551955141*^9, 3.654738559351729*^9}, {3.654738599129403*^9, 
   3.654738599566987*^9}, {3.654738653005966*^9, 3.654738704434928*^9}, {
   3.654738885183668*^9, 3.654738922018218*^9}, {3.654739011880048*^9, 
   3.65473910917871*^9}, {3.654739159170903*^9, 3.654739162120161*^9}, {
   3.6547393230277576`*^9, 3.6547393764227123`*^9}, {3.654739415181912*^9, 
   3.65473942023728*^9}, {3.654739453135948*^9, 3.654739679965816*^9}, {
   3.654739718627033*^9, 3.6547397334487553`*^9}, {3.654739765385715*^9, 
   3.654739851694334*^9}, {3.654739889466123*^9, 3.654740005071364*^9}, {
   3.6547400491757*^9, 3.654740154008595*^9}, 3.654740216700787*^9, {
   3.654740314399178*^9, 3.6547403286014967`*^9}, 3.6547403850818996`*^9, {
   3.654740521314966*^9, 3.654740541208376*^9}, {3.65474063388687*^9, 
   3.654740654515286*^9}, {3.654740701345427*^9, 3.654740810460566*^9}, {
   3.654740848239312*^9, 3.654741082783293*^9}, {3.654741274225429*^9, 
   3.65474127713437*^9}, 3.654741426789631*^9, {3.6547414571147537`*^9, 
   3.654741569824174*^9}, {3.654741604551594*^9, 3.65474161887015*^9}, {
   3.6547416933496304`*^9, 3.654741709459137*^9}, {3.654741935230948*^9, 
   3.654741945307493*^9}, {3.6547830386167917`*^9, 3.654783105454197*^9}, {
   3.6547832406606083`*^9, 3.6547832525310373`*^9}, {3.654783794511154*^9, 
   3.654783837663447*^9}, {3.65478390359721*^9, 3.654783909803577*^9}, {
   3.654783989474423*^9, 3.654784403124803*^9}, {3.654784520313846*^9, 
   3.654784622329711*^9}, {3.6547847231449842`*^9, 3.654784727983326*^9}, {
   3.654785122876478*^9, 3.654785187751635*^9}, {3.654785255283667*^9, 
   3.654785472044736*^9}, {3.654785554330287*^9, 3.6547855634367*^9}, {
   3.6547858133842907`*^9, 3.654785842420493*^9}, {3.654785988696732*^9, 
   3.654785999313698*^9}, {3.654786083383224*^9, 3.654786083827299*^9}, {
   3.654799998454865*^9, 3.654800009014682*^9}, 3.654800058896707*^9, {
   3.6548001027328*^9, 3.654800173381201*^9}, {3.654800206111162*^9, 
   3.654800346038969*^9}, {3.654800415767541*^9, 3.654800685527397*^9}, {
   3.654800717895743*^9, 3.6548007259529123`*^9}, {3.6548007560240192`*^9, 
   3.654800892868227*^9}, {3.654800961067473*^9, 3.6548010443125353`*^9}, {
   3.654801144205307*^9, 3.6548013970409203`*^9}, {3.654801447723054*^9, 
   3.6548014700938597`*^9}, {3.654801562889327*^9, 3.6548017505389137`*^9}, {
   3.6548017965315866`*^9, 3.654801838591158*^9}, {3.654801925163512*^9, 
   3.654801957336872*^9}, {3.654802037838778*^9, 3.654802097667626*^9}, {
   3.6548021338675137`*^9, 3.654802151746142*^9}, {3.6548021938035927`*^9, 
   3.65480226557542*^9}, {3.6548023434469347`*^9, 3.6548024564595747`*^9}, {
   3.654802493167995*^9, 3.654802498462143*^9}, {3.654802632969117*^9, 
   3.654802636326886*^9}, {3.6548026864101667`*^9, 3.6548027624957323`*^9}, {
   3.654802812209731*^9, 3.6548030159498*^9}, {3.6548066359524317`*^9, 
   3.654806720935005*^9}, {3.654806751992766*^9, 3.6548067587144833`*^9}, {
   3.654806821497799*^9, 3.654806889382121*^9}, {3.654807006283039*^9, 
   3.654807210369132*^9}, {3.654807340425975*^9, 3.6548074184588003`*^9}, {
   3.6548074913193197`*^9, 3.654807699931301*^9}, 3.6548078200861998`*^9, {
   3.654807890939335*^9, 3.65480791502777*^9}, {3.654807960842239*^9, 
   3.6548080712336483`*^9}, {3.654808128338978*^9, 3.6548081799548407`*^9}, {
   3.6548101758929577`*^9, 3.654810330104765*^9}, {3.654810401423953*^9, 
   3.654810408457419*^9}, {3.6548104718702717`*^9, 3.6548106690676603`*^9}, {
   3.6548107121438303`*^9, 3.6548108463298893`*^9}, {3.654810878513033*^9, 
   3.6548109250220337`*^9}, {3.654810973064028*^9, 3.6548109963255377`*^9}, {
   3.654811065383171*^9, 3.65481111435124*^9}, {3.6548111568410273`*^9, 
   3.654811165569319*^9}, {3.654811202562601*^9, 3.654811649746052*^9}, {
   3.657067656153129*^9, 3.657067660941557*^9}, {3.6570766750689*^9, 
   3.657076677028944*^9}, {3.658274451899232*^9, 3.6582744912918463`*^9}, {
   3.6583703518545094`*^9, 3.65837035300604*^9}, {3.675597080161522*^9, 
   3.675597119970598*^9}, {3.675597158104844*^9, 3.675597160162319*^9}, {
   3.675597211069208*^9, 3.675597216985806*^9}, {3.678096131049049*^9, 
   3.678096133158791*^9}, 3.690425584100696*^9, {3.6908550657287827`*^9, 
   3.690855066083803*^9}, {3.692469640014104*^9, 3.6924696452475147`*^9}, {
   3.693153479115822*^9, 
   3.693153480753825*^9}},ExpressionUUID->"714eca3f-16a5-4ea7-8474-\
d28bf3a85bb8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"se3ToVec", "[", "se3mat_", "]"}], ":", "\[IndentingNewLine]", 
     "   ", 
     RowBox[{
      RowBox[{"Takes", " ", "se3mat", " ", "a", " ", "4", "x4", " ", "se", 
       RowBox[{"(", "3", ")"}], " ", 
       RowBox[{"matrix", ".", "\[IndentingNewLine]", "Returns"}], " ", "the", 
       " ", "corresponding", " ", "6"}], "-", 
      RowBox[{"vector", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"representing", " ", "spatial", " ", "velocity"}], ")"}], 
        "."}]}]}]}], "\[IndentingNewLine]", ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Example", ":", "\[IndentingNewLine]", "Input", ":", " ", "V"}], 
     " ", "=", " ", 
     RowBox[{
      RowBox[{"se3ToVec", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", "3"}], ",", "2", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "0", ",", 
           RowBox[{"-", "1"}], ",", "5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "1", ",", "0", ",", "6"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Output", ":", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "1", "}"}], ",", 
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", "3", "}"}], ",", 
         RowBox[{"{", "4", "}"}], ",", 
         RowBox[{"{", "5", "}"}], ",", 
         RowBox[{"{", "6", "}"}]}], "}"}]}]}]}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"se3ToVec", "[", "se3mat_", "]"}], ":=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"se3mat", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"se3mat", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", 
        RowBox[{"se3mat", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"se3mat", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "4"}], "]"}], "]"}], ",", 
        RowBox[{"se3mat", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "4"}], "]"}], "]"}], ",", 
        RowBox[{"se3mat", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "4"}], "]"}], "]"}]}], "}"}], "}"}], 
     "\[Transpose]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654107438701495*^9, 3.6541075770931664`*^9}, {
   3.6541076103152647`*^9, 3.654107726674172*^9}, {3.654107800327899*^9, 
   3.654107805926005*^9}, {3.654107842157054*^9, 3.654107956534466*^9}, {
   3.6541080276373253`*^9, 3.654108039845397*^9}, {3.654108208328875*^9, 
   3.654108267778264*^9}, {3.654108316603101*^9, 3.65410832858707*^9}, {
   3.654122072990996*^9, 3.654122200142358*^9}, {3.654122232524707*^9, 
   3.6541222637488813`*^9}, {3.654122372486209*^9, 3.65412253592478*^9}, {
   3.654122571686759*^9, 3.654122685636675*^9}, {3.654122740902017*^9, 
   3.6541228215630703`*^9}, {3.654122865671712*^9, 3.654122935620612*^9}, {
   3.654123032181581*^9, 3.6541230914473333`*^9}, {3.654123152783122*^9, 
   3.6541232043612537`*^9}, {3.654123304611115*^9, 3.654123341073502*^9}, {
   3.654123502235703*^9, 3.654123578362132*^9}, {3.654123664279245*^9, 
   3.654123683195951*^9}, {3.6541237878998413`*^9, 3.6541238249788847`*^9}, {
   3.654123940392714*^9, 3.654123947510108*^9}, {3.654124026309593*^9, 
   3.654124026885428*^9}, 3.6541241152729683`*^9, 3.654124170343902*^9, {
   3.6541246995439568`*^9, 3.654124712871656*^9}, {3.6541251843297157`*^9, 
   3.654125231518578*^9}, {3.6541254856851683`*^9, 3.65412548908077*^9}, {
   3.654125547742125*^9, 3.654125551165526*^9}, {3.654125930807577*^9, 
   3.654126007244483*^9}, {3.654126127665163*^9, 3.654126191634789*^9}, {
   3.654126236482831*^9, 3.654126250153975*^9}, {3.6541262848658533`*^9, 
   3.654126288991514*^9}, {3.654126323055903*^9, 3.654126399729628*^9}, {
   3.654126435349374*^9, 3.654126447266036*^9}, {3.654126530077552*^9, 
   3.6541265937421*^9}, {3.654126679867402*^9, 3.6541267650289497`*^9}, {
   3.6541267969631968`*^9, 3.654126798410089*^9}, {3.654126829860013*^9, 
   3.654126881359337*^9}, {3.6541269393824577`*^9, 3.654126959132009*^9}, {
   3.654127079773924*^9, 3.654127194954756*^9}, {3.654127229244482*^9, 
   3.654127253953713*^9}, {3.6541278694900227`*^9, 3.654127878663176*^9}, {
   3.654127969775614*^9, 3.6541279938293123`*^9}, {3.654128051763153*^9, 
   3.654128134016169*^9}, {3.654128326830834*^9, 3.654128326972948*^9}, {
   3.654182305132535*^9, 3.654182317491791*^9}, {3.65418238746202*^9, 
   3.654182511491269*^9}, {3.654182551115921*^9, 3.654182559209998*^9}, {
   3.6541826265390177`*^9, 3.654182732425318*^9}, {3.654182795218339*^9, 
   3.654182802306821*^9}, {3.654182858360195*^9, 3.654182976637673*^9}, {
   3.65418309291822*^9, 3.6541831115452337`*^9}, {3.654183280620055*^9, 
   3.654183381285778*^9}, {3.6541834216733217`*^9, 3.65418343026462*^9}, {
   3.65418347398075*^9, 3.654183479016459*^9}, {3.654183517743698*^9, 
   3.654183590244978*^9}, {3.654183629340012*^9, 3.654183659551435*^9}, {
   3.654183828746057*^9, 3.654183869187777*^9}, {3.654183918271063*^9, 
   3.6541839184304667`*^9}, {3.654206461375032*^9, 3.6542064948942213`*^9}, {
   3.6542065261576433`*^9, 3.654206710642645*^9}, {3.65420685898112*^9, 
   3.654206859498214*^9}, {3.654206912388175*^9, 3.6542069199221067`*^9}, {
   3.654206956850091*^9, 3.654206957769821*^9}, {3.6542070885864773`*^9, 
   3.6542070905801163`*^9}, {3.6542071861274023`*^9, 3.654207197287834*^9}, {
   3.654207355631957*^9, 3.65420737546005*^9}, {3.654207422116619*^9, 
   3.6542074295958633`*^9}, {3.654207513008601*^9, 3.654207622631179*^9}, {
   3.6542077902321663`*^9, 3.6542079082040863`*^9}, {3.654208112675095*^9, 
   3.6542082406765347`*^9}, {3.654208390436673*^9, 3.654208437282127*^9}, {
   3.654208729398788*^9, 3.6542088242969923`*^9}, {3.654208875181876*^9, 
   3.6542089105814543`*^9}, {3.654209036563011*^9, 3.654209042056604*^9}, {
   3.654209131808134*^9, 3.654209211748107*^9}, {3.654277910558556*^9, 
   3.654277962902483*^9}, {3.6542785554956903`*^9, 3.654278555764879*^9}, {
   3.6542801407928543`*^9, 3.654280145647377*^9}, {3.654280336511973*^9, 
   3.654280388661951*^9}, {3.654735519742467*^9, 3.654735526212496*^9}, {
   3.654736711632904*^9, 3.654736744359725*^9}, {3.654736840726715*^9, 
   3.6547369027091503`*^9}, {3.6547369619155817`*^9, 3.65473711893006*^9}, 
   3.654737215212165*^9, {3.6547372623430433`*^9, 3.654737301717353*^9}, {
   3.654737434898181*^9, 3.654737445769989*^9}, {3.654737593349925*^9, 
   3.654737893647337*^9}, {3.654737938282483*^9, 3.654737939560112*^9}, {
   3.654737995469615*^9, 3.65473804382544*^9}, {3.65473814244207*^9, 
   3.65473826286047*^9}, {3.654738473301898*^9, 3.654738519313912*^9}, {
   3.654738551955141*^9, 3.654738559351729*^9}, {3.654738599129403*^9, 
   3.654738599566987*^9}, {3.654738653005966*^9, 3.654738704434928*^9}, {
   3.654738885183668*^9, 3.654738922018218*^9}, {3.654739011880048*^9, 
   3.65473910917871*^9}, {3.654739159170903*^9, 3.654739162120161*^9}, {
   3.6547393230277576`*^9, 3.6547393764227123`*^9}, {3.654739415181912*^9, 
   3.65473942023728*^9}, {3.654739453135948*^9, 3.654739679965816*^9}, {
   3.654739718627033*^9, 3.6547397334487553`*^9}, {3.654739765385715*^9, 
   3.654739851694334*^9}, {3.654739889466123*^9, 3.654740005071364*^9}, {
   3.6547400491757*^9, 3.654740154008595*^9}, 3.654740216700787*^9, {
   3.654740314399178*^9, 3.6547403286014967`*^9}, 3.6547403850818996`*^9, {
   3.654740521314966*^9, 3.654740541208376*^9}, {3.65474063388687*^9, 
   3.654740654515286*^9}, {3.654740701345427*^9, 3.654740810460566*^9}, {
   3.654740848239312*^9, 3.654741082783293*^9}, {3.654741274225429*^9, 
   3.65474127713437*^9}, 3.654741426789631*^9, {3.6547414571147537`*^9, 
   3.654741569824174*^9}, {3.654741604551594*^9, 3.65474161887015*^9}, {
   3.6547416933496304`*^9, 3.654741709459137*^9}, {3.654741935230948*^9, 
   3.654741945307493*^9}, {3.6547830386167917`*^9, 3.654783105454197*^9}, {
   3.6547832406606083`*^9, 3.6547832525310373`*^9}, {3.654783794511154*^9, 
   3.654783837663447*^9}, {3.65478390359721*^9, 3.654783909803577*^9}, {
   3.654783989474423*^9, 3.654784403124803*^9}, {3.654784520313846*^9, 
   3.654784622329711*^9}, {3.6547847231449842`*^9, 3.654784727983326*^9}, {
   3.654785122876478*^9, 3.654785187751635*^9}, {3.654785255283667*^9, 
   3.654785472044736*^9}, {3.654785554330287*^9, 3.6547855634367*^9}, {
   3.6547858133842907`*^9, 3.654785842420493*^9}, {3.654785988696732*^9, 
   3.654785999313698*^9}, {3.654786083383224*^9, 3.654786083827299*^9}, {
   3.654799998454865*^9, 3.654800009014682*^9}, 3.654800058896707*^9, {
   3.6548001027328*^9, 3.654800173381201*^9}, {3.654800206111162*^9, 
   3.654800346038969*^9}, {3.654800415767541*^9, 3.654800685527397*^9}, {
   3.654800717895743*^9, 3.6548007259529123`*^9}, {3.6548007560240192`*^9, 
   3.654800892868227*^9}, {3.654800961067473*^9, 3.6548010443125353`*^9}, {
   3.654801144205307*^9, 3.6548013970409203`*^9}, {3.654801447723054*^9, 
   3.6548014700938597`*^9}, {3.654801562889327*^9, 3.6548017505389137`*^9}, {
   3.6548017965315866`*^9, 3.654801838591158*^9}, {3.654801925163512*^9, 
   3.654801957336872*^9}, {3.654802037838778*^9, 3.654802097667626*^9}, {
   3.6548021338675137`*^9, 3.654802151746142*^9}, {3.6548021938035927`*^9, 
   3.65480226557542*^9}, {3.6548023434469347`*^9, 3.6548024564595747`*^9}, {
   3.654802493167995*^9, 3.654802498462143*^9}, {3.654802632969117*^9, 
   3.654802636326886*^9}, {3.6548026864101667`*^9, 3.6548027624957323`*^9}, {
   3.654802812209731*^9, 3.6548030159498*^9}, {3.6548066359524317`*^9, 
   3.654806720935005*^9}, {3.654806751992766*^9, 3.6548067587144833`*^9}, {
   3.654806821497799*^9, 3.654806889382121*^9}, {3.654807006283039*^9, 
   3.654807210369132*^9}, {3.654807340425975*^9, 3.6548074184588003`*^9}, {
   3.6548074913193197`*^9, 3.654807699931301*^9}, 3.6548078200861998`*^9, {
   3.654807890939335*^9, 3.65480791502777*^9}, {3.654807960842239*^9, 
   3.6548080712336483`*^9}, {3.654808128338978*^9, 3.6548081799548407`*^9}, {
   3.6548101758929577`*^9, 3.654810330104765*^9}, {3.654810401423953*^9, 
   3.654810408457419*^9}, {3.6548104718702717`*^9, 3.6548106690676603`*^9}, {
   3.6548107121438303`*^9, 3.6548108463298893`*^9}, {3.654810878513033*^9, 
   3.6548109250220337`*^9}, {3.654810973064028*^9, 3.6548109963255377`*^9}, {
   3.654811065383171*^9, 3.65481111435124*^9}, {3.6548111568410273`*^9, 
   3.654811165569319*^9}, {3.654811202562601*^9, 3.654811649746052*^9}, {
   3.657067656153129*^9, 3.657067660941557*^9}, {3.6570766750689*^9, 
   3.657076677028944*^9}, {3.658274451899232*^9, 3.6582744912918463`*^9}, {
   3.6583703518545094`*^9, 3.65837035300604*^9}, {3.6755973505611753`*^9, 
   3.675597361941107*^9}, {3.675597420571553*^9, 3.675597428321558*^9}, {
   3.6755976369085283`*^9, 3.675597642481595*^9}, {3.6755978045694723`*^9, 
   3.675597816797654*^9}, {3.6780961362188787`*^9, 3.678096138047097*^9}, {
   3.6904267079109745`*^9, 3.6904267082029915`*^9}, 3.6908550701496177`*^9, {
   3.692469658216547*^9, 3.692469661621353*^9}, {3.6931534906910424`*^9, 
   3.693153492095045*^9}},ExpressionUUID->"b112c66f-befc-41f6-b959-\
5661164488a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Adjoint", "[", "T_", "]"}], ":", "\[IndentingNewLine]", "  ", 
     RowBox[{
     "Takes", " ", "T", " ", "a", " ", "transformation", " ", "matrix", " ", 
      "SE", 
      RowBox[{
       RowBox[{"(", "3", ")"}], ".", "\[IndentingNewLine]", "Returns"}], " ", 
      "the", " ", "corresponding", " ", "6", "x6", " ", "adjoint", " ", 
      RowBox[{"representation", "[", "AdT", "]"}]}]}], "\[IndentingNewLine]", 
    ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Example", ":", "\[IndentingNewLine]", "Input", ":", " ", "AdT"}], " ", 
     "=", " ", 
     RowBox[{
      RowBox[{"Adjoint", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}], "]"}], 
      "//", 
      RowBox[{"MatrixForm", "\[IndentingNewLine]", 
       RowBox[{"Output", ":", " ", 
        TagBox[
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {"1", "0", "0", "0", "0", "0"},
            {"0", "0", 
             RowBox[{"-", "1"}], "0", "0", "0"},
            {"0", "1", "0", "0", "0", "0"},
            {"0", "0", "3", "1", "0", "0"},
            {"3", "0", "0", "0", "0", 
             RowBox[{"-", "1"}]},
            {"0", "0", "0", "0", "1", "0"}
           },
           
           GridBoxAlignment->{
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.7]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
         Function[BoxForm`e$, 
          MatrixForm[BoxForm`e$]]]}]}]}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Adjoint", "[", "T_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"R", ",", "p"}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"R", ",", "p"}], "}"}], "=", 
        RowBox[{"TransToRp", "[", "T", "]"}]}], ";", 
       RowBox[{"Return", "[", 
        RowBox[{"ArrayFlatten", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"R", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"VecToso3", "[", "p", "]"}], ".", "R"}], ",", "R"}], 
            "}"}]}], "}"}], "]"}], "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654107438701495*^9, 3.6541075770931664`*^9}, {
   3.6541076103152647`*^9, 3.654107726674172*^9}, {3.654107800327899*^9, 
   3.654107805926005*^9}, {3.654107842157054*^9, 3.654107956534466*^9}, {
   3.6541080276373253`*^9, 3.654108039845397*^9}, {3.654108208328875*^9, 
   3.654108267778264*^9}, {3.654108316603101*^9, 3.65410832858707*^9}, {
   3.654122072990996*^9, 3.654122200142358*^9}, {3.654122232524707*^9, 
   3.6541222637488813`*^9}, {3.654122372486209*^9, 3.65412253592478*^9}, {
   3.654122571686759*^9, 3.654122685636675*^9}, {3.654122740902017*^9, 
   3.6541228215630703`*^9}, {3.654122865671712*^9, 3.654122935620612*^9}, {
   3.654123032181581*^9, 3.6541230914473333`*^9}, {3.654123152783122*^9, 
   3.6541232043612537`*^9}, {3.654123304611115*^9, 3.654123341073502*^9}, {
   3.654123502235703*^9, 3.654123578362132*^9}, {3.654123664279245*^9, 
   3.654123683195951*^9}, {3.6541237878998413`*^9, 3.6541238249788847`*^9}, {
   3.654123940392714*^9, 3.654123947510108*^9}, {3.654124026309593*^9, 
   3.654124026885428*^9}, 3.6541241152729683`*^9, 3.654124170343902*^9, {
   3.6541246995439568`*^9, 3.654124712871656*^9}, {3.6541251843297157`*^9, 
   3.654125231518578*^9}, {3.6541254856851683`*^9, 3.65412548908077*^9}, {
   3.654125547742125*^9, 3.654125551165526*^9}, {3.654125930807577*^9, 
   3.654126007244483*^9}, {3.654126127665163*^9, 3.654126191634789*^9}, {
   3.654126236482831*^9, 3.654126250153975*^9}, {3.6541262848658533`*^9, 
   3.654126288991514*^9}, {3.654126323055903*^9, 3.654126399729628*^9}, {
   3.654126435349374*^9, 3.654126447266036*^9}, {3.654126530077552*^9, 
   3.6541265937421*^9}, {3.654126679867402*^9, 3.6541267650289497`*^9}, {
   3.6541267969631968`*^9, 3.654126798410089*^9}, {3.654126829860013*^9, 
   3.654126881359337*^9}, {3.6541269393824577`*^9, 3.654126959132009*^9}, {
   3.654127079773924*^9, 3.654127194954756*^9}, {3.654127229244482*^9, 
   3.654127253953713*^9}, {3.6541278694900227`*^9, 3.654127878663176*^9}, {
   3.654127969775614*^9, 3.6541279938293123`*^9}, {3.654128051763153*^9, 
   3.654128134016169*^9}, {3.654128326830834*^9, 3.654128326972948*^9}, {
   3.654182305132535*^9, 3.654182317491791*^9}, {3.65418238746202*^9, 
   3.654182511491269*^9}, {3.654182551115921*^9, 3.654182559209998*^9}, {
   3.6541826265390177`*^9, 3.654182732425318*^9}, {3.654182795218339*^9, 
   3.654182802306821*^9}, {3.654182858360195*^9, 3.654182976637673*^9}, {
   3.65418309291822*^9, 3.6541831115452337`*^9}, {3.654183280620055*^9, 
   3.654183381285778*^9}, {3.6541834216733217`*^9, 3.65418343026462*^9}, {
   3.65418347398075*^9, 3.654183479016459*^9}, {3.654183517743698*^9, 
   3.654183590244978*^9}, {3.654183629340012*^9, 3.654183659551435*^9}, {
   3.654183828746057*^9, 3.654183869187777*^9}, {3.654183918271063*^9, 
   3.6541839184304667`*^9}, {3.654206461375032*^9, 3.6542064948942213`*^9}, {
   3.6542065261576433`*^9, 3.654206710642645*^9}, {3.65420685898112*^9, 
   3.654206859498214*^9}, {3.654206912388175*^9, 3.6542069199221067`*^9}, {
   3.654206956850091*^9, 3.654206957769821*^9}, {3.6542070885864773`*^9, 
   3.6542070905801163`*^9}, {3.6542071861274023`*^9, 3.654207197287834*^9}, {
   3.654207355631957*^9, 3.65420737546005*^9}, {3.654207422116619*^9, 
   3.6542074295958633`*^9}, {3.654207513008601*^9, 3.654207622631179*^9}, {
   3.6542077902321663`*^9, 3.6542079082040863`*^9}, {3.654208112675095*^9, 
   3.6542082406765347`*^9}, {3.654208390436673*^9, 3.654208437282127*^9}, {
   3.654208729398788*^9, 3.6542088242969923`*^9}, {3.654208875181876*^9, 
   3.6542089105814543`*^9}, {3.654209036563011*^9, 3.654209042056604*^9}, {
   3.654209131808134*^9, 3.654209211748107*^9}, {3.654277910558556*^9, 
   3.654277962902483*^9}, {3.6542785554956903`*^9, 3.654278555764879*^9}, {
   3.6542801407928543`*^9, 3.654280145647377*^9}, {3.654280336511973*^9, 
   3.654280388661951*^9}, {3.654735519742467*^9, 3.654735526212496*^9}, {
   3.654736711632904*^9, 3.654736744359725*^9}, {3.654736840726715*^9, 
   3.6547369027091503`*^9}, {3.6547369619155817`*^9, 3.65473711893006*^9}, 
   3.654737215212165*^9, {3.6547372623430433`*^9, 3.654737301717353*^9}, {
   3.654737434898181*^9, 3.654737445769989*^9}, {3.654737593349925*^9, 
   3.654737893647337*^9}, {3.654737938282483*^9, 3.654737939560112*^9}, {
   3.654737995469615*^9, 3.65473804382544*^9}, {3.65473814244207*^9, 
   3.65473826286047*^9}, {3.654738473301898*^9, 3.654738519313912*^9}, {
   3.654738551955141*^9, 3.654738559351729*^9}, {3.654738599129403*^9, 
   3.654738599566987*^9}, {3.654738653005966*^9, 3.654738704434928*^9}, {
   3.654738885183668*^9, 3.654738922018218*^9}, {3.654739011880048*^9, 
   3.65473910917871*^9}, {3.654739159170903*^9, 3.654739162120161*^9}, {
   3.6547393230277576`*^9, 3.6547393764227123`*^9}, {3.654739415181912*^9, 
   3.65473942023728*^9}, {3.654739453135948*^9, 3.654739679965816*^9}, {
   3.654739718627033*^9, 3.6547397334487553`*^9}, {3.654739765385715*^9, 
   3.654739851694334*^9}, {3.654739889466123*^9, 3.654740005071364*^9}, {
   3.6547400491757*^9, 3.654740154008595*^9}, 3.654740216700787*^9, {
   3.654740314399178*^9, 3.6547403286014967`*^9}, 3.6547403850818996`*^9, {
   3.654740521314966*^9, 3.654740541208376*^9}, {3.65474063388687*^9, 
   3.654740654515286*^9}, {3.654740701345427*^9, 3.654740810460566*^9}, {
   3.654740848239312*^9, 3.654741082783293*^9}, {3.654741274225429*^9, 
   3.65474127713437*^9}, 3.654741426789631*^9, {3.6547414571147537`*^9, 
   3.654741569824174*^9}, {3.654741604551594*^9, 3.65474161887015*^9}, {
   3.6547416933496304`*^9, 3.654741709459137*^9}, {3.654741935230948*^9, 
   3.654741945307493*^9}, {3.6547830386167917`*^9, 3.654783105454197*^9}, {
   3.6547832406606083`*^9, 3.6547832525310373`*^9}, {3.654783794511154*^9, 
   3.654783837663447*^9}, {3.65478390359721*^9, 3.654783909803577*^9}, {
   3.654783989474423*^9, 3.654784403124803*^9}, {3.654784520313846*^9, 
   3.654784622329711*^9}, {3.6547847231449842`*^9, 3.654784727983326*^9}, {
   3.654785122876478*^9, 3.654785187751635*^9}, {3.654785255283667*^9, 
   3.654785472044736*^9}, {3.654785554330287*^9, 3.6547855634367*^9}, {
   3.6547858133842907`*^9, 3.654785842420493*^9}, {3.654785988696732*^9, 
   3.654785999313698*^9}, {3.654786083383224*^9, 3.654786083827299*^9}, {
   3.654799998454865*^9, 3.654800009014682*^9}, 3.654800058896707*^9, {
   3.6548001027328*^9, 3.654800173381201*^9}, {3.654800206111162*^9, 
   3.654800346038969*^9}, {3.654800415767541*^9, 3.654800685527397*^9}, {
   3.654800717895743*^9, 3.6548007259529123`*^9}, {3.6548007560240192`*^9, 
   3.654800892868227*^9}, {3.654800961067473*^9, 3.6548010443125353`*^9}, {
   3.654801144205307*^9, 3.6548013970409203`*^9}, {3.654801447723054*^9, 
   3.6548014700938597`*^9}, {3.654801562889327*^9, 3.6548017505389137`*^9}, {
   3.6548017965315866`*^9, 3.654801838591158*^9}, {3.654801925163512*^9, 
   3.654801957336872*^9}, {3.654802037838778*^9, 3.654802097667626*^9}, {
   3.6548021338675137`*^9, 3.654802151746142*^9}, {3.6548021938035927`*^9, 
   3.65480226557542*^9}, {3.6548023434469347`*^9, 3.6548024564595747`*^9}, {
   3.654802493167995*^9, 3.654802498462143*^9}, {3.654802632969117*^9, 
   3.654802636326886*^9}, {3.6548026864101667`*^9, 3.6548027624957323`*^9}, {
   3.654802812209731*^9, 3.6548030159498*^9}, {3.6548066359524317`*^9, 
   3.654806720935005*^9}, {3.654806751992766*^9, 3.6548067587144833`*^9}, {
   3.654806821497799*^9, 3.654806889382121*^9}, {3.654807006283039*^9, 
   3.654807210369132*^9}, {3.654807340425975*^9, 3.6548074184588003`*^9}, {
   3.6548074913193197`*^9, 3.654807699931301*^9}, 3.6548078200861998`*^9, {
   3.654807890939335*^9, 3.65480791502777*^9}, {3.654807960842239*^9, 
   3.6548080712336483`*^9}, {3.654808128338978*^9, 3.6548081799548407`*^9}, {
   3.6548101758929577`*^9, 3.654810330104765*^9}, {3.654810401423953*^9, 
   3.654810408457419*^9}, {3.6548104718702717`*^9, 3.6548106690676603`*^9}, {
   3.6548107121438303`*^9, 3.6548108463298893`*^9}, {3.654810878513033*^9, 
   3.6548109250220337`*^9}, {3.654810973064028*^9, 3.6548109963255377`*^9}, {
   3.654811065383171*^9, 3.65481111435124*^9}, {3.6548111568410273`*^9, 
   3.654811165569319*^9}, {3.654811202562601*^9, 3.654811649746052*^9}, {
   3.657067656153129*^9, 3.657067660941557*^9}, {3.6570766750689*^9, 
   3.657076677028944*^9}, {3.658274451899232*^9, 3.6582744912918463`*^9}, {
   3.6583703518545094`*^9, 3.65837035300604*^9}, {3.675597878325226*^9, 
   3.6755979146605263`*^9}, {3.6755980148620157`*^9, 3.675598030554899*^9}, {
   3.678096141013015*^9, 3.678096147753409*^9}, 3.6904267357345657`*^9, {
   3.6904271471640983`*^9, 3.690427155538577*^9}, {3.690427186077324*^9, 
   3.6904272732573104`*^9}, {3.690427309554386*^9, 3.690427453700631*^9}, 
   3.6908550730897727`*^9, {3.6924696712189736`*^9, 3.692469680609393*^9}, {
   3.693153498335056*^9, 
   3.6931535006126595`*^9}},ExpressionUUID->"99a8bd6b-a8f6-456b-94e1-\
e0442a5ece6a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"ScrewToAxis", "[", 
      RowBox[{"q_", ",", "s_", ",", "h_"}], "]"}], ":", "\[IndentingNewLine]",
      "  ", 
     RowBox[{"Takes", " ", "q"}], ":", " ", 
     RowBox[{
     "a", " ", "point", " ", "lying", " ", "on", " ", "the", " ", "screw", 
      " ", "axis"}]}], ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"s", ":", " ", 
     RowBox[{
     "a", " ", "unit", " ", "vector", " ", "in", " ", "the", " ", "direction",
       " ", "of", " ", "the", " ", "screw", " ", "axis"}]}], ",", 
    "\[IndentingNewLine]", "         ", 
    RowBox[{
     RowBox[{"h", ":", " ", 
      RowBox[{"the", " ", "pitch", " ", "of", " ", "the", " ", "screw", " ", 
       RowBox[{"axis", ".", "\[IndentingNewLine]", "Returns"}], " ", "the", 
       " ", "corresponding", " ", "normalized", " ", "screw", " ", 
       RowBox[{"axis", "."}]}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Example", ":", "\[IndentingNewLine]", "Input", ":", " ", "S"}],
       " ", "=", " ", 
      RowBox[{
       RowBox[{"ScrewToAxis", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"3", ",", "0", ",", "0"}], "}"}], "}"}], "\[Transpose]"}],
          ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1"}], "}"}], "}"}], "\[Transpose]"}],
          ",", "2"}], "]"}], "\[IndentingNewLine]", 
       RowBox[{"Output", ":", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "0", "}"}], ",", 
          RowBox[{"{", "0", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "0", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"-", "3"}], "}"}], ",", 
          RowBox[{"{", "2", "}"}]}], "}"}]}]}]}]}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ScrewToAxis", "[", 
     RowBox[{"q_", ",", "s_", ",", "h_"}], "]"}], ":=", 
    RowBox[{"ArrayFlatten", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "s", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Cross", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", "q", "]"}], ",", 
             RowBox[{"Flatten", "[", "s", "]"}]}], "]"}], "}"}], 
          "\[Transpose]"}], "+", 
         RowBox[{"h", "*", "s"}]}], "}"}]}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654107438701495*^9, 3.6541075770931664`*^9}, {
   3.6541076103152647`*^9, 3.654107726674172*^9}, {3.654107800327899*^9, 
   3.654107805926005*^9}, {3.654107842157054*^9, 3.654107956534466*^9}, {
   3.6541080276373253`*^9, 3.654108039845397*^9}, {3.654108208328875*^9, 
   3.654108267778264*^9}, {3.654108316603101*^9, 3.65410832858707*^9}, {
   3.654122072990996*^9, 3.654122200142358*^9}, {3.654122232524707*^9, 
   3.6541222637488813`*^9}, {3.654122372486209*^9, 3.65412253592478*^9}, {
   3.654122571686759*^9, 3.654122685636675*^9}, {3.654122740902017*^9, 
   3.6541228215630703`*^9}, {3.654122865671712*^9, 3.654122935620612*^9}, {
   3.654123032181581*^9, 3.6541230914473333`*^9}, {3.654123152783122*^9, 
   3.6541232043612537`*^9}, {3.654123304611115*^9, 3.654123341073502*^9}, {
   3.654123502235703*^9, 3.654123578362132*^9}, {3.654123664279245*^9, 
   3.654123683195951*^9}, {3.6541237878998413`*^9, 3.6541238249788847`*^9}, {
   3.654123940392714*^9, 3.654123947510108*^9}, {3.654124026309593*^9, 
   3.654124026885428*^9}, 3.6541241152729683`*^9, 3.654124170343902*^9, {
   3.6541246995439568`*^9, 3.654124712871656*^9}, {3.6541251843297157`*^9, 
   3.654125231518578*^9}, {3.6541254856851683`*^9, 3.65412548908077*^9}, {
   3.654125547742125*^9, 3.654125551165526*^9}, {3.654125930807577*^9, 
   3.654126007244483*^9}, {3.654126127665163*^9, 3.654126191634789*^9}, {
   3.654126236482831*^9, 3.654126250153975*^9}, {3.6541262848658533`*^9, 
   3.654126288991514*^9}, {3.654126323055903*^9, 3.654126399729628*^9}, {
   3.654126435349374*^9, 3.654126447266036*^9}, {3.654126530077552*^9, 
   3.6541265937421*^9}, {3.654126679867402*^9, 3.6541267650289497`*^9}, {
   3.6541267969631968`*^9, 3.654126798410089*^9}, {3.654126829860013*^9, 
   3.654126881359337*^9}, {3.6541269393824577`*^9, 3.654126959132009*^9}, {
   3.654127079773924*^9, 3.654127194954756*^9}, {3.654127229244482*^9, 
   3.654127253953713*^9}, {3.6541278694900227`*^9, 3.654127878663176*^9}, {
   3.654127969775614*^9, 3.6541279938293123`*^9}, {3.654128051763153*^9, 
   3.654128134016169*^9}, {3.654128326830834*^9, 3.654128326972948*^9}, {
   3.654182305132535*^9, 3.654182317491791*^9}, {3.65418238746202*^9, 
   3.654182511491269*^9}, {3.654182551115921*^9, 3.654182559209998*^9}, {
   3.6541826265390177`*^9, 3.654182732425318*^9}, {3.654182795218339*^9, 
   3.654182802306821*^9}, {3.654182858360195*^9, 3.654182976637673*^9}, {
   3.65418309291822*^9, 3.6541831115452337`*^9}, {3.654183280620055*^9, 
   3.654183381285778*^9}, {3.6541834216733217`*^9, 3.65418343026462*^9}, {
   3.65418347398075*^9, 3.654183479016459*^9}, {3.654183517743698*^9, 
   3.654183590244978*^9}, {3.654183629340012*^9, 3.654183659551435*^9}, {
   3.654183828746057*^9, 3.654183869187777*^9}, {3.654183918271063*^9, 
   3.6541839184304667`*^9}, {3.654206461375032*^9, 3.6542064948942213`*^9}, {
   3.6542065261576433`*^9, 3.654206710642645*^9}, {3.65420685898112*^9, 
   3.654206859498214*^9}, {3.654206912388175*^9, 3.6542069199221067`*^9}, {
   3.654206956850091*^9, 3.654206957769821*^9}, {3.6542070885864773`*^9, 
   3.6542070905801163`*^9}, {3.6542071861274023`*^9, 3.654207197287834*^9}, {
   3.654207355631957*^9, 3.65420737546005*^9}, {3.654207422116619*^9, 
   3.6542074295958633`*^9}, {3.654207513008601*^9, 3.654207622631179*^9}, {
   3.6542077902321663`*^9, 3.6542079082040863`*^9}, {3.654208112675095*^9, 
   3.6542082406765347`*^9}, {3.654208390436673*^9, 3.654208437282127*^9}, {
   3.654208729398788*^9, 3.6542088242969923`*^9}, {3.654208875181876*^9, 
   3.6542089105814543`*^9}, {3.654209036563011*^9, 3.654209042056604*^9}, {
   3.654209131808134*^9, 3.654209211748107*^9}, {3.654277910558556*^9, 
   3.654277962902483*^9}, {3.6542785554956903`*^9, 3.654278555764879*^9}, {
   3.6542801407928543`*^9, 3.654280145647377*^9}, {3.654280336511973*^9, 
   3.654280388661951*^9}, {3.654735519742467*^9, 3.654735526212496*^9}, {
   3.654736711632904*^9, 3.654736744359725*^9}, {3.654736840726715*^9, 
   3.6547369027091503`*^9}, {3.6547369619155817`*^9, 3.65473711893006*^9}, 
   3.654737215212165*^9, {3.6547372623430433`*^9, 3.654737301717353*^9}, {
   3.654737434898181*^9, 3.654737445769989*^9}, {3.654737593349925*^9, 
   3.654737893647337*^9}, {3.654737938282483*^9, 3.654737939560112*^9}, {
   3.654737995469615*^9, 3.65473804382544*^9}, {3.65473814244207*^9, 
   3.65473826286047*^9}, {3.654738473301898*^9, 3.654738519313912*^9}, {
   3.654738551955141*^9, 3.654738559351729*^9}, {3.654738599129403*^9, 
   3.654738599566987*^9}, {3.654738653005966*^9, 3.654738704434928*^9}, {
   3.654738885183668*^9, 3.654738922018218*^9}, {3.654739011880048*^9, 
   3.65473910917871*^9}, {3.654739159170903*^9, 3.654739162120161*^9}, {
   3.6547393230277576`*^9, 3.6547393764227123`*^9}, {3.654739415181912*^9, 
   3.65473942023728*^9}, {3.654739453135948*^9, 3.654739679965816*^9}, {
   3.654739718627033*^9, 3.6547397334487553`*^9}, {3.654739765385715*^9, 
   3.654739851694334*^9}, {3.654739889466123*^9, 3.654740005071364*^9}, {
   3.6547400491757*^9, 3.654740154008595*^9}, 3.654740216700787*^9, {
   3.654740314399178*^9, 3.6547403286014967`*^9}, 3.6547403850818996`*^9, {
   3.654740521314966*^9, 3.654740541208376*^9}, {3.65474063388687*^9, 
   3.654740654515286*^9}, {3.654740701345427*^9, 3.654740810460566*^9}, {
   3.654740848239312*^9, 3.654741082783293*^9}, {3.654741274225429*^9, 
   3.65474127713437*^9}, 3.654741426789631*^9, {3.6547414571147537`*^9, 
   3.654741569824174*^9}, {3.654741604551594*^9, 3.65474161887015*^9}, {
   3.6547416933496304`*^9, 3.654741709459137*^9}, {3.654741935230948*^9, 
   3.654741945307493*^9}, {3.6547830386167917`*^9, 3.654783105454197*^9}, {
   3.6547832406606083`*^9, 3.6547832525310373`*^9}, {3.654783794511154*^9, 
   3.654783837663447*^9}, {3.65478390359721*^9, 3.654783909803577*^9}, {
   3.654783989474423*^9, 3.654784403124803*^9}, {3.654784520313846*^9, 
   3.654784622329711*^9}, {3.6547847231449842`*^9, 3.654784727983326*^9}, {
   3.654785122876478*^9, 3.654785187751635*^9}, {3.654785255283667*^9, 
   3.654785472044736*^9}, {3.654785554330287*^9, 3.6547855634367*^9}, {
   3.6547858133842907`*^9, 3.654785842420493*^9}, {3.654785988696732*^9, 
   3.654785999313698*^9}, {3.654786083383224*^9, 3.654786083827299*^9}, {
   3.654799998454865*^9, 3.654800009014682*^9}, 3.654800058896707*^9, {
   3.6548001027328*^9, 3.654800173381201*^9}, {3.654800206111162*^9, 
   3.654800346038969*^9}, {3.654800415767541*^9, 3.654800685527397*^9}, {
   3.654800717895743*^9, 3.6548007259529123`*^9}, {3.6548007560240192`*^9, 
   3.654800892868227*^9}, {3.654800961067473*^9, 3.6548010443125353`*^9}, {
   3.654801144205307*^9, 3.6548013970409203`*^9}, {3.654801447723054*^9, 
   3.6548014700938597`*^9}, {3.654801562889327*^9, 3.6548017505389137`*^9}, {
   3.6548017965315866`*^9, 3.654801838591158*^9}, {3.654801925163512*^9, 
   3.654801957336872*^9}, {3.654802037838778*^9, 3.654802097667626*^9}, {
   3.6548021338675137`*^9, 3.654802151746142*^9}, {3.6548021938035927`*^9, 
   3.65480226557542*^9}, {3.6548023434469347`*^9, 3.6548024564595747`*^9}, {
   3.654802493167995*^9, 3.654802498462143*^9}, {3.654802632969117*^9, 
   3.654802636326886*^9}, {3.6548026864101667`*^9, 3.6548027624957323`*^9}, {
   3.654802812209731*^9, 3.6548030159498*^9}, {3.6548066359524317`*^9, 
   3.654806720935005*^9}, {3.654806751992766*^9, 3.6548067587144833`*^9}, {
   3.654806821497799*^9, 3.654806889382121*^9}, {3.654807006283039*^9, 
   3.654807210369132*^9}, {3.654807340425975*^9, 3.6548074184588003`*^9}, {
   3.6548074913193197`*^9, 3.654807699931301*^9}, 3.6548078200861998`*^9, {
   3.654807890939335*^9, 3.65480791502777*^9}, {3.654807960842239*^9, 
   3.6548080712336483`*^9}, {3.654808128338978*^9, 3.6548081799548407`*^9}, {
   3.6548101758929577`*^9, 3.654810330104765*^9}, {3.654810401423953*^9, 
   3.654810408457419*^9}, {3.6548104718702717`*^9, 3.6548106690676603`*^9}, {
   3.6548107121438303`*^9, 3.6548108463298893`*^9}, {3.654810878513033*^9, 
   3.6548109250220337`*^9}, {3.654810973064028*^9, 3.6548109963255377`*^9}, {
   3.654811065383171*^9, 3.65481111435124*^9}, {3.6548111568410273`*^9, 
   3.654811165569319*^9}, {3.654811202562601*^9, 3.654811649746052*^9}, {
   3.657067656153129*^9, 3.657067660941557*^9}, {3.6570766750689*^9, 
   3.657076677028944*^9}, {3.658274451899232*^9, 3.6582744912918463`*^9}, {
   3.6583703518545094`*^9, 3.65837035300604*^9}, {3.675598055508669*^9, 
   3.675598057083598*^9}, {3.675598169865116*^9, 3.6755982065219803`*^9}, {
   3.675598239676413*^9, 3.675598240245709*^9}, {3.675598295505789*^9, 
   3.675598303845595*^9}, 3.675598755218297*^9, {3.675601452088194*^9, 
   3.675601456989585*^9}, 3.678096151946823*^9, {3.689124095917945*^9, 
   3.689124123410983*^9}, {3.6904602993220882`*^9, 3.6904603012564917`*^9}, {
   3.690460343750966*^9, 3.6904603675722084`*^9}, 3.6908550752764926`*^9, {
   3.6924697082304506`*^9, 3.6924697713209963`*^9}, {3.6931536131044574`*^9, 
   3.693153616879664*^9}},ExpressionUUID->"30d59f5e-3f2d-45a8-afa3-\
2e0a8597e22e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"AxisAng6", "[", "expc6_", "]"}], ":", "\[IndentingNewLine]", 
     "   ", 
     RowBox[{
      RowBox[{"Takes", " ", "a", " ", "6"}], "-", 
      RowBox[{
      "vector", " ", "of", " ", "exponential", " ", "coordinates", " ", "for",
        " ", "rigid"}], "-", 
      RowBox[{"body", " ", "motion", " ", "S", "*", 
       RowBox[{"theta", ".", "\[IndentingNewLine]", "Returns"}], " ", "S"}]}],
      ":", " ", 
     RowBox[{
     "the", " ", "corresponding", " ", "normalized", " ", "screw", " ", 
      "axis"}]}], ",", "\[IndentingNewLine]", "            ", 
    RowBox[{
     RowBox[{"theta", ":", " ", 
      RowBox[{"the", " ", "distance", " ", "traveled", " ", 
       RowBox[{"along", "/", "about"}], " ", 
       RowBox[{"S", ".", " ", "\[IndentingNewLine]", " ", "The"}], " ", 
       "first", " ", "element", " ", "of", " ", "the", " ", "output", " ", 
       "is", " ", "the", " ", "screw", " ", "axis", " ", "S", " ", "and", " ",
        "the", " ", "second", " ", "is", " ", "the", " ", "distance", " ", 
       RowBox[{"theta", "."}]}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Example", ":", "\[IndentingNewLine]", "Input", ":", " ", 
       RowBox[{"{", 
        RowBox[{"S", ",", " ", "theta"}], "}"}]}], " ", "=", " ", 
      RowBox[{
       RowBox[{"AxisAng6", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "0", "}"}], ",", 
          RowBox[{"{", "0", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "2", "}"}], ",", 
          RowBox[{"{", "3", "}"}]}], "}"}], "]"}], "\[IndentingNewLine]", 
       RowBox[{"Output", ":", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "1", "}"}], ",", 
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "1", "}"}], ",", 
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", "3", "}"}]}], "}"}], ",", "1"}], "}"}]}]}]}]}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"AxisAng6", "[", "expc6_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "theta", "}"}], ",", 
      RowBox[{
       RowBox[{"theta", "=", 
        RowBox[{"Norm", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"expc6", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"1", ";;", "3"}], ",", "1"}], "]"}], "]"}], "}"}], 
          "\[Transpose]"}], "]"}]}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"NearZero", "[", "theta", "]"}], ",", 
         RowBox[{"theta", "=", 
          RowBox[{"Norm", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"expc6", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"4", ";;", "6"}], ",", "1"}], "]"}], "]"}], "}"}], 
            "\[Transpose]"}], "]"}]}]}], "]"}], ";", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"expc6", "/", "theta"}], ",", "theta"}], "}"}], "]"}]}]}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654107438701495*^9, 3.6541075770931664`*^9}, {
   3.6541076103152647`*^9, 3.654107726674172*^9}, {3.654107800327899*^9, 
   3.654107805926005*^9}, {3.654107842157054*^9, 3.654107956534466*^9}, {
   3.6541080276373253`*^9, 3.654108039845397*^9}, {3.654108208328875*^9, 
   3.654108267778264*^9}, {3.654108316603101*^9, 3.65410832858707*^9}, {
   3.654122072990996*^9, 3.654122200142358*^9}, {3.654122232524707*^9, 
   3.6541222637488813`*^9}, {3.654122372486209*^9, 3.65412253592478*^9}, {
   3.654122571686759*^9, 3.654122685636675*^9}, {3.654122740902017*^9, 
   3.6541228215630703`*^9}, {3.654122865671712*^9, 3.654122935620612*^9}, {
   3.654123032181581*^9, 3.6541230914473333`*^9}, {3.654123152783122*^9, 
   3.6541232043612537`*^9}, {3.654123304611115*^9, 3.654123341073502*^9}, {
   3.654123502235703*^9, 3.654123578362132*^9}, {3.654123664279245*^9, 
   3.654123683195951*^9}, {3.6541237878998413`*^9, 3.6541238249788847`*^9}, {
   3.654123940392714*^9, 3.654123947510108*^9}, {3.654124026309593*^9, 
   3.654124026885428*^9}, 3.6541241152729683`*^9, 3.654124170343902*^9, {
   3.6541246995439568`*^9, 3.654124712871656*^9}, {3.6541251843297157`*^9, 
   3.654125231518578*^9}, {3.6541254856851683`*^9, 3.65412548908077*^9}, {
   3.654125547742125*^9, 3.654125551165526*^9}, {3.654125930807577*^9, 
   3.654126007244483*^9}, {3.654126127665163*^9, 3.654126191634789*^9}, {
   3.654126236482831*^9, 3.654126250153975*^9}, {3.6541262848658533`*^9, 
   3.654126288991514*^9}, {3.654126323055903*^9, 3.654126399729628*^9}, {
   3.654126435349374*^9, 3.654126447266036*^9}, {3.654126530077552*^9, 
   3.6541265937421*^9}, {3.654126679867402*^9, 3.6541267650289497`*^9}, {
   3.6541267969631968`*^9, 3.654126798410089*^9}, {3.654126829860013*^9, 
   3.654126881359337*^9}, {3.6541269393824577`*^9, 3.654126959132009*^9}, {
   3.654127079773924*^9, 3.654127194954756*^9}, {3.654127229244482*^9, 
   3.654127253953713*^9}, {3.6541278694900227`*^9, 3.654127878663176*^9}, {
   3.654127969775614*^9, 3.6541279938293123`*^9}, {3.654128051763153*^9, 
   3.654128134016169*^9}, {3.654128326830834*^9, 3.654128326972948*^9}, {
   3.654182305132535*^9, 3.654182317491791*^9}, {3.65418238746202*^9, 
   3.654182511491269*^9}, {3.654182551115921*^9, 3.654182559209998*^9}, {
   3.6541826265390177`*^9, 3.654182732425318*^9}, {3.654182795218339*^9, 
   3.654182802306821*^9}, {3.654182858360195*^9, 3.654182976637673*^9}, {
   3.65418309291822*^9, 3.6541831115452337`*^9}, {3.654183280620055*^9, 
   3.654183381285778*^9}, {3.6541834216733217`*^9, 3.65418343026462*^9}, {
   3.65418347398075*^9, 3.654183479016459*^9}, {3.654183517743698*^9, 
   3.654183590244978*^9}, {3.654183629340012*^9, 3.654183659551435*^9}, {
   3.654183828746057*^9, 3.654183869187777*^9}, {3.654183918271063*^9, 
   3.6541839184304667`*^9}, {3.654206461375032*^9, 3.6542064948942213`*^9}, {
   3.6542065261576433`*^9, 3.654206710642645*^9}, {3.65420685898112*^9, 
   3.654206859498214*^9}, {3.654206912388175*^9, 3.6542069199221067`*^9}, {
   3.654206956850091*^9, 3.654206957769821*^9}, {3.6542070885864773`*^9, 
   3.6542070905801163`*^9}, {3.6542071861274023`*^9, 3.654207197287834*^9}, {
   3.654207355631957*^9, 3.65420737546005*^9}, {3.654207422116619*^9, 
   3.6542074295958633`*^9}, {3.654207513008601*^9, 3.654207622631179*^9}, {
   3.6542077902321663`*^9, 3.6542079082040863`*^9}, {3.654208112675095*^9, 
   3.6542082406765347`*^9}, {3.654208390436673*^9, 3.654208437282127*^9}, {
   3.654208729398788*^9, 3.6542088242969923`*^9}, {3.654208875181876*^9, 
   3.6542089105814543`*^9}, {3.654209036563011*^9, 3.654209042056604*^9}, {
   3.654209131808134*^9, 3.654209211748107*^9}, {3.654277910558556*^9, 
   3.654277962902483*^9}, {3.6542785554956903`*^9, 3.654278555764879*^9}, {
   3.6542801407928543`*^9, 3.654280145647377*^9}, {3.654280336511973*^9, 
   3.654280388661951*^9}, {3.654735519742467*^9, 3.654735526212496*^9}, {
   3.654736711632904*^9, 3.654736744359725*^9}, {3.654736840726715*^9, 
   3.6547369027091503`*^9}, {3.6547369619155817`*^9, 3.65473711893006*^9}, 
   3.654737215212165*^9, {3.6547372623430433`*^9, 3.654737301717353*^9}, {
   3.654737434898181*^9, 3.654737445769989*^9}, {3.654737593349925*^9, 
   3.654737893647337*^9}, {3.654737938282483*^9, 3.654737939560112*^9}, {
   3.654737995469615*^9, 3.65473804382544*^9}, {3.65473814244207*^9, 
   3.65473826286047*^9}, {3.654738473301898*^9, 3.654738519313912*^9}, {
   3.654738551955141*^9, 3.654738559351729*^9}, {3.654738599129403*^9, 
   3.654738599566987*^9}, {3.654738653005966*^9, 3.654738704434928*^9}, {
   3.654738885183668*^9, 3.654738922018218*^9}, {3.654739011880048*^9, 
   3.65473910917871*^9}, {3.654739159170903*^9, 3.654739162120161*^9}, {
   3.6547393230277576`*^9, 3.6547393764227123`*^9}, {3.654739415181912*^9, 
   3.65473942023728*^9}, {3.654739453135948*^9, 3.654739679965816*^9}, {
   3.654739718627033*^9, 3.6547397334487553`*^9}, {3.654739765385715*^9, 
   3.654739851694334*^9}, {3.654739889466123*^9, 3.654740005071364*^9}, {
   3.6547400491757*^9, 3.654740154008595*^9}, 3.654740216700787*^9, {
   3.654740314399178*^9, 3.6547403286014967`*^9}, 3.6547403850818996`*^9, {
   3.654740521314966*^9, 3.654740541208376*^9}, {3.65474063388687*^9, 
   3.654740654515286*^9}, {3.654740701345427*^9, 3.654740810460566*^9}, {
   3.654740848239312*^9, 3.654741082783293*^9}, {3.654741274225429*^9, 
   3.65474127713437*^9}, 3.654741426789631*^9, {3.6547414571147537`*^9, 
   3.654741569824174*^9}, {3.654741604551594*^9, 3.65474161887015*^9}, {
   3.6547416933496304`*^9, 3.654741709459137*^9}, {3.654741935230948*^9, 
   3.654741945307493*^9}, {3.6547830386167917`*^9, 3.654783105454197*^9}, {
   3.6547832406606083`*^9, 3.6547832525310373`*^9}, {3.654783794511154*^9, 
   3.654783837663447*^9}, {3.65478390359721*^9, 3.654783909803577*^9}, {
   3.654783989474423*^9, 3.654784403124803*^9}, {3.654784520313846*^9, 
   3.654784622329711*^9}, {3.6547847231449842`*^9, 3.654784727983326*^9}, {
   3.654785122876478*^9, 3.654785187751635*^9}, {3.654785255283667*^9, 
   3.654785472044736*^9}, {3.654785554330287*^9, 3.6547855634367*^9}, {
   3.6547858133842907`*^9, 3.654785842420493*^9}, {3.654785988696732*^9, 
   3.654785999313698*^9}, {3.654786083383224*^9, 3.654786083827299*^9}, {
   3.654799998454865*^9, 3.654800009014682*^9}, 3.654800058896707*^9, {
   3.6548001027328*^9, 3.654800173381201*^9}, {3.654800206111162*^9, 
   3.654800346038969*^9}, {3.654800415767541*^9, 3.654800685527397*^9}, {
   3.654800717895743*^9, 3.6548007259529123`*^9}, {3.6548007560240192`*^9, 
   3.654800892868227*^9}, {3.654800961067473*^9, 3.6548010443125353`*^9}, {
   3.654801144205307*^9, 3.6548013970409203`*^9}, {3.654801447723054*^9, 
   3.6548014700938597`*^9}, {3.654801562889327*^9, 3.6548017505389137`*^9}, {
   3.6548017965315866`*^9, 3.654801838591158*^9}, {3.654801925163512*^9, 
   3.654801957336872*^9}, {3.654802037838778*^9, 3.654802097667626*^9}, {
   3.6548021338675137`*^9, 3.654802151746142*^9}, {3.6548021938035927`*^9, 
   3.65480226557542*^9}, {3.6548023434469347`*^9, 3.6548024564595747`*^9}, {
   3.654802493167995*^9, 3.654802498462143*^9}, {3.654802632969117*^9, 
   3.654802636326886*^9}, {3.6548026864101667`*^9, 3.6548027624957323`*^9}, {
   3.654802812209731*^9, 3.6548030159498*^9}, {3.6548066359524317`*^9, 
   3.654806720935005*^9}, {3.654806751992766*^9, 3.6548067587144833`*^9}, {
   3.654806821497799*^9, 3.654806889382121*^9}, {3.654807006283039*^9, 
   3.654807210369132*^9}, {3.654807340425975*^9, 3.6548074184588003`*^9}, {
   3.6548074913193197`*^9, 3.654807699931301*^9}, 3.6548078200861998`*^9, {
   3.654807890939335*^9, 3.65480791502777*^9}, {3.654807960842239*^9, 
   3.6548080712336483`*^9}, {3.654808128338978*^9, 3.6548081799548407`*^9}, {
   3.6548101758929577`*^9, 3.654810330104765*^9}, {3.654810401423953*^9, 
   3.654810408457419*^9}, {3.6548104718702717`*^9, 3.6548106690676603`*^9}, {
   3.6548107121438303`*^9, 3.6548108463298893`*^9}, {3.654810878513033*^9, 
   3.6548109250220337`*^9}, {3.654810973064028*^9, 3.6548109963255377`*^9}, {
   3.654811065383171*^9, 3.65481111435124*^9}, {3.6548111568410273`*^9, 
   3.654811165569319*^9}, {3.654811202562601*^9, 3.654811649746052*^9}, {
   3.657067656153129*^9, 3.657067660941557*^9}, {3.6570766750689*^9, 
   3.657076677028944*^9}, {3.658274451899232*^9, 3.6582744912918463`*^9}, {
   3.6583703518545094`*^9, 3.65837035300604*^9}, {3.6755985001383038`*^9, 
   3.675598581679422*^9}, {3.675598613345693*^9, 3.675598641956484*^9}, {
   3.675598705465678*^9, 3.675598735438822*^9}, 3.678096156180605*^9, {
   3.6891242180401173`*^9, 3.6891242578011737`*^9}, {3.690461719030828*^9, 
   3.6904619133687925`*^9}, 3.690855077692618*^9, {3.692469788064231*^9, 
   3.692469825517315*^9}, 3.693099536242242*^9, {3.693153629718487*^9, 
   3.6931536382673016`*^9}},ExpressionUUID->"46db7d2d-b8e9-4083-8c2c-\
61972e8c645d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MatrixExp6", "[", "se3mat", "]"}], ":", "\[IndentingNewLine]", 
      "  ", 
      RowBox[{"Takes", " ", "a", " ", "se", 
       RowBox[{"(", "3", ")"}], " ", "representation", " ", "of", " ", 
       "exponential", " ", 
       RowBox[{"coordinates", ".", "\[IndentingNewLine]", "Returns"}], " ", 
       "a", " ", "T", " ", "matrix", " ", "SE", 
       RowBox[{"(", "3", ")"}], " ", "that", " ", "is", " ", "achieved", " ", 
       "by", " ", "traveling", " ", 
       RowBox[{"along", "/", "about"}], " ", "the", " ", "screw", " ", "axis",
        " ", "S", " ", "for", " ", "a", " ", "distance", " ", "theta", " ", 
       "from", " ", "an", " ", "initial", " ", "configuration", " ", "T"}]}], 
     "=", 
     RowBox[{"I", "."}]}], "\[IndentingNewLine]", ";", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"Example", ":", "\[IndentingNewLine]", "Input", ":", " ", "T"}], 
     " ", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"MatrixExp6", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"-", "1.5707963267948966"}], ",", "2.3561944901923448"}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "1.5707963267948966", ",", "0", ",", 
            "2.3561944901923448"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], "]"}],
        "//", "MatrixForm"}], "//", 
      RowBox[{"N", "\[IndentingNewLine]", 
       RowBox[{"Output", ":", " ", 
        TagBox[
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {"1.", "0.", "0.", "0."},
            {"0.", "0.", 
             RowBox[{"-", "1."}], "0."},
            {"0.", "1.", "0.", "3."},
            {"0.", "0.", "0.", "1."}
           },
           
           GridBoxAlignment->{
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.7]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}], ")"}],
         Function[BoxForm`e$, 
          MatrixForm[BoxForm`e$]]]}]}]}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MatrixExp6", "[", "se3mat_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "omgtheta", ",", "omghat", ",", "theta", ",", "omgmat", ",", "G"}], 
       "}"}], ",", 
      RowBox[{
       RowBox[{"omgtheta", "=", 
        RowBox[{"so3ToVec", "[", 
         RowBox[{"se3mat", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"1", ";;", "3"}], ",", 
            RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], "]"}]}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"NearZero", "[", 
          RowBox[{"Norm", "[", "omgtheta", "]"}], "]"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"ArrayFlatten", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"se3mat", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}], "}"}],
                 "\[Transpose]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"omghat", ",", "theta"}], "}"}], " ", "=", " ", 
           RowBox[{"AxisAng3", "[", "omgtheta", "]"}]}], ";", 
          RowBox[{"omgmat", "=", 
           RowBox[{
            RowBox[{"se3mat", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"1", ";;", "3"}], ",", 
               RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], "/", "theta"}]}], 
          ";", 
          RowBox[{"Return", "[", 
           RowBox[{"ArrayFlatten", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"MatrixExp3", "[", 
                 RowBox[{"se3mat", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"1", ";;", "3"}], ",", 
                    RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"IdentityMatrix", "[", "3", "]"}], "*", "theta"}],
                    "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"Cos", "[", "theta", "]"}]}], ")"}], "*", 
                    "omgmat"}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"theta", "-", 
                    RowBox[{"Sin", "[", "theta", "]"}]}], ")"}], "*", 
                    RowBox[{"omgmat", ".", "omgmat"}]}]}], ")"}], ".", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"se3mat", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}], "}"}],
                     "\[Transpose]"}], "/", "theta"}], ")"}]}]}], "}"}], ",", 
              
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "]"}], "]"}]}]}], 
        "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654107438701495*^9, 3.6541075770931664`*^9}, {
   3.6541076103152647`*^9, 3.654107726674172*^9}, {3.654107800327899*^9, 
   3.654107805926005*^9}, {3.654107842157054*^9, 3.654107956534466*^9}, {
   3.6541080276373253`*^9, 3.654108039845397*^9}, {3.654108208328875*^9, 
   3.654108267778264*^9}, {3.654108316603101*^9, 3.65410832858707*^9}, {
   3.654122072990996*^9, 3.654122200142358*^9}, {3.654122232524707*^9, 
   3.6541222637488813`*^9}, {3.654122372486209*^9, 3.65412253592478*^9}, {
   3.654122571686759*^9, 3.654122685636675*^9}, {3.654122740902017*^9, 
   3.6541228215630703`*^9}, {3.654122865671712*^9, 3.654122935620612*^9}, {
   3.654123032181581*^9, 3.6541230914473333`*^9}, {3.654123152783122*^9, 
   3.6541232043612537`*^9}, {3.654123304611115*^9, 3.654123341073502*^9}, {
   3.654123502235703*^9, 3.654123578362132*^9}, {3.654123664279245*^9, 
   3.654123683195951*^9}, {3.6541237878998413`*^9, 3.6541238249788847`*^9}, {
   3.654123940392714*^9, 3.654123947510108*^9}, {3.654124026309593*^9, 
   3.654124026885428*^9}, 3.6541241152729683`*^9, 3.654124170343902*^9, {
   3.6541246995439568`*^9, 3.654124712871656*^9}, {3.6541251843297157`*^9, 
   3.654125231518578*^9}, {3.6541254856851683`*^9, 3.65412548908077*^9}, {
   3.654125547742125*^9, 3.654125551165526*^9}, {3.654125930807577*^9, 
   3.654126007244483*^9}, {3.654126127665163*^9, 3.654126191634789*^9}, {
   3.654126236482831*^9, 3.654126250153975*^9}, {3.6541262848658533`*^9, 
   3.654126288991514*^9}, {3.654126323055903*^9, 3.654126399729628*^9}, {
   3.654126435349374*^9, 3.654126447266036*^9}, {3.654126530077552*^9, 
   3.6541265937421*^9}, {3.654126679867402*^9, 3.6541267650289497`*^9}, {
   3.6541267969631968`*^9, 3.654126798410089*^9}, {3.654126829860013*^9, 
   3.654126881359337*^9}, {3.6541269393824577`*^9, 3.654126959132009*^9}, {
   3.654127079773924*^9, 3.654127194954756*^9}, {3.654127229244482*^9, 
   3.654127253953713*^9}, {3.6541278694900227`*^9, 3.654127878663176*^9}, {
   3.654127969775614*^9, 3.6541279938293123`*^9}, {3.654128051763153*^9, 
   3.654128134016169*^9}, {3.654128326830834*^9, 3.654128326972948*^9}, {
   3.654182305132535*^9, 3.654182317491791*^9}, {3.65418238746202*^9, 
   3.654182511491269*^9}, {3.654182551115921*^9, 3.654182559209998*^9}, {
   3.6541826265390177`*^9, 3.654182732425318*^9}, {3.654182795218339*^9, 
   3.654182802306821*^9}, {3.654182858360195*^9, 3.654182976637673*^9}, {
   3.65418309291822*^9, 3.6541831115452337`*^9}, {3.654183280620055*^9, 
   3.654183381285778*^9}, {3.6541834216733217`*^9, 3.65418343026462*^9}, {
   3.65418347398075*^9, 3.654183479016459*^9}, {3.654183517743698*^9, 
   3.654183590244978*^9}, {3.654183629340012*^9, 3.654183659551435*^9}, {
   3.654183828746057*^9, 3.654183869187777*^9}, {3.654183918271063*^9, 
   3.6541839184304667`*^9}, {3.654206461375032*^9, 3.6542064948942213`*^9}, {
   3.6542065261576433`*^9, 3.654206710642645*^9}, {3.65420685898112*^9, 
   3.654206859498214*^9}, {3.654206912388175*^9, 3.6542069199221067`*^9}, {
   3.654206956850091*^9, 3.654206957769821*^9}, {3.6542070885864773`*^9, 
   3.6542070905801163`*^9}, {3.6542071861274023`*^9, 3.654207197287834*^9}, {
   3.654207355631957*^9, 3.65420737546005*^9}, {3.654207422116619*^9, 
   3.6542074295958633`*^9}, {3.654207513008601*^9, 3.654207622631179*^9}, {
   3.6542077902321663`*^9, 3.6542079082040863`*^9}, {3.654208112675095*^9, 
   3.6542082406765347`*^9}, {3.654208390436673*^9, 3.654208437282127*^9}, {
   3.654208729398788*^9, 3.6542088242969923`*^9}, {3.654208875181876*^9, 
   3.6542089105814543`*^9}, {3.654209036563011*^9, 3.654209042056604*^9}, {
   3.654209131808134*^9, 3.654209211748107*^9}, {3.654277910558556*^9, 
   3.654277962902483*^9}, {3.6542785554956903`*^9, 3.654278555764879*^9}, {
   3.6542801407928543`*^9, 3.654280145647377*^9}, {3.654280336511973*^9, 
   3.654280388661951*^9}, {3.654735519742467*^9, 3.654735526212496*^9}, {
   3.654736711632904*^9, 3.654736744359725*^9}, {3.654736840726715*^9, 
   3.6547369027091503`*^9}, {3.6547369619155817`*^9, 3.65473711893006*^9}, 
   3.654737215212165*^9, {3.6547372623430433`*^9, 3.654737301717353*^9}, {
   3.654737434898181*^9, 3.654737445769989*^9}, {3.654737593349925*^9, 
   3.654737893647337*^9}, {3.654737938282483*^9, 3.654737939560112*^9}, {
   3.654737995469615*^9, 3.65473804382544*^9}, {3.65473814244207*^9, 
   3.65473826286047*^9}, {3.654738473301898*^9, 3.654738519313912*^9}, {
   3.654738551955141*^9, 3.654738559351729*^9}, {3.654738599129403*^9, 
   3.654738599566987*^9}, {3.654738653005966*^9, 3.654738704434928*^9}, {
   3.654738885183668*^9, 3.654738922018218*^9}, {3.654739011880048*^9, 
   3.65473910917871*^9}, {3.654739159170903*^9, 3.654739162120161*^9}, {
   3.6547393230277576`*^9, 3.6547393764227123`*^9}, {3.654739415181912*^9, 
   3.65473942023728*^9}, {3.654739453135948*^9, 3.654739679965816*^9}, {
   3.654739718627033*^9, 3.6547397334487553`*^9}, {3.654739765385715*^9, 
   3.654739851694334*^9}, {3.654739889466123*^9, 3.654740005071364*^9}, {
   3.6547400491757*^9, 3.654740154008595*^9}, 3.654740216700787*^9, {
   3.654740314399178*^9, 3.6547403286014967`*^9}, 3.6547403850818996`*^9, {
   3.654740521314966*^9, 3.654740541208376*^9}, {3.65474063388687*^9, 
   3.654740654515286*^9}, {3.654740701345427*^9, 3.654740810460566*^9}, {
   3.654740848239312*^9, 3.654741082783293*^9}, {3.654741274225429*^9, 
   3.65474127713437*^9}, 3.654741426789631*^9, {3.6547414571147537`*^9, 
   3.654741569824174*^9}, {3.654741604551594*^9, 3.65474161887015*^9}, {
   3.6547416933496304`*^9, 3.654741709459137*^9}, {3.654741935230948*^9, 
   3.654741945307493*^9}, {3.6547830386167917`*^9, 3.654783105454197*^9}, {
   3.6547832406606083`*^9, 3.6547832525310373`*^9}, {3.654783794511154*^9, 
   3.654783837663447*^9}, {3.65478390359721*^9, 3.654783909803577*^9}, {
   3.654783989474423*^9, 3.654784403124803*^9}, {3.654784520313846*^9, 
   3.654784622329711*^9}, {3.6547847231449842`*^9, 3.654784727983326*^9}, {
   3.654785122876478*^9, 3.654785187751635*^9}, {3.654785255283667*^9, 
   3.654785472044736*^9}, {3.654785554330287*^9, 3.6547855634367*^9}, {
   3.6547858133842907`*^9, 3.654785842420493*^9}, {3.654785988696732*^9, 
   3.654785999313698*^9}, {3.654786083383224*^9, 3.654786083827299*^9}, {
   3.654799998454865*^9, 3.654800009014682*^9}, 3.654800058896707*^9, {
   3.6548001027328*^9, 3.654800173381201*^9}, {3.654800206111162*^9, 
   3.654800346038969*^9}, {3.654800415767541*^9, 3.654800685527397*^9}, {
   3.654800717895743*^9, 3.6548007259529123`*^9}, {3.6548007560240192`*^9, 
   3.654800892868227*^9}, {3.654800961067473*^9, 3.6548010443125353`*^9}, {
   3.654801144205307*^9, 3.6548013970409203`*^9}, {3.654801447723054*^9, 
   3.6548014700938597`*^9}, {3.654801562889327*^9, 3.6548017505389137`*^9}, {
   3.6548017965315866`*^9, 3.654801838591158*^9}, {3.654801925163512*^9, 
   3.654801957336872*^9}, {3.654802037838778*^9, 3.654802097667626*^9}, {
   3.6548021338675137`*^9, 3.654802151746142*^9}, {3.6548021938035927`*^9, 
   3.65480226557542*^9}, {3.6548023434469347`*^9, 3.6548024564595747`*^9}, {
   3.654802493167995*^9, 3.654802498462143*^9}, {3.654802632969117*^9, 
   3.654802636326886*^9}, {3.6548026864101667`*^9, 3.6548027624957323`*^9}, {
   3.654802812209731*^9, 3.6548030159498*^9}, {3.6548066359524317`*^9, 
   3.654806720935005*^9}, {3.654806751992766*^9, 3.6548067587144833`*^9}, {
   3.654806821497799*^9, 3.654806889382121*^9}, {3.654807006283039*^9, 
   3.654807210369132*^9}, {3.654807340425975*^9, 3.6548074184588003`*^9}, {
   3.6548074913193197`*^9, 3.654807699931301*^9}, 3.6548078200861998`*^9, {
   3.654807890939335*^9, 3.65480791502777*^9}, {3.654807960842239*^9, 
   3.6548080712336483`*^9}, {3.654808128338978*^9, 3.6548081799548407`*^9}, {
   3.6548101758929577`*^9, 3.654810330104765*^9}, {3.654810401423953*^9, 
   3.654810408457419*^9}, {3.6548104718702717`*^9, 3.6548106690676603`*^9}, {
   3.6548107121438303`*^9, 3.6548108463298893`*^9}, {3.654810878513033*^9, 
   3.6548109250220337`*^9}, {3.654810973064028*^9, 3.6548109963255377`*^9}, {
   3.654811065383171*^9, 3.65481111435124*^9}, {3.6548111568410273`*^9, 
   3.654811165569319*^9}, {3.654811202562601*^9, 3.654811649746052*^9}, {
   3.657067656153129*^9, 3.657067660941557*^9}, {3.6570766750689*^9, 
   3.657076677028944*^9}, {3.658274451899232*^9, 3.6582744912918463`*^9}, {
   3.6583703518545094`*^9, 3.65837035300604*^9}, {3.6755988080579853`*^9, 
   3.675598809147863*^9}, {3.67559891787045*^9, 3.675598943668881*^9}, {
   3.675599076607477*^9, 3.675599086502984*^9}, {3.675599163344201*^9, 
   3.675599246140224*^9}, {3.675599495513714*^9, 3.675599501889613*^9}, {
   3.6756003985310173`*^9, 3.67560041869237*^9}, {3.675600613139152*^9, 
   3.675600616115411*^9}, {3.675600652001363*^9, 3.6756006755021143`*^9}, {
   3.675600735634182*^9, 3.6756007488548737`*^9}, {3.67560092599559*^9, 
   3.675600966443502*^9}, 3.67561176087851*^9, {3.675614302769956*^9, 
   3.675614306885004*^9}, {3.675614423023447*^9, 3.675614423525736*^9}, 
   3.678096161809099*^9, {3.689124390276373*^9, 3.6891244327234344`*^9}, 
   3.6904655248817186`*^9, {3.6904657025972514`*^9, 3.6904657281132965`*^9}, {
   3.690465837887202*^9, 3.6904659438953967`*^9}, {3.6904660709156213`*^9, 
   3.6904660860717483`*^9}, {3.6904661740336037`*^9, 3.690466204669458*^9}, {
   3.690466287340516*^9, 3.6904663114681587`*^9}, {3.690466356136339*^9, 
   3.690466371287966*^9}, {3.690466405029338*^9, 3.6904664909169974`*^9}, {
   3.6904665250646596`*^9, 3.690466648441888*^9}, {3.690466693050069*^9, 
   3.690466820960202*^9}, {3.6904668777386026`*^9, 3.6904668854918165`*^9}, {
   3.690466979476494*^9, 3.690466999505231*^9}, {3.690467043933509*^9, 
   3.6904670502203207`*^9}, {3.6904671421806884`*^9, 
   3.6904672154541245`*^9}, {3.6904761776892157`*^9, 
   3.6904761866748314`*^9}, {3.690853707533787*^9, 3.6908537180965414`*^9}, {
   3.690853754712088*^9, 3.6908538141704364`*^9}, 3.6908539660488844`*^9, {
   3.6908546093581734`*^9, 3.6908546307019024`*^9}, {3.6908548189158974`*^9, 
   3.690854823667144*^9}, {3.690854870014203*^9, 3.6908549195384235`*^9}, {
   3.690855006521449*^9, 3.690855014308058*^9}, 3.690855083439123*^9, {
   3.69246983542494*^9, 3.6924699200499463`*^9}, 3.693099537023243*^9, {
   3.693153642338909*^9, 3.6931536540233293`*^9}, {3.6931907105719614`*^9, 
   3.693190710899562*^9}},ExpressionUUID->"eac75cf4-61fb-43ca-8d48-\
d6ed63b7ae73"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"MatrixLog6", "[", "T_", "]"}], ":", "\[IndentingNewLine]", 
     "   ", 
     RowBox[{
     "Takes", " ", "a", " ", "transformation", " ", "matrix", " ", "T", " ", 
      "in", " ", "SE", 
      RowBox[{
       RowBox[{"(", "3", ")"}], ".", "\[IndentingNewLine]", "Returns"}], " ", 
      "the", " ", "corresponding", " ", "se", 
      RowBox[{"(", "3", ")"}], " ", "representation", " ", "of", " ", 
      "exponential", " ", 
      RowBox[{"coordinates", "."}]}]}], "\[IndentingNewLine]", ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Example", ":", "\[IndentingNewLine]", "Input", ":", " ", "se3mat"}], 
     " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"MatrixLog6", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}], "]"}],
        "//", "MatrixForm"}], "//", 
      RowBox[{"N", "\[IndentingNewLine]", 
       RowBox[{"Output", ":", " ", 
        TagBox[
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {"0.", "0.", "0.", "0."},
            {"0.", "0.", 
             RowBox[{"-", "1.5707963267948966"}], "2.356194490192345"},
            {"0.", "1.5707963267948966", "0.", "2.356194490192345"},
            {"0.", "0.", "0.", "0."}
           },
           
           GridBoxAlignment->{
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.7]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}], ")"}],
         Function[BoxForm`e$, 
          MatrixForm[BoxForm`e$]]]}]}]}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MatrixLog6", "[", "T_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"R", ",", "p", ",", "acosinput", ",", "theta", ",", "omgmat"}],
        "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"R", ",", "p"}], "}"}], "=", 
        RowBox[{"TransToRp", "[", "T", "]"}]}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"NearZero", "[", 
          RowBox[{"Norm", "[", 
           RowBox[{"R", "-", 
            RowBox[{"IdentityMatrix", "[", "3", "]"}]}], "]"}], "]"}], ",", 
         RowBox[{"ArrayFlatten", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ConstantArray", "[", 
               RowBox[{"0", ",", 
                RowBox[{"{", 
                 RowBox[{"3", ",", "3"}], "}"}]}], "]"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"T", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}], "}"}], 
               "\[Transpose]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
         RowBox[{
          RowBox[{"acosinput", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Tr", "[", "R", "]"}], "-", "1"}], ")"}], "/", "2"}]}], 
          ";", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"acosinput", ">", "1"}], ",", 
            RowBox[{"acosinput", "=", "1"}], ",", 
            RowBox[{"acosinput", "<", 
             RowBox[{"-", "1"}]}], ",", 
            RowBox[{"acosinput", "=", 
             RowBox[{"-", "1"}]}]}], "]"}], ";", 
          RowBox[{"theta", "=", 
           RowBox[{"ArcCos", "[", "acosinput", "]"}]}], ";", 
          RowBox[{"omgmat", "=", 
           RowBox[{"MatrixLog3", "[", "R", "]"}]}], ";", 
          RowBox[{"Return", "[", 
           RowBox[{"ArrayFlatten", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"omgmat", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"IdentityMatrix", "[", "3", "]"}], "-", 
                   RowBox[{"omgmat", "/", "2"}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"1", "/", "theta"}], "-", 
                    RowBox[{
                    RowBox[{"Cot", "[", 
                    RowBox[{"theta", "/", "2"}], "]"}], "/", "2"}]}], ")"}], 
                    "*", 
                    RowBox[{
                    RowBox[{"omgmat", ".", "omgmat"}], "/", "theta"}]}]}], 
                  ")"}], ".", "p"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "]"}], "]"}]}]}], 
        "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654107438701495*^9, 3.6541075770931664`*^9}, {
   3.6541076103152647`*^9, 3.654107726674172*^9}, {3.654107800327899*^9, 
   3.654107805926005*^9}, {3.654107842157054*^9, 3.654107956534466*^9}, {
   3.6541080276373253`*^9, 3.654108039845397*^9}, {3.654108208328875*^9, 
   3.654108267778264*^9}, {3.654108316603101*^9, 3.65410832858707*^9}, {
   3.654122072990996*^9, 3.654122200142358*^9}, {3.654122232524707*^9, 
   3.6541222637488813`*^9}, {3.654122372486209*^9, 3.65412253592478*^9}, {
   3.654122571686759*^9, 3.654122685636675*^9}, {3.654122740902017*^9, 
   3.6541228215630703`*^9}, {3.654122865671712*^9, 3.654122935620612*^9}, {
   3.654123032181581*^9, 3.6541230914473333`*^9}, {3.654123152783122*^9, 
   3.6541232043612537`*^9}, {3.654123304611115*^9, 3.654123341073502*^9}, {
   3.654123502235703*^9, 3.654123578362132*^9}, {3.654123664279245*^9, 
   3.654123683195951*^9}, {3.6541237878998413`*^9, 3.6541238249788847`*^9}, {
   3.654123940392714*^9, 3.654123947510108*^9}, {3.654124026309593*^9, 
   3.654124026885428*^9}, 3.6541241152729683`*^9, 3.654124170343902*^9, {
   3.6541246995439568`*^9, 3.654124712871656*^9}, {3.6541251843297157`*^9, 
   3.654125231518578*^9}, {3.6541254856851683`*^9, 3.65412548908077*^9}, {
   3.654125547742125*^9, 3.654125551165526*^9}, {3.654125930807577*^9, 
   3.654126007244483*^9}, {3.654126127665163*^9, 3.654126191634789*^9}, {
   3.654126236482831*^9, 3.654126250153975*^9}, {3.6541262848658533`*^9, 
   3.654126288991514*^9}, {3.654126323055903*^9, 3.654126399729628*^9}, {
   3.654126435349374*^9, 3.654126447266036*^9}, {3.654126530077552*^9, 
   3.6541265937421*^9}, {3.654126679867402*^9, 3.6541267650289497`*^9}, {
   3.6541267969631968`*^9, 3.654126798410089*^9}, {3.654126829860013*^9, 
   3.654126881359337*^9}, {3.6541269393824577`*^9, 3.654126959132009*^9}, {
   3.654127079773924*^9, 3.654127194954756*^9}, {3.654127229244482*^9, 
   3.654127253953713*^9}, {3.6541278694900227`*^9, 3.654127878663176*^9}, {
   3.654127969775614*^9, 3.6541279938293123`*^9}, {3.654128051763153*^9, 
   3.654128134016169*^9}, {3.654128326830834*^9, 3.654128326972948*^9}, {
   3.654182305132535*^9, 3.654182317491791*^9}, {3.65418238746202*^9, 
   3.654182511491269*^9}, {3.654182551115921*^9, 3.654182559209998*^9}, {
   3.6541826265390177`*^9, 3.654182732425318*^9}, {3.654182795218339*^9, 
   3.654182802306821*^9}, {3.654182858360195*^9, 3.654182976637673*^9}, {
   3.65418309291822*^9, 3.6541831115452337`*^9}, {3.654183280620055*^9, 
   3.654183381285778*^9}, {3.6541834216733217`*^9, 3.65418343026462*^9}, {
   3.65418347398075*^9, 3.654183479016459*^9}, {3.654183517743698*^9, 
   3.654183590244978*^9}, {3.654183629340012*^9, 3.654183659551435*^9}, {
   3.654183828746057*^9, 3.654183869187777*^9}, {3.654183918271063*^9, 
   3.6541839184304667`*^9}, {3.654206461375032*^9, 3.6542064948942213`*^9}, {
   3.6542065261576433`*^9, 3.654206710642645*^9}, {3.65420685898112*^9, 
   3.654206859498214*^9}, {3.654206912388175*^9, 3.6542069199221067`*^9}, {
   3.654206956850091*^9, 3.654206957769821*^9}, {3.6542070885864773`*^9, 
   3.6542070905801163`*^9}, {3.6542071861274023`*^9, 3.654207197287834*^9}, {
   3.654207355631957*^9, 3.65420737546005*^9}, {3.654207422116619*^9, 
   3.6542074295958633`*^9}, {3.654207513008601*^9, 3.654207622631179*^9}, {
   3.6542077902321663`*^9, 3.6542079082040863`*^9}, {3.654208112675095*^9, 
   3.6542082406765347`*^9}, {3.654208390436673*^9, 3.654208437282127*^9}, {
   3.654208729398788*^9, 3.6542088242969923`*^9}, {3.654208875181876*^9, 
   3.6542089105814543`*^9}, {3.654209036563011*^9, 3.654209042056604*^9}, {
   3.654209131808134*^9, 3.654209211748107*^9}, {3.654277910558556*^9, 
   3.654277962902483*^9}, {3.6542785554956903`*^9, 3.654278555764879*^9}, {
   3.6542801407928543`*^9, 3.654280145647377*^9}, {3.654280336511973*^9, 
   3.654280388661951*^9}, {3.654735519742467*^9, 3.654735526212496*^9}, {
   3.654736711632904*^9, 3.654736744359725*^9}, {3.654736840726715*^9, 
   3.6547369027091503`*^9}, {3.6547369619155817`*^9, 3.65473711893006*^9}, 
   3.654737215212165*^9, {3.6547372623430433`*^9, 3.654737301717353*^9}, {
   3.654737434898181*^9, 3.654737445769989*^9}, {3.654737593349925*^9, 
   3.654737893647337*^9}, {3.654737938282483*^9, 3.654737939560112*^9}, {
   3.654737995469615*^9, 3.65473804382544*^9}, {3.65473814244207*^9, 
   3.65473826286047*^9}, {3.654738473301898*^9, 3.654738519313912*^9}, {
   3.654738551955141*^9, 3.654738559351729*^9}, {3.654738599129403*^9, 
   3.654738599566987*^9}, {3.654738653005966*^9, 3.654738704434928*^9}, {
   3.654738885183668*^9, 3.654738922018218*^9}, {3.654739011880048*^9, 
   3.65473910917871*^9}, {3.654739159170903*^9, 3.654739162120161*^9}, {
   3.6547393230277576`*^9, 3.6547393764227123`*^9}, {3.654739415181912*^9, 
   3.65473942023728*^9}, {3.654739453135948*^9, 3.654739679965816*^9}, {
   3.654739718627033*^9, 3.6547397334487553`*^9}, {3.654739765385715*^9, 
   3.654739851694334*^9}, {3.654739889466123*^9, 3.654740005071364*^9}, {
   3.6547400491757*^9, 3.654740154008595*^9}, 3.654740216700787*^9, {
   3.654740314399178*^9, 3.6547403286014967`*^9}, 3.6547403850818996`*^9, {
   3.654740521314966*^9, 3.654740541208376*^9}, {3.65474063388687*^9, 
   3.654740654515286*^9}, {3.654740701345427*^9, 3.654740810460566*^9}, {
   3.654740848239312*^9, 3.654741082783293*^9}, {3.654741274225429*^9, 
   3.65474127713437*^9}, 3.654741426789631*^9, {3.6547414571147537`*^9, 
   3.654741569824174*^9}, {3.654741604551594*^9, 3.65474161887015*^9}, {
   3.6547416933496304`*^9, 3.654741709459137*^9}, {3.654741935230948*^9, 
   3.654741945307493*^9}, {3.6547830386167917`*^9, 3.654783105454197*^9}, {
   3.6547832406606083`*^9, 3.6547832525310373`*^9}, {3.654783794511154*^9, 
   3.654783837663447*^9}, {3.65478390359721*^9, 3.654783909803577*^9}, {
   3.654783989474423*^9, 3.654784403124803*^9}, {3.654784520313846*^9, 
   3.654784622329711*^9}, {3.6547847231449842`*^9, 3.654784727983326*^9}, {
   3.654785122876478*^9, 3.654785187751635*^9}, {3.654785255283667*^9, 
   3.654785472044736*^9}, {3.654785554330287*^9, 3.6547855634367*^9}, {
   3.6547858133842907`*^9, 3.654785842420493*^9}, {3.654785988696732*^9, 
   3.654785999313698*^9}, {3.654786083383224*^9, 3.654786083827299*^9}, {
   3.654799998454865*^9, 3.654800009014682*^9}, 3.654800058896707*^9, {
   3.6548001027328*^9, 3.654800173381201*^9}, {3.654800206111162*^9, 
   3.654800346038969*^9}, {3.654800415767541*^9, 3.654800685527397*^9}, {
   3.654800717895743*^9, 3.6548007259529123`*^9}, {3.6548007560240192`*^9, 
   3.654800892868227*^9}, {3.654800961067473*^9, 3.6548010443125353`*^9}, {
   3.654801144205307*^9, 3.6548013970409203`*^9}, {3.654801447723054*^9, 
   3.6548014700938597`*^9}, {3.654801562889327*^9, 3.6548017505389137`*^9}, {
   3.6548017965315866`*^9, 3.654801838591158*^9}, {3.654801925163512*^9, 
   3.654801957336872*^9}, {3.654802037838778*^9, 3.654802097667626*^9}, {
   3.6548021338675137`*^9, 3.654802151746142*^9}, {3.6548021938035927`*^9, 
   3.65480226557542*^9}, {3.6548023434469347`*^9, 3.6548024564595747`*^9}, {
   3.654802493167995*^9, 3.654802498462143*^9}, {3.654802632969117*^9, 
   3.654802636326886*^9}, {3.6548026864101667`*^9, 3.6548027624957323`*^9}, {
   3.654802812209731*^9, 3.6548030159498*^9}, {3.6548066359524317`*^9, 
   3.654806720935005*^9}, {3.654806751992766*^9, 3.6548067587144833`*^9}, {
   3.654806821497799*^9, 3.654806889382121*^9}, {3.654807006283039*^9, 
   3.654807210369132*^9}, {3.654807340425975*^9, 3.6548074184588003`*^9}, {
   3.6548074913193197`*^9, 3.654807699931301*^9}, 3.6548078200861998`*^9, {
   3.654807890939335*^9, 3.65480791502777*^9}, {3.654807960842239*^9, 
   3.6548080712336483`*^9}, {3.654808128338978*^9, 3.6548081799548407`*^9}, {
   3.6548101758929577`*^9, 3.654810330104765*^9}, {3.654810401423953*^9, 
   3.654810408457419*^9}, {3.6548104718702717`*^9, 3.6548106690676603`*^9}, {
   3.6548107121438303`*^9, 3.6548108463298893`*^9}, {3.654810878513033*^9, 
   3.6548109250220337`*^9}, {3.654810973064028*^9, 3.6548109963255377`*^9}, {
   3.654811065383171*^9, 3.65481111435124*^9}, {3.6548111568410273`*^9, 
   3.654811165569319*^9}, {3.654811202562601*^9, 3.654811649746052*^9}, {
   3.657067656153129*^9, 3.657067660941557*^9}, {3.6570766750689*^9, 
   3.657076677028944*^9}, {3.658274451899232*^9, 3.6582744912918463`*^9}, {
   3.6583703518545094`*^9, 3.65837035300604*^9}, {3.675601244578272*^9, 
   3.675601274744042*^9}, {3.675601332061564*^9, 3.6756013660455017`*^9}, {
   3.675601414151766*^9, 3.675601425123197*^9}, {3.6756015530027637`*^9, 
   3.675601569614365*^9}, {3.6756016074254293`*^9, 3.6756016077890882`*^9}, {
   3.675601716305842*^9, 3.675601756140202*^9}, 3.678096166990847*^9, {
   3.689098490580514*^9, 3.689098507300537*^9}, {3.689111564919878*^9, 
   3.689111586179908*^9}, 3.6891116904600563`*^9, {3.6891118051222205`*^9, 
   3.689111809086226*^9}, {3.689379383872934*^9, 3.6893794400131445`*^9}, {
   3.68938243800862*^9, 3.689382448001191*^9}, 3.689382610528487*^9, {
   3.6908553028715415`*^9, 3.690855319790837*^9}, {3.690855465409556*^9, 
   3.69085553112724*^9}, {3.6908555755599923`*^9, 3.690855621936455*^9}, {
   3.690855691278123*^9, 3.690855730212586*^9}, {3.69085576541925*^9, 
   3.6908557663243017`*^9}, {3.6908558009069347`*^9, 
   3.6908558302116833`*^9}, {3.6908558673282585`*^9, 
   3.6908558827748747`*^9}, {3.690855999875291*^9, 3.69085615320261*^9}, {
   3.6908561939683766`*^9, 3.690856456654299*^9}, {3.6924699265289583`*^9, 
   3.692469953753217*^9}, 3.693099537729245*^9, 3.6931536614021425`*^9, 
   3.6931536952074013`*^9},ExpressionUUID->"6d99f6b0-2774-4d69-a54b-\
d891268b0240"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["CHAPTER  4: FORWARD KINEMATICS",
 FontSize->24,
 FontWeight->"Bold",
 FontColor->RGBColor[0, 0, 1]]], "Title",
 CellChangeTimes->{{3.6755319110417843`*^9, 3.675531927048277*^9}, {
  3.675531958735077*^9, 3.67553201284205*^9}, {3.675607857109823*^9, 
  3.6756079117244864`*^9}},ExpressionUUID->"adad6dd3-3cb5-44e7-a1be-\
a9b7c7dca95c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"FKinBody", "[", 
      RowBox[{"M_", ",", "Blist_", ",", "thetalist_"}], "]"}], ":", 
     "\[IndentingNewLine]", "   ", 
     RowBox[{"Takes", " ", "M"}], ":", " ", 
     RowBox[{
      RowBox[{"The", " ", "home", " ", "configuration", " ", 
       RowBox[{"(", 
        RowBox[{"position", " ", "and", " ", "orientation"}], ")"}], " ", 
       "of", " ", "the", " ", "end"}], "-", "effector"}]}], ",", 
    "\[IndentingNewLine]", "          ", 
    RowBox[{"Blist", ":", " ", 
     RowBox[{
      RowBox[{
      "The", " ", "joint", " ", "screw", " ", "axes", " ", "in", " ", "the", 
       " ", "end"}], "-", 
      RowBox[{
      "effector", " ", "frame", " ", "when", " ", "the", " ", "manipulator", 
       " ", "is", " ", "at", " ", "the", " ", "home", " ", "position"}]}]}], 
    ",", "\[IndentingNewLine]", "          ", 
    RowBox[{
     RowBox[{"thetalist", ":", " ", 
      RowBox[{
       RowBox[{"A", " ", "list", " ", "of", " ", "joint", " ", 
        RowBox[{"coordinates", ".", "\[IndentingNewLine]", "Returns"}], " ", 
        "T", " ", "in", " ", "SE", 
        RowBox[{"(", "3", ")"}], " ", "representing", " ", "the", " ", 
        "end"}], "-", 
       RowBox[{
       "effector", " ", "frame", " ", "when", " ", "the", " ", "joints", " ", 
        "are", " ", "at", " ", "the", " ", "specified", " ", "coordinates", 
        " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"i", ".", "t", ".", "o"}], " ", "Body", " ", "Frame"}], 
          ")"}], "."}]}]}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Example", ":", "\[IndentingNewLine]", "Inputs", ":", 
       "\[IndentingNewLine]", "M"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "6"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"-", "1"}], ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\n", "  ", 
     RowBox[{"Blist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{"-", "1"}], ",", "2", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0.1"}], 
          "}"}]}], "}"}], "\[Transpose]"}]}], ";", "\n", "  ", 
     RowBox[{"thetalist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Pi", "/", "2.0"}], ")"}], ",", "3", ",", "Pi"}], "}"}], 
        "}"}], "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"T", " ", "=", " ", 
      RowBox[{
       RowBox[{"FKinBody", "[", 
        RowBox[{"M", ",", "Blist", ",", "thetalist"}], "]"}], "//", 
       RowBox[{"MatrixForm", "\[IndentingNewLine]", 
        RowBox[{"Output", ":", " ", "\[IndentingNewLine]", 
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"0.", "1.", "0.", 
              RowBox[{"-", "5."}]},
             {"1.", "0.", "0.", "4."},
             {"0.", "0.", 
              RowBox[{"-", "1."}], "1.6858407346410207"},
             {"0.", "0.", "0.", "1."}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]]}]}]}]}]}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FKinBody", "[", 
     RowBox[{"M_", ",", "Blist_", ",", "thetalist_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", ",", "T", ",", "i"}], "}"}], ",", 
      RowBox[{
       RowBox[{"T", "=", "M"}], ";", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"T", "=", 
          RowBox[{"T", ".", 
           RowBox[{"MatrixExp6", "[", 
            RowBox[{"VecTose3", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Blist", "[", 
                 RowBox[{"[", 
                  RowBox[{";;", ",", "i"}], "]"}], "]"}], "}"}], 
               "\[Transpose]"}], "*", 
              RowBox[{"thetalist", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}]}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "thetalist", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "T", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6755319110417843`*^9, 3.675531927048277*^9}, {
   3.675531958735077*^9, 3.675532032779791*^9}, {3.6755321540719852`*^9, 
   3.675532155394449*^9}, 3.67559226134205*^9, {3.675596340559066*^9, 
   3.675596342576479*^9}, {3.675608043908893*^9, 3.67560805615449*^9}, {
   3.6756083091754017`*^9, 3.675608326044199*^9}, {3.6756089089651537`*^9, 
   3.6756089115657463`*^9}, {3.675609347333695*^9, 3.6756093476969*^9}, {
   3.675614529395809*^9, 3.675614539340641*^9}, {3.675614717287609*^9, 
   3.6756147189544277`*^9}, {3.675614753634843*^9, 3.675614844854802*^9}, {
   3.6756150166027203`*^9, 3.6756150520677147`*^9}, {3.6756150854940557`*^9, 
   3.675615119635448*^9}, {3.67561583526125*^9, 3.675615944525145*^9}, {
   3.675615986252219*^9, 3.67561600346618*^9}, {3.676118088970602*^9, 
   3.676118088974634*^9}, {3.676119594877483*^9, 3.676119639850988*^9}, 
   3.6780961875824127`*^9, {3.690904713168393*^9, 3.690904724455039*^9}, {
   3.690905180246108*^9, 3.690905247655964*^9}, {3.690905481129318*^9, 
   3.6909055264869127`*^9}, {3.6909093445092907`*^9, 3.690909346678415*^9}, {
   3.690913217309802*^9, 3.6909132234171515`*^9}, {3.690913769452383*^9, 
   3.690913778017873*^9}, {3.69091678495786*^9, 3.6909168381479025`*^9}, {
   3.690916907209852*^9, 3.69091690908796*^9}, {3.690917071469248*^9, 
   3.6909171230241966`*^9}, {3.692471405863173*^9, 3.692471476641342*^9}, {
   3.6931537191066437`*^9, 
   3.69315372827946*^9}},ExpressionUUID->"21cf6a13-d1c1-4e39-a23b-\
bc44ac2c3c82"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"FKinSpace", "[", 
      RowBox[{"M_", ",", "Slist_", ",", "thetalist_"}], "]"}], ":", 
     "\[IndentingNewLine]", "    ", 
     RowBox[{"Takes", " ", "M"}], ":", " ", 
     RowBox[{
      RowBox[{"the", " ", "home", " ", "configuration", " ", 
       RowBox[{"(", 
        RowBox[{"position", " ", "and", " ", "orientation"}], ")"}], " ", 
       "of", " ", "the", " ", "end"}], "-", "effector"}]}], ",", 
    "\[IndentingNewLine]", "           ", 
    RowBox[{"Slist", ":", " ", 
     RowBox[{
     "The", " ", "joint", " ", "screw", " ", "axes", " ", "in", " ", "the", 
      " ", "space", " ", "frame", " ", "when", " ", "the", " ", "manipulator",
       " ", "is", " ", "at", " ", "the", " ", "home", " ", "position"}]}], 
    ",", "\[IndentingNewLine]", "           ", 
    RowBox[{
     RowBox[{"thetalist", ":", " ", 
      RowBox[{
       RowBox[{"A", " ", "list", " ", "of", " ", "joint", " ", 
        RowBox[{"coordinates", ".", " ", "\[IndentingNewLine]", "Returns"}], 
        " ", "T", " ", "in", " ", "SE", 
        RowBox[{"(", "3", ")"}], " ", "representing", " ", "the", " ", 
        "end"}], "-", 
       RowBox[{
       "effector", " ", "frame", " ", "when", " ", "the", " ", "joints", " ", 
        "are", " ", "at", " ", "the", " ", "specified", " ", "coordinates", 
        " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"i", ".", "t", ".", "o"}], " ", "Fixed", " ", "Space", " ",
            "Frame"}], ")"}], "."}]}]}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Example", ":", "\[IndentingNewLine]", "Inputs", ":", 
       "\[IndentingNewLine]", "M"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "6"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"-", "1"}], ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\n", "  ", 
     RowBox[{"Slist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1", ",", "4", ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "6"}], ",", "0", ",", 
           RowBox[{"-", "0.1"}]}], "}"}]}], "}"}], "\[Transpose]"}]}], ";", 
     "\n", "  ", 
     RowBox[{"thetalist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Pi", "/", "2"}], ",", "3", ",", "Pi"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"T", " ", "=", " ", 
      RowBox[{
       RowBox[{"FKinSpace", "[", 
        RowBox[{"M", ",", "Slist", ",", "thetalist"}], "]"}], "//", 
       RowBox[{"MatrixForm", "\[IndentingNewLine]", 
        RowBox[{"Output", ":", " ", "\[IndentingNewLine]", 
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"0.", "1.", "0.", 
              RowBox[{"-", "5."}]},
             {"1.", "0.", "0.", "4.000000000000001"},
             {"0.", "0.", 
              RowBox[{"-", "1."}], "1.6858407346410207"},
             {"0.", "0.", "0.", "1."}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]]}]}]}]}]}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FKinSpace", "[", 
     RowBox[{"M_", ",", "Slist_", ",", "thetalist_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", ",", "T"}], "}"}], ",", 
      RowBox[{
       RowBox[{"T", "=", "M"}], ";", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"T", "=", 
          RowBox[{
           RowBox[{"MatrixExp6", "[", 
            RowBox[{"VecTose3", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Slist", "[", 
                 RowBox[{"[", 
                  RowBox[{";;", ",", "i"}], "]"}], "]"}], "}"}], 
               "\[Transpose]"}], "*", 
              RowBox[{"thetalist", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}], ".", 
           "T"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "thetalist", "]"}], ",", "1", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "T", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.67561602324156*^9, 3.6756160562747183`*^9}, {
   3.675616098480197*^9, 3.6756162304999313`*^9}, {3.675616267860519*^9, 
   3.6756162750402412`*^9}, {3.675616305671249*^9, 3.675616309582301*^9}, {
   3.6756163906900806`*^9, 3.675616392204427*^9}, {3.675616509110962*^9, 
   3.675616528559065*^9}, {3.676118088983922*^9, 3.676118088989098*^9}, {
   3.6774897363386793`*^9, 3.6774897422094803`*^9}, {3.677489976352415*^9, 
   3.677489976705158*^9}, 3.6780961963052464`*^9, {3.69090928837708*^9, 
   3.690909520265343*^9}, {3.690913200376834*^9, 3.690913206713196*^9}, {
   3.6909137447619705`*^9, 3.6909137493342323`*^9}, 3.690914243936522*^9, {
   3.6909171313316717`*^9, 3.690917211043231*^9}, {3.690999375578245*^9, 
   3.690999384735461*^9}, {3.6924715529323044`*^9, 3.6924716042118273`*^9}, {
   3.693153734503871*^9, 
   3.693153743817087*^9}},ExpressionUUID->"6c1a71c3-00c6-4090-82d8-\
835019f90473"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["CHAPTER  5: VELOCITY KINEMATICS AND STATICS",
 FontSize->24,
 FontWeight->"Bold",
 FontColor->RGBColor[0, 0, 1]]], "Title",
 CellChangeTimes->{{3.6755319110417843`*^9, 3.675531927048277*^9}, {
  3.675531958735077*^9, 3.67553201284205*^9}, {3.675607857109823*^9, 
  3.6756079117244864`*^9}, {3.6756821024917507`*^9, 
  3.6756821283850946`*^9}},ExpressionUUID->"8c456625-0100-4029-9a0c-\
290c6927b44f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"JacobianBody", "[", 
      RowBox[{"Blist_", ",", "thetalist_"}], "]"}], ":", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Takes", " ", "Blist"}], ":", " ", 
     RowBox[{
      RowBox[{
      "The", " ", "joint", " ", "screw", " ", "axes", " ", "in", " ", "the", 
       " ", "end"}], "-", 
      RowBox[{
      "effector", " ", "frame", " ", "when", " ", "the", " ", "manipulator", 
       " ", "is", " ", "at", " ", "the", " ", "home", " ", "position"}]}]}], 
    ",", "\[IndentingNewLine]", "         ", 
    RowBox[{
     RowBox[{"thetalist", ":", 
      RowBox[{"A", " ", "list", " ", "of", " ", "joint", " ", 
       RowBox[{"coordinates", ".", "\[IndentingNewLine]", "Returns"}], " ", 
       "the", " ", "corresponding", " ", "body", " ", "Jacobian", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"6", "xn", " ", "real", " ", "numbers"}], ")"}], "."}]}]}], 
     "\[IndentingNewLine]", ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Example", ":", "\[IndentingNewLine]", "Input", ":", 
       "\[IndentingNewLine]", "Blist"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", "0.2", ",", "0.2"}],
           "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0", ",", "2", ",", "0", ",", "3"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", "0", ",", "2", ",", "1"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "1", ",", "0", ",", "0", ",", "0.2", ",", "0.3", ",", "0.4"}], 
          "}"}]}], "}"}], "\[Transpose]"}]}], ";", "\n", 
     RowBox[{"thetalist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.2", ",", "1.1", ",", "0.1", ",", "1.2"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Jb", "=", 
      RowBox[{
       RowBox[{"JacobianBody", "[", 
        RowBox[{"Blist", ",", "thetalist"}], "]"}], "//", 
       RowBox[{"MatrixForm", "\[IndentingNewLine]", 
        RowBox[{"Output", ":", "\[IndentingNewLine]", 
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {
              RowBox[{"-", "0.04528405057966491"}], "0.9950041652780258", 
              "0.", "1"},
             {"0.7435931265563965", "0.09304864640049498", 
              "0.3623577544766736", "0"},
             {
              RowBox[{"-", "0.6670971570177624"}], "0.03617541267787882", 
              RowBox[{"-", "0.9320390859672263"}], "0"},
             {"2.3258604714595155", "1.668090004953633", "0.5641083080438885",
               "0.2"},
             {
              RowBox[{"-", "1.4432116718196153"}], "2.945612749911765", 
              "1.4330652142884392", "0.3"},
             {
              RowBox[{"-", "2.066395648760265"}], "1.8288172246233696", 
              RowBox[{"-", "1.5886862785321807"}], "0.4"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]]}]}]}]}]}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"JacobianBody", "[", 
     RowBox[{"Blist_", ",", "thetalist_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Jb", "=", "Blist"}], ",", 
        RowBox[{"T", "=", 
         RowBox[{"IdentityMatrix", "[", "4", "]"}]}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"T", "=", 
           RowBox[{"T", ".", 
            RowBox[{"MatrixExp6", "[", 
             RowBox[{"VecTose3", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Blist", "[", 
                  RowBox[{"[", 
                   RowBox[{";;", ",", 
                    RowBox[{"i", "+", "1"}]}], "]"}], "]"}], "}"}], 
                "\[Transpose]"}], "*", 
               RowBox[{"-", 
                RowBox[{"thetalist", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}]}]}], 
              "]"}], "]"}]}]}], ";", 
          RowBox[{
           RowBox[{"Jb", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", "i"}], "]"}], "]"}], "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Adjoint", "[", "T", "]"}], ".", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Blist", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", "i"}], "]"}], "]"}], "}"}], 
              "\[Transpose]"}]}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"Length", "[", "thetalist", "]"}], "-", "1"}], ",", "1", 
           ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";", 
       RowBox[{"Return", "[", "Jb", "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654107438701495*^9, 3.6541075770931664`*^9}, {
   3.6541076103152647`*^9, 3.654107726674172*^9}, {3.654107800327899*^9, 
   3.654107805926005*^9}, {3.654107842157054*^9, 3.654107956534466*^9}, {
   3.6541080276373253`*^9, 3.654108039845397*^9}, {3.654108208328875*^9, 
   3.654108267778264*^9}, {3.654108316603101*^9, 3.65410832858707*^9}, {
   3.654122072990996*^9, 3.654122200142358*^9}, {3.654122232524707*^9, 
   3.6541222637488813`*^9}, {3.654122372486209*^9, 3.65412253592478*^9}, {
   3.654122571686759*^9, 3.654122685636675*^9}, {3.654122740902017*^9, 
   3.6541228215630703`*^9}, {3.654122865671712*^9, 3.654122935620612*^9}, {
   3.654123032181581*^9, 3.6541230914473333`*^9}, {3.654123152783122*^9, 
   3.6541232043612537`*^9}, {3.654123304611115*^9, 3.654123341073502*^9}, {
   3.654123502235703*^9, 3.654123578362132*^9}, {3.654123664279245*^9, 
   3.654123683195951*^9}, {3.6541237878998413`*^9, 3.6541238249788847`*^9}, {
   3.654123940392714*^9, 3.654123947510108*^9}, {3.654124026309593*^9, 
   3.654124026885428*^9}, 3.6541241152729683`*^9, 3.654124170343902*^9, {
   3.6541246995439568`*^9, 3.654124712871656*^9}, {3.6541251843297157`*^9, 
   3.654125231518578*^9}, {3.6541254856851683`*^9, 3.65412548908077*^9}, {
   3.654125547742125*^9, 3.654125551165526*^9}, {3.654125930807577*^9, 
   3.654126007244483*^9}, {3.654126127665163*^9, 3.654126191634789*^9}, {
   3.654126236482831*^9, 3.654126250153975*^9}, {3.6541262848658533`*^9, 
   3.654126288991514*^9}, {3.654126323055903*^9, 3.654126399729628*^9}, {
   3.654126435349374*^9, 3.654126447266036*^9}, {3.654126530077552*^9, 
   3.6541265937421*^9}, {3.654126679867402*^9, 3.6541267650289497`*^9}, {
   3.6541267969631968`*^9, 3.654126798410089*^9}, {3.654126829860013*^9, 
   3.654126881359337*^9}, {3.6541269393824577`*^9, 3.654126959132009*^9}, {
   3.654127079773924*^9, 3.654127194954756*^9}, {3.654127229244482*^9, 
   3.654127253953713*^9}, {3.6541278694900227`*^9, 3.654127878663176*^9}, {
   3.654127969775614*^9, 3.6541279938293123`*^9}, {3.654128051763153*^9, 
   3.654128134016169*^9}, {3.654128326830834*^9, 3.654128326972948*^9}, {
   3.654182305132535*^9, 3.654182317491791*^9}, {3.65418238746202*^9, 
   3.654182511491269*^9}, {3.654182551115921*^9, 3.654182559209998*^9}, {
   3.6541826265390177`*^9, 3.654182732425318*^9}, {3.654182795218339*^9, 
   3.654182802306821*^9}, {3.654182858360195*^9, 3.654182976637673*^9}, {
   3.65418309291822*^9, 3.6541831115452337`*^9}, {3.654183280620055*^9, 
   3.654183381285778*^9}, {3.6541834216733217`*^9, 3.65418343026462*^9}, {
   3.65418347398075*^9, 3.654183479016459*^9}, {3.654183517743698*^9, 
   3.654183590244978*^9}, {3.654183629340012*^9, 3.654183659551435*^9}, {
   3.654183828746057*^9, 3.654183869187777*^9}, {3.654183918271063*^9, 
   3.6541839184304667`*^9}, {3.654206461375032*^9, 3.6542064948942213`*^9}, {
   3.6542065261576433`*^9, 3.654206710642645*^9}, {3.65420685898112*^9, 
   3.654206859498214*^9}, {3.654206912388175*^9, 3.6542069199221067`*^9}, {
   3.654206956850091*^9, 3.654206957769821*^9}, {3.6542070885864773`*^9, 
   3.6542070905801163`*^9}, {3.6542071861274023`*^9, 3.654207197287834*^9}, {
   3.654207355631957*^9, 3.65420737546005*^9}, {3.654207422116619*^9, 
   3.6542074295958633`*^9}, {3.654207513008601*^9, 3.654207622631179*^9}, {
   3.6542077902321663`*^9, 3.6542079082040863`*^9}, {3.654208112675095*^9, 
   3.6542082406765347`*^9}, {3.654208390436673*^9, 3.654208437282127*^9}, {
   3.654208729398788*^9, 3.6542088242969923`*^9}, {3.654208875181876*^9, 
   3.6542089105814543`*^9}, {3.654209036563011*^9, 3.654209042056604*^9}, {
   3.654209131808134*^9, 3.654209211748107*^9}, {3.654277910558556*^9, 
   3.654277962902483*^9}, {3.6542785554956903`*^9, 3.654278555764879*^9}, {
   3.6542801407928543`*^9, 3.654280145647377*^9}, {3.654280336511973*^9, 
   3.654280388661951*^9}, {3.654735519742467*^9, 3.654735526212496*^9}, {
   3.654736711632904*^9, 3.654736744359725*^9}, {3.654736840726715*^9, 
   3.6547369027091503`*^9}, {3.6547369619155817`*^9, 3.65473711893006*^9}, 
   3.654737215212165*^9, {3.6547372623430433`*^9, 3.654737301717353*^9}, {
   3.654737434898181*^9, 3.654737445769989*^9}, {3.654737593349925*^9, 
   3.654737893647337*^9}, {3.654737938282483*^9, 3.654737939560112*^9}, {
   3.654737995469615*^9, 3.65473804382544*^9}, {3.65473814244207*^9, 
   3.65473826286047*^9}, {3.654738473301898*^9, 3.654738519313912*^9}, {
   3.654738551955141*^9, 3.654738559351729*^9}, {3.654738599129403*^9, 
   3.654738599566987*^9}, {3.654738653005966*^9, 3.654738704434928*^9}, {
   3.654738885183668*^9, 3.654738922018218*^9}, {3.654739011880048*^9, 
   3.65473910917871*^9}, {3.654739159170903*^9, 3.654739162120161*^9}, {
   3.6547393230277576`*^9, 3.6547393764227123`*^9}, {3.654739415181912*^9, 
   3.65473942023728*^9}, {3.654739453135948*^9, 3.654739679965816*^9}, {
   3.654739718627033*^9, 3.6547397334487553`*^9}, {3.654739765385715*^9, 
   3.654739851694334*^9}, {3.654739889466123*^9, 3.654740005071364*^9}, {
   3.6547400491757*^9, 3.654740154008595*^9}, 3.654740216700787*^9, {
   3.654740314399178*^9, 3.6547403286014967`*^9}, 3.6547403850818996`*^9, {
   3.654740521314966*^9, 3.654740541208376*^9}, {3.65474063388687*^9, 
   3.654740654515286*^9}, {3.654740701345427*^9, 3.654740810460566*^9}, {
   3.654740848239312*^9, 3.654741082783293*^9}, {3.654741274225429*^9, 
   3.65474127713437*^9}, 3.654741426789631*^9, {3.6547414571147537`*^9, 
   3.654741569824174*^9}, {3.654741604551594*^9, 3.65474161887015*^9}, {
   3.6547416933496304`*^9, 3.654741709459137*^9}, {3.654741935230948*^9, 
   3.654741945307493*^9}, {3.6547830386167917`*^9, 3.654783105454197*^9}, {
   3.6547832406606083`*^9, 3.6547832525310373`*^9}, {3.654783794511154*^9, 
   3.654783837663447*^9}, {3.65478390359721*^9, 3.654783909803577*^9}, {
   3.654783989474423*^9, 3.654784403124803*^9}, {3.654784520313846*^9, 
   3.654784622329711*^9}, {3.6547847231449842`*^9, 3.654784727983326*^9}, {
   3.654785122876478*^9, 3.654785187751635*^9}, {3.654785255283667*^9, 
   3.654785472044736*^9}, {3.654785554330287*^9, 3.6547855634367*^9}, {
   3.6547858133842907`*^9, 3.654785842420493*^9}, {3.654785988696732*^9, 
   3.654785999313698*^9}, {3.654786083383224*^9, 3.654786083827299*^9}, {
   3.654799998454865*^9, 3.654800009014682*^9}, 3.654800058896707*^9, {
   3.6548001027328*^9, 3.654800173381201*^9}, {3.654800206111162*^9, 
   3.654800346038969*^9}, {3.654800415767541*^9, 3.654800685527397*^9}, {
   3.654800717895743*^9, 3.6548007259529123`*^9}, {3.6548007560240192`*^9, 
   3.654800892868227*^9}, {3.654800961067473*^9, 3.6548010443125353`*^9}, {
   3.654801144205307*^9, 3.6548013970409203`*^9}, {3.654801447723054*^9, 
   3.6548014700938597`*^9}, {3.654801562889327*^9, 3.6548017505389137`*^9}, {
   3.6548017965315866`*^9, 3.654801838591158*^9}, {3.654801925163512*^9, 
   3.654801957336872*^9}, {3.654802037838778*^9, 3.654802097667626*^9}, {
   3.6548021338675137`*^9, 3.654802151746142*^9}, {3.6548021938035927`*^9, 
   3.65480226557542*^9}, {3.6548023434469347`*^9, 3.6548024564595747`*^9}, {
   3.654802493167995*^9, 3.654802498462143*^9}, {3.654802632969117*^9, 
   3.654802636326886*^9}, {3.6548026864101667`*^9, 3.6548027624957323`*^9}, {
   3.654802812209731*^9, 3.6548030159498*^9}, {3.6548066359524317`*^9, 
   3.654806720935005*^9}, {3.654806751992766*^9, 3.6548067587144833`*^9}, {
   3.654806821497799*^9, 3.654806889382121*^9}, {3.654807006283039*^9, 
   3.654807210369132*^9}, {3.654807340425975*^9, 3.6548074184588003`*^9}, {
   3.6548074913193197`*^9, 3.654807699931301*^9}, 3.6548078200861998`*^9, {
   3.654807890939335*^9, 3.65480791502777*^9}, {3.654807960842239*^9, 
   3.6548080712336483`*^9}, {3.654808128338978*^9, 3.6548081799548407`*^9}, {
   3.6548101758929577`*^9, 3.654810330104765*^9}, {3.654810401423953*^9, 
   3.654810408457419*^9}, {3.6548104718702717`*^9, 3.6548106690676603`*^9}, {
   3.6548107121438303`*^9, 3.6548108463298893`*^9}, {3.654810878513033*^9, 
   3.6548109250220337`*^9}, {3.654810973064028*^9, 3.6548109963255377`*^9}, {
   3.654811065383171*^9, 3.65481111435124*^9}, {3.6548111568410273`*^9, 
   3.654811165569319*^9}, {3.654811202562601*^9, 3.654811649746052*^9}, {
   3.657067656153129*^9, 3.657067660941557*^9}, {3.6570766750689*^9, 
   3.657076677028944*^9}, {3.658274451899232*^9, 3.6582744912918463`*^9}, {
   3.6583703518545094`*^9, 3.65837035300604*^9}, {3.675682824450754*^9, 
   3.6756828836706333`*^9}, {3.6756829858535852`*^9, 3.675683093476144*^9}, {
   3.675683163431617*^9, 3.675683301926485*^9}, {3.6756834458193197`*^9, 
   3.675683520674423*^9}, {3.675683569012762*^9, 3.675683584065415*^9}, 
   3.675683635500771*^9, {3.675684508273862*^9, 3.675684520687911*^9}, {
   3.676118088998353*^9, 3.6761180890027103`*^9}, {3.6780962114132557`*^9, 
   3.6780962222523317`*^9}, {3.690913621955947*^9, 3.6909136343216543`*^9}, {
   3.6909136679215755`*^9, 3.690913725619876*^9}, {3.690913797528989*^9, 
   3.6909138031643114`*^9}, {3.690914105377597*^9, 3.6909142142378235`*^9}, {
   3.6909142598524323`*^9, 3.6909143132884884`*^9}, {3.6909143596851425`*^9, 
   3.690914398644371*^9}, {3.690914598697813*^9, 3.690914613259646*^9}, {
   3.690914668211789*^9, 3.690914685903801*^9}, {3.690914747675334*^9, 
   3.69091474865139*^9}, {3.690914908730546*^9, 3.690914919761177*^9}, 
   3.690915080529372*^9, {3.6909151348674803`*^9, 3.69091517210761*^9}, {
   3.6909152557973967`*^9, 3.6909153375360723`*^9}, {3.6909172880516353`*^9, 
   3.690917438477239*^9}, {3.6909175950231934`*^9, 3.6909176033206673`*^9}, {
   3.690917683287242*^9, 3.6909176858573885`*^9}, {3.690917719940338*^9, 
   3.6909177389524255`*^9}, {3.6909853171351404`*^9, 3.690985339935088*^9}, {
   3.690985502174197*^9, 3.690985506302885*^9}, {3.6909855510623407`*^9, 
   3.6909856006920443`*^9}, 3.69098572316947*^9, {3.690985829611455*^9, 
   3.6909858397746425`*^9}, {3.690985881794064*^9, 3.69098589040903*^9}, {
   3.6909859209394445`*^9, 3.6909859300320067`*^9}, {3.690986739189022*^9, 
   3.6909867483930387`*^9}, {3.6909898070292606`*^9, 
   3.6909898474961324`*^9}, {3.690989877981586*^9, 3.690989899620225*^9}, {
   3.6909903529604497`*^9, 3.690990508746724*^9}, {3.6924716549023256`*^9, 
   3.69247168464919*^9}},ExpressionUUID->"06bd328e-b430-4e7d-acba-\
f59582ec3386"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"JacobianSpace", "[", 
      RowBox[{"Slist_", ",", "thetalist_"}], "]"}], ":", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Takes", " ", "Slist"}], ":", " ", 
     RowBox[{
     "The", " ", "joint", " ", "screw", " ", "axes", " ", "in", " ", "the", 
      " ", "space", " ", "frame", " ", "when", " ", "the", " ", "manipulator",
       " ", "is", " ", "at", " ", "the", " ", "home", " ", "position"}]}], 
    ",", "\[IndentingNewLine]", "         ", 
    RowBox[{
     RowBox[{"thetalist", ":", 
      RowBox[{"A", " ", "list", " ", "of", " ", "joint", " ", 
       RowBox[{"coordinates", ".", "\[IndentingNewLine]", "Returns"}], " ", 
       "the", " ", "corresponding", " ", "space", " ", "Jacobian", " ", 
       RowBox[{"(", 
        RowBox[{"6", "xn", " ", "real", " ", "numbers"}], ")"}]}]}], 
     "\[IndentingNewLine]", ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Example", ":", "\[IndentingNewLine]", "Input", ":", 
       "\[IndentingNewLine]", "Slist"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", "0.2", ",", "0.2"}],
           "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0", ",", "2", ",", "0", ",", "3"}], 
          "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", "0", ",", "2", ",", "1"}], 
          "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
          "1", ",", "0", ",", "0", ",", "0.2", ",", "0.3", ",", "0.4"}], 
          "}"}]}], "}"}], "\[Transpose]"}]}], ";", "\n", 
     RowBox[{"thetalist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.2", ",", "1.1", ",", "0.1", ",", "1.2"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Js", " ", "=", " ", 
      RowBox[{
       RowBox[{"JacobianSpace", "[", 
        RowBox[{"Slist", ",", " ", "thetalist"}], "]"}], "//", 
       RowBox[{"MatrixForm", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Ouput", ":", "\[IndentingNewLine]", 
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"0", "0.9800665778412416", 
              RowBox[{"-", "0.09011563789485476"}], "0.957494264730031"},
             {"0", "0.19866933079506122", "0.4445543984476258", 
              "0.28487556541794845"},
             {"1", "0.", "0.8912073600614354", 
              RowBox[{"-", "0.04528405057966491"}]},
             {"0", "1.9521863824506809", 
              RowBox[{"-", "2.216352156896298"}], 
              RowBox[{"-", "0.5116153729819477"}]},
             {"0.2", "0.4365413247037721", 
              RowBox[{"-", "2.437125727653321"}], "2.7753571339551537"},
             {"0.2", "2.960266133840988", "3.2357306532803083", 
              "2.22512443353574"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]]}]}]}]}]}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"JacobianSpace", "[", 
     RowBox[{"Slist_", ",", "thetalist_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Js", "=", "Slist"}], ",", 
        RowBox[{"T", "=", 
         RowBox[{"IdentityMatrix", "[", "4", "]"}]}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"T", "=", 
           RowBox[{"T", ".", 
            RowBox[{"MatrixExp6", "[", 
             RowBox[{"VecTose3", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Slist", "[", 
                  RowBox[{"[", 
                   RowBox[{";;", ",", 
                    RowBox[{"i", "-", "1"}]}], "]"}], "]"}], "}"}], 
                "\[Transpose]"}], "*", 
               RowBox[{"thetalist", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"i", "-", "1"}], ",", "1"}], "]"}], "]"}]}], "]"}], 
             "]"}]}]}], ";", 
          RowBox[{
           RowBox[{"Js", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", "i"}], "]"}], "]"}], "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Adjoint", "[", "T", "]"}], ".", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Slist", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", "i"}], "]"}], "]"}], "}"}], 
              "\[Transpose]"}]}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "[", "thetalist", "]"}]}], "}"}]}], "]"}], ";", 
       RowBox[{"Return", "[", "Js", "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654107438701495*^9, 3.6541075770931664`*^9}, {
   3.6541076103152647`*^9, 3.654107726674172*^9}, {3.654107800327899*^9, 
   3.654107805926005*^9}, {3.654107842157054*^9, 3.654107956534466*^9}, {
   3.6541080276373253`*^9, 3.654108039845397*^9}, {3.654108208328875*^9, 
   3.654108267778264*^9}, {3.654108316603101*^9, 3.65410832858707*^9}, {
   3.654122072990996*^9, 3.654122200142358*^9}, {3.654122232524707*^9, 
   3.6541222637488813`*^9}, {3.654122372486209*^9, 3.65412253592478*^9}, {
   3.654122571686759*^9, 3.654122685636675*^9}, {3.654122740902017*^9, 
   3.6541228215630703`*^9}, {3.654122865671712*^9, 3.654122935620612*^9}, {
   3.654123032181581*^9, 3.6541230914473333`*^9}, {3.654123152783122*^9, 
   3.6541232043612537`*^9}, {3.654123304611115*^9, 3.654123341073502*^9}, {
   3.654123502235703*^9, 3.654123578362132*^9}, {3.654123664279245*^9, 
   3.654123683195951*^9}, {3.6541237878998413`*^9, 3.6541238249788847`*^9}, {
   3.654123940392714*^9, 3.654123947510108*^9}, {3.654124026309593*^9, 
   3.654124026885428*^9}, 3.6541241152729683`*^9, 3.654124170343902*^9, {
   3.6541246995439568`*^9, 3.654124712871656*^9}, {3.6541251843297157`*^9, 
   3.654125231518578*^9}, {3.6541254856851683`*^9, 3.65412548908077*^9}, {
   3.654125547742125*^9, 3.654125551165526*^9}, {3.654125930807577*^9, 
   3.654126007244483*^9}, {3.654126127665163*^9, 3.654126191634789*^9}, {
   3.654126236482831*^9, 3.654126250153975*^9}, {3.6541262848658533`*^9, 
   3.654126288991514*^9}, {3.654126323055903*^9, 3.654126399729628*^9}, {
   3.654126435349374*^9, 3.654126447266036*^9}, {3.654126530077552*^9, 
   3.6541265937421*^9}, {3.654126679867402*^9, 3.6541267650289497`*^9}, {
   3.6541267969631968`*^9, 3.654126798410089*^9}, {3.654126829860013*^9, 
   3.654126881359337*^9}, {3.6541269393824577`*^9, 3.654126959132009*^9}, {
   3.654127079773924*^9, 3.654127194954756*^9}, {3.654127229244482*^9, 
   3.654127253953713*^9}, {3.6541278694900227`*^9, 3.654127878663176*^9}, {
   3.654127969775614*^9, 3.6541279938293123`*^9}, {3.654128051763153*^9, 
   3.654128134016169*^9}, {3.654128326830834*^9, 3.654128326972948*^9}, {
   3.654182305132535*^9, 3.654182317491791*^9}, {3.65418238746202*^9, 
   3.654182511491269*^9}, {3.654182551115921*^9, 3.654182559209998*^9}, {
   3.6541826265390177`*^9, 3.654182732425318*^9}, {3.654182795218339*^9, 
   3.654182802306821*^9}, {3.654182858360195*^9, 3.654182976637673*^9}, {
   3.65418309291822*^9, 3.6541831115452337`*^9}, {3.654183280620055*^9, 
   3.654183381285778*^9}, {3.6541834216733217`*^9, 3.65418343026462*^9}, {
   3.65418347398075*^9, 3.654183479016459*^9}, {3.654183517743698*^9, 
   3.654183590244978*^9}, {3.654183629340012*^9, 3.654183659551435*^9}, {
   3.654183828746057*^9, 3.654183869187777*^9}, {3.654183918271063*^9, 
   3.6541839184304667`*^9}, {3.654206461375032*^9, 3.6542064948942213`*^9}, {
   3.6542065261576433`*^9, 3.654206710642645*^9}, {3.65420685898112*^9, 
   3.654206859498214*^9}, {3.654206912388175*^9, 3.6542069199221067`*^9}, {
   3.654206956850091*^9, 3.654206957769821*^9}, {3.6542070885864773`*^9, 
   3.6542070905801163`*^9}, {3.6542071861274023`*^9, 3.654207197287834*^9}, {
   3.654207355631957*^9, 3.65420737546005*^9}, {3.654207422116619*^9, 
   3.6542074295958633`*^9}, {3.654207513008601*^9, 3.654207622631179*^9}, {
   3.6542077902321663`*^9, 3.6542079082040863`*^9}, {3.654208112675095*^9, 
   3.6542082406765347`*^9}, {3.654208390436673*^9, 3.654208437282127*^9}, {
   3.654208729398788*^9, 3.6542088242969923`*^9}, {3.654208875181876*^9, 
   3.6542089105814543`*^9}, {3.654209036563011*^9, 3.654209042056604*^9}, {
   3.654209131808134*^9, 3.654209211748107*^9}, {3.654277910558556*^9, 
   3.654277962902483*^9}, {3.6542785554956903`*^9, 3.654278555764879*^9}, {
   3.6542801407928543`*^9, 3.654280145647377*^9}, {3.654280336511973*^9, 
   3.654280388661951*^9}, {3.654735519742467*^9, 3.654735526212496*^9}, {
   3.654736711632904*^9, 3.654736744359725*^9}, {3.654736840726715*^9, 
   3.6547369027091503`*^9}, {3.6547369619155817`*^9, 3.65473711893006*^9}, 
   3.654737215212165*^9, {3.6547372623430433`*^9, 3.654737301717353*^9}, {
   3.654737434898181*^9, 3.654737445769989*^9}, {3.654737593349925*^9, 
   3.654737893647337*^9}, {3.654737938282483*^9, 3.654737939560112*^9}, {
   3.654737995469615*^9, 3.65473804382544*^9}, {3.65473814244207*^9, 
   3.65473826286047*^9}, {3.654738473301898*^9, 3.654738519313912*^9}, {
   3.654738551955141*^9, 3.654738559351729*^9}, {3.654738599129403*^9, 
   3.654738599566987*^9}, {3.654738653005966*^9, 3.654738704434928*^9}, {
   3.654738885183668*^9, 3.654738922018218*^9}, {3.654739011880048*^9, 
   3.65473910917871*^9}, {3.654739159170903*^9, 3.654739162120161*^9}, {
   3.6547393230277576`*^9, 3.6547393764227123`*^9}, {3.654739415181912*^9, 
   3.65473942023728*^9}, {3.654739453135948*^9, 3.654739679965816*^9}, {
   3.654739718627033*^9, 3.6547397334487553`*^9}, {3.654739765385715*^9, 
   3.654739851694334*^9}, {3.654739889466123*^9, 3.654740005071364*^9}, {
   3.6547400491757*^9, 3.654740154008595*^9}, 3.654740216700787*^9, {
   3.654740314399178*^9, 3.6547403286014967`*^9}, 3.6547403850818996`*^9, {
   3.654740521314966*^9, 3.654740541208376*^9}, {3.65474063388687*^9, 
   3.654740654515286*^9}, {3.654740701345427*^9, 3.654740810460566*^9}, {
   3.654740848239312*^9, 3.654741082783293*^9}, {3.654741274225429*^9, 
   3.65474127713437*^9}, 3.654741426789631*^9, {3.6547414571147537`*^9, 
   3.654741569824174*^9}, {3.654741604551594*^9, 3.65474161887015*^9}, {
   3.6547416933496304`*^9, 3.654741709459137*^9}, {3.654741935230948*^9, 
   3.654741945307493*^9}, {3.6547830386167917`*^9, 3.654783105454197*^9}, {
   3.6547832406606083`*^9, 3.6547832525310373`*^9}, {3.654783794511154*^9, 
   3.654783837663447*^9}, {3.65478390359721*^9, 3.654783909803577*^9}, {
   3.654783989474423*^9, 3.654784403124803*^9}, {3.654784520313846*^9, 
   3.654784622329711*^9}, {3.6547847231449842`*^9, 3.654784727983326*^9}, {
   3.654785122876478*^9, 3.654785187751635*^9}, {3.654785255283667*^9, 
   3.654785472044736*^9}, {3.654785554330287*^9, 3.6547855634367*^9}, {
   3.6547858133842907`*^9, 3.654785842420493*^9}, {3.654785988696732*^9, 
   3.654785999313698*^9}, {3.654786083383224*^9, 3.654786083827299*^9}, {
   3.654799998454865*^9, 3.654800009014682*^9}, 3.654800058896707*^9, {
   3.6548001027328*^9, 3.654800173381201*^9}, {3.654800206111162*^9, 
   3.654800346038969*^9}, {3.654800415767541*^9, 3.654800685527397*^9}, {
   3.654800717895743*^9, 3.6548007259529123`*^9}, {3.6548007560240192`*^9, 
   3.654800892868227*^9}, {3.654800961067473*^9, 3.6548010443125353`*^9}, {
   3.654801144205307*^9, 3.6548013970409203`*^9}, {3.654801447723054*^9, 
   3.6548014700938597`*^9}, {3.654801562889327*^9, 3.6548017505389137`*^9}, {
   3.6548017965315866`*^9, 3.654801838591158*^9}, {3.654801925163512*^9, 
   3.654801957336872*^9}, {3.654802037838778*^9, 3.654802097667626*^9}, {
   3.6548021338675137`*^9, 3.654802151746142*^9}, {3.6548021938035927`*^9, 
   3.65480226557542*^9}, {3.6548023434469347`*^9, 3.6548024564595747`*^9}, {
   3.654802493167995*^9, 3.654802498462143*^9}, {3.654802632969117*^9, 
   3.654802636326886*^9}, {3.6548026864101667`*^9, 3.6548027624957323`*^9}, {
   3.654802812209731*^9, 3.6548030159498*^9}, {3.6548066359524317`*^9, 
   3.654806720935005*^9}, {3.654806751992766*^9, 3.6548067587144833`*^9}, {
   3.654806821497799*^9, 3.654806889382121*^9}, {3.654807006283039*^9, 
   3.654807210369132*^9}, {3.654807340425975*^9, 3.6548074184588003`*^9}, {
   3.6548074913193197`*^9, 3.654807699931301*^9}, 3.6548078200861998`*^9, {
   3.654807890939335*^9, 3.65480791502777*^9}, {3.654807960842239*^9, 
   3.6548080712336483`*^9}, {3.654808128338978*^9, 3.6548081799548407`*^9}, {
   3.6548101758929577`*^9, 3.654810330104765*^9}, {3.654810401423953*^9, 
   3.654810408457419*^9}, {3.6548104718702717`*^9, 3.6548106690676603`*^9}, {
   3.6548107121438303`*^9, 3.6548108463298893`*^9}, {3.654810878513033*^9, 
   3.6548109250220337`*^9}, {3.654810973064028*^9, 3.6548109963255377`*^9}, {
   3.654811065383171*^9, 3.65481111435124*^9}, {3.6548111568410273`*^9, 
   3.654811165569319*^9}, {3.654811202562601*^9, 3.654811649746052*^9}, {
   3.657067656153129*^9, 3.657067660941557*^9}, {3.6570766750689*^9, 
   3.657076677028944*^9}, {3.658274451899232*^9, 3.6582744912918463`*^9}, {
   3.6583703518545094`*^9, 3.65837035300604*^9}, {3.675684467101232*^9, 
   3.6756844876690702`*^9}, 3.675685101672298*^9, {3.675685132865593*^9, 
   3.675685170606345*^9}, {3.6756852137594137`*^9, 3.675685253900947*^9}, {
   3.675685284425191*^9, 3.6756853403668823`*^9}, {3.6756853826789017`*^9, 
   3.675685417250636*^9}, {3.6761180890121613`*^9, 3.6761180890163*^9}, {
   3.6772374764222107`*^9, 3.677237478976756*^9}, 3.6774898698726873`*^9, {
   3.67748999177361*^9, 3.677489992267871*^9}, {3.678096227392668*^9, 
   3.6780962321466627`*^9}, {3.6909992890056925`*^9, 
   3.6909993428453875`*^9}, {3.690999403441894*^9, 3.6909994879708433`*^9}, {
   3.6909995975862417`*^9, 3.6909997130448446`*^9}, {3.692471696981022*^9, 
   3.692471714808461*^9}},ExpressionUUID->"290b86ce-006f-452c-ad1d-\
c66502d93173"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["CHAPTER  6: INVERSE KINEMATICS",
 FontSize->24,
 FontWeight->"Bold",
 FontColor->RGBColor[0, 0, 1]]], "Title",
 CellChangeTimes->{{3.6755319110417843`*^9, 3.675531927048277*^9}, {
  3.675531958735077*^9, 3.67553201284205*^9}, {3.675607857109823*^9, 
  3.6756079117244864`*^9}, {3.6756821024917507`*^9, 3.6756821283850946`*^9}, {
  3.6757648758196497`*^9, 
  3.675764892595064*^9}},ExpressionUUID->"aeb0f32d-f3a5-4448-95d9-\
5bcb1f965aee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"IKinBody", "[", 
      RowBox[{
      "Blist_", ",", "M_", ",", "T_", ",", "thetalist0_", ",", "eomg_", ",", 
       "ev_"}], "]"}], ":", "\[IndentingNewLine]", "   ", 
     RowBox[{"Takes", " ", "Blist"}], ":", " ", 
     RowBox[{
      RowBox[{
      "The", " ", "joint", " ", "screw", " ", "axes", " ", "in", " ", "the", 
       " ", "end"}], "-", 
      RowBox[{
      "effector", " ", "frame", " ", "when", " ", "the", " ", "manipulator", 
       " ", "is", " ", "at", " ", "the", " ", "home", " ", "position"}]}]}], 
    ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"M", ":", " ", 
     RowBox[{
      RowBox[{
      "The", " ", "home", " ", "configuration", " ", "of", " ", "the", " ", 
       "end"}], "-", "effector"}]}], ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"T", ":", " ", 
     RowBox[{
      RowBox[{"The", " ", "desired", " ", "end"}], "-", 
      RowBox[{"effector", " ", "configuration", " ", "T"}]}]}], ",", "\n", 
    "          ", 
    RowBox[{"thetalist0", ":", " ", 
     RowBox[{
     "An", " ", "initial", " ", "guess", " ", "of", " ", "joint", " ", 
      "angles", " ", "that", " ", "are", " ", "close", " ", "to", " ", 
      "satisfying", " ", "T"}]}], ",", "\n", "          ", 
    RowBox[{"eomg", ":", " ", 
     RowBox[{
      RowBox[{
      "A", " ", "small", " ", "positive", " ", "tolerance", " ", "on", " ", 
       "the", " ", "end"}], "-", 
      RowBox[{"effector", " ", "orientation", " ", 
       RowBox[{"error", ".", " ", "The"}], " ", "returned", " ", "joint", " ",
        "angles", " ", "must", " ", "give", " ", "an", " ", "end"}], "-", 
      RowBox[{
      "effector", " ", "orientation", " ", "error", " ", "less", " ", "than", 
       " ", "eomg"}]}]}], ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"ev", ":", " ", 
     RowBox[{
      RowBox[{
      "A", " ", "small", " ", "positive", " ", "tolerance", " ", "on", " ", 
       "the", " ", "end"}], "-", 
      RowBox[{"effector", " ", "linear", " ", "position", " ", 
       RowBox[{"error", ".", " ", "The"}], " ", "returned", " ", "joint", " ",
        "angles", " ", "must", " ", "give", " ", "an", " ", "end"}], "-", 
      RowBox[{
      "effector", " ", "position", " ", "error", " ", "less", " ", "than", 
       " ", 
       RowBox[{"ev", ".", " ", "\[IndentingNewLine]", "Returns"}], " ", 
       "thetalist"}]}], ":", " ", 
     RowBox[{
     "Joint", " ", "angles", " ", "that", " ", "achieve", " ", "T", " ", 
      "within", " ", "the", " ", "specified", " ", "tolerance"}]}], ",", " ", 
    
    RowBox[{"success", ":", " ", 
     RowBox[{
      RowBox[{
      "A", " ", "logical", " ", "value", " ", "where", " ", "True", " ", 
       "means", " ", "that", " ", "the", " ", "function", " ", "found", " ", 
       "a", " ", "solution", " ", "and", " ", "False", " ", "means", " ", 
       "that", " ", "it", " ", "ran", " ", "through", " ", "the", " ", "set", 
       " ", "number", " ", "of", " ", "maximum", " ", "iterations", " ", 
       "without", " ", "finding", " ", "a", " ", "solution", " ", "within", 
       " ", "the", " ", "tolerances", " ", "eomg", " ", "and", " ", 
       RowBox[{"ev", ".", "\[IndentingNewLine]", "Uses"}], " ", "an", " ", 
       "iterative", " ", "Newton"}], "-", 
      RowBox[{"Raphson", " ", "root"}], "-", 
      RowBox[{"finding", " ", 
       RowBox[{"method", ".", "\[IndentingNewLine]", "The"}], " ", "maximum", 
       " ", "number", " ", "of", " ", "iterations", " ", "before", " ", "the",
        " ", "algorithm", " ", "is", " ", "terminated", " ", "has", " ", 
       "been", " ", "hardcoded", " ", "in", " ", "as", " ", "a", " ", 
       "variable", " ", "called", " ", 
       RowBox[{"maxiterations", ".", "It"}], " ", "is", " ", "set", " ", "to",
        " ", "20", " ", "at", " ", "the", " ", "start", " ", "of", " ", "the",
        " ", "function"}]}]}], ",", 
    RowBox[{
     RowBox[{"but", " ", "can", " ", "be", " ", "changed", " ", "if", " ", 
      RowBox[{"needed", "."}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Exapmle", ":", "\[IndentingNewLine]", "Input", ":", 
       "\[IndentingNewLine]", "Blist"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{"-", "1"}], ",", "2", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0.1"}], 
          "}"}]}], "}"}], "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
     "  ", 
     RowBox[{"M", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "6"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"-", "1"}], ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     " ", "\[IndentingNewLine]", "  ", 
     RowBox[{"T", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", 
          RowBox[{"-", "5"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"-", "1"}], ",", "1.6858"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"thetalist0", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"1.5", ",", "2.5", ",", "3"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"eomg", "=", "0.01"}], ";", "\n", "  ", 
     RowBox[{"ev", "=", "0.001"}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"thetalist", ",", "success"}], "}"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"IKinBody", "[", 
        RowBox[{
        "Blist", ",", "M", ",", "T", ",", "thetalist0", ",", "eomg", ",", 
         "ev"}], "]"}], "\[IndentingNewLine]", 
       RowBox[{"Ouput", ":", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "1.5707381937148923", "}"}], ",", 
            RowBox[{"{", "2.999666997382942", "}"}], ",", 
            RowBox[{"{", "3.141539129217613", "}"}]}], "}"}], ",", "True"}], 
         "}"}]}]}]}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"IKinBody", "[", 
     RowBox[{
     "Blist_", ",", "M_", ",", "T_", ",", "thetalist0_", ",", "eomg_", ",", 
      "ev_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Vb", ",", 
        RowBox[{"thetalist", "=", "thetalist0"}], ",", "err", ",", 
        RowBox[{"i", "=", "0"}], ",", 
        RowBox[{"maxiterations", " ", "=", " ", "20"}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"Vb", " ", "=", " ", 
        RowBox[{"se3ToVec", "[", 
         RowBox[{"MatrixLog6", "[", 
          RowBox[{
           RowBox[{"TransInv", "[", 
            RowBox[{"FKinBody", "[", 
             RowBox[{"M", ",", "Blist", ",", "thetalist"}], "]"}], "]"}], ".",
            "T"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"err", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Norm", "[", 
           RowBox[{"Vb", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"1", ";;", "3"}], ",", "1"}], "]"}], "]"}], "]"}], ">", 
          "eomg"}], " ", "||", " ", 
         RowBox[{
          RowBox[{"Norm", "[", 
           RowBox[{"Vb", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"4", ";;", "6"}], ",", "1"}], "]"}], "]"}], "]"}], ">", 
          "ev"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"err", " ", "&&", 
          RowBox[{"i", " ", "<", " ", "maxiterations"}]}], ",", 
         RowBox[{
          RowBox[{"thetalist", "=", " ", 
           RowBox[{"thetalist", "+", 
            RowBox[{
             RowBox[{"PseudoInverse", "[", 
              RowBox[{"JacobianBody", "[", 
               RowBox[{"Blist", ",", "thetalist"}], "]"}], "]"}], ".", 
             "Vb"}]}]}], ";", 
          RowBox[{"i", "++"}], ";", 
          RowBox[{"Vb", " ", "=", " ", 
           RowBox[{"se3ToVec", "[", 
            RowBox[{"MatrixLog6", "[", 
             RowBox[{
              RowBox[{"TransInv", "[", 
               RowBox[{"FKinBody", "[", 
                RowBox[{"M", ",", "Blist", ",", "thetalist"}], "]"}], "]"}], 
              ".", "T"}], "]"}], "]"}]}], ";", 
          RowBox[{"err", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Norm", "[", 
              RowBox[{"Vb", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"1", ";;", "3"}], ",", "1"}], "]"}], "]"}], "]"}], 
             ">", "eomg"}], " ", "||", " ", 
            RowBox[{
             RowBox[{"Norm", "[", 
              RowBox[{"Vb", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"4", ";;", "6"}], ",", "1"}], "]"}], "]"}], "]"}], 
             ">", "ev"}]}]}]}]}], "]"}], ";", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"thetalist", ",", " ", 
          RowBox[{"!", "err"}]}], "}"}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654107438701495*^9, 3.6541075770931664`*^9}, {
   3.6541076103152647`*^9, 3.654107726674172*^9}, {3.654107800327899*^9, 
   3.654107805926005*^9}, {3.654107842157054*^9, 3.654107956534466*^9}, {
   3.6541080276373253`*^9, 3.654108039845397*^9}, {3.654108208328875*^9, 
   3.654108267778264*^9}, {3.654108316603101*^9, 3.65410832858707*^9}, {
   3.654122072990996*^9, 3.654122200142358*^9}, {3.654122232524707*^9, 
   3.6541222637488813`*^9}, {3.654122372486209*^9, 3.65412253592478*^9}, {
   3.654122571686759*^9, 3.654122685636675*^9}, {3.654122740902017*^9, 
   3.6541228215630703`*^9}, {3.654122865671712*^9, 3.654122935620612*^9}, {
   3.654123032181581*^9, 3.6541230914473333`*^9}, {3.654123152783122*^9, 
   3.6541232043612537`*^9}, {3.654123304611115*^9, 3.654123341073502*^9}, {
   3.654123502235703*^9, 3.654123578362132*^9}, {3.654123664279245*^9, 
   3.654123683195951*^9}, {3.6541237878998413`*^9, 3.6541238249788847`*^9}, {
   3.654123940392714*^9, 3.654123947510108*^9}, {3.654124026309593*^9, 
   3.654124026885428*^9}, 3.6541241152729683`*^9, 3.654124170343902*^9, {
   3.6541246995439568`*^9, 3.654124712871656*^9}, {3.6541251843297157`*^9, 
   3.654125231518578*^9}, {3.6541254856851683`*^9, 3.65412548908077*^9}, {
   3.654125547742125*^9, 3.654125551165526*^9}, {3.654125930807577*^9, 
   3.654126007244483*^9}, {3.654126127665163*^9, 3.654126191634789*^9}, {
   3.654126236482831*^9, 3.654126250153975*^9}, {3.6541262848658533`*^9, 
   3.654126288991514*^9}, {3.654126323055903*^9, 3.654126399729628*^9}, {
   3.654126435349374*^9, 3.654126447266036*^9}, {3.654126530077552*^9, 
   3.6541265937421*^9}, {3.654126679867402*^9, 3.6541267650289497`*^9}, {
   3.6541267969631968`*^9, 3.654126798410089*^9}, {3.654126829860013*^9, 
   3.654126881359337*^9}, {3.6541269393824577`*^9, 3.654126959132009*^9}, {
   3.654127079773924*^9, 3.654127194954756*^9}, {3.654127229244482*^9, 
   3.654127253953713*^9}, {3.6541278694900227`*^9, 3.654127878663176*^9}, {
   3.654127969775614*^9, 3.6541279938293123`*^9}, {3.654128051763153*^9, 
   3.654128134016169*^9}, {3.654128326830834*^9, 3.654128326972948*^9}, {
   3.654182305132535*^9, 3.654182317491791*^9}, {3.65418238746202*^9, 
   3.654182511491269*^9}, {3.654182551115921*^9, 3.654182559209998*^9}, {
   3.6541826265390177`*^9, 3.654182732425318*^9}, {3.654182795218339*^9, 
   3.654182802306821*^9}, {3.654182858360195*^9, 3.654182976637673*^9}, {
   3.65418309291822*^9, 3.6541831115452337`*^9}, {3.654183280620055*^9, 
   3.654183381285778*^9}, {3.6541834216733217`*^9, 3.65418343026462*^9}, {
   3.65418347398075*^9, 3.654183479016459*^9}, {3.654183517743698*^9, 
   3.654183590244978*^9}, {3.654183629340012*^9, 3.654183659551435*^9}, {
   3.654183828746057*^9, 3.654183869187777*^9}, {3.654183918271063*^9, 
   3.6541839184304667`*^9}, {3.654206461375032*^9, 3.6542064948942213`*^9}, {
   3.6542065261576433`*^9, 3.654206710642645*^9}, {3.65420685898112*^9, 
   3.654206859498214*^9}, {3.654206912388175*^9, 3.6542069199221067`*^9}, {
   3.654206956850091*^9, 3.654206957769821*^9}, {3.6542070885864773`*^9, 
   3.6542070905801163`*^9}, {3.6542071861274023`*^9, 3.654207197287834*^9}, {
   3.654207355631957*^9, 3.65420737546005*^9}, {3.654207422116619*^9, 
   3.6542074295958633`*^9}, {3.654207513008601*^9, 3.654207622631179*^9}, {
   3.6542077902321663`*^9, 3.6542079082040863`*^9}, {3.654208112675095*^9, 
   3.6542082406765347`*^9}, {3.654208390436673*^9, 3.654208437282127*^9}, {
   3.654208729398788*^9, 3.6542088242969923`*^9}, {3.654208875181876*^9, 
   3.6542089105814543`*^9}, {3.654209036563011*^9, 3.654209042056604*^9}, {
   3.654209131808134*^9, 3.654209211748107*^9}, {3.654277910558556*^9, 
   3.654277962902483*^9}, {3.6542785554956903`*^9, 3.654278555764879*^9}, {
   3.6542801407928543`*^9, 3.654280145647377*^9}, {3.654280336511973*^9, 
   3.654280388661951*^9}, {3.654735519742467*^9, 3.654735526212496*^9}, {
   3.654736711632904*^9, 3.654736744359725*^9}, {3.654736840726715*^9, 
   3.6547369027091503`*^9}, {3.6547369619155817`*^9, 3.65473711893006*^9}, 
   3.654737215212165*^9, {3.6547372623430433`*^9, 3.654737301717353*^9}, {
   3.654737434898181*^9, 3.654737445769989*^9}, {3.654737593349925*^9, 
   3.654737893647337*^9}, {3.654737938282483*^9, 3.654737939560112*^9}, {
   3.654737995469615*^9, 3.65473804382544*^9}, {3.65473814244207*^9, 
   3.65473826286047*^9}, {3.654738473301898*^9, 3.654738519313912*^9}, {
   3.654738551955141*^9, 3.654738559351729*^9}, {3.654738599129403*^9, 
   3.654738599566987*^9}, {3.654738653005966*^9, 3.654738704434928*^9}, {
   3.654738885183668*^9, 3.654738922018218*^9}, {3.654739011880048*^9, 
   3.65473910917871*^9}, {3.654739159170903*^9, 3.654739162120161*^9}, {
   3.6547393230277576`*^9, 3.6547393764227123`*^9}, {3.654739415181912*^9, 
   3.65473942023728*^9}, {3.654739453135948*^9, 3.654739679965816*^9}, {
   3.654739718627033*^9, 3.6547397334487553`*^9}, {3.654739765385715*^9, 
   3.654739851694334*^9}, {3.654739889466123*^9, 3.654740005071364*^9}, {
   3.6547400491757*^9, 3.654740154008595*^9}, 3.654740216700787*^9, {
   3.654740314399178*^9, 3.6547403286014967`*^9}, 3.6547403850818996`*^9, {
   3.654740521314966*^9, 3.654740541208376*^9}, {3.65474063388687*^9, 
   3.654740654515286*^9}, {3.654740701345427*^9, 3.654740810460566*^9}, {
   3.654740848239312*^9, 3.654741082783293*^9}, {3.654741274225429*^9, 
   3.65474127713437*^9}, 3.654741426789631*^9, {3.6547414571147537`*^9, 
   3.654741569824174*^9}, {3.654741604551594*^9, 3.65474161887015*^9}, {
   3.6547416933496304`*^9, 3.654741709459137*^9}, {3.654741935230948*^9, 
   3.654741945307493*^9}, {3.6547830386167917`*^9, 3.654783105454197*^9}, {
   3.6547832406606083`*^9, 3.6547832525310373`*^9}, {3.654783794511154*^9, 
   3.654783837663447*^9}, {3.65478390359721*^9, 3.654783909803577*^9}, {
   3.654783989474423*^9, 3.654784403124803*^9}, {3.654784520313846*^9, 
   3.654784622329711*^9}, {3.6547847231449842`*^9, 3.654784727983326*^9}, {
   3.654785122876478*^9, 3.654785187751635*^9}, {3.654785255283667*^9, 
   3.654785472044736*^9}, {3.654785554330287*^9, 3.6547855634367*^9}, {
   3.6547858133842907`*^9, 3.654785842420493*^9}, {3.654785988696732*^9, 
   3.654785999313698*^9}, {3.654786083383224*^9, 3.654786083827299*^9}, {
   3.654799998454865*^9, 3.654800009014682*^9}, 3.654800058896707*^9, {
   3.6548001027328*^9, 3.654800173381201*^9}, {3.654800206111162*^9, 
   3.654800346038969*^9}, {3.654800415767541*^9, 3.654800685527397*^9}, {
   3.654800717895743*^9, 3.6548007259529123`*^9}, {3.6548007560240192`*^9, 
   3.654800892868227*^9}, {3.654800961067473*^9, 3.6548010443125353`*^9}, {
   3.654801144205307*^9, 3.6548013970409203`*^9}, {3.654801447723054*^9, 
   3.6548014700938597`*^9}, {3.654801562889327*^9, 3.6548017505389137`*^9}, {
   3.6548017965315866`*^9, 3.654801838591158*^9}, {3.654801925163512*^9, 
   3.654801957336872*^9}, {3.654802037838778*^9, 3.654802097667626*^9}, {
   3.6548021338675137`*^9, 3.654802151746142*^9}, {3.6548021938035927`*^9, 
   3.65480226557542*^9}, {3.6548023434469347`*^9, 3.6548024564595747`*^9}, {
   3.654802493167995*^9, 3.654802498462143*^9}, {3.654802632969117*^9, 
   3.654802636326886*^9}, {3.6548026864101667`*^9, 3.6548027624957323`*^9}, {
   3.654802812209731*^9, 3.6548030159498*^9}, {3.6548066359524317`*^9, 
   3.654806720935005*^9}, {3.654806751992766*^9, 3.6548067587144833`*^9}, {
   3.654806821497799*^9, 3.654806889382121*^9}, {3.654807006283039*^9, 
   3.654807210369132*^9}, {3.654807340425975*^9, 3.6548074184588003`*^9}, {
   3.6548074913193197`*^9, 3.654807699931301*^9}, 3.6548078200861998`*^9, {
   3.654807890939335*^9, 3.65480791502777*^9}, {3.654807960842239*^9, 
   3.6548080712336483`*^9}, {3.654808128338978*^9, 3.6548081799548407`*^9}, {
   3.6548101758929577`*^9, 3.654810330104765*^9}, {3.654810401423953*^9, 
   3.654810408457419*^9}, {3.6548104718702717`*^9, 3.6548106690676603`*^9}, {
   3.6548107121438303`*^9, 3.6548108463298893`*^9}, {3.654810878513033*^9, 
   3.6548109250220337`*^9}, {3.654810973064028*^9, 3.6548109963255377`*^9}, {
   3.654811065383171*^9, 3.65481111435124*^9}, {3.6548111568410273`*^9, 
   3.654811165569319*^9}, {3.654811202562601*^9, 3.654811649746052*^9}, {
   3.657067656153129*^9, 3.657067660941557*^9}, {3.6570766750689*^9, 
   3.657076677028944*^9}, {3.658274451899232*^9, 3.6582744912918463`*^9}, {
   3.6583703518545094`*^9, 3.65837035300604*^9}, {3.675682824450754*^9, 
   3.6756828836706333`*^9}, {3.6756829858535852`*^9, 3.675683093476144*^9}, {
   3.675683163431617*^9, 3.675683301926485*^9}, {3.6756834458193197`*^9, 
   3.675683520674423*^9}, {3.675683569012762*^9, 3.675683584065415*^9}, 
   3.675683635500771*^9, {3.675684508273862*^9, 3.675684520687911*^9}, {
   3.675764977565001*^9, 3.675764979617189*^9}, {3.6757662451157312`*^9, 
   3.675766254498831*^9}, {3.675766317871736*^9, 3.675766345394107*^9}, {
   3.6757664078898573`*^9, 3.675766419041957*^9}, {3.6757665260531073`*^9, 
   3.6757665599652433`*^9}, {3.675766688881428*^9, 3.675766693414764*^9}, {
   3.675766760364307*^9, 3.675766898736827*^9}, {3.675766931380547*^9, 
   3.675766932915333*^9}, 3.675767022524777*^9, 3.675767053903921*^9, {
   3.675767094663486*^9, 3.675767157353602*^9}, {3.6757672038039017`*^9, 
   3.67576720815028*^9}, {3.675767263478516*^9, 3.675767302851701*^9}, {
   3.6757673469407463`*^9, 3.6757675158730087`*^9}, {3.675767609117689*^9, 
   3.6757676149377613`*^9}, 3.676110621848937*^9, {3.676110673192341*^9, 
   3.676110708132433*^9}, {3.676110758266004*^9, 3.676110779724792*^9}, {
   3.676110837502541*^9, 3.676110924302658*^9}, {3.676111015370205*^9, 
   3.676111023652515*^9}, {3.676111616884136*^9, 3.676111619101164*^9}, {
   3.67611165132108*^9, 3.67611182175666*^9}, 3.6761124388093357`*^9, {
   3.6761125310577183`*^9, 3.676112535417371*^9}, {3.67611278534865*^9, 
   3.676112852293083*^9}, {3.6761129469420633`*^9, 3.6761129566090517`*^9}, {
   3.6761133261675377`*^9, 3.6761133851728067`*^9}, {3.6761134570078707`*^9, 
   3.6761134886549597`*^9}, {3.676113519585043*^9, 3.676113581404831*^9}, {
   3.676113994051722*^9, 3.6761140495138607`*^9}, {3.67611471759483*^9, 
   3.676114727326268*^9}, {3.676114788083909*^9, 3.676114788267289*^9}, {
   3.67611493328951*^9, 3.6761149644016867`*^9}, {3.6761149993051443`*^9, 
   3.676115038096011*^9}, {3.676115419194528*^9, 3.676115484935451*^9}, {
   3.6761155900865583`*^9, 3.676115605985518*^9}, {3.676115760093829*^9, 
   3.676115778909306*^9}, {3.676115982499289*^9, 3.676116037133542*^9}, {
   3.6761161990700502`*^9, 3.676116233908482*^9}, {3.676116286507206*^9, 
   3.676116286712512*^9}, {3.67611639463448*^9, 3.676116464258135*^9}, {
   3.6761165873897543`*^9, 3.676116602580727*^9}, {3.6761174556753473`*^9, 
   3.67611745672952*^9}, {3.676117506535368*^9, 3.6761175229462357`*^9}, {
   3.676117600215383*^9, 3.6761176442364273`*^9}, {3.676117677849012*^9, 
   3.6761177082717953`*^9}, {3.67611812248459*^9, 3.6761181278825502`*^9}, {
   3.676118580166224*^9, 3.67611860485815*^9}, {3.676118651876894*^9, 
   3.6761187537386017`*^9}, {3.676118838160269*^9, 3.676118838374693*^9}, {
   3.67611887610327*^9, 3.676118940213615*^9}, {3.6761191096213007`*^9, 
   3.676119140757559*^9}, {3.6761192665343122`*^9, 3.676119273783136*^9}, {
   3.67611936142714*^9, 3.676119363325075*^9}, {3.676119488561606*^9, 
   3.676119492487294*^9}, {3.6761200703687267`*^9, 3.6761200707356052`*^9}, {
   3.6761202104386873`*^9, 3.676120268289008*^9}, {3.676120410677075*^9, 
   3.676120443293746*^9}, {3.676120474583932*^9, 3.676120475526285*^9}, {
   3.6761206125852633`*^9, 3.6761206205196333`*^9}, {3.6761234586125507`*^9, 
   3.676123489461384*^9}, {3.6761235483793917`*^9, 3.676123569634534*^9}, {
   3.676124493441423*^9, 3.676124518157651*^9}, {3.676124553443336*^9, 
   3.676124582966502*^9}, {3.6761246820730133`*^9, 3.676124716437358*^9}, {
   3.67612487549886*^9, 3.676124882235661*^9}, {3.676124956893395*^9, 
   3.676124958216114*^9}, {3.6761249904362507`*^9, 3.676124994364197*^9}, {
   3.676125048497746*^9, 3.676125189073619*^9}, {3.676125219923954*^9, 
   3.6761253767254953`*^9}, {3.6761261361020412`*^9, 3.676126180304117*^9}, {
   3.6761262318219957`*^9, 3.676126312208794*^9}, {3.6761263690337877`*^9, 
   3.6761264446350737`*^9}, {3.676126475578731*^9, 3.676126485467072*^9}, {
   3.676126538828438*^9, 3.676126562090301*^9}, {3.676126633785634*^9, 
   3.6761266365895157`*^9}, 3.6761268247458773`*^9, 3.676126912241247*^9, {
   3.676126960168599*^9, 3.676126960170166*^9}, {3.676127961375718*^9, 
   3.676127975299335*^9}, {3.676128268770321*^9, 3.676128269338847*^9}, 
   3.676128811729394*^9, {3.677836754519267*^9, 3.6778367717532873`*^9}, 
   3.67809625024065*^9, 3.689380335363355*^9, {3.6893829735532513`*^9, 
   3.689383002923931*^9}, {3.691020104798397*^9, 3.6910201089496346`*^9}, {
   3.6910201777305684`*^9, 3.691020183893921*^9}, {3.691020235296861*^9, 
   3.6910202732930346`*^9}, {3.6910203243449545`*^9, 
   3.6910203267120895`*^9}, {3.691020559810422*^9, 3.6910206644754086`*^9}, {
   3.6910207871354246`*^9, 3.691020794730859*^9}, {3.6910209046111436`*^9, 
   3.6910209689858255`*^9}, {3.6910210393288493`*^9, 3.691021392074025*^9}, {
   3.691024282901371*^9, 3.691024307291766*^9}, {3.691087747352803*^9, 
   3.6910877526568127`*^9}, {3.692471869950526*^9, 3.692472081378619*^9}, 
   3.6924721337466145`*^9, {3.6924722147252464`*^9, 3.6924722761497593`*^9}, {
   3.692472394155509*^9, 3.692472397761715*^9}, {3.69310613421097*^9, 
   3.6931062576971726`*^9}, {3.693106385545392*^9, 3.693106400715414*^9}, {
   3.693153754253505*^9, 3.693153757545111*^9}, {3.693238620895026*^9, 
   3.6932386630669003`*^9}},ExpressionUUID->"2019be37-8152-4806-8505-\
1ba3f9326729"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"IKinSpace", "[", 
      RowBox[{
      "Slist_", ",", "M_", ",", "T_", ",", "thetalist0_", ",", "eomg_", ",", 
       "ev_"}], "]"}], ":", "\[IndentingNewLine]", "   ", 
     RowBox[{"Takes", " ", "Slist"}], ":", " ", 
     RowBox[{
     "The", " ", "joint", " ", "screw", " ", "axes", " ", "in", " ", "the", 
      " ", "space", " ", "frame", " ", "when", " ", "the", " ", "manipulator",
       " ", "is", " ", "at", " ", "the", " ", "home", " ", "position"}]}], 
    ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"M", ":", " ", 
     RowBox[{
      RowBox[{
      "The", " ", "home", " ", "configuration", " ", "of", " ", "the", " ", 
       "end"}], "-", "effector"}]}], ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"T", ":", " ", 
     RowBox[{
      RowBox[{"The", " ", "desired", " ", "end"}], "-", 
      RowBox[{"effector", " ", "configuration", " ", "T"}]}]}], ",", "\n", 
    "          ", 
    RowBox[{"thetalist0", ":", " ", 
     RowBox[{
     "An", " ", "initial", " ", "guess", " ", "of", " ", "joint", " ", 
      "angles", " ", "that", " ", "are", " ", "close", " ", "to", " ", 
      "satisfying", " ", "T"}]}], ",", "\n", "          ", 
    RowBox[{"eomg", ":", " ", 
     RowBox[{
      RowBox[{
      "A", " ", "small", " ", "positive", " ", "tolerance", " ", "on", " ", 
       "the", " ", "end"}], "-", 
      RowBox[{"effector", " ", "orientation", " ", 
       RowBox[{"error", ".", " ", "The"}], " ", "returned", " ", "joint", " ",
        "angles", " ", "must", " ", "give", " ", "an", " ", "end"}], "-", 
      RowBox[{
      "effector", " ", "orientation", " ", "error", " ", "less", " ", "than", 
       " ", "eomg"}]}]}], ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"ev", ":", " ", 
     RowBox[{
      RowBox[{
      "A", " ", "small", " ", "positive", " ", "tolerance", " ", "on", " ", 
       "the", " ", "end"}], "-", 
      RowBox[{"effector", " ", "linear", " ", "position", " ", 
       RowBox[{"error", ".", " ", "The"}], " ", "returned", " ", "joint", " ",
        "angles", " ", "must", " ", "give", " ", "an", " ", "end"}], "-", 
      RowBox[{
      "effector", " ", "position", " ", "error", " ", "less", " ", "than", 
       " ", 
       RowBox[{"ev", ".", "\[IndentingNewLine]", "Returns"}], " ", 
       "thetalist"}]}], ":", " ", 
     RowBox[{
     "Joint", " ", "angles", " ", "that", " ", "achieve", " ", "T", " ", 
      "within", " ", "the", " ", "specified", " ", "tolerances"}]}], ",", " ",
     "\[IndentingNewLine]", 
    RowBox[{"success", ":", 
     RowBox[{
      RowBox[{
      "A", " ", "logical", " ", "value", " ", "where", " ", "True", " ", 
       "means", " ", "that", " ", "the", " ", "function", " ", "found", " ", 
       "a", " ", "solution", " ", "and", " ", "False", " ", "means", " ", 
       "that", " ", "it", " ", "ran", " ", "through", " ", "the", " ", "set", 
       " ", "number", " ", "of", " ", "maximum", " ", "iterations", " ", 
       "without", " ", "finding", " ", "a", " ", "solution", " ", "within", 
       " ", "the", " ", "tolerances", " ", "eomg", " ", "and", " ", 
       RowBox[{"ev", ".", "\[IndentingNewLine]", "Uses"}], " ", "an", " ", 
       "iterative", " ", "Newton"}], "-", 
      RowBox[{"Raphson", " ", "root"}], "-", 
      RowBox[{"finding", " ", 
       RowBox[{"method", ".", "\[IndentingNewLine]", "The"}], " ", "maximum", 
       " ", "number", " ", "of", " ", "iterations", " ", "before", " ", "the",
        " ", "algorithm", " ", "is", " ", "terminated", " ", "has", " ", 
       "been", " ", "hardcoded", " ", "in", " ", "as", " ", "a", " ", 
       "variable", " ", "called", " ", 
       RowBox[{"maxiterations", ".", "It"}], " ", "is", " ", "set", " ", "to",
        " ", "20", " ", "at", " ", "the", " ", "start", " ", "of", " ", "the",
        " ", "function"}]}]}], ",", 
    RowBox[{
     RowBox[{"but", " ", "can", " ", "be", " ", "changed", " ", "if", " ", 
      RowBox[{"needed", "."}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Exapmle", ":", "\[IndentingNewLine]", "Input", ":", 
       "\[IndentingNewLine]", "Slist"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1", ",", "4", ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "6"}], ",", "0", ",", 
           RowBox[{"-", "0.1"}]}], "}"}]}], "}"}], "\[Transpose]"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "6"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"-", "1"}], ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"T", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", 
          RowBox[{"-", "5"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"-", "1"}], ",", "1.6858"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"thetalist0", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"1.5", ",", "2.5", ",", "3"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"eomg", "=", "0.01"}], ";", "\n", "  ", 
     RowBox[{"ev", "=", "0.001"}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"thetalist", ",", "success"}], "}"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"IKinSpace", "[", 
        RowBox[{
        "Slist", ",", "M", ",", "T", ",", "thetalist0", ",", "eomg", ",", 
         "ev"}], "]"}], "\[IndentingNewLine]", 
       RowBox[{"Ouput", ":", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "1.5707378450946832", "}"}], ",", 
            RowBox[{"{", "2.9996640511341215", "}"}], ",", 
            RowBox[{"{", "3.1415412500167736", "}"}]}], "}"}], ",", "True"}], 
         "}"}]}]}]}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"IKinSpace", "[", 
     RowBox[{
     "Slist_", ",", "M_", ",", "T_", ",", "thetalist0_", ",", "eomg_", ",", 
      "ev_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Tsb", ",", "Vs", ",", 
        RowBox[{"thetalist", "=", "thetalist0"}], ",", "err", ",", 
        RowBox[{"i", "=", "0"}], ",", 
        RowBox[{"maxiterations", " ", "=", " ", "20"}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"Tsb", "=", 
        RowBox[{"FKinSpace", "[", 
         RowBox[{"M", ",", "Slist", ",", "thetalist"}], "]"}]}], ";", 
       RowBox[{"Vs", " ", "=", " ", 
        RowBox[{
         RowBox[{"Adjoint", "[", "Tsb", "]"}], ".", 
         RowBox[{"se3ToVec", "[", 
          RowBox[{"MatrixLog6", "[", 
           RowBox[{
            RowBox[{"TransInv", "[", "Tsb", "]"}], ".", "T"}], "]"}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"err", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Norm", "[", 
           RowBox[{"Vs", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"1", ";;", "3"}], ",", "1"}], "]"}], "]"}], "]"}], ">", 
          "eomg"}], " ", "||", " ", 
         RowBox[{
          RowBox[{"Norm", "[", 
           RowBox[{"Vs", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"4", ";;", "6"}], ",", "1"}], "]"}], "]"}], "]"}], ">", 
          "ev"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"err", " ", "&&", 
          RowBox[{"i", " ", "<", " ", "maxiterations"}]}], ",", 
         RowBox[{
          RowBox[{"thetalist", "=", " ", 
           RowBox[{"thetalist", "+", 
            RowBox[{
             RowBox[{"PseudoInverse", "[", 
              RowBox[{"JacobianSpace", "[", 
               RowBox[{"Slist", ",", "thetalist"}], "]"}], "]"}], ".", 
             "Vs"}]}]}], ";", 
          RowBox[{"i", "++"}], ";", 
          RowBox[{"Tsb", "=", 
           RowBox[{"FKinSpace", "[", 
            RowBox[{"M", ",", "Slist", ",", "thetalist"}], "]"}]}], ";", 
          RowBox[{"Vs", " ", "=", " ", 
           RowBox[{
            RowBox[{"Adjoint", "[", "Tsb", "]"}], ".", 
            RowBox[{"se3ToVec", "[", 
             RowBox[{"MatrixLog6", "[", 
              RowBox[{
               RowBox[{"TransInv", "[", "Tsb", "]"}], ".", "T"}], "]"}], 
             "]"}]}]}], ";", 
          RowBox[{"err", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Norm", "[", 
              RowBox[{"Vs", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"1", ";;", "3"}], ",", "1"}], "]"}], "]"}], "]"}], 
             ">", "eomg"}], " ", "||", " ", 
            RowBox[{
             RowBox[{"Norm", "[", 
              RowBox[{"Vs", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"4", ";;", "6"}], ",", "1"}], "]"}], "]"}], "]"}], 
             ">", "ev"}]}]}]}]}], "]"}], ";", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"thetalist", ",", " ", 
          RowBox[{"!", "err"}]}], "}"}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654107438701495*^9, 3.6541075770931664`*^9}, {
   3.6541076103152647`*^9, 3.654107726674172*^9}, {3.654107800327899*^9, 
   3.654107805926005*^9}, {3.654107842157054*^9, 3.654107956534466*^9}, {
   3.6541080276373253`*^9, 3.654108039845397*^9}, {3.654108208328875*^9, 
   3.654108267778264*^9}, {3.654108316603101*^9, 3.65410832858707*^9}, {
   3.654122072990996*^9, 3.654122200142358*^9}, {3.654122232524707*^9, 
   3.6541222637488813`*^9}, {3.654122372486209*^9, 3.65412253592478*^9}, {
   3.654122571686759*^9, 3.654122685636675*^9}, {3.654122740902017*^9, 
   3.6541228215630703`*^9}, {3.654122865671712*^9, 3.654122935620612*^9}, {
   3.654123032181581*^9, 3.6541230914473333`*^9}, {3.654123152783122*^9, 
   3.6541232043612537`*^9}, {3.654123304611115*^9, 3.654123341073502*^9}, {
   3.654123502235703*^9, 3.654123578362132*^9}, {3.654123664279245*^9, 
   3.654123683195951*^9}, {3.6541237878998413`*^9, 3.6541238249788847`*^9}, {
   3.654123940392714*^9, 3.654123947510108*^9}, {3.654124026309593*^9, 
   3.654124026885428*^9}, 3.6541241152729683`*^9, 3.654124170343902*^9, {
   3.6541246995439568`*^9, 3.654124712871656*^9}, {3.6541251843297157`*^9, 
   3.654125231518578*^9}, {3.6541254856851683`*^9, 3.65412548908077*^9}, {
   3.654125547742125*^9, 3.654125551165526*^9}, {3.654125930807577*^9, 
   3.654126007244483*^9}, {3.654126127665163*^9, 3.654126191634789*^9}, {
   3.654126236482831*^9, 3.654126250153975*^9}, {3.6541262848658533`*^9, 
   3.654126288991514*^9}, {3.654126323055903*^9, 3.654126399729628*^9}, {
   3.654126435349374*^9, 3.654126447266036*^9}, {3.654126530077552*^9, 
   3.6541265937421*^9}, {3.654126679867402*^9, 3.6541267650289497`*^9}, {
   3.6541267969631968`*^9, 3.654126798410089*^9}, {3.654126829860013*^9, 
   3.654126881359337*^9}, {3.6541269393824577`*^9, 3.654126959132009*^9}, {
   3.654127079773924*^9, 3.654127194954756*^9}, {3.654127229244482*^9, 
   3.654127253953713*^9}, {3.6541278694900227`*^9, 3.654127878663176*^9}, {
   3.654127969775614*^9, 3.6541279938293123`*^9}, {3.654128051763153*^9, 
   3.654128134016169*^9}, {3.654128326830834*^9, 3.654128326972948*^9}, {
   3.654182305132535*^9, 3.654182317491791*^9}, {3.65418238746202*^9, 
   3.654182511491269*^9}, {3.654182551115921*^9, 3.654182559209998*^9}, {
   3.6541826265390177`*^9, 3.654182732425318*^9}, {3.654182795218339*^9, 
   3.654182802306821*^9}, {3.654182858360195*^9, 3.654182976637673*^9}, {
   3.65418309291822*^9, 3.6541831115452337`*^9}, {3.654183280620055*^9, 
   3.654183381285778*^9}, {3.6541834216733217`*^9, 3.65418343026462*^9}, {
   3.65418347398075*^9, 3.654183479016459*^9}, {3.654183517743698*^9, 
   3.654183590244978*^9}, {3.654183629340012*^9, 3.654183659551435*^9}, {
   3.654183828746057*^9, 3.654183869187777*^9}, {3.654183918271063*^9, 
   3.6541839184304667`*^9}, {3.654206461375032*^9, 3.6542064948942213`*^9}, {
   3.6542065261576433`*^9, 3.654206710642645*^9}, {3.65420685898112*^9, 
   3.654206859498214*^9}, {3.654206912388175*^9, 3.6542069199221067`*^9}, {
   3.654206956850091*^9, 3.654206957769821*^9}, {3.6542070885864773`*^9, 
   3.6542070905801163`*^9}, {3.6542071861274023`*^9, 3.654207197287834*^9}, {
   3.654207355631957*^9, 3.65420737546005*^9}, {3.654207422116619*^9, 
   3.6542074295958633`*^9}, {3.654207513008601*^9, 3.654207622631179*^9}, {
   3.6542077902321663`*^9, 3.6542079082040863`*^9}, {3.654208112675095*^9, 
   3.6542082406765347`*^9}, {3.654208390436673*^9, 3.654208437282127*^9}, {
   3.654208729398788*^9, 3.6542088242969923`*^9}, {3.654208875181876*^9, 
   3.6542089105814543`*^9}, {3.654209036563011*^9, 3.654209042056604*^9}, {
   3.654209131808134*^9, 3.654209211748107*^9}, {3.654277910558556*^9, 
   3.654277962902483*^9}, {3.6542785554956903`*^9, 3.654278555764879*^9}, {
   3.6542801407928543`*^9, 3.654280145647377*^9}, {3.654280336511973*^9, 
   3.654280388661951*^9}, {3.654735519742467*^9, 3.654735526212496*^9}, {
   3.654736711632904*^9, 3.654736744359725*^9}, {3.654736840726715*^9, 
   3.6547369027091503`*^9}, {3.6547369619155817`*^9, 3.65473711893006*^9}, 
   3.654737215212165*^9, {3.6547372623430433`*^9, 3.654737301717353*^9}, {
   3.654737434898181*^9, 3.654737445769989*^9}, {3.654737593349925*^9, 
   3.654737893647337*^9}, {3.654737938282483*^9, 3.654737939560112*^9}, {
   3.654737995469615*^9, 3.65473804382544*^9}, {3.65473814244207*^9, 
   3.65473826286047*^9}, {3.654738473301898*^9, 3.654738519313912*^9}, {
   3.654738551955141*^9, 3.654738559351729*^9}, {3.654738599129403*^9, 
   3.654738599566987*^9}, {3.654738653005966*^9, 3.654738704434928*^9}, {
   3.654738885183668*^9, 3.654738922018218*^9}, {3.654739011880048*^9, 
   3.65473910917871*^9}, {3.654739159170903*^9, 3.654739162120161*^9}, {
   3.6547393230277576`*^9, 3.6547393764227123`*^9}, {3.654739415181912*^9, 
   3.65473942023728*^9}, {3.654739453135948*^9, 3.654739679965816*^9}, {
   3.654739718627033*^9, 3.6547397334487553`*^9}, {3.654739765385715*^9, 
   3.654739851694334*^9}, {3.654739889466123*^9, 3.654740005071364*^9}, {
   3.6547400491757*^9, 3.654740154008595*^9}, 3.654740216700787*^9, {
   3.654740314399178*^9, 3.6547403286014967`*^9}, 3.6547403850818996`*^9, {
   3.654740521314966*^9, 3.654740541208376*^9}, {3.65474063388687*^9, 
   3.654740654515286*^9}, {3.654740701345427*^9, 3.654740810460566*^9}, {
   3.654740848239312*^9, 3.654741082783293*^9}, {3.654741274225429*^9, 
   3.65474127713437*^9}, 3.654741426789631*^9, {3.6547414571147537`*^9, 
   3.654741569824174*^9}, {3.654741604551594*^9, 3.65474161887015*^9}, {
   3.6547416933496304`*^9, 3.654741709459137*^9}, {3.654741935230948*^9, 
   3.654741945307493*^9}, {3.6547830386167917`*^9, 3.654783105454197*^9}, {
   3.6547832406606083`*^9, 3.6547832525310373`*^9}, {3.654783794511154*^9, 
   3.654783837663447*^9}, {3.65478390359721*^9, 3.654783909803577*^9}, {
   3.654783989474423*^9, 3.654784403124803*^9}, {3.654784520313846*^9, 
   3.654784622329711*^9}, {3.6547847231449842`*^9, 3.654784727983326*^9}, {
   3.654785122876478*^9, 3.654785187751635*^9}, {3.654785255283667*^9, 
   3.654785472044736*^9}, {3.654785554330287*^9, 3.6547855634367*^9}, {
   3.6547858133842907`*^9, 3.654785842420493*^9}, {3.654785988696732*^9, 
   3.654785999313698*^9}, {3.654786083383224*^9, 3.654786083827299*^9}, {
   3.654799998454865*^9, 3.654800009014682*^9}, 3.654800058896707*^9, {
   3.6548001027328*^9, 3.654800173381201*^9}, {3.654800206111162*^9, 
   3.654800346038969*^9}, {3.654800415767541*^9, 3.654800685527397*^9}, {
   3.654800717895743*^9, 3.6548007259529123`*^9}, {3.6548007560240192`*^9, 
   3.654800892868227*^9}, {3.654800961067473*^9, 3.6548010443125353`*^9}, {
   3.654801144205307*^9, 3.6548013970409203`*^9}, {3.654801447723054*^9, 
   3.6548014700938597`*^9}, {3.654801562889327*^9, 3.6548017505389137`*^9}, {
   3.6548017965315866`*^9, 3.654801838591158*^9}, {3.654801925163512*^9, 
   3.654801957336872*^9}, {3.654802037838778*^9, 3.654802097667626*^9}, {
   3.6548021338675137`*^9, 3.654802151746142*^9}, {3.6548021938035927`*^9, 
   3.65480226557542*^9}, {3.6548023434469347`*^9, 3.6548024564595747`*^9}, {
   3.654802493167995*^9, 3.654802498462143*^9}, {3.654802632969117*^9, 
   3.654802636326886*^9}, {3.6548026864101667`*^9, 3.6548027624957323`*^9}, {
   3.654802812209731*^9, 3.6548030159498*^9}, {3.6548066359524317`*^9, 
   3.654806720935005*^9}, {3.654806751992766*^9, 3.6548067587144833`*^9}, {
   3.654806821497799*^9, 3.654806889382121*^9}, {3.654807006283039*^9, 
   3.654807210369132*^9}, {3.654807340425975*^9, 3.6548074184588003`*^9}, {
   3.6548074913193197`*^9, 3.654807699931301*^9}, 3.6548078200861998`*^9, {
   3.654807890939335*^9, 3.65480791502777*^9}, {3.654807960842239*^9, 
   3.6548080712336483`*^9}, {3.654808128338978*^9, 3.6548081799548407`*^9}, {
   3.6548101758929577`*^9, 3.654810330104765*^9}, {3.654810401423953*^9, 
   3.654810408457419*^9}, {3.6548104718702717`*^9, 3.6548106690676603`*^9}, {
   3.6548107121438303`*^9, 3.6548108463298893`*^9}, {3.654810878513033*^9, 
   3.6548109250220337`*^9}, {3.654810973064028*^9, 3.6548109963255377`*^9}, {
   3.654811065383171*^9, 3.65481111435124*^9}, {3.6548111568410273`*^9, 
   3.654811165569319*^9}, {3.654811202562601*^9, 3.654811649746052*^9}, {
   3.657067656153129*^9, 3.657067660941557*^9}, {3.6570766750689*^9, 
   3.657076677028944*^9}, {3.658274451899232*^9, 3.6582744912918463`*^9}, {
   3.6583703518545094`*^9, 3.65837035300604*^9}, {3.675682824450754*^9, 
   3.6756828836706333`*^9}, {3.6756829858535852`*^9, 3.675683093476144*^9}, {
   3.675683163431617*^9, 3.675683301926485*^9}, {3.6756834458193197`*^9, 
   3.675683520674423*^9}, {3.675683569012762*^9, 3.675683584065415*^9}, 
   3.675683635500771*^9, {3.675684508273862*^9, 3.675684520687911*^9}, {
   3.675764977565001*^9, 3.675764979617189*^9}, {3.6757662451157312`*^9, 
   3.675766254498831*^9}, {3.675766317871736*^9, 3.675766345394107*^9}, {
   3.6757664078898573`*^9, 3.675766419041957*^9}, {3.6757665260531073`*^9, 
   3.6757665599652433`*^9}, {3.675766688881428*^9, 3.675766693414764*^9}, {
   3.675766760364307*^9, 3.675766898736827*^9}, {3.675766931380547*^9, 
   3.675766932915333*^9}, 3.675767022524777*^9, 3.675767053903921*^9, {
   3.675767094663486*^9, 3.675767157353602*^9}, {3.6757672038039017`*^9, 
   3.67576720815028*^9}, {3.675767263478516*^9, 3.675767302851701*^9}, {
   3.6757673469407463`*^9, 3.6757675158730087`*^9}, {3.675767609117689*^9, 
   3.6757676149377613`*^9}, 3.676110621848937*^9, {3.676110673192341*^9, 
   3.676110708132433*^9}, {3.676110758266004*^9, 3.676110779724792*^9}, {
   3.676110837502541*^9, 3.676110924302658*^9}, {3.676111015370205*^9, 
   3.676111023652515*^9}, {3.676111616884136*^9, 3.676111619101164*^9}, {
   3.67611165132108*^9, 3.67611182175666*^9}, 3.6761124388093357`*^9, {
   3.6761125310577183`*^9, 3.676112535417371*^9}, {3.67611278534865*^9, 
   3.676112852293083*^9}, {3.6761129469420633`*^9, 3.6761129566090517`*^9}, {
   3.6761133261675377`*^9, 3.6761133851728067`*^9}, {3.6761134570078707`*^9, 
   3.6761134886549597`*^9}, {3.676113519585043*^9, 3.676113581404831*^9}, {
   3.676113994051722*^9, 3.6761140495138607`*^9}, {3.67611471759483*^9, 
   3.676114727326268*^9}, {3.676114788083909*^9, 3.676114788267289*^9}, {
   3.67611493328951*^9, 3.6761149644016867`*^9}, {3.6761149993051443`*^9, 
   3.676115038096011*^9}, {3.676115419194528*^9, 3.676115484935451*^9}, {
   3.6761155900865583`*^9, 3.676115605985518*^9}, {3.676115760093829*^9, 
   3.676115778909306*^9}, {3.676115982499289*^9, 3.676116037133542*^9}, {
   3.6761161990700502`*^9, 3.676116233908482*^9}, {3.676116286507206*^9, 
   3.676116286712512*^9}, {3.67611639463448*^9, 3.676116464258135*^9}, {
   3.6761165873897543`*^9, 3.676116602580727*^9}, {3.6761174556753473`*^9, 
   3.67611745672952*^9}, {3.676117506535368*^9, 3.6761175229462357`*^9}, {
   3.676117600215383*^9, 3.6761176442364273`*^9}, {3.676117677849012*^9, 
   3.6761177082717953`*^9}, {3.67611812248459*^9, 3.6761181278825502`*^9}, {
   3.676118580166224*^9, 3.67611860485815*^9}, {3.676118651876894*^9, 
   3.6761187537386017`*^9}, {3.676118838160269*^9, 3.676118838374693*^9}, {
   3.67611887610327*^9, 3.676118940213615*^9}, {3.6761191096213007`*^9, 
   3.676119140757559*^9}, {3.6761192665343122`*^9, 3.676119273783136*^9}, {
   3.67611936142714*^9, 3.676119363325075*^9}, {3.676119488561606*^9, 
   3.676119492487294*^9}, {3.6761200703687267`*^9, 3.6761200707356052`*^9}, {
   3.6761202104386873`*^9, 3.676120268289008*^9}, {3.676120410677075*^9, 
   3.676120443293746*^9}, {3.676120474583932*^9, 3.676120475526285*^9}, {
   3.6761206125852633`*^9, 3.6761206205196333`*^9}, {3.6761234586125507`*^9, 
   3.676123489461384*^9}, {3.6761235483793917`*^9, 3.676123569634534*^9}, {
   3.676124493441423*^9, 3.676124518157651*^9}, {3.676124553443336*^9, 
   3.676124582966502*^9}, {3.6761246820730133`*^9, 3.676124716437358*^9}, {
   3.67612487549886*^9, 3.676124882235661*^9}, {3.676124956893395*^9, 
   3.676124958216114*^9}, {3.6761249904362507`*^9, 3.676124994364197*^9}, {
   3.676125048497746*^9, 3.676125189073619*^9}, {3.676125219923954*^9, 
   3.6761253767254953`*^9}, {3.6761261361020412`*^9, 3.676126180304117*^9}, {
   3.6761262318219957`*^9, 3.676126312208794*^9}, {3.6761263690337877`*^9, 
   3.6761264446350737`*^9}, {3.676126475578731*^9, 3.676126485467072*^9}, {
   3.676126538828438*^9, 3.676126562090301*^9}, {3.676126633785634*^9, 
   3.6761266365895157`*^9}, 3.6761269067489443`*^9, {3.676126941350791*^9, 
   3.676127003932433*^9}, {3.6761275996551237`*^9, 3.676127642283627*^9}, {
   3.6761279161285563`*^9, 3.6761279412801857`*^9}, {3.6761280105764437`*^9, 
   3.676128037774667*^9}, {3.676128092513379*^9, 3.676128127330976*^9}, 
   3.676128221290659*^9, {3.676128273312995*^9, 3.676128326326386*^9}, {
   3.676129382956367*^9, 3.676129408886795*^9}, {3.676129456274128*^9, 
   3.6761295004906263`*^9}, {3.676129547547868*^9, 3.676129590188859*^9}, 
   3.677237481686187*^9, {3.6772375151100492`*^9, 3.677237518364565*^9}, {
   3.677489743906653*^9, 3.677489745104307*^9}, {3.6774903277274837`*^9, 
   3.6774903278784943`*^9}, {3.677836773282992*^9, 3.677836780209435*^9}, 
   3.678096258635654*^9, 3.6890433458033247`*^9, {3.6890434053454146`*^9, 
   3.6890434199284363`*^9}, {3.6890434611274986`*^9, 
   3.6890434997985554`*^9}, {3.689112213714801*^9, 3.6891122722758837`*^9}, {
   3.6891123040729294`*^9, 3.6891123604780345`*^9}, 3.689380295105053*^9, {
   3.6893828628119173`*^9, 3.6893829526540556`*^9}, {3.6910240135629654`*^9, 
   3.6910241507148104`*^9}, {3.6910241972084694`*^9, 3.691024272485775*^9}, {
   3.6924722961669044`*^9, 3.6924724469235272`*^9}, {3.69310628166721*^9, 
   3.693106472273528*^9}, {3.6931538659809017`*^9, 3.693153874670117*^9}, {
   3.693238672584917*^9, 
   3.693238682509535*^9}},ExpressionUUID->"08ec95ce-ac90-49ad-8fd9-\
387f0b2a56f1"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["CHAPTER  8: DYNAMICS OF OPEN CHAINS",
 FontSize->24,
 FontWeight->"Bold",
 FontColor->RGBColor[0, 0, 1]]], "Title",
 CellChangeTimes->{{3.6755319110417843`*^9, 3.675531927048277*^9}, {
  3.675531958735077*^9, 3.67553201284205*^9}, {3.675607857109823*^9, 
  3.6756079117244864`*^9}, {3.6756821024917507`*^9, 3.6756821283850946`*^9}, {
  3.675777792107044*^9, 3.67577781248841*^9}, {3.676210079313513*^9, 
  3.676210092833352*^9}},ExpressionUUID->"08468a25-7661-4274-8149-\
e4e0ff06774a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ad", "[", "V_", "]"}], ":", "\[IndentingNewLine]", "   ", 
      RowBox[{
       RowBox[{"Takes", " ", "6"}], "-", 
       RowBox[{"vector", " ", "spatial", " ", 
        RowBox[{"velocity", ".", "\[IndentingNewLine]", "Returns"}], " ", 
        "the", " ", "corresponding", " ", "6", "x6", " ", 
        RowBox[{
         RowBox[{"matrix", "[", "adV", "]"}], ".", "\[IndentingNewLine]", 
         "Used"}], " ", "to", " ", "calculate", " ", "the", " ", "Lie", " ", 
        RowBox[{"bracket", "[", 
         RowBox[{"V1", ",", "V2"}], "]"}]}]}]}], "=", 
     RowBox[{
      RowBox[{"[", "adV1", "]"}], "V2"}]}], "\[IndentingNewLine]", ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Example", ":", "\[IndentingNewLine]", " ", "Input", ":", 
      "\[IndentingNewLine]", "V"}], "  ", "=", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6"}], 
        "}"}], "}"}], "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
    RowBox[{
     RowBox[{"ad", "[", "V", "]"}], "//", 
     RowBox[{"MatrixForm", "\n", 
      RowBox[{"Output", ":", "\[IndentingNewLine]", 
       TagBox[
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0", 
            RowBox[{"-", "3"}], "2", "0", "0", "0"},
           {"3", "0", 
            RowBox[{"-", "1"}], "0", "0", "0"},
           {
            RowBox[{"-", "2"}], "1", "0", "0", "0", "0"},
           {"0", 
            RowBox[{"-", "6"}], "5", "0", 
            RowBox[{"-", "3"}], "2"},
           {"6", "0", 
            RowBox[{"-", "4"}], "3", "0", 
            RowBox[{"-", "1"}]},
           {
            RowBox[{"-", "5"}], "4", "0", 
            RowBox[{"-", "2"}], "1", "0"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]]}]}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ad", "[", "V_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "w", "}"}], ",", 
      RowBox[{
       RowBox[{"w", "=", 
        RowBox[{"VecToso3", "[", 
         RowBox[{"V", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "3"}], "]"}], "]"}], "]"}]}], ";", 
       RowBox[{"Return", "[", 
        RowBox[{"ArrayFlatten", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"w", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"VecToso3", "[", 
              RowBox[{"V", "[", 
               RowBox[{"[", 
                RowBox[{"4", ";;", "6"}], "]"}], "]"}], "]"}], ",", "w"}], 
            "}"}]}], "}"}], "]"}], "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.658273872689763*^9, 3.658273988902459*^9}, {
   3.658274157743518*^9, 3.6582741742369556`*^9}, {3.65827421723704*^9, 
   3.6582742187327127`*^9}, {3.6582742677636137`*^9, 3.658274330534523*^9}, {
   3.658274365312026*^9, 3.6582744138260403`*^9}, {3.658274810942898*^9, 
   3.658274859112701*^9}, {3.658275033847995*^9, 3.658275109340135*^9}, {
   3.658275161547172*^9, 3.6582752536631193`*^9}, {3.65827533442001*^9, 
   3.658275354865328*^9}, {3.6582755590331087`*^9, 3.658275644746291*^9}, {
   3.658275839400229*^9, 3.6582758455265408`*^9}, {3.6582758973266172`*^9, 
   3.658276032713943*^9}, {3.658276065782716*^9, 3.6582762151364822`*^9}, {
   3.658276271302123*^9, 3.6582763371711683`*^9}, 3.658276384203477*^9, {
   3.658276429293391*^9, 3.658276729581854*^9}, {3.658276847155965*^9, 
   3.6582768822910967`*^9}, 3.658277078361019*^9, {3.658277454514134*^9, 
   3.65827755246841*^9}, {3.658277707616706*^9, 3.658277724793824*^9}, {
   3.658277775557291*^9, 3.658277790046358*^9}, {3.6582778408966618`*^9, 
   3.658277880321537*^9}, {3.658277965874803*^9, 3.658278001723259*^9}, {
   3.658278068864526*^9, 3.658278122465324*^9}, {3.6582782743035307`*^9, 
   3.658278463989525*^9}, {3.658278495324057*^9, 3.6582785116036882`*^9}, {
   3.6582787258401527`*^9, 3.6582787620388193`*^9}, {3.658278813660791*^9, 
   3.658278890779448*^9}, {3.658278981426128*^9, 3.6582789851507807`*^9}, {
   3.658279023852993*^9, 3.658279071286935*^9}, {3.6582792891814613`*^9, 
   3.6582793220434237`*^9}, {3.658279596716886*^9, 3.658279661442956*^9}, {
   3.658279700093648*^9, 3.658279706815292*^9}, {3.658279792551382*^9, 
   3.658279815830398*^9}, {3.658279878622261*^9, 3.658279897713276*^9}, {
   3.658279959320986*^9, 3.658279968167665*^9}, {3.658280159539792*^9, 
   3.658280259153908*^9}, {3.658280389314715*^9, 3.658280492142959*^9}, {
   3.65828054504196*^9, 3.6582806104625673`*^9}, {3.658280703485147*^9, 
   3.6582807265634003`*^9}, {3.658280783403376*^9, 3.658280995068233*^9}, {
   3.658332125643222*^9, 3.658332285669385*^9}, {3.658332356434971*^9, 
   3.658332432532056*^9}, {3.6583324694681797`*^9, 3.658332536889868*^9}, {
   3.6583325787135487`*^9, 3.658332603918232*^9}, {3.658332777986459*^9, 
   3.658332831919935*^9}, {3.6583329211917048`*^9, 3.6583329244763107`*^9}, {
   3.65833298690902*^9, 3.6583329940420103`*^9}, {3.658333033513297*^9, 
   3.658333041965459*^9}, {3.658333140934991*^9, 3.6583331410849524`*^9}, {
   3.658333260874716*^9, 3.658333325111835*^9}, {3.6583333640450163`*^9, 
   3.658333602194475*^9}, {3.658333866428316*^9, 3.658333876484424*^9}, {
   3.6583340410637217`*^9, 3.658334041446103*^9}, {3.658334239767832*^9, 
   3.658334256853527*^9}, {3.658334325290709*^9, 3.658334328931733*^9}, {
   3.658334454601124*^9, 3.658334541125682*^9}, {3.658334583676895*^9, 
   3.658334664745475*^9}, {3.658334705147303*^9, 3.6583347127203903`*^9}, {
   3.658334814800128*^9, 3.658334905957917*^9}, {3.658334952676396*^9, 
   3.658334989092309*^9}, {3.658335053255745*^9, 3.658335071690804*^9}, {
   3.658335129550527*^9, 3.658335241594574*^9}, {3.6583353167377977`*^9, 
   3.658335317096506*^9}, {3.658335384569755*^9, 3.658335396679709*^9}, {
   3.658335459752262*^9, 3.658335474398382*^9}, {3.658335569564763*^9, 
   3.6583356135466957`*^9}, {3.658335963702228*^9, 3.6583360118223963`*^9}, {
   3.6583361961257257`*^9, 3.658336324493081*^9}, {3.658336387471901*^9, 
   3.658336413286467*^9}, {3.6583364883081408`*^9, 3.658336518027725*^9}, {
   3.6583497860827847`*^9, 3.658349831490996*^9}, {3.658349861737459*^9, 
   3.658349862153501*^9}, {3.658349942786976*^9, 3.658349965329233*^9}, {
   3.6583500320501423`*^9, 3.658350038684167*^9}, {3.6583500726428823`*^9, 
   3.658350074339263*^9}, {3.658350117777423*^9, 3.658350161383792*^9}, {
   3.6583501955208597`*^9, 3.658350234542882*^9}, {3.6583502755982323`*^9, 
   3.658350338283965*^9}, {3.658350380319613*^9, 3.6583503814310093`*^9}, {
   3.658350450869604*^9, 3.658350549946392*^9}, {3.658350685268361*^9, 
   3.6583506855161467`*^9}, {3.658350727058009*^9, 3.6583507290251617`*^9}, {
   3.658350771093258*^9, 3.658350847603608*^9}, {3.658350951089933*^9, 
   3.658350961855956*^9}, {3.658351021399521*^9, 3.658351021591137*^9}, {
   3.6583511160719757`*^9, 3.658351121390588*^9}, {3.658351310629883*^9, 
   3.658351330581682*^9}, {3.658351453089098*^9, 3.6583514579767447`*^9}, {
   3.6583514969183617`*^9, 3.6583514999993277`*^9}, {3.658351570635014*^9, 
   3.658351577593944*^9}, {3.6583516106406183`*^9, 3.658351657352182*^9}, {
   3.658351766088022*^9, 3.658351770343424*^9}, {3.658351890506502*^9, 
   3.658351904164137*^9}, {3.6583519453391848`*^9, 3.65835200222512*^9}, {
   3.658352444511814*^9, 3.6583524450885687`*^9}, {3.65835945210156*^9, 
   3.658359582160754*^9}, {3.6583597573611526`*^9, 3.658359895421398*^9}, {
   3.6583600200459547`*^9, 3.658360209087796*^9}, {3.6583604062023983`*^9, 
   3.658360556362865*^9}, {3.658369386717368*^9, 3.658369415920825*^9}, {
   3.658369495583129*^9, 3.658369511397794*^9}, {3.658369604058823*^9, 
   3.6583698687217712`*^9}, {3.658369905522255*^9, 3.658370289459115*^9}, {
   3.658435473074052*^9, 3.65843549562414*^9}, {3.658435606368175*^9, 
   3.658435611544252*^9}, {3.6584356461976643`*^9, 3.6584356582216187`*^9}, {
   3.65843569293461*^9, 3.658435693127248*^9}, {3.6584357386455507`*^9, 
   3.6584357504379663`*^9}, {3.658437328158703*^9, 3.658437328842226*^9}, {
   3.658451386320923*^9, 3.658451396416233*^9}, {3.6584514558014927`*^9, 
   3.658451498437763*^9}, {3.65845176533173*^9, 3.658451769500102*^9}, {
   3.658451827834752*^9, 3.658451828192766*^9}, {3.6584518628797626`*^9, 
   3.658451915580929*^9}, {3.658451961311802*^9, 3.658451961463069*^9}, {
   3.658452686235773*^9, 3.658452689778323*^9}, {3.6584528065184526`*^9, 
   3.658452806708708*^9}, {3.6586220651258087`*^9, 3.658622180449822*^9}, {
   3.658622217313324*^9, 3.658622381467565*^9}, {3.658622437008402*^9, 
   3.658622500999549*^9}, {3.658623683248323*^9, 3.6586241287979918`*^9}, {
   3.658624240472498*^9, 3.658624332091518*^9}, {3.6586243934910803`*^9, 
   3.6586246606532173`*^9}, {3.6757780749103928`*^9, 3.675778092666944*^9}, {
   3.6757781317770443`*^9, 3.675778148103283*^9}, {3.675778193206167*^9, 
   3.675778200868908*^9}, {3.6757782344147387`*^9, 3.675778299338944*^9}, {
   3.676118088954138*^9, 3.676118088960745*^9}, {3.676210121948041*^9, 
   3.6762101271997538`*^9}, {3.676212687043581*^9, 3.676212739302689*^9}, {
   3.676212821098608*^9, 3.6762128555983953`*^9}, {3.676212894839349*^9, 
   3.676212899651846*^9}, {3.676213280902792*^9, 3.6762133170611897`*^9}, {
   3.6762133722711687`*^9, 3.676213420278404*^9}, {3.676213490348229*^9, 
   3.676213507276989*^9}, {3.6762136472488127`*^9, 3.676213647419341*^9}, {
   3.676213686097926*^9, 3.676213707298381*^9}, {3.6762137454501057`*^9, 
   3.676213746612797*^9}, {3.6762142650551157`*^9, 3.676214334303116*^9}, {
   3.676216025217536*^9, 3.676216073648109*^9}, {3.676216233956223*^9, 
   3.676216234458477*^9}, {3.6762944072751217`*^9, 3.676294572531825*^9}, 
   3.677238397377141*^9, 3.6772388506211557`*^9, {3.677238962412993*^9, 
   3.677238962996073*^9}, {3.677245446690844*^9, 3.6772454628094*^9}, {
   3.678096299605474*^9, 3.678096309489983*^9}, {3.691027328198552*^9, 
   3.6910274631952734`*^9}, {3.691095227787376*^9, 3.6910952655862427`*^9}, {
   3.6911618379687304`*^9, 3.6911618393415327`*^9}, {3.69247246637964*^9, 
   3.6924724791353693`*^9}, {3.693153895636554*^9, 
   3.693153896931356*^9}},ExpressionUUID->"a7283161-cdc0-498a-b163-\
e77b1dfae91b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"InverseDynamics", "[", 
      RowBox[{
      "thetalist_", ",", "dthetalist_", ",", "ddthetalist_", ",", "g_", ",", 
       "Ftip_", ",", "Mlist_", ",", "Glist_", ",", "Slist_"}], "]"}], ":", 
     "\[IndentingNewLine]", "   ", 
     RowBox[{"Takes", " ", "thetalist"}], ":", " ", 
     RowBox[{"n", "-", 
      RowBox[{"vector", " ", "of", " ", "joint", " ", "variables"}]}]}], ",", 
    "\[IndentingNewLine]", "          ", 
    RowBox[{"dthetalist", ":", " ", 
     RowBox[{"n", "-", 
      RowBox[{"vector", " ", "of", " ", "joint", " ", "rates"}]}]}], ",", 
    "\[IndentingNewLine]", "          ", 
    RowBox[{"ddthetalist", ":", " ", 
     RowBox[{"n", "-", 
      RowBox[{"vector", " ", "of", " ", "joint", " ", "accelerations"}]}]}], 
    ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"g", ":", " ", 
     RowBox[{"Gravity", " ", "vector", " ", "g"}]}], ",", 
    "\[IndentingNewLine]", "          ", 
    RowBox[{"Ftip", ":", " ", 
     RowBox[{
      RowBox[{
      "Spatial", " ", "force", " ", "applied", " ", "by", " ", "the", " ", 
       "end"}], "-", 
      RowBox[{"effector", " ", "expressed", " ", "in", " ", "frame", " ", 
       RowBox[{"{", 
        RowBox[{"n", "+", "1"}], "}"}]}]}]}], ",", "\[IndentingNewLine]", 
    "          ", 
    RowBox[{"Mlist", ":", 
     RowBox[{"L", " ", "ist", " ", "of", " ", "link", " ", "frames", " ", 
      RowBox[{"{", "i", "}"}], " ", "relative", " ", "to", " ", 
      RowBox[{"{", 
       RowBox[{"i", "-", "1"}], "}"}], " ", "at", " ", "the", " ", "home", 
      " ", "position"}]}], ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"Glist", ":", " ", 
     RowBox[{
     "Spatial", " ", "inertia", " ", "matrices", " ", "Gi", " ", "of", " ", 
      "the", " ", "links"}]}], ",", "\[IndentingNewLine]", "          ", 
    RowBox[{
     RowBox[{
      RowBox[{"Slist", ":", " ", 
       RowBox[{
       "Screw", " ", "axes", " ", "Si", " ", "of", " ", "the", " ", "joints", 
        " ", "in", " ", "a", " ", "space", " ", 
        RowBox[{"frame", ".", "\[IndentingNewLine]", "Returns"}], " ", 
        "taulist"}], ":", 
       RowBox[{
        RowBox[{"The", " ", "n"}], "-", 
        RowBox[{"vector", " ", "of", " ", "required", " ", "joint", " ", 
         RowBox[{"forces", "/", 
          RowBox[{"torques", ".", "\[IndentingNewLine]", "This"}]}], " ", 
         "function", " ", "uses", " ", "forward"}], "-", 
        RowBox[{"backward", " ", "Newton"}], "-", 
        RowBox[{
        "Euler", " ", "iterations", " ", "to", " ", "solve", " ", "the", " ", 
         
         RowBox[{"equation", ":", "\[IndentingNewLine]", "taulist"}]}]}]}], 
      "=", 
      RowBox[{
       RowBox[{"Mlist", 
        RowBox[{"(", "thetalist", ")"}], "ddthetalist"}], "+", 
       RowBox[{"c", 
        RowBox[{"(", 
         RowBox[{"thetalist", ",", "dthetalist"}], ")"}]}], "+", 
       RowBox[{"g", 
        RowBox[{"(", "thetalist", ")"}]}], "+", 
       RowBox[{"Jtr", 
        RowBox[{"(", "thetalist", ")"}], "Ftip"}]}]}], "\[IndentingNewLine]", 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Example", " ", "Input", " ", 
        RowBox[{"(", 
         RowBox[{"3", " ", "Link", " ", "Robot"}], ")"}]}], ":", 
       "\[IndentingNewLine]", "thetalist"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", "0.1", ",", "0.1"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "  ", "\[IndentingNewLine]", "  ", 
     RowBox[{"dthetalist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", "0.2", ",", "0.3"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "  ", "\[IndentingNewLine]", "  ", 
     RowBox[{"ddthetalist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"2", ",", "1.5", ",", "1"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", " ", "\[IndentingNewLine]", "  ", 
     RowBox[{"g", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"-", "9.8"}]}], "}"}], "}"}], "\[Transpose]"}]}], ";", " ", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Ftip", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
         "}"}], "}"}], "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"M01", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.089159"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     " ", "\[IndentingNewLine]", "  ", 
     RowBox[{"M12", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.28"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0.13585"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M23", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", 
          RowBox[{"-", "0.1197"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.395"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     " ", "\[IndentingNewLine]", "  ", 
     RowBox[{"M34", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.14225"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     " ", "\[IndentingNewLine]", "  ", 
     RowBox[{"G1", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.010267", ",", "0.010267", ",", "0.00666", ",", "3.7", ",", "3.7", 
         ",", "3.7"}], "}"}], "]"}]}], ";", " ", "\[IndentingNewLine]", "  ", 
     
     RowBox[{"G2", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.22689", ",", "0.22689", ",", "0.0151074", ",", "8.393", ",", 
         "8.393", ",", "8.393"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "  ", 
     RowBox[{"G3", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.0494433", ",", "0.0494433", ",", "0.004095", ",", "2.275", ",", 
         "2.275", ",", "2.275"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "  ", 
     RowBox[{"Glist", "=", 
      RowBox[{"{", 
       RowBox[{"G1", ",", "G2", ",", "G3"}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Mlist", "=", 
      RowBox[{"{", 
       RowBox[{"M01", ",", "M12", ",", "M23", ",", "M34"}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Slist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0.425"}], "}"}]}], "}"}], 
       "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"taulist", " ", "=", " ", 
      RowBox[{
       RowBox[{"InverseDynamics", "[", 
        RowBox[{
        "thetalist", ",", "dthetalist", ",", "ddthetalist", ",", "g", ",", 
         "Ftip", ",", "Mlist", ",", "Glist", ",", "Slist"}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Output", ":", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "74.41297704450305", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"-", "32.94408933077205"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"-", "3.218558853605959"}], "}"}]}], "}"}]}]}]}]}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"InverseDynamics", "[", 
     RowBox[{
     "thetalist_", ",", "dthetalist_", ",", "ddthetalist_", ",", "g_", ",", 
      "Ftip_", ",", "Mlist_", ",", "Glist_", ",", "Slist_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "n", " ", ",", "Ai", ",", "AdTi", ",", "Ti", ",", "Vi", ",", "Vdi", 
        ",", 
        RowBox[{"Fi", "=", "Ftip"}], ",", "taulist", ",", 
        RowBox[{"Mi", "=", 
         RowBox[{"IdentityMatrix", "[", "4", "]"}]}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "thetalist", "]"}]}], ";", 
       RowBox[{"Ai", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"6", ",", "n"}], "}"}]}], "]"}]}], ";", 
       RowBox[{"AdTi", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"Null", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
       RowBox[{"Vi", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"6", ",", 
            RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
       RowBox[{"Vdi", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"6", ",", 
            RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
       RowBox[{
        RowBox[{"Vdi", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"4", ";;", "6"}], ",", "1"}], "]"}], "]"}], "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"-", "g"}], "]"}]}], ";", 
       RowBox[{
        RowBox[{"AdTi", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", 
           RowBox[{"n", "+", "1"}]}], "]"}], "]"}], "=", 
        RowBox[{"Adjoint", "[", 
         RowBox[{"TransInv", "[", 
          RowBox[{"Mlist", "[", 
           RowBox[{"[", 
            RowBox[{"n", "+", "1"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
       RowBox[{"taulist", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "1"}], "}"}]}], "]"}]}], ";", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Mi", "=", 
           RowBox[{"Mi", ".", 
            RowBox[{"Mlist", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}], ";", 
          RowBox[{
           RowBox[{"Ai", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", "i"}], "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"Adjoint", "[", 
             RowBox[{"TransInv", "[", "Mi", "]"}], "]"}], ".", 
            RowBox[{"Slist", "[", 
             RowBox[{"[", 
              RowBox[{";;", ",", "i"}], "]"}], "]"}]}]}], ";", 
          RowBox[{
           RowBox[{"AdTi", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "i"}], "]"}], "]"}], "=", 
           RowBox[{"Adjoint", "[", 
            RowBox[{
             RowBox[{"MatrixExp6", "[", 
              RowBox[{"VecTose3", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"Ai", "[", 
                   RowBox[{"[", 
                    RowBox[{";;", ",", "i"}], "]"}], "]"}], "}"}], 
                 "\[Transpose]"}], "*", 
                RowBox[{"-", 
                 RowBox[{"thetalist", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}], "]"}], "]"}], 
             ".", 
             RowBox[{"TransInv", "[", 
              RowBox[{"Mlist", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
          RowBox[{
           RowBox[{"Vi", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", 
              RowBox[{"i", "+", "1"}]}], "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"AdTi", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "i"}], "]"}], "]"}], ".", 
             RowBox[{"Vi", "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", "i"}], "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Ai", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", "i"}], "]"}], "]"}], "}"}], 
              "\[Transpose]"}], "*", 
             RowBox[{"dthetalist", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}]}], ";", 
          RowBox[{
           RowBox[{"Vdi", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", 
              RowBox[{"i", "+", "1"}]}], "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"AdTi", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "i"}], "]"}], "]"}], ".", 
             RowBox[{"Vdi", "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", "i"}], "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Ai", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", "i"}], "]"}], "]"}], "}"}], 
              "\[Transpose]"}], "*", 
             RowBox[{"ddthetalist", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{
              RowBox[{"ad", "[", 
               RowBox[{"Vi", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", 
                  RowBox[{"i", "+", "1"}]}], "]"}], "]"}], "]"}], ".", 
              RowBox[{"Ai", "[", 
               RowBox[{"[", 
                RowBox[{";;", ",", "i"}], "]"}], "]"}]}], "*", 
             RowBox[{"dthetalist", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Fi", "=", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"AdTi", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", 
                 RowBox[{"i", "+", "1"}]}], "]"}], "]"}], "\[Transpose]"}], 
             ".", "Fi"}], "+", 
            RowBox[{
             RowBox[{"Glist", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ".", 
             RowBox[{"Vdi", "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", 
                RowBox[{"i", "+", "1"}]}], "]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{
              RowBox[{"ad", "[", 
               RowBox[{"Vi", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", 
                  RowBox[{"i", "+", "1"}]}], "]"}], "]"}], "]"}], 
              "\[Transpose]"}], ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Glist", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ".", 
               RowBox[{"Vi", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", 
                  RowBox[{"i", "+", "1"}]}], "]"}], "]"}]}], ")"}]}]}]}], ";", 
          RowBox[{
           RowBox[{"taulist", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Fi", "\[Transpose]"}], ".", 
              RowBox[{"Ai", "[", 
               RowBox[{"[", 
                RowBox[{";;", ",", "i"}], "]"}], "]"}]}], ")"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n", ",", "1", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";", 
       RowBox[{"Return", "[", "taulist", "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.658273872689763*^9, 3.658273988902459*^9}, {
   3.658274157743518*^9, 3.6582741742369556`*^9}, {3.65827421723704*^9, 
   3.6582742187327127`*^9}, {3.6582742677636137`*^9, 3.658274330534523*^9}, {
   3.658274365312026*^9, 3.6582744138260403`*^9}, {3.658274810942898*^9, 
   3.658274859112701*^9}, {3.658275033847995*^9, 3.658275109340135*^9}, {
   3.658275161547172*^9, 3.6582752536631193`*^9}, {3.65827533442001*^9, 
   3.658275354865328*^9}, {3.6582755590331087`*^9, 3.658275644746291*^9}, {
   3.658275839400229*^9, 3.6582758455265408`*^9}, {3.6582758973266172`*^9, 
   3.658276032713943*^9}, {3.658276065782716*^9, 3.6582762151364822`*^9}, {
   3.658276271302123*^9, 3.6582763371711683`*^9}, 3.658276384203477*^9, {
   3.658276429293391*^9, 3.658276729581854*^9}, {3.658276847155965*^9, 
   3.6582768822910967`*^9}, 3.658277078361019*^9, {3.658277454514134*^9, 
   3.65827755246841*^9}, {3.658277707616706*^9, 3.658277724793824*^9}, {
   3.658277775557291*^9, 3.658277790046358*^9}, {3.6582778408966618`*^9, 
   3.658277880321537*^9}, {3.658277965874803*^9, 3.658278001723259*^9}, {
   3.658278068864526*^9, 3.658278122465324*^9}, {3.6582782743035307`*^9, 
   3.658278463989525*^9}, {3.658278495324057*^9, 3.6582785116036882`*^9}, {
   3.6582787258401527`*^9, 3.6582787620388193`*^9}, {3.658278813660791*^9, 
   3.658278890779448*^9}, {3.658278981426128*^9, 3.6582789851507807`*^9}, {
   3.658279023852993*^9, 3.658279071286935*^9}, {3.6582792891814613`*^9, 
   3.6582793220434237`*^9}, {3.658279596716886*^9, 3.658279661442956*^9}, {
   3.658279700093648*^9, 3.658279706815292*^9}, {3.658279792551382*^9, 
   3.658279815830398*^9}, {3.658279878622261*^9, 3.658279897713276*^9}, {
   3.658279959320986*^9, 3.658279968167665*^9}, {3.658280159539792*^9, 
   3.658280259153908*^9}, {3.658280389314715*^9, 3.658280492142959*^9}, {
   3.65828054504196*^9, 3.6582806104625673`*^9}, {3.658280703485147*^9, 
   3.6582807265634003`*^9}, {3.658280783403376*^9, 3.658280995068233*^9}, {
   3.658332125643222*^9, 3.658332285669385*^9}, {3.658332356434971*^9, 
   3.658332432532056*^9}, {3.6583324694681797`*^9, 3.658332536889868*^9}, {
   3.6583325787135487`*^9, 3.658332603918232*^9}, {3.658332777986459*^9, 
   3.658332831919935*^9}, {3.6583329211917048`*^9, 3.6583329244763107`*^9}, {
   3.65833298690902*^9, 3.6583329940420103`*^9}, {3.658333033513297*^9, 
   3.658333041965459*^9}, {3.658333140934991*^9, 3.6583331410849524`*^9}, {
   3.658333260874716*^9, 3.658333325111835*^9}, {3.6583333640450163`*^9, 
   3.658333602194475*^9}, {3.658333866428316*^9, 3.658333876484424*^9}, {
   3.6583340410637217`*^9, 3.658334041446103*^9}, {3.658334239767832*^9, 
   3.658334256853527*^9}, {3.658334325290709*^9, 3.658334328931733*^9}, {
   3.658334454601124*^9, 3.658334541125682*^9}, {3.658334583676895*^9, 
   3.658334664745475*^9}, {3.658334705147303*^9, 3.6583347127203903`*^9}, {
   3.658334814800128*^9, 3.658334905957917*^9}, {3.658334952676396*^9, 
   3.658334989092309*^9}, {3.658335053255745*^9, 3.658335071690804*^9}, {
   3.658335129550527*^9, 3.658335241594574*^9}, {3.6583353167377977`*^9, 
   3.658335317096506*^9}, {3.658335384569755*^9, 3.658335396679709*^9}, {
   3.658335459752262*^9, 3.658335474398382*^9}, {3.658335569564763*^9, 
   3.6583356135466957`*^9}, {3.658335963702228*^9, 3.6583360118223963`*^9}, {
   3.6583361961257257`*^9, 3.658336324493081*^9}, {3.658336387471901*^9, 
   3.658336413286467*^9}, {3.6583364883081408`*^9, 3.658336518027725*^9}, {
   3.6583497860827847`*^9, 3.658349831490996*^9}, {3.658349861737459*^9, 
   3.658349862153501*^9}, {3.658349942786976*^9, 3.658349965329233*^9}, {
   3.6583500320501423`*^9, 3.658350038684167*^9}, {3.6583500726428823`*^9, 
   3.658350074339263*^9}, {3.658350117777423*^9, 3.658350161383792*^9}, {
   3.6583501955208597`*^9, 3.658350234542882*^9}, {3.6583502755982323`*^9, 
   3.658350338283965*^9}, {3.658350380319613*^9, 3.6583503814310093`*^9}, {
   3.658350450869604*^9, 3.658350549946392*^9}, {3.658350685268361*^9, 
   3.6583506855161467`*^9}, {3.658350727058009*^9, 3.6583507290251617`*^9}, {
   3.658350771093258*^9, 3.658350847603608*^9}, {3.658350951089933*^9, 
   3.658350961855956*^9}, {3.658351021399521*^9, 3.658351021591137*^9}, {
   3.6583511160719757`*^9, 3.658351121390588*^9}, {3.658351310629883*^9, 
   3.658351330581682*^9}, {3.658351453089098*^9, 3.6583514579767447`*^9}, {
   3.6583514969183617`*^9, 3.6583514999993277`*^9}, {3.658351570635014*^9, 
   3.658351577593944*^9}, {3.6583516106406183`*^9, 3.658351657352182*^9}, {
   3.658351766088022*^9, 3.658351770343424*^9}, {3.658351890506502*^9, 
   3.658351904164137*^9}, {3.6583519453391848`*^9, 3.65835200222512*^9}, {
   3.658352444511814*^9, 3.6583524450885687`*^9}, {3.65835945210156*^9, 
   3.658359582160754*^9}, {3.6583597573611526`*^9, 3.658359895421398*^9}, {
   3.6583600200459547`*^9, 3.658360209087796*^9}, {3.6583604062023983`*^9, 
   3.658360556362865*^9}, {3.658369386717368*^9, 3.658369415920825*^9}, {
   3.658369495583129*^9, 3.658369511397794*^9}, {3.658369604058823*^9, 
   3.6583698687217712`*^9}, {3.658369905522255*^9, 3.658370289459115*^9}, {
   3.658435473074052*^9, 3.65843549562414*^9}, {3.658435606368175*^9, 
   3.658435611544252*^9}, {3.6584356461976643`*^9, 3.6584356582216187`*^9}, {
   3.65843569293461*^9, 3.658435693127248*^9}, {3.6584357386455507`*^9, 
   3.6584357504379663`*^9}, {3.658437328158703*^9, 3.658437328842226*^9}, {
   3.658451386320923*^9, 3.658451396416233*^9}, {3.6584514558014927`*^9, 
   3.658451498437763*^9}, {3.65845176533173*^9, 3.658451769500102*^9}, {
   3.658451827834752*^9, 3.658451828192766*^9}, {3.6584518628797626`*^9, 
   3.658451915580929*^9}, {3.658451961311802*^9, 3.658451961463069*^9}, {
   3.658452686235773*^9, 3.658452689778323*^9}, {3.6584528065184526`*^9, 
   3.658452806708708*^9}, {3.6586220651258087`*^9, 3.658622180449822*^9}, {
   3.658622217313324*^9, 3.658622381467565*^9}, {3.658622437008402*^9, 
   3.658622500999549*^9}, {3.658623683248323*^9, 3.6586241287979918`*^9}, {
   3.658624240472498*^9, 3.658624332091518*^9}, {3.6586243934910803`*^9, 
   3.6586246606532173`*^9}, {3.6772391025485983`*^9, 3.6772391030813503`*^9}, 
   3.677244355984013*^9, {3.677244432148254*^9, 3.677244504323576*^9}, {
   3.677244554123225*^9, 3.677244576679357*^9}, {3.677244685399939*^9, 
   3.677244756023776*^9}, 3.67724480098313*^9, {3.677245676616014*^9, 
   3.67724568111721*^9}, {3.677246001533386*^9, 3.6772461750994062`*^9}, {
   3.677246209080035*^9, 3.677246229640416*^9}, {3.677246271327312*^9, 
   3.677246312154667*^9}, {3.677246368623028*^9, 3.677246384540496*^9}, {
   3.677246494811397*^9, 3.677246548249215*^9}, {3.677246627246484*^9, 
   3.677246772095085*^9}, {3.67724729367937*^9, 3.677247340339321*^9}, {
   3.677247372979681*^9, 3.677247391909115*^9}, {3.677247561296047*^9, 
   3.6772475644357*^9}, {3.6772476504484663`*^9, 3.6772476565869627`*^9}, {
   3.6772476975735493`*^9, 3.677247723351466*^9}, {3.6772477583612003`*^9, 
   3.677247782172574*^9}, {3.677247813053689*^9, 3.677247821497436*^9}, {
   3.67724786098481*^9, 3.677247887660157*^9}, {3.677247918383231*^9, 
   3.6772479227268*^9}, {3.677248051666149*^9, 3.677248152419401*^9}, {
   3.6772481871568413`*^9, 3.677248213947154*^9}, {3.677248311113554*^9, 
   3.677248386749319*^9}, {3.677248426650477*^9, 3.6772484275017853`*^9}, {
   3.6772485383032217`*^9, 3.677248588205284*^9}, {3.677248681364223*^9, 
   3.6772486890120153`*^9}, {3.6772487541715918`*^9, 
   3.6772488872632723`*^9}, {3.677248932718923*^9, 3.67724893344909*^9}, {
   3.677249002513879*^9, 3.677249115230443*^9}, {3.6772491452713337`*^9, 
   3.677249198829335*^9}, 3.677249242707559*^9, {3.677249353801366*^9, 
   3.6772494274284277`*^9}, {3.6772495211811447`*^9, 3.677249528268223*^9}, {
   3.677249676107225*^9, 3.677249714971898*^9}, {3.677249813626606*^9, 
   3.6772501354896927`*^9}, 3.677250272338114*^9, {3.677250388806677*^9, 
   3.677250512226314*^9}, {3.6772505488546057`*^9, 3.677250548946186*^9}, {
   3.6772506625894833`*^9, 3.677250834033412*^9}, {3.6772508642856293`*^9, 
   3.677250926794492*^9}, {3.677251890854176*^9, 3.677251908541988*^9}, {
   3.677251955063167*^9, 3.677251982543026*^9}, {3.677252082789035*^9, 
   3.677252135707983*^9}, {3.6772547120542088`*^9, 3.677254778367365*^9}, {
   3.677254809940134*^9, 3.677254810694992*^9}, {3.677254936380105*^9, 
   3.6772550358368607`*^9}, {3.677255175840102*^9, 3.677255202520162*^9}, {
   3.6772552720212193`*^9, 3.677255272480659*^9}, 3.677255321516757*^9, 
   3.6772554026994257`*^9, {3.677255533302904*^9, 3.677255548144637*^9}, {
   3.677255924206114*^9, 3.6772559564821453`*^9}, {3.677255990775902*^9, 
   3.6772560084051123`*^9}, {3.677256048499477*^9, 3.677256101134179*^9}, {
   3.677256255849882*^9, 3.677256431791498*^9}, {3.677256470560192*^9, 
   3.677256537679666*^9}, {3.6772567050765944`*^9, 3.6772567532846327`*^9}, {
   3.677256819553606*^9, 3.677256943552742*^9}, {3.677257016408537*^9, 
   3.677257041328187*^9}, {3.677257086092701*^9, 3.677257325334237*^9}, {
   3.6772573735555563`*^9, 3.677257448101842*^9}, {3.6772575152209272`*^9, 
   3.677257535140091*^9}, {3.6772576590287313`*^9, 3.677257677722865*^9}, {
   3.677257729412159*^9, 3.677257788180209*^9}, {3.677257833538631*^9, 
   3.677257942254745*^9}, {3.6772585288153133`*^9, 3.677258592724414*^9}, {
   3.6772588085902243`*^9, 3.677258819342699*^9}, {3.677258983718956*^9, 
   3.6772590167734127`*^9}, {3.677259130975376*^9, 3.6772591650591803`*^9}, {
   3.677259274513762*^9, 3.677259372680434*^9}, {3.677259417310178*^9, 
   3.6772596693390636`*^9}, {3.677259912324069*^9, 3.6772600207718277`*^9}, {
   3.677260060802122*^9, 3.677260207489208*^9}, {3.677260242637308*^9, 
   3.677260382454686*^9}, {3.67726042036277*^9, 3.677260507331476*^9}, {
   3.67726056708534*^9, 3.677260571117894*^9}, 3.677260611982997*^9, {
   3.677260659686365*^9, 3.677260696376569*^9}, {3.677260881888175*^9, 
   3.677260909792899*^9}, {3.677260943377907*^9, 3.677260943956663*^9}, {
   3.677261046331066*^9, 3.67726106321067*^9}, {3.6772611189125423`*^9, 
   3.677261159467651*^9}, {3.6772612579889803`*^9, 3.6772613036200323`*^9}, {
   3.677261343258348*^9, 3.67726164112537*^9}, {3.67726168069374*^9, 
   3.677261684921814*^9}, {3.677261739688339*^9, 3.677261795521442*^9}, {
   3.67726184472169*^9, 3.677261850163794*^9}, {3.677261889920115*^9, 
   3.677261917748721*^9}, {3.677261953319784*^9, 3.677262018774967*^9}, {
   3.6772620665573263`*^9, 3.67726206684867*^9}, {3.677262109500868*^9, 
   3.67726226901488*^9}, {3.677262344350646*^9, 3.6772623894785347`*^9}, {
   3.677262443299412*^9, 3.677262547832739*^9}, {3.6772626032030478`*^9, 
   3.677262634813252*^9}, 3.6772627141364517`*^9, {3.6772627478397913`*^9, 
   3.677262922790249*^9}, {3.6772630014493*^9, 3.6772630257156763`*^9}, 
   3.677315262280599*^9, {3.67749043474179*^9, 3.677490435196591*^9}, 
   3.678096323305634*^9, {3.689425372571526*^9, 3.6894253786515346`*^9}, 
   3.6894255331707864`*^9, {3.6894256983130226`*^9, 3.6894257019930277`*^9}, {
   3.68942594175738*^9, 3.689425947906389*^9}, {3.6910877988152933`*^9, 
   3.69108784198057*^9}, {3.691087942741146*^9, 3.691088086089798*^9}, {
   3.6910899615168066`*^9, 3.691090039782144*^9}, {3.6910900911062346`*^9, 
   3.691090380845543*^9}, {3.6910904608892837`*^9, 3.691090461622485*^9}, {
   3.691090633246855*^9, 3.691090645404476*^9}, {3.691090688852553*^9, 
   3.691090698321769*^9}, {3.691090830722822*^9, 3.6910909020681744`*^9}, {
   3.691090936654836*^9, 3.6910909622428813`*^9}, {3.691091150496703*^9, 
   3.6910911825461597`*^9}, {3.691091267007641*^9, 3.6910912928454895`*^9}, {
   3.691091452032501*^9, 3.691091706237749*^9}, {3.691091806043125*^9, 
   3.6910918338775744`*^9}, {3.6910918795000553`*^9, 
   3.6910920615431805`*^9}, {3.691092124965292*^9, 3.6910921297545004`*^9}, {
   3.6910921680253677`*^9, 3.6910928825158305`*^9}, {3.6910938532617574`*^9, 
   3.6910939062862506`*^9}, {3.691093945348719*^9, 3.691093946487521*^9}, {
   3.691093986002391*^9, 3.69109401976085*^9}, {3.691094099991791*^9, 
   3.691094112799413*^9}, {3.6910941512222805`*^9, 3.6910942130763893`*^9}, {
   3.6910942447756453`*^9, 3.6910943098345594`*^9}, {3.6910943633862534`*^9, 
   3.6910944765020523`*^9}, {3.6910946728164015`*^9, 
   3.6910948599699297`*^9}, {3.6910949224168396`*^9, 
   3.6910949332276583`*^9}, {3.691094975144932*^9, 3.691095007670989*^9}, {
   3.6910950547206717`*^9, 3.691095100865553*^9}, {3.6910951462460327`*^9, 
   3.6910951524548435`*^9}, {3.6910952907022867`*^9, 3.6910952927926903`*^9}, 
   3.6910953256931477`*^9, {3.691095363850815*^9, 3.6910954988222523`*^9}, {
   3.6910955487735395`*^9, 3.691095596603224*^9}, {3.691095637163295*^9, 
   3.691095672107356*^9}, {3.691095718049437*^9, 3.6910957558483033`*^9}, {
   3.691095797625177*^9, 3.6910958338640404`*^9}, {3.6910958989629545`*^9, 
   3.6910959288526073`*^9}, {3.6910959727198844`*^9, 
   3.6910959746386876`*^9}, {3.691096008319147*^9, 3.691096255626381*^9}, {
   3.6910962893692403`*^9, 3.6910963868382115`*^9}, {3.691096435401097*^9, 
   3.691096474697566*^9}, {3.691096507488824*^9, 3.6910965739449406`*^9}, {
   3.691096745202041*^9, 3.6910968655874524`*^9}, {3.6910969087839284`*^9, 
   3.6910969107495317`*^9}, {3.6910969482987976`*^9, 
   3.6910970279213376`*^9}, {3.6910970787618265`*^9, 3.691097124391907*^9}, {
   3.6910971561535625`*^9, 3.6910973171146455`*^9}, {3.691097355490713*^9, 
   3.6910974337716503`*^9}, {3.6910974804157324`*^9, 3.691097579772307*^9}, {
   3.6910976711572676`*^9, 3.6910980782399826`*^9}, {3.6910981464100056`*^9, 
   3.691098181510067*^9}, {3.6910982601090083`*^9, 3.6910982929782662`*^9}, {
   3.6910984759651403`*^9, 3.6910985514104557`*^9}, 3.6910989209605927`*^9, {
   3.691098952641405*^9, 3.6910990286157503`*^9}, {3.6910990813687677`*^9, 
   3.6910990900512643`*^9}, {3.691099122065095*^9, 3.6910991992945127`*^9}, {
   3.6910992359446087`*^9, 3.6910992937299137`*^9}, {3.691099323873638*^9, 
   3.691099377304694*^9}, {3.691099408146458*^9, 3.691099433338899*^9}, {
   3.6910994652877264`*^9, 3.6910995545958347`*^9}, {3.691108080578456*^9, 
   3.6911080965528836`*^9}, {3.691160563848493*^9, 3.691160565938897*^9}, {
   3.691160763173643*^9, 3.691160883091053*^9}, {3.691160934212343*^9, 
   3.69116094973437*^9}, {3.6911610989954324`*^9, 3.6911611191662683`*^9}, {
   3.6911611801623755`*^9, 3.6911611940307994`*^9}, {3.691161287989764*^9, 
   3.6911612974433813`*^9}, {3.6911615389942055`*^9, 
   3.6911615577766385`*^9}, {3.6911616312371674`*^9, 3.6911616374927783`*^9}, 
   3.69116177494462*^9, {3.691161806331875*^9, 3.691161816471893*^9}, {
   3.6912154015777874`*^9, 3.6912154342286444`*^9}, {3.691215597202131*^9, 
   3.6912156235193768`*^9}, {3.692472488882927*^9, 3.692472631883106*^9}, {
   3.693153903935768*^9, 
   3.6931539074145746`*^9}},ExpressionUUID->"1c0967b5-dc60-4e4c-a4a2-\
4d75440db633"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"MassMatrix", "[", 
      RowBox[{"thetalist_", ",", "Mlist_", ",", "Glist_", ",", "Slist_"}], 
      "]"}], ":", "\[IndentingNewLine]", "   ", 
     RowBox[{"Takes", " ", "thetalist"}], ":", " ", 
     RowBox[{"A", " ", "list", " ", "of", " ", "joint", " ", "variables"}]}], 
    ",", 
    RowBox[{"Mlist", ":", 
     RowBox[{
      RowBox[{
      "List", " ", "of", " ", "link", " ", "frames", " ", "i", " ", 
       "relative", " ", "to", " ", "i"}], "-", 
      RowBox[{"1", " ", "at", " ", "the", " ", "home", " ", "position"}]}]}], 
    ",", 
    RowBox[{"Glist", ":", 
     RowBox[{
     "Spatial", " ", "inertia", " ", "matrices", " ", "Gi", " ", "of", " ", 
      "the", " ", "links"}]}], ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"Slist", ":", 
     RowBox[{
     "Screw", " ", "axes", " ", "Si", " ", "of", " ", "the", " ", "joints", 
      " ", "in", " ", "a", " ", "space", " ", 
      RowBox[{"frame", ".", "\[IndentingNewLine]", " ", "Returns"}], " ", 
      "M"}], ":", " ", 
     RowBox[{
      RowBox[{
      "The", " ", "numerical", " ", "inertia", " ", "matrix", " ", "M", 
       RowBox[{"(", "thetalist", ")"}], " ", "of", " ", "an", " ", "n"}], "-", 
      RowBox[{
      "joint", " ", "serial", " ", "chain", " ", "at", " ", "the", " ", 
       "given", " ", "configuration", " ", 
       RowBox[{"thetalist", ".", "\[IndentingNewLine]", "This"}], " ", 
       "function", " ", "calls", " ", "InverseDynamics", " ", "n", " ", 
       "times"}]}]}], ",", 
    RowBox[{
    "each", " ", "time", " ", "passing", " ", "a", " ", "ddthetalist", " ", 
     "vector", " ", "with", " ", "a", " ", "single", " ", "element", " ", 
     "equal", " ", "to", " ", "one", " ", "and", " ", "all", " ", "other", 
     " ", "inputs", " ", "set", " ", "to", " ", 
     RowBox[{"zero", ".", " ", "Each"}], " ", "call", " ", "of", " ", 
     "InverseDynamics", " ", "generates", " ", "a", " ", "single", " ", 
     "column"}], ",", 
    RowBox[{
     RowBox[{
     "and", " ", "these", " ", "columns", " ", "are", " ", "assembled", " ", 
      "to", " ", "create", " ", "the", " ", "inertia", " ", 
      RowBox[{"matrix", "."}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Example", " ", "Input", " ", 
        RowBox[{"(", 
         RowBox[{"3", " ", "Link", " ", "Robot"}], ")"}]}], ":", 
       "\[IndentingNewLine]", "thetalist"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", "0.1", ",", "0.1"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "  ", "\[IndentingNewLine]", "  ", 
     RowBox[{"M01", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.089159"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     " ", "\[IndentingNewLine]", "  ", 
     RowBox[{"M12", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.28"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0.13585"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     " ", "\[IndentingNewLine]", "  ", 
     RowBox[{"M23", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", 
          RowBox[{"-", "0.1197"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.395"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     " ", "\[IndentingNewLine]", "  ", 
     RowBox[{"M34", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.14225"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     " ", "\[IndentingNewLine]", "  ", 
     RowBox[{"G1", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.010267", ",", "0.010267", ",", "0.00666", ",", "3.7", ",", "3.7", 
         ",", "3.7"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"G2", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.22689", ",", "0.22689", ",", "0.0151074", ",", "8.393", ",", 
         "8.393", ",", "8.393"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "  ", 
     RowBox[{"G3", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.0494433", ",", "0.0494433", ",", "0.004095", ",", "2.275", ",", 
         "2.275", ",", "2.275"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "  ", 
     RowBox[{"Glist", "=", 
      RowBox[{"{", 
       RowBox[{"G1", ",", "G2", ",", "G3"}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Mlist", "=", 
      RowBox[{"{", 
       RowBox[{"M01", ",", "M12", ",", "M23", ",", "M34"}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Slist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0.425"}], "}"}]}], "}"}], 
       "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"M", " ", "=", " ", 
      RowBox[{
       RowBox[{"MassMatrix", "[", 
        RowBox[{"thetalist", ",", "Mlist", ",", "Glist", ",", "Slist"}], 
        "]"}], "//", 
       RowBox[{"MatrixForm", "\[IndentingNewLine]", 
        RowBox[{"Output", ":", "\[IndentingNewLine]", 
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"22.543338035546054", 
              RowBox[{"-", "0.3071467542246569"}], 
              RowBox[{"-", "0.0071842639094406744"}]},
             {
              RowBox[{"-", "0.307146754224657"}], "1.968507166255545", 
              "0.43215736829319346"},
             {
              RowBox[{"-", "0.007184263909440675"}], "0.43215736829319357", 
              "0.19163085751427505"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]]}]}]}]}]}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MassMatrix", "[", 
     RowBox[{"thetalist_", ",", "Mlist_", ",", "Glist_", ",", "Slist_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "n", ",", "dthetalist", ",", "ddthetalist", ",", "g", ",", "Ftip", ",",
         "taulist", ",", "M"}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"n", " ", "=", " ", 
         RowBox[{"Length", "[", "thetalist", "]"}]}], ";", 
        RowBox[{"M", " ", "=", " ", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ddthetalist", " ", "=", " ", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"n", ",", "1"}], "}"}]}], "]"}]}], ";", 
          RowBox[{
           RowBox[{"ddthetalist", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], " ", "=", " ", "1"}], ";", 
          RowBox[{
           RowBox[{"M", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", "i"}], "]"}], "]"}], "=", " ", 
           RowBox[{"Flatten", "[", 
            RowBox[{"InverseDynamics", "[", 
             RowBox[{"thetalist", ",", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"0", ",", 
                RowBox[{"{", 
                 RowBox[{"6", ",", "n"}], "}"}]}], "]"}], ",", "ddthetalist", 
              ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}], 
               "\[Transpose]"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                 "}"}], "}"}], "\[Transpose]"}], ",", "Mlist", ",", "Glist", 
              ",", "Slist"}], "]"}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "M", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.658273872689763*^9, 3.658273988902459*^9}, {
   3.658274157743518*^9, 3.6582741742369556`*^9}, {3.65827421723704*^9, 
   3.6582742187327127`*^9}, {3.6582742677636137`*^9, 3.658274330534523*^9}, {
   3.658274365312026*^9, 3.6582744138260403`*^9}, {3.658274810942898*^9, 
   3.658274859112701*^9}, {3.658275033847995*^9, 3.658275109340135*^9}, {
   3.658275161547172*^9, 3.6582752536631193`*^9}, {3.65827533442001*^9, 
   3.658275354865328*^9}, {3.6582755590331087`*^9, 3.658275644746291*^9}, {
   3.658275839400229*^9, 3.6582758455265408`*^9}, {3.6582758973266172`*^9, 
   3.658276032713943*^9}, {3.658276065782716*^9, 3.6582762151364822`*^9}, {
   3.658276271302123*^9, 3.6582763371711683`*^9}, 3.658276384203477*^9, {
   3.658276429293391*^9, 3.658276729581854*^9}, {3.658276847155965*^9, 
   3.6582768822910967`*^9}, 3.658277078361019*^9, {3.658277454514134*^9, 
   3.65827755246841*^9}, {3.658277707616706*^9, 3.658277724793824*^9}, {
   3.658277775557291*^9, 3.658277790046358*^9}, {3.6582778408966618`*^9, 
   3.658277880321537*^9}, {3.658277965874803*^9, 3.658278001723259*^9}, {
   3.658278068864526*^9, 3.658278122465324*^9}, {3.6582782743035307`*^9, 
   3.658278463989525*^9}, {3.658278495324057*^9, 3.6582785116036882`*^9}, {
   3.6582787258401527`*^9, 3.6582787620388193`*^9}, {3.658278813660791*^9, 
   3.658278890779448*^9}, {3.658278981426128*^9, 3.6582789851507807`*^9}, {
   3.658279023852993*^9, 3.658279071286935*^9}, {3.6582792891814613`*^9, 
   3.6582793220434237`*^9}, {3.658279596716886*^9, 3.658279661442956*^9}, {
   3.658279700093648*^9, 3.658279706815292*^9}, {3.658279792551382*^9, 
   3.658279815830398*^9}, {3.658279878622261*^9, 3.658279897713276*^9}, {
   3.658279959320986*^9, 3.658279968167665*^9}, {3.658280159539792*^9, 
   3.658280259153908*^9}, {3.658280389314715*^9, 3.658280492142959*^9}, {
   3.65828054504196*^9, 3.6582806104625673`*^9}, {3.658280703485147*^9, 
   3.6582807265634003`*^9}, {3.658280783403376*^9, 3.658280995068233*^9}, {
   3.658332125643222*^9, 3.658332285669385*^9}, {3.658332356434971*^9, 
   3.658332432532056*^9}, {3.6583324694681797`*^9, 3.658332536889868*^9}, {
   3.6583325787135487`*^9, 3.658332603918232*^9}, {3.658332777986459*^9, 
   3.658332831919935*^9}, {3.6583329211917048`*^9, 3.6583329244763107`*^9}, {
   3.65833298690902*^9, 3.6583329940420103`*^9}, {3.658333033513297*^9, 
   3.658333041965459*^9}, {3.658333140934991*^9, 3.6583331410849524`*^9}, {
   3.658333260874716*^9, 3.658333325111835*^9}, {3.6583333640450163`*^9, 
   3.658333602194475*^9}, {3.658333866428316*^9, 3.658333876484424*^9}, {
   3.6583340410637217`*^9, 3.658334041446103*^9}, {3.658334239767832*^9, 
   3.658334256853527*^9}, {3.658334325290709*^9, 3.658334328931733*^9}, {
   3.658334454601124*^9, 3.658334541125682*^9}, {3.658334583676895*^9, 
   3.658334664745475*^9}, {3.658334705147303*^9, 3.6583347127203903`*^9}, {
   3.658334814800128*^9, 3.658334905957917*^9}, {3.658334952676396*^9, 
   3.658334989092309*^9}, {3.658335053255745*^9, 3.658335071690804*^9}, {
   3.658335129550527*^9, 3.658335241594574*^9}, {3.6583353167377977`*^9, 
   3.658335317096506*^9}, {3.658335384569755*^9, 3.658335396679709*^9}, {
   3.658335459752262*^9, 3.658335474398382*^9}, {3.658335569564763*^9, 
   3.6583356135466957`*^9}, {3.658335963702228*^9, 3.6583360118223963`*^9}, {
   3.6583361961257257`*^9, 3.658336324493081*^9}, {3.658336387471901*^9, 
   3.658336413286467*^9}, {3.6583364883081408`*^9, 3.658336518027725*^9}, {
   3.6583497860827847`*^9, 3.658349831490996*^9}, {3.658349861737459*^9, 
   3.658349862153501*^9}, {3.658349942786976*^9, 3.658349965329233*^9}, {
   3.6583500320501423`*^9, 3.658350038684167*^9}, {3.6583500726428823`*^9, 
   3.658350074339263*^9}, {3.658350117777423*^9, 3.658350161383792*^9}, {
   3.6583501955208597`*^9, 3.658350234542882*^9}, {3.6583502755982323`*^9, 
   3.658350338283965*^9}, {3.658350380319613*^9, 3.6583503814310093`*^9}, {
   3.658350450869604*^9, 3.658350549946392*^9}, {3.658350685268361*^9, 
   3.6583506855161467`*^9}, {3.658350727058009*^9, 3.6583507290251617`*^9}, {
   3.658350771093258*^9, 3.658350847603608*^9}, {3.658350951089933*^9, 
   3.658350961855956*^9}, {3.658351021399521*^9, 3.658351021591137*^9}, {
   3.6583511160719757`*^9, 3.658351121390588*^9}, {3.658351310629883*^9, 
   3.658351330581682*^9}, {3.658351453089098*^9, 3.6583514579767447`*^9}, {
   3.6583514969183617`*^9, 3.6583514999993277`*^9}, {3.658351570635014*^9, 
   3.658351577593944*^9}, {3.6583516106406183`*^9, 3.658351657352182*^9}, {
   3.658351766088022*^9, 3.658351770343424*^9}, {3.658351890506502*^9, 
   3.658351904164137*^9}, {3.6583519453391848`*^9, 3.65835200222512*^9}, {
   3.658352444511814*^9, 3.6583524450885687`*^9}, {3.65835945210156*^9, 
   3.658359582160754*^9}, {3.6583597573611526`*^9, 3.658359895421398*^9}, {
   3.6583600200459547`*^9, 3.658360209087796*^9}, {3.6583604062023983`*^9, 
   3.658360556362865*^9}, {3.658369386717368*^9, 3.658369415920825*^9}, {
   3.658369495583129*^9, 3.658369511397794*^9}, {3.658369604058823*^9, 
   3.6583698687217712`*^9}, {3.658369905522255*^9, 3.658370289459115*^9}, {
   3.658435473074052*^9, 3.65843549562414*^9}, {3.658435606368175*^9, 
   3.658435611544252*^9}, {3.6584356461976643`*^9, 3.6584356582216187`*^9}, {
   3.65843569293461*^9, 3.658435693127248*^9}, {3.6584357386455507`*^9, 
   3.6584357504379663`*^9}, {3.658437328158703*^9, 3.658437328842226*^9}, {
   3.658451386320923*^9, 3.658451396416233*^9}, {3.6584514558014927`*^9, 
   3.658451498437763*^9}, {3.65845176533173*^9, 3.658451769500102*^9}, {
   3.658451827834752*^9, 3.658451828192766*^9}, {3.6584518628797626`*^9, 
   3.658451915580929*^9}, {3.658451961311802*^9, 3.658451961463069*^9}, {
   3.658452686235773*^9, 3.658452689778323*^9}, {3.6584528065184526`*^9, 
   3.658452806708708*^9}, {3.6586220651258087`*^9, 3.658622180449822*^9}, {
   3.658622217313324*^9, 3.658622381467565*^9}, {3.658622437008402*^9, 
   3.658622500999549*^9}, {3.658623683248323*^9, 3.6586241287979918`*^9}, {
   3.658624240472498*^9, 3.658624332091518*^9}, {3.6586243934910803`*^9, 
   3.6586246606532173`*^9}, {3.677315383100857*^9, 3.6773153874097767`*^9}, {
   3.677315451577257*^9, 3.67731550527804*^9}, {3.677315540973567*^9, 
   3.67731554925203*^9}, {3.677315687843329*^9, 3.677315714044332*^9}, {
   3.677316340908476*^9, 3.6773165375560226`*^9}, {3.677316574393567*^9, 
   3.6773165751686068`*^9}, {3.677316741164989*^9, 3.677316779517893*^9}, {
   3.67731693109394*^9, 3.677316983329446*^9}, {3.677317041029996*^9, 
   3.677317088346855*^9}, {3.6773171561703167`*^9, 3.677317188692944*^9}, {
   3.677318007172571*^9, 3.677318025098009*^9}, {3.677490445750225*^9, 
   3.677490446389659*^9}, 3.678096332476907*^9, {3.681451008340869*^9, 
   3.681451020942246*^9}, {3.6911117904422407`*^9, 3.69111183014431*^9}, {
   3.6911119168336625`*^9, 3.6911121390716524`*^9}, {3.6911121834537306`*^9, 
   3.6911122504246483`*^9}, {3.691160202785859*^9, 3.691160204377062*^9}, 
   3.6911602529555473`*^9, {3.6924727035902076`*^9, 3.6924728492545395`*^9}, {
   3.6931539138105855`*^9, 3.693153917476592*^9}, {3.693162166200325*^9, 
   3.6931621959781785`*^9}},ExpressionUUID->"8f203f6f-118c-4dfe-8134-\
e1707b0a8783"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"VelQuadraticForces", "[", 
      RowBox[{
      "thetalist_", ",", "dthetalist_", ",", "Mlist_", ",", "Glist_", ",", 
       "Slist_"}], "]"}], ":", "\[IndentingNewLine]", "   ", 
     RowBox[{"Takes", " ", "thetalist"}], ":", " ", 
     RowBox[{"A", " ", "list", " ", "of", " ", "joint", " ", "variables"}]}], 
    ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"dthetalist", ":", " ", 
     RowBox[{"A", " ", "list", " ", "of", " ", "joint", " ", "rates"}]}], ",",
     "\[IndentingNewLine]", "          ", 
    RowBox[{"Mlist", ":", " ", 
     RowBox[{
      RowBox[{
      "List", " ", "of", " ", "link", " ", "frames", " ", "i", " ", 
       "relative", " ", "to", " ", "i"}], "-", 
      RowBox[{"1", " ", "at", " ", "the", " ", "home", " ", "position"}]}]}], 
    ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"Glist", ":", " ", 
     RowBox[{
     "Spatial", " ", "inertia", " ", "matrices", " ", "Gi", " ", "of", " ", 
      "the", " ", "links"}]}], ",", "\[IndentingNewLine]", "          ", 
    RowBox[{
     RowBox[{"Slist", ":", " ", 
      RowBox[{
      "Screw", " ", "axes", " ", "Si", " ", "of", " ", "the", " ", "joints", 
       " ", "in", " ", "a", " ", "space", " ", 
       RowBox[{"frame", ".", "\[IndentingNewLine]", "Returns"}], " ", "c"}], 
      ":", " ", 
      RowBox[{"The", " ", "vector", " ", "c", 
       RowBox[{"(", 
        RowBox[{"thetalist", ",", "dthetalist"}], ")"}], " ", "of", " ", 
       "Coriolis", " ", "and", " ", "centripetal", " ", "terms", " ", "for", 
       " ", "a", " ", "given", " ", "thetalist", " ", "and", " ", 
       RowBox[{"dthetalist", ".", "\n", "    ", "This"}], " ", "function", 
       " ", "calls", " ", "InverseDynamics", " ", "with", " ", "g"}]}], "=", 
     "0"}], ",", 
    RowBox[{"Ftip", "=", "0"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"and", " ", "ddthetalist"}], "=", "0."}], "\[IndentingNewLine]",
      ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Example", " ", "Input", " ", 
        RowBox[{"(", 
         RowBox[{"3", " ", "Link", " ", "Robot"}], ")"}]}], ":", 
       "\[IndentingNewLine]", "thetalist"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", "0.1", ",", "0.1"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "  ", "\[IndentingNewLine]", "  ", 
     RowBox[{"dthetalist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", "0.2", ",", "0.3"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"M01", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.089159"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M12", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.28"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0.13585"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M23", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", 
          RowBox[{"-", "0.1197"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.395"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M34", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.14225"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"G1", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.010267", ",", "0.010267", ",", "0.00666", ",", "3.7", ",", "3.7", 
         ",", "3.7"}], "}"}], "]"}]}], ";", " ", "\[IndentingNewLine]", "  ", 
     
     RowBox[{"G2", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.22689", ",", "0.22689", ",", "0.0151074", ",", "8.393", ",", 
         "8.393", ",", "8.393"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "  ", 
     RowBox[{"G3", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.0494433", ",", "0.0494433", ",", "0.004095", ",", "2.275", ",", 
         "2.275", ",", "2.275"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "  ", 
     RowBox[{"Glist", "=", 
      RowBox[{"{", 
       RowBox[{"G1", ",", "G2", ",", "G3"}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Mlist", "=", 
      RowBox[{"{", 
       RowBox[{"M01", ",", "M12", ",", "M23", ",", "M34"}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Slist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0.425"}], "}"}]}], "}"}], 
       "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"c", " ", "=", " ", 
      RowBox[{
       RowBox[{"VelQuadraticForces", "[", 
        RowBox[{
        "thetalist", ",", "dthetalist", ",", "Mlist", ",", "Glist", ",", 
         "Slist"}], "]"}], "//", 
       RowBox[{"MatrixForm", "\[IndentingNewLine]", 
        RowBox[{"Output", ":", "\[IndentingNewLine]", 
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"0.26453118054501235"},
             {
              RowBox[{"-", "0.0550515682891655"}]},
             {
              RowBox[{"-", "0.006891320068248913"}]}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]]}]}]}]}]}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"VelQuadraticForces", "[", 
     RowBox[{
     "thetalist_", ",", "dthetalist_", ",", "Mlist_", ",", "Glist_", ",", 
      "Slist_"}], "]"}], ":=", 
    RowBox[{"InverseDynamics", "[", 
     RowBox[{"thetalist", ",", "dthetalist", ",", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Length", "[", "thetalist", "]"}], ",", "1"}], "}"}]}], 
       "]"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}], "\[Transpose]"}], 
      ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}], "}"}], "\[Transpose]"}], ",", "Mlist", ",", "Glist", ",", 
      "Slist"}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.658273872689763*^9, 3.658273988902459*^9}, {
   3.658274157743518*^9, 3.6582741742369556`*^9}, {3.65827421723704*^9, 
   3.6582742187327127`*^9}, {3.6582742677636137`*^9, 3.658274330534523*^9}, {
   3.658274365312026*^9, 3.6582744138260403`*^9}, {3.658274810942898*^9, 
   3.658274859112701*^9}, {3.658275033847995*^9, 3.658275109340135*^9}, {
   3.658275161547172*^9, 3.6582752536631193`*^9}, {3.65827533442001*^9, 
   3.658275354865328*^9}, {3.6582755590331087`*^9, 3.658275644746291*^9}, {
   3.658275839400229*^9, 3.6582758455265408`*^9}, {3.6582758973266172`*^9, 
   3.658276032713943*^9}, {3.658276065782716*^9, 3.6582762151364822`*^9}, {
   3.658276271302123*^9, 3.6582763371711683`*^9}, 3.658276384203477*^9, {
   3.658276429293391*^9, 3.658276729581854*^9}, {3.658276847155965*^9, 
   3.6582768822910967`*^9}, 3.658277078361019*^9, {3.658277454514134*^9, 
   3.65827755246841*^9}, {3.658277707616706*^9, 3.658277724793824*^9}, {
   3.658277775557291*^9, 3.658277790046358*^9}, {3.6582778408966618`*^9, 
   3.658277880321537*^9}, {3.658277965874803*^9, 3.658278001723259*^9}, {
   3.658278068864526*^9, 3.658278122465324*^9}, {3.6582782743035307`*^9, 
   3.658278463989525*^9}, {3.658278495324057*^9, 3.6582785116036882`*^9}, {
   3.6582787258401527`*^9, 3.6582787620388193`*^9}, {3.658278813660791*^9, 
   3.658278890779448*^9}, {3.658278981426128*^9, 3.6582789851507807`*^9}, {
   3.658279023852993*^9, 3.658279071286935*^9}, {3.6582792891814613`*^9, 
   3.6582793220434237`*^9}, {3.658279596716886*^9, 3.658279661442956*^9}, {
   3.658279700093648*^9, 3.658279706815292*^9}, {3.658279792551382*^9, 
   3.658279815830398*^9}, {3.658279878622261*^9, 3.658279897713276*^9}, {
   3.658279959320986*^9, 3.658279968167665*^9}, {3.658280159539792*^9, 
   3.658280259153908*^9}, {3.658280389314715*^9, 3.658280492142959*^9}, {
   3.65828054504196*^9, 3.6582806104625673`*^9}, {3.658280703485147*^9, 
   3.6582807265634003`*^9}, {3.658280783403376*^9, 3.658280995068233*^9}, {
   3.658332125643222*^9, 3.658332285669385*^9}, {3.658332356434971*^9, 
   3.658332432532056*^9}, {3.6583324694681797`*^9, 3.658332536889868*^9}, {
   3.6583325787135487`*^9, 3.658332603918232*^9}, {3.658332777986459*^9, 
   3.658332831919935*^9}, {3.6583329211917048`*^9, 3.6583329244763107`*^9}, {
   3.65833298690902*^9, 3.6583329940420103`*^9}, {3.658333033513297*^9, 
   3.658333041965459*^9}, {3.658333140934991*^9, 3.6583331410849524`*^9}, {
   3.658333260874716*^9, 3.658333325111835*^9}, {3.6583333640450163`*^9, 
   3.658333602194475*^9}, {3.658333866428316*^9, 3.658333876484424*^9}, {
   3.6583340410637217`*^9, 3.658334041446103*^9}, {3.658334239767832*^9, 
   3.658334256853527*^9}, {3.658334325290709*^9, 3.658334328931733*^9}, {
   3.658334454601124*^9, 3.658334541125682*^9}, {3.658334583676895*^9, 
   3.658334664745475*^9}, {3.658334705147303*^9, 3.6583347127203903`*^9}, {
   3.658334814800128*^9, 3.658334905957917*^9}, {3.658334952676396*^9, 
   3.658334989092309*^9}, {3.658335053255745*^9, 3.658335071690804*^9}, {
   3.658335129550527*^9, 3.658335241594574*^9}, {3.6583353167377977`*^9, 
   3.658335317096506*^9}, {3.658335384569755*^9, 3.658335396679709*^9}, {
   3.658335459752262*^9, 3.658335474398382*^9}, {3.658335569564763*^9, 
   3.6583356135466957`*^9}, {3.658335963702228*^9, 3.6583360118223963`*^9}, {
   3.6583361961257257`*^9, 3.658336324493081*^9}, {3.658336387471901*^9, 
   3.658336413286467*^9}, {3.6583364883081408`*^9, 3.658336518027725*^9}, {
   3.6583497860827847`*^9, 3.658349831490996*^9}, {3.658349861737459*^9, 
   3.658349862153501*^9}, {3.658349942786976*^9, 3.658349965329233*^9}, {
   3.6583500320501423`*^9, 3.658350038684167*^9}, {3.6583500726428823`*^9, 
   3.658350074339263*^9}, {3.658350117777423*^9, 3.658350161383792*^9}, {
   3.6583501955208597`*^9, 3.658350234542882*^9}, {3.6583502755982323`*^9, 
   3.658350338283965*^9}, {3.658350380319613*^9, 3.6583503814310093`*^9}, {
   3.658350450869604*^9, 3.658350549946392*^9}, {3.658350685268361*^9, 
   3.6583506855161467`*^9}, {3.658350727058009*^9, 3.6583507290251617`*^9}, {
   3.658350771093258*^9, 3.658350847603608*^9}, {3.658350951089933*^9, 
   3.658350961855956*^9}, {3.658351021399521*^9, 3.658351021591137*^9}, {
   3.6583511160719757`*^9, 3.658351121390588*^9}, {3.658351310629883*^9, 
   3.658351330581682*^9}, {3.658351453089098*^9, 3.6583514579767447`*^9}, {
   3.6583514969183617`*^9, 3.6583514999993277`*^9}, {3.658351570635014*^9, 
   3.658351577593944*^9}, {3.6583516106406183`*^9, 3.658351657352182*^9}, {
   3.658351766088022*^9, 3.658351770343424*^9}, {3.658351890506502*^9, 
   3.658351904164137*^9}, {3.6583519453391848`*^9, 3.65835200222512*^9}, {
   3.658352444511814*^9, 3.6583524450885687`*^9}, {3.65835945210156*^9, 
   3.658359582160754*^9}, {3.6583597573611526`*^9, 3.658359895421398*^9}, {
   3.6583600200459547`*^9, 3.658360209087796*^9}, {3.6583604062023983`*^9, 
   3.658360556362865*^9}, {3.658369386717368*^9, 3.658369415920825*^9}, {
   3.658369495583129*^9, 3.658369511397794*^9}, {3.658369604058823*^9, 
   3.6583698687217712`*^9}, {3.658369905522255*^9, 3.658370289459115*^9}, {
   3.658435473074052*^9, 3.65843549562414*^9}, {3.658435606368175*^9, 
   3.658435611544252*^9}, {3.6584356461976643`*^9, 3.6584356582216187`*^9}, {
   3.65843569293461*^9, 3.658435693127248*^9}, {3.6584357386455507`*^9, 
   3.6584357504379663`*^9}, {3.658437328158703*^9, 3.658437328842226*^9}, {
   3.658451386320923*^9, 3.658451396416233*^9}, {3.6584514558014927`*^9, 
   3.658451498437763*^9}, {3.65845176533173*^9, 3.658451769500102*^9}, {
   3.658451827834752*^9, 3.658451828192766*^9}, {3.6584518628797626`*^9, 
   3.658451915580929*^9}, {3.658451961311802*^9, 3.658451961463069*^9}, {
   3.658452686235773*^9, 3.658452689778323*^9}, {3.6584528065184526`*^9, 
   3.658452806708708*^9}, {3.6586220651258087`*^9, 3.658622180449822*^9}, {
   3.658622217313324*^9, 3.658622381467565*^9}, {3.658622437008402*^9, 
   3.658622500999549*^9}, {3.658623683248323*^9, 3.6586241287979918`*^9}, {
   3.658624240472498*^9, 3.658624332091518*^9}, {3.6586243934910803`*^9, 
   3.6586246606532173`*^9}, {3.677317411138452*^9, 3.677317488094689*^9}, {
   3.677317526836624*^9, 3.6773175326578627`*^9}, {3.677317664909581*^9, 
   3.6773177047834806`*^9}, {3.677317735802031*^9, 3.677317802344627*^9}, {
   3.677317840881192*^9, 3.677317897783889*^9}, {3.677317993699333*^9, 
   3.677317999721787*^9}, {3.677318816262457*^9, 3.6773188165402718`*^9}, {
   3.677490452561892*^9, 3.6774904527054863`*^9}, 3.6780963385542927`*^9, {
   3.678449190708435*^9, 3.6784492009951878`*^9}, 3.6911133614117994`*^9, {
   3.691113616815448*^9, 3.691113618359851*^9}, {3.691159215370124*^9, 
   3.6911592166493263`*^9}, {3.6911592647286105`*^9, 
   3.6911593580479746`*^9}, {3.69115942412969*^9, 3.691159444487726*^9}, {
   3.69115952638027*^9, 3.6911595273006716`*^9}, {3.6911618605419703`*^9, 
   3.691161876032797*^9}, {3.692472871888834*^9, 3.6924730025533075`*^9}, {
   3.6931539222814007`*^9, 
   3.6931539237946033`*^9}},ExpressionUUID->"a0c7be14-9f77-4b01-b125-\
e243b43f9e52"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"GravityForces", "[", 
      RowBox[{
      "thetalist_", ",", "g_", ",", "Mlist_", ",", "Glist_", ",", "Slist_"}], 
      "]"}], ":", "\[IndentingNewLine]", "   ", 
     RowBox[{"Takes", " ", "thetalist"}], ":", " ", 
     RowBox[{"A", " ", "list", " ", "of", " ", "joint", " ", "variables"}]}], 
    ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"g", ":", " ", 
     RowBox[{"3", "-", 
      RowBox[{
      "vector", " ", "for", " ", "gravitational", " ", "acceleration"}]}]}], 
    ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"Mlist", ":", " ", 
     RowBox[{
      RowBox[{
      "List", " ", "of", " ", "link", " ", "frames", " ", "i", " ", 
       "relative", " ", "to", " ", "i"}], "-", 
      RowBox[{"1", " ", "at", " ", "the", " ", "home", " ", "position"}]}]}], 
    ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"Glist", ":", " ", 
     RowBox[{
     "Spatial", " ", "inertia", " ", "matrices", " ", "Gi", " ", "of", " ", 
      "the", " ", "links"}]}], ",", "\[IndentingNewLine]", "          ", 
    RowBox[{
     RowBox[{"Slist", ":", " ", 
      RowBox[{
      "Screw", " ", "axes", " ", "Si", " ", "of", " ", "the", " ", "joints", 
       " ", "in", " ", "a", " ", "space", " ", 
       RowBox[{"frame", ".", "\[IndentingNewLine]", "Returns"}], " ", 
       "grav"}], ":", " ", 
      RowBox[{"The", " ", "joint", " ", 
       RowBox[{"forces", "/", "torques"}], " ", "required", " ", "to", " ", 
       "overcome", " ", "gravity", " ", "at", " ", 
       RowBox[{"thetalist", ".", "\n", "    ", "This"}], " ", "function", " ",
        "calls", " ", "InverseDynamics", " ", "with", " ", "Ftip"}]}], "=", 
     "0"}], ",", 
    RowBox[{"dthetalist", "=", "0"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"and", " ", "ddthetalist"}], "=", "0."}], "\[IndentingNewLine]",
      ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Example", " ", "Input", " ", 
        RowBox[{"(", 
         RowBox[{"3", " ", "Link", " ", "Robot"}], ")"}]}], ":", 
       "\[IndentingNewLine]", "thetalist"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", "0.1", ",", "0.1"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "  ", "\[IndentingNewLine]", "  ", 
     RowBox[{"g", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"-", "9.8"}]}], "}"}], "}"}], "\[Transpose]"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M01", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.089159"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M12", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.28"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0.13585"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M23", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", 
          RowBox[{"-", "0.1197"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.395"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M34", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.14225"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"G1", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.010267", ",", "0.010267", ",", "0.00666", ",", "3.7", ",", "3.7", 
         ",", "3.7"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"G2", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.22689", ",", "0.22689", ",", "0.0151074", ",", "8.393", ",", 
         "8.393", ",", "8.393"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "  ", 
     RowBox[{"G3", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.0494433", ",", "0.0494433", ",", "0.004095", ",", "2.275", ",", 
         "2.275", ",", "2.275"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "  ", 
     RowBox[{"Glist", "=", 
      RowBox[{"{", 
       RowBox[{"G1", ",", "G2", ",", "G3"}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Mlist", "=", 
      RowBox[{"{", 
       RowBox[{"M01", ",", "M12", ",", "M23", ",", "M34"}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Slist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0.425"}], "}"}]}], "}"}], 
       "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"grav", " ", "=", " ", 
      RowBox[{
       RowBox[{"GravityForces", "[", 
        RowBox[{
        "thetalist", ",", "g", ",", "Mlist", ",", "Glist", ",", "Slist"}], 
        "]"}], "\[IndentingNewLine]", 
       RowBox[{"Output", ":", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "28.40331261821983", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"-", "37.64094817177068"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"-", "5.4415891999683605"}], "}"}]}], "}"}]}]}]}]}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"GravityForces", "[", 
     RowBox[{
     "thetalist_", ",", "g_", ",", "Mlist_", ",", "Glist_", ",", "Slist_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "thetalist", "]"}]}], "}"}], ",", 
      RowBox[{"Return", "[", 
       RowBox[{"InverseDynamics", "[", 
        RowBox[{"thetalist", ",", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1"}], "}"}]}], "]"}], ",", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1"}], "}"}]}], "]"}], ",", "g", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}], "}"}], "\[Transpose]"}], ",", "Mlist", ",", "Glist", ",", 
         "Slist"}], "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.658273872689763*^9, 3.658273988902459*^9}, {
   3.658274157743518*^9, 3.6582741742369556`*^9}, {3.65827421723704*^9, 
   3.6582742187327127`*^9}, {3.6582742677636137`*^9, 3.658274330534523*^9}, {
   3.658274365312026*^9, 3.6582744138260403`*^9}, {3.658274810942898*^9, 
   3.658274859112701*^9}, {3.658275033847995*^9, 3.658275109340135*^9}, {
   3.658275161547172*^9, 3.6582752536631193`*^9}, {3.65827533442001*^9, 
   3.658275354865328*^9}, {3.6582755590331087`*^9, 3.658275644746291*^9}, {
   3.658275839400229*^9, 3.6582758455265408`*^9}, {3.6582758973266172`*^9, 
   3.658276032713943*^9}, {3.658276065782716*^9, 3.6582762151364822`*^9}, {
   3.658276271302123*^9, 3.6582763371711683`*^9}, 3.658276384203477*^9, {
   3.658276429293391*^9, 3.658276729581854*^9}, {3.658276847155965*^9, 
   3.6582768822910967`*^9}, 3.658277078361019*^9, {3.658277454514134*^9, 
   3.65827755246841*^9}, {3.658277707616706*^9, 3.658277724793824*^9}, {
   3.658277775557291*^9, 3.658277790046358*^9}, {3.6582778408966618`*^9, 
   3.658277880321537*^9}, {3.658277965874803*^9, 3.658278001723259*^9}, {
   3.658278068864526*^9, 3.658278122465324*^9}, {3.6582782743035307`*^9, 
   3.658278463989525*^9}, {3.658278495324057*^9, 3.6582785116036882`*^9}, {
   3.6582787258401527`*^9, 3.6582787620388193`*^9}, {3.658278813660791*^9, 
   3.658278890779448*^9}, {3.658278981426128*^9, 3.6582789851507807`*^9}, {
   3.658279023852993*^9, 3.658279071286935*^9}, {3.6582792891814613`*^9, 
   3.6582793220434237`*^9}, {3.658279596716886*^9, 3.658279661442956*^9}, {
   3.658279700093648*^9, 3.658279706815292*^9}, {3.658279792551382*^9, 
   3.658279815830398*^9}, {3.658279878622261*^9, 3.658279897713276*^9}, {
   3.658279959320986*^9, 3.658279968167665*^9}, {3.658280159539792*^9, 
   3.658280259153908*^9}, {3.658280389314715*^9, 3.658280492142959*^9}, {
   3.65828054504196*^9, 3.6582806104625673`*^9}, {3.658280703485147*^9, 
   3.6582807265634003`*^9}, {3.658280783403376*^9, 3.658280995068233*^9}, {
   3.658332125643222*^9, 3.658332285669385*^9}, {3.658332356434971*^9, 
   3.658332432532056*^9}, {3.6583324694681797`*^9, 3.658332536889868*^9}, {
   3.6583325787135487`*^9, 3.658332603918232*^9}, {3.658332777986459*^9, 
   3.658332831919935*^9}, {3.6583329211917048`*^9, 3.6583329244763107`*^9}, {
   3.65833298690902*^9, 3.6583329940420103`*^9}, {3.658333033513297*^9, 
   3.658333041965459*^9}, {3.658333140934991*^9, 3.6583331410849524`*^9}, {
   3.658333260874716*^9, 3.658333325111835*^9}, {3.6583333640450163`*^9, 
   3.658333602194475*^9}, {3.658333866428316*^9, 3.658333876484424*^9}, {
   3.6583340410637217`*^9, 3.658334041446103*^9}, {3.658334239767832*^9, 
   3.658334256853527*^9}, {3.658334325290709*^9, 3.658334328931733*^9}, {
   3.658334454601124*^9, 3.658334541125682*^9}, {3.658334583676895*^9, 
   3.658334664745475*^9}, {3.658334705147303*^9, 3.6583347127203903`*^9}, {
   3.658334814800128*^9, 3.658334905957917*^9}, {3.658334952676396*^9, 
   3.658334989092309*^9}, {3.658335053255745*^9, 3.658335071690804*^9}, {
   3.658335129550527*^9, 3.658335241594574*^9}, {3.6583353167377977`*^9, 
   3.658335317096506*^9}, {3.658335384569755*^9, 3.658335396679709*^9}, {
   3.658335459752262*^9, 3.658335474398382*^9}, {3.658335569564763*^9, 
   3.6583356135466957`*^9}, {3.658335963702228*^9, 3.6583360118223963`*^9}, {
   3.6583361961257257`*^9, 3.658336324493081*^9}, {3.658336387471901*^9, 
   3.658336413286467*^9}, {3.6583364883081408`*^9, 3.658336518027725*^9}, {
   3.6583497860827847`*^9, 3.658349831490996*^9}, {3.658349861737459*^9, 
   3.658349862153501*^9}, {3.658349942786976*^9, 3.658349965329233*^9}, {
   3.6583500320501423`*^9, 3.658350038684167*^9}, {3.6583500726428823`*^9, 
   3.658350074339263*^9}, {3.658350117777423*^9, 3.658350161383792*^9}, {
   3.6583501955208597`*^9, 3.658350234542882*^9}, {3.6583502755982323`*^9, 
   3.658350338283965*^9}, {3.658350380319613*^9, 3.6583503814310093`*^9}, {
   3.658350450869604*^9, 3.658350549946392*^9}, {3.658350685268361*^9, 
   3.6583506855161467`*^9}, {3.658350727058009*^9, 3.6583507290251617`*^9}, {
   3.658350771093258*^9, 3.658350847603608*^9}, {3.658350951089933*^9, 
   3.658350961855956*^9}, {3.658351021399521*^9, 3.658351021591137*^9}, {
   3.6583511160719757`*^9, 3.658351121390588*^9}, {3.658351310629883*^9, 
   3.658351330581682*^9}, {3.658351453089098*^9, 3.6583514579767447`*^9}, {
   3.6583514969183617`*^9, 3.6583514999993277`*^9}, {3.658351570635014*^9, 
   3.658351577593944*^9}, {3.6583516106406183`*^9, 3.658351657352182*^9}, {
   3.658351766088022*^9, 3.658351770343424*^9}, {3.658351890506502*^9, 
   3.658351904164137*^9}, {3.6583519453391848`*^9, 3.65835200222512*^9}, {
   3.658352444511814*^9, 3.6583524450885687`*^9}, {3.65835945210156*^9, 
   3.658359582160754*^9}, {3.6583597573611526`*^9, 3.658359895421398*^9}, {
   3.6583600200459547`*^9, 3.658360209087796*^9}, {3.6583604062023983`*^9, 
   3.658360556362865*^9}, {3.658369386717368*^9, 3.658369415920825*^9}, {
   3.658369495583129*^9, 3.658369511397794*^9}, {3.658369604058823*^9, 
   3.6583698687217712`*^9}, {3.658369905522255*^9, 3.658370289459115*^9}, {
   3.658435473074052*^9, 3.65843549562414*^9}, {3.658435606368175*^9, 
   3.658435611544252*^9}, {3.6584356461976643`*^9, 3.6584356582216187`*^9}, {
   3.65843569293461*^9, 3.658435693127248*^9}, {3.6584357386455507`*^9, 
   3.6584357504379663`*^9}, {3.658437328158703*^9, 3.658437328842226*^9}, {
   3.658451386320923*^9, 3.658451396416233*^9}, {3.6584514558014927`*^9, 
   3.658451498437763*^9}, {3.65845176533173*^9, 3.658451769500102*^9}, {
   3.658451827834752*^9, 3.658451828192766*^9}, {3.6584518628797626`*^9, 
   3.658451915580929*^9}, {3.658451961311802*^9, 3.658451961463069*^9}, {
   3.658452686235773*^9, 3.658452689778323*^9}, {3.6584528065184526`*^9, 
   3.658452806708708*^9}, {3.6586220651258087`*^9, 3.658622180449822*^9}, {
   3.658622217313324*^9, 3.658622381467565*^9}, {3.658622437008402*^9, 
   3.658622500999549*^9}, {3.658623683248323*^9, 3.6586241287979918`*^9}, {
   3.658624240472498*^9, 3.658624332091518*^9}, {3.6586243934910803`*^9, 
   3.6586246606532173`*^9}, {3.6773181226916533`*^9, 3.677318187212339*^9}, {
   3.677318223833849*^9, 3.677318304494225*^9}, {3.677318387435951*^9, 
   3.677318391354529*^9}, {3.677318421693688*^9, 3.67731848053815*^9}, {
   3.677318518292635*^9, 3.677318589025486*^9}, {3.677318623307369*^9, 
   3.677318659212624*^9}, {3.6773187956764297`*^9, 3.677318796630522*^9}, {
   3.677318844715273*^9, 3.6773188452284517`*^9}, {3.6774899146551743`*^9, 
   3.6774899486273317`*^9}, 3.6780963445239964`*^9, {3.6911622041325736`*^9, 
   3.6911623908649015`*^9}, {3.6911637568981695`*^9, 3.69116377596926*^9}, {
   3.6911638900637856`*^9, 3.691163905613675*^9}, {3.6924730191782584`*^9, 
   3.692473148785671*^9}, {3.6931539296446133`*^9, 
   3.6931539309706154`*^9}},ExpressionUUID->"19c57df1-dd43-496b-a6f0-\
c96a701c71d0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"EndEffectorForces", "[", 
      RowBox[{
      "thetalist_", ",", "Ftip_", ",", "Mlist_", ",", "Glist_", ",", 
       "Slist_"}], "]"}], ":", "\[IndentingNewLine]", "    ", 
     RowBox[{"Takes", " ", "thetalist"}], ":", " ", 
     RowBox[{"A", " ", "list", " ", "of", " ", "joint", " ", "variables"}]}], 
    ",", "\[IndentingNewLine]", "           ", 
    RowBox[{"Ftip", ":", " ", 
     RowBox[{
      RowBox[{
      "Spatial", " ", "force", " ", "applied", " ", "by", " ", "the", " ", 
       "end"}], "-", 
      RowBox[{"effector", " ", "expressed", " ", "in", " ", "frame", " ", 
       RowBox[{"{", 
        RowBox[{"n", "+", "1"}], "}"}]}]}]}], ",", "\[IndentingNewLine]", 
    "           ", 
    RowBox[{"Mlist", ":", " ", 
     RowBox[{
      RowBox[{
      "List", " ", "of", " ", "link", " ", "frames", " ", "i", " ", 
       "relative", " ", "to", " ", "i"}], "-", 
      RowBox[{"1", " ", "at", " ", "the", " ", "home", " ", "position"}]}]}], 
    ",", "\[IndentingNewLine]", "           ", 
    RowBox[{"Glist", ":", " ", 
     RowBox[{
     "Spatial", " ", "inertia", " ", "matrices", " ", "Gi", " ", "of", " ", 
      "the", " ", "links"}]}], ",", "\[IndentingNewLine]", "           ", 
    RowBox[{
     RowBox[{"Slist", ":", " ", 
      RowBox[{
      "Screw", " ", "axes", " ", "Si", " ", "of", " ", "the", " ", "joints", 
       " ", "in", " ", "a", " ", "space", " ", 
       RowBox[{"frame", ".", "\[IndentingNewLine]", " ", "Returns"}], " ", 
       "JTFtip"}], ":", 
      RowBox[{
       RowBox[{
       "The", " ", "joint", " ", "forces", " ", "and", " ", "torques", " ", 
        "required", " ", "only", " ", "to", " ", "create", " ", "the", " ", 
        "end"}], "-", 
       RowBox[{"effector", " ", "force", " ", 
        RowBox[{"Ftip", ".", "\[IndentingNewLine]", "This"}], " ", "function",
         " ", "calls", " ", "InverseDynamics", " ", "with", " ", "g"}]}]}], 
     "=", "0"}], ",", 
    RowBox[{"dthetalist", "=", "0"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"and", " ", "ddthetalist"}], "=", "0."}], "\[IndentingNewLine]",
      ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Example", " ", "Input", " ", 
        RowBox[{"(", 
         RowBox[{"3", " ", "Link", " ", "Robot"}], ")"}]}], ":", 
       "\[IndentingNewLine]", "thetalist"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", "0.1", ",", "0.1"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "  ", "\[IndentingNewLine]", "  ", 
     RowBox[{"Ftip", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
         "}"}], "}"}], "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"M01", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.089159"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M12", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.28"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0.13585"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M23", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", 
          RowBox[{"-", "0.1197"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.395"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M34", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.14225"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"G1", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.010267", ",", "0.010267", ",", "0.00666", ",", "3.7", ",", "3.7", 
         ",", "3.7"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"G2", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.22689", ",", "0.22689", ",", "0.0151074", ",", "8.393", ",", 
         "8.393", ",", "8.393"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "  ", 
     RowBox[{"G3", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.0494433", ",", "0.0494433", ",", "0.004095", ",", "2.275", ",", 
         "2.275", ",", "2.275"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "  ", 
     RowBox[{"Glist", "=", 
      RowBox[{"{", 
       RowBox[{"G1", ",", "G2", ",", "G3"}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Mlist", "=", 
      RowBox[{"{", 
       RowBox[{"M01", ",", "M12", ",", "M23", ",", "M34"}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Slist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0.425"}], "}"}]}], "}"}], 
       "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"JTFtip", " ", "=", " ", 
      RowBox[{
       RowBox[{"EndEffectorForces", "[", 
        RowBox[{
        "thetalist", ",", "Ftip", ",", "Mlist", ",", "Glist", ",", "Slist"}], 
        "]"}], "\[IndentingNewLine]", 
       RowBox[{"Output", ":", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1.4095460782639782", "}"}], ",", 
          RowBox[{"{", "1.8577149723180628", "}"}], ",", 
          RowBox[{"{", "1.392409", "}"}]}], "}"}]}]}]}]}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"EndEffectorForces", "[", 
     RowBox[{
     "thetalist_", ",", "Ftip_", ",", "Mlist_", ",", "Glist_", ",", 
      "Slist_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "thetalist", "]"}]}], "}"}], ",", 
      RowBox[{"Return", "[", 
       RowBox[{"InverseDynamics", "[", 
        RowBox[{"thetalist", ",", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1"}], "}"}]}], "]"}], ",", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1"}], "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}], "\[Transpose]"}],
          ",", "Ftip", ",", "Mlist", ",", "Glist", ",", "Slist"}], "]"}], 
       "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.677319029687563*^9, 3.677319233082024*^9}, {
   3.677319283141276*^9, 3.677319344821434*^9}, {3.6774904635778027`*^9, 
   3.677490465727865*^9}, 3.678096352332324*^9, {3.691163661939738*^9, 
   3.691163750908827*^9}, {3.6911637930762386`*^9, 3.69116382632514*^9}, {
   3.6911639372694855`*^9, 3.691164030416814*^9}, {3.692473168599805*^9, 
   3.6924732701186113`*^9}, {3.693153936056225*^9, 
   3.6931539374914274`*^9}},ExpressionUUID->"4123ea26-48e5-44da-8143-\
ee8d46f0bb0f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"ForwardDynamics", "[", 
      RowBox[{
      "thetalist_", ",", "dthetalist_", ",", "taulist_", ",", "g_", ",", 
       "Ftip_", ",", "Mlist_", ",", "Glist_", ",", "Slist_"}], "]"}], ":", 
     "\[IndentingNewLine]", "   ", 
     RowBox[{"Takes", " ", "thetalist"}], ":", " ", 
     RowBox[{"A", " ", "list", " ", "of", " ", "joint", " ", "variables"}]}], 
    ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"dthetalist", ":", " ", 
     RowBox[{"A", " ", "list", " ", "of", " ", "joint", " ", "rates"}]}], ",",
     "\[IndentingNewLine]", "          ", 
    RowBox[{"taulist", ":", " ", 
     RowBox[{
      RowBox[{"An", " ", "n"}], "-", 
      RowBox[{"vector", " ", "of", " ", "joint", " ", 
       RowBox[{"forces", "/", "torques"}]}]}]}], ",", "\[IndentingNewLine]", 
    "          ", 
    RowBox[{"g", ":", " ", 
     RowBox[{"Gravity", " ", "vector", " ", "g"}]}], ",", 
    "\[IndentingNewLine]", "          ", 
    RowBox[{"Ftip", ":", " ", 
     RowBox[{
      RowBox[{
      "Spatial", " ", "force", " ", "applied", " ", "by", " ", "the", " ", 
       "end"}], "-", 
      RowBox[{"effector", " ", "expressed", " ", "in", " ", "frame", " ", 
       RowBox[{"{", 
        RowBox[{"n", "+", "1"}], "}"}]}]}]}], ",", "                ", 
    "\[IndentingNewLine]", "          ", 
    RowBox[{"Mlist", ":", " ", 
     RowBox[{
      RowBox[{
      "List", " ", "of", " ", "link", " ", "frames", " ", "i", " ", 
       "relative", " ", "to", " ", "i"}], "-", 
      RowBox[{"1", " ", "at", " ", "the", " ", "home", " ", "position"}]}]}], 
    ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"Glist", ":", " ", 
     RowBox[{
     "Spatial", " ", "inertia", " ", "matrices", " ", "Gi", " ", "of", " ", 
      "the", " ", "links"}]}], ",", "\[IndentingNewLine]", "          ", 
    RowBox[{
     RowBox[{
      RowBox[{"Slist", ":", " ", 
       RowBox[{
       "Screw", " ", "axes", " ", "Si", " ", "of", " ", "the", " ", "joints", 
        " ", "in", " ", "a", " ", "space", " ", 
        RowBox[{"frame", ".", "\[IndentingNewLine]", "Returns"}], " ", 
        "ddthetalist"}], ":", " ", 
       RowBox[{"The", " ", "resulting", " ", "joint", " ", 
        RowBox[{"accelerations", ".", "\[IndentingNewLine]", "This"}], " ", 
        "function", " ", "computes", " ", "ddthetalist", " ", "by", " ", 
        RowBox[{"solving", ":", "\[IndentingNewLine]", 
         RowBox[{"Mlist", 
          RowBox[{"(", "thetalist", ")"}], "ddthetalist"}]}]}]}], "=", 
      RowBox[{"taulist", "-", 
       RowBox[{"c", 
        RowBox[{"(", 
         RowBox[{"thetalist", ",", "dthetalist"}], ")"}]}], "-", 
       RowBox[{"g", 
        RowBox[{"(", "thetalist", ")"}]}], "-", 
       RowBox[{"Jtr", 
        RowBox[{"(", "thetalist", ")"}], "Ftip"}]}]}], "\[IndentingNewLine]", 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Example", " ", "Input", " ", 
        RowBox[{"(", 
         RowBox[{"3", " ", "Link", " ", "Robot"}], ")"}]}], ":", 
       "\[IndentingNewLine]", "thetalist"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", "0.1", ",", "0.1"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"dthetalist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", "0.2", ",", "0.3"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"taulist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.5", ",", "0.6", ",", "0.7"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "  ", "\[IndentingNewLine]", "  ", 
     RowBox[{"g", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"-", "9.8"}]}], "}"}], "}"}], "\[Transpose]"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Ftip", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
         "}"}], "}"}], "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"M01", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.089159"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M12", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.28"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0.13585"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M23", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", 
          RowBox[{"-", "0.1197"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.395"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M34", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.14225"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"G1", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.010267", ",", "0.010267", ",", "0.00666", ",", "3.7", ",", "3.7", 
         ",", "3.7"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"G2", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.22689", ",", "0.22689", ",", "0.0151074", ",", "8.393", ",", 
         "8.393", ",", "8.393"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "  ", 
     RowBox[{"G3", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.0494433", ",", "0.0494433", ",", "0.004095", ",", "2.275", ",", 
         "2.275", ",", "2.275"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "  ", 
     RowBox[{"Glist", "=", 
      RowBox[{"{", 
       RowBox[{"G1", ",", "G2", ",", "G3"}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Mlist", "=", 
      RowBox[{"{", 
       RowBox[{"M01", ",", "M12", ",", "M23", ",", "M34"}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Slist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0.425"}], "}"}]}], "}"}], 
       "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"ddthetalist", " ", "=", " ", 
      RowBox[{
       RowBox[{"ForwardDynamics", "[", 
        RowBox[{
        "thetalist", ",", "dthetalist", ",", "taulist", ",", "g", ",", "Ftip",
          ",", "Mlist", ",", "Glist", ",", "Slist"}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Output", ":", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"-", "0.9739290670855624"}], "}"}], ",", 
          RowBox[{"{", "25.584667840340558", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"-", "32.91499212478149"}], "}"}]}], "}"}]}]}]}]}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ForwardDynamics", "[", 
     RowBox[{
     "thetalist_", ",", "dthetalist_", ",", "taulist_", ",", "g_", ",", 
      "Ftip_", ",", "Mlist_", ",", "Glist_", ",", "Slist_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Inverse", "[", 
      RowBox[{"MassMatrix", "[", 
       RowBox[{"thetalist", ",", "Mlist", ",", "Glist", ",", "Slist"}], "]"}],
       "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"taulist", " ", "-", " ", 
       RowBox[{"VelQuadraticForces", "[", 
        RowBox[{
        "thetalist", ",", "dthetalist", ",", "Mlist", ",", "Glist", ",", 
         "Slist"}], "]"}], "-", 
       RowBox[{"GravityForces", "[", 
        RowBox[{
        "thetalist", ",", "g", ",", "Mlist", ",", "Glist", ",", "Slist"}], 
        "]"}], "-", 
       RowBox[{"EndEffectorForces", "[", 
        RowBox[{
        "thetalist", ",", "Ftip", ",", "Mlist", ",", "Glist", ",", "Slist"}], 
        "]"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.658273872689763*^9, 3.658273988902459*^9}, {
   3.658274157743518*^9, 3.6582741742369556`*^9}, {3.65827421723704*^9, 
   3.6582742187327127`*^9}, {3.6582742677636137`*^9, 3.658274330534523*^9}, {
   3.658274365312026*^9, 3.6582744138260403`*^9}, {3.658274810942898*^9, 
   3.658274859112701*^9}, {3.658275033847995*^9, 3.658275109340135*^9}, {
   3.658275161547172*^9, 3.6582752536631193`*^9}, {3.65827533442001*^9, 
   3.658275354865328*^9}, {3.6582755590331087`*^9, 3.658275644746291*^9}, {
   3.658275839400229*^9, 3.6582758455265408`*^9}, {3.6582758973266172`*^9, 
   3.658276032713943*^9}, {3.658276065782716*^9, 3.6582762151364822`*^9}, {
   3.658276271302123*^9, 3.6582763371711683`*^9}, 3.658276384203477*^9, {
   3.658276429293391*^9, 3.658276729581854*^9}, {3.658276847155965*^9, 
   3.6582768822910967`*^9}, 3.658277078361019*^9, {3.658277454514134*^9, 
   3.65827755246841*^9}, {3.658277707616706*^9, 3.658277724793824*^9}, {
   3.658277775557291*^9, 3.658277790046358*^9}, {3.6582778408966618`*^9, 
   3.658277880321537*^9}, {3.658277965874803*^9, 3.658278001723259*^9}, {
   3.658278068864526*^9, 3.658278122465324*^9}, {3.6582782743035307`*^9, 
   3.658278463989525*^9}, {3.658278495324057*^9, 3.6582785116036882`*^9}, {
   3.6582787258401527`*^9, 3.6582787620388193`*^9}, {3.658278813660791*^9, 
   3.658278890779448*^9}, {3.658278981426128*^9, 3.6582789851507807`*^9}, {
   3.658279023852993*^9, 3.658279071286935*^9}, {3.6582792891814613`*^9, 
   3.6582793220434237`*^9}, {3.658279596716886*^9, 3.658279661442956*^9}, {
   3.658279700093648*^9, 3.658279706815292*^9}, {3.658279792551382*^9, 
   3.658279815830398*^9}, {3.658279878622261*^9, 3.658279897713276*^9}, {
   3.658279959320986*^9, 3.658279968167665*^9}, {3.658280159539792*^9, 
   3.658280259153908*^9}, {3.658280389314715*^9, 3.658280492142959*^9}, {
   3.65828054504196*^9, 3.6582806104625673`*^9}, {3.658280703485147*^9, 
   3.6582807265634003`*^9}, {3.658280783403376*^9, 3.658280995068233*^9}, {
   3.658332125643222*^9, 3.658332285669385*^9}, {3.658332356434971*^9, 
   3.658332432532056*^9}, {3.6583324694681797`*^9, 3.658332536889868*^9}, {
   3.6583325787135487`*^9, 3.658332603918232*^9}, {3.658332777986459*^9, 
   3.658332831919935*^9}, {3.6583329211917048`*^9, 3.6583329244763107`*^9}, {
   3.65833298690902*^9, 3.6583329940420103`*^9}, {3.658333033513297*^9, 
   3.658333041965459*^9}, {3.658333140934991*^9, 3.6583331410849524`*^9}, {
   3.658333260874716*^9, 3.658333325111835*^9}, {3.6583333640450163`*^9, 
   3.658333602194475*^9}, {3.658333866428316*^9, 3.658333876484424*^9}, {
   3.6583340410637217`*^9, 3.658334041446103*^9}, {3.658334239767832*^9, 
   3.658334256853527*^9}, {3.658334325290709*^9, 3.658334328931733*^9}, {
   3.658334454601124*^9, 3.658334541125682*^9}, {3.658334583676895*^9, 
   3.658334664745475*^9}, {3.658334705147303*^9, 3.6583347127203903`*^9}, {
   3.658334814800128*^9, 3.658334905957917*^9}, {3.658334952676396*^9, 
   3.658334989092309*^9}, {3.658335053255745*^9, 3.658335071690804*^9}, {
   3.658335129550527*^9, 3.658335241594574*^9}, {3.6583353167377977`*^9, 
   3.658335317096506*^9}, {3.658335384569755*^9, 3.658335396679709*^9}, {
   3.658335459752262*^9, 3.658335474398382*^9}, {3.658335569564763*^9, 
   3.6583356135466957`*^9}, {3.658335963702228*^9, 3.6583360118223963`*^9}, {
   3.6583361961257257`*^9, 3.658336324493081*^9}, {3.658336387471901*^9, 
   3.658336413286467*^9}, {3.6583364883081408`*^9, 3.658336518027725*^9}, {
   3.6583497860827847`*^9, 3.658349831490996*^9}, {3.658349861737459*^9, 
   3.658349862153501*^9}, {3.658349942786976*^9, 3.658349965329233*^9}, {
   3.6583500320501423`*^9, 3.658350038684167*^9}, {3.6583500726428823`*^9, 
   3.658350074339263*^9}, {3.658350117777423*^9, 3.658350161383792*^9}, {
   3.6583501955208597`*^9, 3.658350234542882*^9}, {3.6583502755982323`*^9, 
   3.658350338283965*^9}, {3.658350380319613*^9, 3.6583503814310093`*^9}, {
   3.658350450869604*^9, 3.658350549946392*^9}, {3.658350685268361*^9, 
   3.6583506855161467`*^9}, {3.658350727058009*^9, 3.6583507290251617`*^9}, {
   3.658350771093258*^9, 3.658350847603608*^9}, {3.658350951089933*^9, 
   3.658350961855956*^9}, {3.658351021399521*^9, 3.658351021591137*^9}, {
   3.6583511160719757`*^9, 3.658351121390588*^9}, {3.658351310629883*^9, 
   3.658351330581682*^9}, {3.658351453089098*^9, 3.6583514579767447`*^9}, {
   3.6583514969183617`*^9, 3.6583514999993277`*^9}, {3.658351570635014*^9, 
   3.658351577593944*^9}, {3.6583516106406183`*^9, 3.658351657352182*^9}, {
   3.658351766088022*^9, 3.658351770343424*^9}, {3.658351890506502*^9, 
   3.658351904164137*^9}, {3.6583519453391848`*^9, 3.65835200222512*^9}, {
   3.658352444511814*^9, 3.6583524450885687`*^9}, {3.65835945210156*^9, 
   3.658359582160754*^9}, {3.6583597573611526`*^9, 3.658359895421398*^9}, {
   3.6583600200459547`*^9, 3.658360209087796*^9}, {3.6583604062023983`*^9, 
   3.658360556362865*^9}, {3.658369386717368*^9, 3.658369415920825*^9}, {
   3.658369495583129*^9, 3.658369511397794*^9}, {3.658369604058823*^9, 
   3.6583698687217712`*^9}, {3.658369905522255*^9, 3.658370289459115*^9}, {
   3.658435473074052*^9, 3.65843549562414*^9}, {3.658435606368175*^9, 
   3.658435611544252*^9}, {3.6584356461976643`*^9, 3.6584356582216187`*^9}, {
   3.65843569293461*^9, 3.658435693127248*^9}, {3.6584357386455507`*^9, 
   3.6584357504379663`*^9}, {3.658437328158703*^9, 3.658437328842226*^9}, {
   3.658451386320923*^9, 3.658451396416233*^9}, {3.6584514558014927`*^9, 
   3.658451498437763*^9}, {3.65845176533173*^9, 3.658451769500102*^9}, {
   3.658451827834752*^9, 3.658451828192766*^9}, {3.6584518628797626`*^9, 
   3.658451915580929*^9}, {3.658451961311802*^9, 3.658451961463069*^9}, {
   3.658452686235773*^9, 3.658452689778323*^9}, {3.6584528065184526`*^9, 
   3.658452806708708*^9}, {3.6586220651258087`*^9, 3.658622180449822*^9}, {
   3.658622217313324*^9, 3.658622381467565*^9}, {3.658622437008402*^9, 
   3.658622500999549*^9}, {3.658623683248323*^9, 3.6586241287979918`*^9}, {
   3.658624240472498*^9, 3.658624332091518*^9}, {3.6586243934910803`*^9, 
   3.6586246606532173`*^9}, {3.677319777222876*^9, 3.677319911210836*^9}, {
   3.677319978967498*^9, 3.6773200301939793`*^9}, {3.677320101176361*^9, 
   3.677320165996676*^9}, {3.677320275527318*^9, 3.677320277148011*^9}, {
   3.6773204032483463`*^9, 3.677320433741617*^9}, {3.67732052567733*^9, 
   3.677320526931965*^9}, {3.677320560922406*^9, 3.6773205774510202`*^9}, {
   3.6773206325151443`*^9, 3.677320917826007*^9}, {3.677320961401045*^9, 
   3.6773210650000067`*^9}, {3.67749047640164*^9, 3.677490476845508*^9}, 
   3.678096359107258*^9, 3.67844919580091*^9, 3.681451022756323*^9, 
   3.691166174765463*^9, {3.6911708289592667`*^9, 3.691170882040303*^9}, {
   3.691170930136054*^9, 3.6911710045903125`*^9}, {3.6924737024313383`*^9, 
   3.6924738363019953`*^9}, {3.6931539414694343`*^9, 
   3.6931539445738397`*^9}},ExpressionUUID->"47a89191-6003-4b60-98e7-\
190c1275e8ec"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"EulerStep", "[", 
      RowBox[{
      "thetalist_", ",", "dthetalist_", ",", "ddthetalist_", ",", "dt_"}], 
      "]"}], ":", "\[IndentingNewLine]", "  ", 
     RowBox[{"Takes", " ", "thetalist"}], ":", " ", 
     RowBox[{"n", "-", 
      RowBox[{"vector", " ", "of", " ", "joint", " ", "variables"}]}]}], ",", 
    "\[IndentingNewLine]", "         ", 
    RowBox[{"dthetalist", ":", " ", 
     RowBox[{"n", "-", 
      RowBox[{"vector", " ", "of", " ", "joint", " ", "rates"}]}]}], ",", 
    "\[IndentingNewLine]", "         ", 
    RowBox[{"ddthetalist", ":", " ", 
     RowBox[{"n", "-", 
      RowBox[{"vector", " ", "of", " ", "joint", " ", "accelerations"}]}]}], 
    ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"dt", ":", " ", 
     RowBox[{"The", " ", "timestep", " ", "delta", " ", 
      RowBox[{"t", ".", "\[IndentingNewLine]", "Returns"}], " ", 
      "thetalistNext"}], ":", " ", 
     RowBox[{
     "Vector", " ", "of", " ", "joint", " ", "variables", " ", "after", " ", 
      "dt", " ", "from", " ", "first", " ", "order", " ", "Euler", " ", 
      "integration"}]}], ",", "\[IndentingNewLine]", "           ", 
    RowBox[{
     RowBox[{"dthetalistNext", ":", " ", 
      RowBox[{
      "Vector", " ", "of", " ", "joint", " ", "rates", " ", "after", " ", 
       "dt", " ", "from", " ", "first", " ", "order", " ", "Euler", " ", 
       RowBox[{"integration", "."}]}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Example", " ", "Inputs", " ", 
        RowBox[{"(", 
         RowBox[{"3", " ", "Link", " ", "Robot"}], ")"}]}], ":", 
       "\[IndentingNewLine]", "thetalist"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", "0.1", ",", "0.1"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\n", 
     RowBox[{"dthetalist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", "0.2", ",", "0.3"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\n", 
     RowBox[{"ddthetalist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"2", ",", "1.5", ",", "1"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\n", 
     RowBox[{"dt", "=", "0.1"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"thetalistNext", ",", "dthetalistNext"}], "}"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"EulerStep", "[", 
        RowBox[{
        "thetalist", ",", "dthetalist", ",", "ddthetalist", ",", "dt"}], 
        "]"}], "\[IndentingNewLine]", 
       RowBox[{"Output", ":", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "0.11", "}"}], ",", 
            RowBox[{"{", "0.12", "}"}], ",", 
            RowBox[{"{", "0.13", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "0.3", "}"}], ",", 
            RowBox[{"{", "0.35", "}"}], ",", 
            RowBox[{"{", "0.4", "}"}]}], "}"}]}], "}"}]}]}]}]}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"EulerStep", "[", 
     RowBox[{
     "thetalist_", ",", "dthetalist_", ",", "ddthetalist_", ",", "dt_"}], 
     "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"thetalist", " ", "+", " ", 
       RowBox[{"dt", "*", "dthetalist"}]}], ",", 
      RowBox[{"dthetalist", " ", "+", " ", 
       RowBox[{"dt", "*", "ddthetalist"}]}]}], "}"}]}], "\[IndentingNewLine]",
    "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.658273872689763*^9, 3.658273988902459*^9}, {
   3.658274157743518*^9, 3.6582741742369556`*^9}, {3.65827421723704*^9, 
   3.6582742187327127`*^9}, {3.6582742677636137`*^9, 3.658274330534523*^9}, {
   3.658274365312026*^9, 3.6582744138260403`*^9}, {3.658274810942898*^9, 
   3.658274859112701*^9}, {3.658275033847995*^9, 3.658275109340135*^9}, {
   3.658275161547172*^9, 3.6582752536631193`*^9}, {3.65827533442001*^9, 
   3.658275354865328*^9}, {3.6582755590331087`*^9, 3.658275644746291*^9}, {
   3.658275839400229*^9, 3.6582758455265408`*^9}, {3.6582758973266172`*^9, 
   3.658276032713943*^9}, {3.658276065782716*^9, 3.6582762151364822`*^9}, {
   3.658276271302123*^9, 3.6582763371711683`*^9}, 3.658276384203477*^9, {
   3.658276429293391*^9, 3.658276729581854*^9}, {3.658276847155965*^9, 
   3.6582768822910967`*^9}, 3.658277078361019*^9, {3.658277454514134*^9, 
   3.65827755246841*^9}, {3.658277707616706*^9, 3.658277724793824*^9}, {
   3.658277775557291*^9, 3.658277790046358*^9}, {3.6582778408966618`*^9, 
   3.658277880321537*^9}, {3.658277965874803*^9, 3.658278001723259*^9}, {
   3.658278068864526*^9, 3.658278122465324*^9}, {3.6582782743035307`*^9, 
   3.658278463989525*^9}, {3.658278495324057*^9, 3.6582785116036882`*^9}, {
   3.6582787258401527`*^9, 3.6582787620388193`*^9}, {3.658278813660791*^9, 
   3.658278890779448*^9}, {3.658278981426128*^9, 3.6582789851507807`*^9}, {
   3.658279023852993*^9, 3.658279071286935*^9}, {3.6582792891814613`*^9, 
   3.6582793220434237`*^9}, {3.658279596716886*^9, 3.658279661442956*^9}, {
   3.658279700093648*^9, 3.658279706815292*^9}, {3.658279792551382*^9, 
   3.658279815830398*^9}, {3.658279878622261*^9, 3.658279897713276*^9}, {
   3.658279959320986*^9, 3.658279968167665*^9}, {3.658280159539792*^9, 
   3.658280259153908*^9}, {3.658280389314715*^9, 3.658280492142959*^9}, {
   3.65828054504196*^9, 3.6582806104625673`*^9}, {3.658280703485147*^9, 
   3.6582807265634003`*^9}, {3.658280783403376*^9, 3.658280995068233*^9}, {
   3.658332125643222*^9, 3.658332285669385*^9}, {3.658332356434971*^9, 
   3.658332432532056*^9}, {3.6583324694681797`*^9, 3.658332536889868*^9}, {
   3.6583325787135487`*^9, 3.658332603918232*^9}, {3.658332777986459*^9, 
   3.658332831919935*^9}, {3.6583329211917048`*^9, 3.6583329244763107`*^9}, {
   3.65833298690902*^9, 3.6583329940420103`*^9}, {3.658333033513297*^9, 
   3.658333041965459*^9}, {3.658333140934991*^9, 3.6583331410849524`*^9}, {
   3.658333260874716*^9, 3.658333325111835*^9}, {3.6583333640450163`*^9, 
   3.658333602194475*^9}, {3.658333866428316*^9, 3.658333876484424*^9}, {
   3.6583340410637217`*^9, 3.658334041446103*^9}, {3.658334239767832*^9, 
   3.658334256853527*^9}, {3.658334325290709*^9, 3.658334328931733*^9}, {
   3.658334454601124*^9, 3.658334541125682*^9}, {3.658334583676895*^9, 
   3.658334664745475*^9}, {3.658334705147303*^9, 3.6583347127203903`*^9}, {
   3.658334814800128*^9, 3.658334905957917*^9}, {3.658334952676396*^9, 
   3.658334989092309*^9}, {3.658335053255745*^9, 3.658335071690804*^9}, {
   3.658335129550527*^9, 3.658335241594574*^9}, {3.6583353167377977`*^9, 
   3.658335317096506*^9}, {3.658335384569755*^9, 3.658335396679709*^9}, {
   3.658335459752262*^9, 3.658335474398382*^9}, {3.658335569564763*^9, 
   3.6583356135466957`*^9}, {3.658335963702228*^9, 3.6583360118223963`*^9}, {
   3.6583361961257257`*^9, 3.658336324493081*^9}, {3.658336387471901*^9, 
   3.658336413286467*^9}, {3.6583364883081408`*^9, 3.658336518027725*^9}, {
   3.6583497860827847`*^9, 3.658349831490996*^9}, {3.658349861737459*^9, 
   3.658349862153501*^9}, {3.658349942786976*^9, 3.658349965329233*^9}, {
   3.6583500320501423`*^9, 3.658350038684167*^9}, {3.6583500726428823`*^9, 
   3.658350074339263*^9}, {3.658350117777423*^9, 3.658350161383792*^9}, {
   3.6583501955208597`*^9, 3.658350234542882*^9}, {3.6583502755982323`*^9, 
   3.658350338283965*^9}, {3.658350380319613*^9, 3.6583503814310093`*^9}, {
   3.658350450869604*^9, 3.658350549946392*^9}, {3.658350685268361*^9, 
   3.6583506855161467`*^9}, {3.658350727058009*^9, 3.6583507290251617`*^9}, {
   3.658350771093258*^9, 3.658350847603608*^9}, {3.658350951089933*^9, 
   3.658350961855956*^9}, {3.658351021399521*^9, 3.658351021591137*^9}, {
   3.6583511160719757`*^9, 3.658351121390588*^9}, {3.658351310629883*^9, 
   3.658351330581682*^9}, {3.658351453089098*^9, 3.6583514579767447`*^9}, {
   3.6583514969183617`*^9, 3.6583514999993277`*^9}, {3.658351570635014*^9, 
   3.658351577593944*^9}, {3.6583516106406183`*^9, 3.658351657352182*^9}, {
   3.658351766088022*^9, 3.658351770343424*^9}, {3.658351890506502*^9, 
   3.658351904164137*^9}, {3.6583519453391848`*^9, 3.65835200222512*^9}, {
   3.658352444511814*^9, 3.6583524450885687`*^9}, {3.65835945210156*^9, 
   3.658359582160754*^9}, {3.6583597573611526`*^9, 3.658359895421398*^9}, {
   3.6583600200459547`*^9, 3.658360209087796*^9}, {3.6583604062023983`*^9, 
   3.658360556362865*^9}, {3.658369386717368*^9, 3.658369415920825*^9}, {
   3.658369495583129*^9, 3.658369511397794*^9}, {3.658369604058823*^9, 
   3.6583698687217712`*^9}, {3.658369905522255*^9, 3.658370289459115*^9}, {
   3.658435473074052*^9, 3.65843549562414*^9}, {3.658435606368175*^9, 
   3.658435611544252*^9}, {3.6584356461976643`*^9, 3.6584356582216187`*^9}, {
   3.65843569293461*^9, 3.658435693127248*^9}, {3.6584357386455507`*^9, 
   3.6584357504379663`*^9}, {3.658437328158703*^9, 3.658437328842226*^9}, {
   3.658451386320923*^9, 3.658451396416233*^9}, {3.6584514558014927`*^9, 
   3.658451498437763*^9}, {3.65845176533173*^9, 3.658451769500102*^9}, {
   3.658451827834752*^9, 3.658451828192766*^9}, {3.6584518628797626`*^9, 
   3.658451915580929*^9}, {3.658451961311802*^9, 3.658451961463069*^9}, {
   3.658452686235773*^9, 3.658452689778323*^9}, {3.6584528065184526`*^9, 
   3.658452806708708*^9}, {3.6586220651258087`*^9, 3.658622180449822*^9}, {
   3.658622217313324*^9, 3.658622381467565*^9}, {3.658622437008402*^9, 
   3.658622500999549*^9}, {3.658623683248323*^9, 3.6586241287979918`*^9}, {
   3.658624240472498*^9, 3.658624332091518*^9}, {3.6586243934910803`*^9, 
   3.6586246606532173`*^9}, {3.6773212430112534`*^9, 
   3.6773213088789883`*^9}, {3.677321361759098*^9, 3.677321367090461*^9}, {
   3.677321470715757*^9, 3.6773215552292967`*^9}, {3.677321669275291*^9, 
   3.677321799799973*^9}, {3.6773218479713087`*^9, 3.6773219232750673`*^9}, 
   3.6774148217031*^9, 3.677414865205659*^9, 3.6780963661744823`*^9, {
   3.6911724756653557`*^9, 3.6911726325784492`*^9}, {3.6924738579022303`*^9, 
   3.692473911180278*^9}, {3.6931539485206466`*^9, 
   3.6931539497374487`*^9}},ExpressionUUID->"47d60faa-97d7-4107-acdf-\
b11826f0060d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"InverseDynamicsTrajectory", "[", 
      RowBox[{
      "thetamat_", ",", "dthetamat_", ",", "ddthetamat_", ",", "g_", ",", 
       "Ftipmat_", ",", "Mlist_", ",", "Glist_", ",", "Slist_"}], "]"}], ":", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Takes", " ", "thetamat"}], ":", " ", 
     RowBox[{
     "An", " ", "N", " ", "x", " ", "n", " ", "matrix", " ", "of", " ", 
      "robot", " ", "joint", " ", "variables"}]}], ",", "\[IndentingNewLine]",
     "         ", 
    RowBox[{"dthetamat", ":", " ", 
     RowBox[{
     "An", " ", "N", " ", "x", " ", "n", " ", "matrix", " ", "of", " ", 
      "robot", " ", "joint", " ", "velocities"}]}], ",", 
    "\[IndentingNewLine]", "         ", 
    RowBox[{"ddthetamat", ":", " ", 
     RowBox[{
     "An", " ", "N", " ", "x", " ", "n", " ", "matrix", " ", "of", " ", 
      "robot", " ", "joint", " ", "accelerations"}]}], ",", 
    "\[IndentingNewLine]", "         ", 
    RowBox[{"g", ":", " ", 
     RowBox[{"Gravity", " ", "vector", " ", "g"}]}], ",", 
    "\[IndentingNewLine]", "         ", 
    RowBox[{"Ftipmat", ":", " ", 
     RowBox[{
      RowBox[{
      "An", " ", "N", " ", "x", " ", "6", " ", "matrix", " ", "of", " ", 
       "spatial", " ", "forces", " ", "applied", " ", "by", " ", "the", " ", 
       "end"}], "-", 
      RowBox[{"effector", " ", 
       RowBox[{"(", 
        RowBox[{
        "If", " ", "there", " ", "are", " ", "no", " ", "tip", " ", "forces", 
         " ", "the", " ", "user", " ", "should", " ", "input", " ", "a", " ", 
         "zero", " ", "and", " ", "a", " ", "zero", " ", "matrix", " ", 
         "will", " ", "be", " ", "used"}], ")"}]}]}]}], ",", 
    "\[IndentingNewLine]", "         ", 
    RowBox[{"Mlist", ":", " ", 
     RowBox[{
      RowBox[{
      "List", " ", "of", " ", "link", " ", "frames", " ", "i", " ", 
       "relative", " ", "to", " ", "i"}], "-", 
      RowBox[{"1", " ", "at", " ", "the", " ", "home", " ", "position"}]}]}], 
    ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"Glist", ":", " ", 
     RowBox[{
     "Spatial", " ", "inertia", " ", "matrices", " ", "Gi", " ", "of", " ", 
      "the", " ", "links"}]}], ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"Slist", ":", " ", 
     RowBox[{
     "Screw", " ", "axes", " ", "Si", " ", "of", " ", "the", " ", "joints", 
      " ", "in", " ", "a", " ", "space", " ", 
      RowBox[{"frame", ".", "\[IndentingNewLine]", "Returns"}], " ", 
      "taumat"}], ":", " ", 
     RowBox[{
     "The", " ", "N", " ", "x", " ", "n", " ", "matrix", " ", "of", " ", 
      "joint", " ", 
      RowBox[{"forces", "/", "torques"}], " ", "for", " ", "the", " ", 
      "specified", " ", "trajectory"}]}], ",", 
    RowBox[{
     RowBox[{
     "where", " ", "each", " ", "of", " ", "the", " ", "N", " ", "rows", " ", 
      "is", " ", "the", " ", "vector", " ", "of", " ", "joint", " ", 
      RowBox[{"forces", "/", "torques"}], " ", "at", " ", "each", " ", "time",
       " ", 
      RowBox[{"step", ".", "\[IndentingNewLine]", " ", "This"}], " ", 
      "function", " ", "uses", " ", "InverseDynamics", " ", "to", " ", 
      "calculate", " ", "the", " ", "joint", " ", 
      RowBox[{"forces", "/", "torques"}], " ", "required", " ", "to", " ", 
      "move", " ", "the", " ", "serial", " ", "chain", " ", "along", " ", 
      "the", " ", "given", " ", 
      RowBox[{"trajectory", "."}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Example", " ", 
       RowBox[{"Input", ":", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Create", " ", "a", " ", "trajectory", " ", "to", " ", "follow", " ",
           "using", " ", "functions", " ", "from", " ", "Chapter", " ", "9"}],
          "*)"}], "\n", "thetastart"}]}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}], "\[Transpose]"}]}], 
     ";", "\n", 
     RowBox[{"thetaend", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Pi", "/", "2"}], ",", 
          RowBox[{"Pi", "/", "2"}], ",", 
          RowBox[{"Pi", "/", "2"}]}], "}"}], "}"}], "\[Transpose]"}]}], ";", 
     "\n", 
     RowBox[{"Tf", "=", "3"}], ";", "\n", 
     RowBox[{"No", "=", "1000"}], ";", "\n", 
     RowBox[{"method", "=", "5"}], ";", "\n", 
     RowBox[{"traj", "=", 
      RowBox[{"JointTrajectory", "[", 
       RowBox[{
       "thetastart", ",", "thetaend", ",", "Tf", ",", "No", ",", "method"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"thetamat", "=", "traj"}], ";", "\n", 
     RowBox[{"dthetamat", "=", "traj"}], ";", "\n", 
     RowBox[{"ddthetamat", "=", "traj"}], ";", "\n", 
     RowBox[{"dt", "=", 
      RowBox[{"Tf", "/", 
       RowBox[{"(", 
        RowBox[{"No", "-", "1.0"}], ")"}]}]}], ";", "\n", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"dthetamat", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", ";;"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"thetamat", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", ";;"}], "]"}], "]"}], "-", 
            RowBox[{"thetamat", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"i", "-", "1"}], ",", ";;"}], "]"}], "]"}]}], ")"}], 
          "/", "dt"}]}], ";", "\n", 
        RowBox[{
         RowBox[{"ddthetamat", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", ";;"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"dthetamat", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", ";;"}], "]"}], "]"}], "-", 
            RowBox[{"dthetamat", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"i", "-", "1"}], ",", ";;"}], "]"}], "]"}]}], ")"}], 
          "/", "dt"}]}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "traj", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Initialise", " ", "robot", " ", "descripstion", " ", 
       RowBox[{"(", 
        RowBox[{"Example", " ", "with", " ", "3", " ", "links"}], ")"}]}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"g", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"-", "9.8"}]}], "}"}], "}"}], "\[Transpose]"}]}], ";", "\n", 
     RowBox[{"Ftipmat", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"1", ",", 
        RowBox[{"{", 
         RowBox[{"No", ",", "6"}], "}"}]}], "]"}]}], ";", "\n", 
     RowBox[{"M01", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.089159"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     RowBox[{"M12", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.28"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0.13585"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     RowBox[{"M23", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", 
          RowBox[{"-", "0.1197"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.395"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     RowBox[{"M34", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.14225"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     RowBox[{"G1", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.010267", ",", "0.010267", ",", "0.00666", ",", "3.7", ",", "3.7", 
         ",", "3.7"}], "}"}], "]"}]}], ";", 
     RowBox[{"G2", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.22689", ",", "0.22689", ",", "0.0151074", ",", "8.393", ",", 
         "8.393", ",", "8.393"}], "}"}], "]"}]}], ";", 
     RowBox[{"G3", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.0494433", ",", "0.0494433", ",", "0.004095", ",", "2.275", ",", 
         "2.275", ",", "2.275"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"Glist", "=", 
      RowBox[{"{", 
       RowBox[{"G1", ",", "G2", ",", "G3"}], "}"}]}], ";", 
     RowBox[{"Mlist", "=", 
      RowBox[{"{", 
       RowBox[{"M01", ",", "M12", ",", "M23", ",", "M34"}], "}"}]}], ";", 
     RowBox[{"Slist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0.425"}], "}"}]}], "}"}], 
       "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"taumat", "=", 
      RowBox[{"InverseDynamicsTrajectory", "[", 
       RowBox[{
       "thetamat", ",", "dthetamat", ",", "ddthetamat", ",", "g", ",", 
        "Ftipmat", ",", "Mlist", ",", "Glist", ",", "Slist"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Output", " ", "to", " ", "plot", " ", "the", " ", "joint", " ", 
       RowBox[{"forces", "/", "torques"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Tau1", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"taumat", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Tau2", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"taumat", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Tau3", " ", "=", 
      RowBox[{"Flatten", "[", " ", 
       RowBox[{"taumat", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", "3"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ListLinePlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Tau1", ",", "Tau2", ",", "Tau3"}], "}"}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<Tau1\>\"", ",", "\"\<Tau2\>\"", ",", "\"\<Tau3\>\""}], 
         "}"}]}], ",", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<Time\>\"", ",", "\"\<Torque\>\""}], "}"}]}], ",", 
       RowBox[{
       "PlotLabel", "\[Rule]", "\"\<Plot of Torque Trajectories\>\""}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "Full"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"InverseDynamicsTrajectory", "[", 
     RowBox[{
     "thetamat_", ",", "dthetamat_", ",", "ddthetamat_", ",", "g_", ",", 
      "Ftipmat_", ",", "Mlist_", ",", "Glist_", ",", "Slist_"}], "]"}], ":=", 
    
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"thetamatt", "=", 
         RowBox[{"thetamat", "\[Transpose]"}]}], ",", 
        RowBox[{"dthetamatt", "=", 
         RowBox[{"dthetamat", "\[Transpose]"}]}], ",", 
        RowBox[{"ddthetamatt", "=", 
         RowBox[{"ddthetamat", "\[Transpose]"}]}], ",", 
        RowBox[{"Ftipmatt", "=", 
         RowBox[{"Ftipmat", "\[Transpose]"}]}], ",", "taumat"}], "}"}], ",", 
      RowBox[{
       RowBox[{"taumat", "=", "thetamatt"}], ";", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"taumat", "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", "i"}], "]"}], "]"}], "=", 
          RowBox[{"InverseDynamics", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"thetamatt", "[", 
               RowBox[{"[", 
                RowBox[{";;", ",", "i"}], "]"}], "]"}], "}"}], 
             "\[Transpose]"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"dthetamatt", "[", 
               RowBox[{"[", 
                RowBox[{";;", ",", "i"}], "]"}], "]"}], "}"}], 
             "\[Transpose]"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ddthetamatt", "[", 
               RowBox[{"[", 
                RowBox[{";;", ",", "i"}], "]"}], "]"}], "}"}], 
             "\[Transpose]"}], ",", "g", ",", 
            RowBox[{"Ftipmatt", "[", 
             RowBox[{"[", 
              RowBox[{";;", ",", "i"}], "]"}], "]"}], ",", "Mlist", ",", 
            "Glist", ",", "Slist"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"Dimensions", "[", "thetamatt", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], ";", 
       RowBox[{"taumat", "=", 
        RowBox[{"taumat", "\[Transpose]"}]}], ";", 
       RowBox[{"Return", "[", "taumat", "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.658273872689763*^9, 3.658273988902459*^9}, {
   3.658274157743518*^9, 3.6582741742369556`*^9}, {3.65827421723704*^9, 
   3.6582742187327127`*^9}, {3.6582742677636137`*^9, 3.658274330534523*^9}, {
   3.658274365312026*^9, 3.6582744138260403`*^9}, {3.658274810942898*^9, 
   3.658274859112701*^9}, {3.658275033847995*^9, 3.658275109340135*^9}, {
   3.658275161547172*^9, 3.6582752536631193`*^9}, {3.65827533442001*^9, 
   3.658275354865328*^9}, {3.6582755590331087`*^9, 3.658275644746291*^9}, {
   3.658275839400229*^9, 3.6582758455265408`*^9}, {3.6582758973266172`*^9, 
   3.658276032713943*^9}, {3.658276065782716*^9, 3.6582762151364822`*^9}, {
   3.658276271302123*^9, 3.6582763371711683`*^9}, 3.658276384203477*^9, {
   3.658276429293391*^9, 3.658276729581854*^9}, {3.658276847155965*^9, 
   3.6582768822910967`*^9}, 3.658277078361019*^9, {3.658277454514134*^9, 
   3.65827755246841*^9}, {3.658277707616706*^9, 3.658277724793824*^9}, {
   3.658277775557291*^9, 3.658277790046358*^9}, {3.6582778408966618`*^9, 
   3.658277880321537*^9}, {3.658277965874803*^9, 3.658278001723259*^9}, {
   3.658278068864526*^9, 3.658278122465324*^9}, {3.6582782743035307`*^9, 
   3.658278463989525*^9}, {3.658278495324057*^9, 3.6582785116036882`*^9}, {
   3.6582787258401527`*^9, 3.6582787620388193`*^9}, {3.658278813660791*^9, 
   3.658278890779448*^9}, {3.658278981426128*^9, 3.6582789851507807`*^9}, {
   3.658279023852993*^9, 3.658279071286935*^9}, {3.6582792891814613`*^9, 
   3.6582793220434237`*^9}, {3.658279596716886*^9, 3.658279661442956*^9}, {
   3.658279700093648*^9, 3.658279706815292*^9}, {3.658279792551382*^9, 
   3.658279815830398*^9}, {3.658279878622261*^9, 3.658279897713276*^9}, {
   3.658279959320986*^9, 3.658279968167665*^9}, {3.658280159539792*^9, 
   3.658280259153908*^9}, {3.658280389314715*^9, 3.658280492142959*^9}, {
   3.65828054504196*^9, 3.6582806104625673`*^9}, {3.658280703485147*^9, 
   3.6582807265634003`*^9}, {3.658280783403376*^9, 3.658280995068233*^9}, {
   3.658332125643222*^9, 3.658332285669385*^9}, {3.658332356434971*^9, 
   3.658332432532056*^9}, {3.6583324694681797`*^9, 3.658332536889868*^9}, {
   3.6583325787135487`*^9, 3.658332603918232*^9}, {3.658332777986459*^9, 
   3.658332831919935*^9}, {3.6583329211917048`*^9, 3.6583329244763107`*^9}, {
   3.65833298690902*^9, 3.6583329940420103`*^9}, {3.658333033513297*^9, 
   3.658333041965459*^9}, {3.658333140934991*^9, 3.6583331410849524`*^9}, {
   3.658333260874716*^9, 3.658333325111835*^9}, {3.6583333640450163`*^9, 
   3.658333602194475*^9}, {3.658333866428316*^9, 3.658333876484424*^9}, {
   3.6583340410637217`*^9, 3.658334041446103*^9}, {3.658334239767832*^9, 
   3.658334256853527*^9}, {3.658334325290709*^9, 3.658334328931733*^9}, {
   3.658334454601124*^9, 3.658334541125682*^9}, {3.658334583676895*^9, 
   3.658334664745475*^9}, {3.658334705147303*^9, 3.6583347127203903`*^9}, {
   3.658334814800128*^9, 3.658334905957917*^9}, {3.658334952676396*^9, 
   3.658334989092309*^9}, {3.658335053255745*^9, 3.658335071690804*^9}, {
   3.658335129550527*^9, 3.658335241594574*^9}, {3.6583353167377977`*^9, 
   3.658335317096506*^9}, {3.658335384569755*^9, 3.658335396679709*^9}, {
   3.658335459752262*^9, 3.658335474398382*^9}, {3.658335569564763*^9, 
   3.6583356135466957`*^9}, {3.658335963702228*^9, 3.6583360118223963`*^9}, {
   3.6583361961257257`*^9, 3.658336324493081*^9}, {3.658336387471901*^9, 
   3.658336413286467*^9}, {3.6583364883081408`*^9, 3.658336518027725*^9}, {
   3.6583497860827847`*^9, 3.658349831490996*^9}, {3.658349861737459*^9, 
   3.658349862153501*^9}, {3.658349942786976*^9, 3.658349965329233*^9}, {
   3.6583500320501423`*^9, 3.658350038684167*^9}, {3.6583500726428823`*^9, 
   3.658350074339263*^9}, {3.658350117777423*^9, 3.658350161383792*^9}, {
   3.6583501955208597`*^9, 3.658350234542882*^9}, {3.6583502755982323`*^9, 
   3.658350338283965*^9}, {3.658350380319613*^9, 3.6583503814310093`*^9}, {
   3.658350450869604*^9, 3.658350549946392*^9}, {3.658350685268361*^9, 
   3.6583506855161467`*^9}, {3.658350727058009*^9, 3.6583507290251617`*^9}, {
   3.658350771093258*^9, 3.658350847603608*^9}, {3.658350951089933*^9, 
   3.658350961855956*^9}, {3.658351021399521*^9, 3.658351021591137*^9}, {
   3.6583511160719757`*^9, 3.658351121390588*^9}, {3.658351310629883*^9, 
   3.658351330581682*^9}, {3.658351453089098*^9, 3.6583514579767447`*^9}, {
   3.6583514969183617`*^9, 3.6583514999993277`*^9}, {3.658351570635014*^9, 
   3.658351577593944*^9}, {3.6583516106406183`*^9, 3.658351657352182*^9}, {
   3.658351766088022*^9, 3.658351770343424*^9}, {3.658351890506502*^9, 
   3.658351904164137*^9}, {3.6583519453391848`*^9, 3.65835200222512*^9}, {
   3.658352444511814*^9, 3.6583524450885687`*^9}, {3.65835945210156*^9, 
   3.658359582160754*^9}, {3.6583597573611526`*^9, 3.658359895421398*^9}, {
   3.6583600200459547`*^9, 3.658360209087796*^9}, {3.6583604062023983`*^9, 
   3.658360556362865*^9}, {3.658369386717368*^9, 3.658369415920825*^9}, {
   3.658369495583129*^9, 3.658369511397794*^9}, {3.658369604058823*^9, 
   3.6583698687217712`*^9}, {3.658369905522255*^9, 3.658370289459115*^9}, {
   3.658435473074052*^9, 3.65843549562414*^9}, {3.658435606368175*^9, 
   3.658435611544252*^9}, {3.6584356461976643`*^9, 3.6584356582216187`*^9}, {
   3.65843569293461*^9, 3.658435693127248*^9}, {3.6584357386455507`*^9, 
   3.6584357504379663`*^9}, {3.658437328158703*^9, 3.658437328842226*^9}, {
   3.658451386320923*^9, 3.658451396416233*^9}, {3.6584514558014927`*^9, 
   3.658451498437763*^9}, {3.65845176533173*^9, 3.658451769500102*^9}, {
   3.658451827834752*^9, 3.658451828192766*^9}, {3.6584518628797626`*^9, 
   3.658451915580929*^9}, {3.658451961311802*^9, 3.658451961463069*^9}, {
   3.658452686235773*^9, 3.658452689778323*^9}, {3.6584528065184526`*^9, 
   3.658452806708708*^9}, {3.6586220651258087`*^9, 3.658622180449822*^9}, {
   3.658622217313324*^9, 3.658622381467565*^9}, {3.658622437008402*^9, 
   3.658622500999549*^9}, {3.658623683248323*^9, 3.6586241287979918`*^9}, {
   3.658624240472498*^9, 3.658624332091518*^9}, {3.6586243934910803`*^9, 
   3.6586246606532173`*^9}, {3.67732315475941*^9, 3.677323235084415*^9}, {
   3.677323276630302*^9, 3.677323434547833*^9}, {3.677323484461143*^9, 
   3.677323499819213*^9}, {3.677323535146171*^9, 3.6773235769457493`*^9}, {
   3.677323628046247*^9, 3.6773236934411507`*^9}, {3.677327123605197*^9, 
   3.6773271239634647`*^9}, {3.677328059209757*^9, 3.6773280603224277`*^9}, {
   3.677331788835787*^9, 3.677331816859844*^9}, {3.677332081788471*^9, 
   3.677332105218265*^9}, {3.677333800582396*^9, 3.67733380225889*^9}, {
   3.6773420774064093`*^9, 3.6773420779146147`*^9}, {3.677405584192568*^9, 
   3.677405597246728*^9}, {3.677415011086073*^9, 3.6774150158485613`*^9}, {
   3.677417169219336*^9, 3.677417179691127*^9}, {3.6774904905071697`*^9, 
   3.677490490950142*^9}, {3.67809637333982*^9, 3.6780963899455423`*^9}, {
   3.678452980732629*^9, 3.678453008727953*^9}, {3.678455504215991*^9, 
   3.678455559017528*^9}, 3.691174932871546*^9, {3.6911749659834394`*^9, 
   3.691174987929695*^9}, 3.6911893616321673`*^9, {3.691210735273591*^9, 
   3.6912111825731764`*^9}, {3.6912119145888624`*^9, 3.691211968034556*^9}, {
   3.691212042555887*^9, 3.6912121208992243`*^9}, {3.6912122484294486`*^9, 
   3.691212251580654*^9}, {3.6912123103147573`*^9, 3.691212326616786*^9}, {
   3.6912150185347147`*^9, 3.691215039485551*^9}, {3.6912151456125374`*^9, 
   3.6912151494501443`*^9}, {3.691215182335002*^9, 3.691215263330344*^9}, {
   3.6912153027360134`*^9, 3.6912153096780252`*^9}, {3.691215672503463*^9, 
   3.6912158207505236`*^9}, {3.6924749083103104`*^9, 
   3.6924751278868694`*^9}, {3.692476439892474*^9, 3.6924764476619186`*^9}, {
   3.6924764909783955`*^9, 3.69247650731933*^9}, {3.6924765581032352`*^9, 
   3.692476559643323*^9}, {3.6924766455042343`*^9, 3.6924767074167757`*^9}, {
   3.6924767414427214`*^9, 3.6924768448506365`*^9}, {3.6931539562270603`*^9, 
   3.6931539593626657`*^9}},ExpressionUUID->"6e8a159e-54ad-4847-bf62-\
128cd2960b3c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"ForwardDynamicsTrajectory", "[", 
      RowBox[{
      "thetalist_", ",", "dthetalist_", ",", "taumat_", ",", "g_", ",", 
       "Ftipmat_", ",", "Mlist_", ",", "Glist_", ",", "Slist_", ",", "dt_", 
       ",", "intRes_"}], "]"}], ":", "\[IndentingNewLine]", "   ", 
     RowBox[{"Takes", " ", "thetalist"}], ":", " ", 
     RowBox[{"n", "-", 
      RowBox[{
      "vector", " ", "of", " ", "initial", " ", "joint", " ", 
       "variables"}]}]}], ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"dthetalist", ":", " ", 
     RowBox[{"n", "-", 
      RowBox[{
      "vector", " ", "of", " ", "initial", " ", "joint", " ", "rates"}]}]}], 
    ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"taumat", ":", " ", 
     RowBox[{
     "An", " ", "N", " ", "x", " ", "n", " ", "matrix", " ", "of", " ", 
      "joint", " ", 
      RowBox[{"forces", "/", "torques"}]}]}], ",", 
    RowBox[{
    "where", " ", "each", " ", "row", " ", "is", " ", "the", " ", "joint", 
     " ", "effort", " ", "at", " ", "any", " ", "time", " ", "step"}], ",", 
    "\[IndentingNewLine]", "          ", 
    RowBox[{"g", ":", 
     RowBox[{"Gravity", " ", "vector", " ", "g"}]}], ",", 
    "\[IndentingNewLine]", "          ", 
    RowBox[{"Ftipmat", ":", " ", 
     RowBox[{
      RowBox[{
      "An", " ", "N", " ", "x", " ", "6", " ", "matrix", " ", "of", " ", 
       "spatial", " ", "forces", " ", "applied", " ", "by", " ", "the", " ", 
       "end"}], "-", 
      RowBox[{"effector", " ", 
       RowBox[{"(", 
        RowBox[{
        "If", " ", "there", " ", "are", " ", "no", " ", "tip", " ", "forces", 
         " ", "the", " ", "user", " ", "should", " ", "input", " ", "a", " ", 
         "zero", " ", "and", " ", "a", " ", "zero", " ", "matrix", " ", 
         "will", " ", "be", " ", "used"}], ")"}]}]}]}], ",", 
    "\[IndentingNewLine]", "          ", 
    RowBox[{"Mlist", ":", " ", 
     RowBox[{"List", " ", "of", " ", "link", " ", "frames", " ", 
      RowBox[{"{", "i", "}"}], " ", "relative", " ", "to", " ", 
      RowBox[{"{", 
       RowBox[{"i", "-", "1"}], "}"}], " ", "at", " ", "the", " ", "home", 
      " ", "position"}]}], ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"Glist", ":", " ", 
     RowBox[{
     "Spatial", " ", "inertia", " ", "matrices", " ", "Gi", " ", "of", " ", 
      "the", " ", "links"}]}], ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"Slist", ":", " ", 
     RowBox[{
     "Screw", " ", "axes", " ", "Si", " ", "of", " ", "the", " ", "joints", 
      " ", "in", " ", "a", " ", "space", " ", "frame"}]}], ",", 
    "\[IndentingNewLine]", "          ", 
    RowBox[{"dt", ":", " ", 
     RowBox[{
     "The", " ", "timestep", " ", "between", " ", "consecutive", " ", "joint",
       " ", 
      RowBox[{"forces", "/", "torques"}]}]}], ",", " ", "\[IndentingNewLine]",
     "          ", 
    RowBox[{"intRes", ":", 
     RowBox[{
     "Integration", " ", "resolution", " ", "is", " ", "the", " ", "number", 
      " ", "of", " ", "times", " ", "integration", " ", 
      RowBox[{"(", "Euler", ")"}], " ", "takes", " ", "places", " ", 
      "between", " ", "each", " ", "time", " ", 
      RowBox[{"step", ".", " ", "Must"}], " ", "be", " ", "an", " ", 
      "integer", " ", "value", " ", "greater", " ", "than", " ", "or", " ", 
      "equal", " ", "to", " ", "1.", "\[IndentingNewLine]", "  ", "Returns", 
      " ", 
      RowBox[{"thetamat", ":", " ", 
       RowBox[{
       "The", " ", "N", " ", "x", " ", "n", " ", "matrix", " ", "of", " ", 
        "robot", " ", "joint", " ", "angles", " ", "resulting", " ", "from", 
        " ", "the", " ", "specified", " ", "joint", " ", 
        RowBox[{"forces", "/", "torques"}]}]}]}]}], ",", 
    RowBox[{
     RowBox[{"dthetamat", ":", 
      RowBox[{
       RowBox[{
       "The", " ", "N", " ", "x", " ", "n", " ", "matrix", " ", "of", " ", 
        "robot", " ", "joint", " ", 
        RowBox[{"velocities", ".", "\[IndentingNewLine]", "This"}], " ", 
        "function", " ", "simulates", " ", "the", " ", "motion", " ", "of", 
        " ", "a", " ", "serial", " ", "chain", " ", "given", " ", "an", " ", 
        "open"}], "-", 
       RowBox[{"loop", " ", "history", " ", "of", " ", "joint", " ", 
        RowBox[{"forces", "/", 
         RowBox[{"torques", ".", " ", "It"}]}], " ", "calls", " ", "a", " ", 
        "numerical", " ", "integration", " ", "procedure", " ", "that", " ", 
        "uses", " ", 
        RowBox[{"ForwardDynamics", "."}]}]}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Example", " ", 
       RowBox[{"Inputs", ":", "\n", "thetalist"}]}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", "0.1", ",", "0.1"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\n", 
     RowBox[{"dthetalist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", "0.2", ",", "0.3"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\n", 
     RowBox[{"taumat", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"3.63", ",", 
          RowBox[{"-", "6.58"}], ",", 
          RowBox[{"-", "5.57"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3.74", ",", 
          RowBox[{"-", "5.55"}], ",", 
          RowBox[{"-", "5.5"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4.31", ",", 
          RowBox[{"-", "0.68"}], ",", 
          RowBox[{"-", "5.19"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5.18", ",", "5.63", ",", 
          RowBox[{"-", "4.31"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5.85", ",", "8.17", ",", 
          RowBox[{"-", "2.59"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5.78", ",", "2.79", ",", 
          RowBox[{"-", "1.7"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4.99", ",", 
          RowBox[{"-", "5.3"}], ",", 
          RowBox[{"-", "1.19"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4.08", ",", 
          RowBox[{"-", "9.41"}], ",", "0.07"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3.56", ",", 
          RowBox[{"-", "10.1"}], ",", "0.97"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3.49", ",", 
          RowBox[{"-", "9.41"}], ",", "1.23"}], "}"}]}], "}"}]}], ";", "\n", 
     RowBox[{"(*", 
      RowBox[{"Initialise", " ", "robot", " ", "descripstion", " ", 
       RowBox[{"(", 
        RowBox[{"Example", " ", "with", " ", "3", " ", "links"}], ")"}]}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"g", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"-", "9.8"}]}], "}"}], "}"}], "\[Transpose]"}]}], ";", "\n", 
     RowBox[{"Ftipmat", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"1", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Dimensions", "[", "taumat", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "6"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"M01", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.089159"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     RowBox[{"M12", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.28"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0.13585"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     RowBox[{"M23", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", 
          RowBox[{"-", "0.1197"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.395"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     RowBox[{"M34", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.14225"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     RowBox[{"G1", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.010267", ",", "0.010267", ",", "0.00666", ",", "3.7", ",", "3.7", 
         ",", "3.7"}], "}"}], "]"}]}], ";", 
     RowBox[{"G2", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.22689", ",", "0.22689", ",", "0.0151074", ",", "8.393", ",", 
         "8.393", ",", "8.393"}], "}"}], "]"}]}], ";", 
     RowBox[{"G3", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.0494433", ",", "0.0494433", ",", "0.004095", ",", "2.275", ",", 
         "2.275", ",", "2.275"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"Glist", "=", 
      RowBox[{"{", 
       RowBox[{"G1", ",", "G2", ",", "G3"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Mlist", "=", 
      RowBox[{"{", 
       RowBox[{"M01", ",", "M12", ",", "M23", ",", "M34"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Slist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0.425"}], "}"}]}], "}"}], 
       "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dt", "=", "0.1"}], ";", "\n", 
     RowBox[{"intRes", "=", "8"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"thetamat", ",", "dthetamat"}], "}"}], "=", 
      RowBox[{"ForwardDynamicsTrajectory", "[", 
       RowBox[{
       "thetalist", ",", "dthetalist", ",", "taumat", ",", "g", ",", 
        "Ftipmat", ",", "Mlist", ",", "Glist", ",", "Slist", ",", "dt", ",", 
        "intRes"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Output", " ", "to", " ", "plot", " ", "the", " ", "joint", " ", 
       RowBox[{"forces", "/", "torques"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"theta1", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"thetamat", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"theta2", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"thetamat", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"theta3", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"thetamat", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", "3"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dtheta1", " ", "=", 
      RowBox[{"Flatten", "[", " ", 
       RowBox[{"dthetamat", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dtheta2", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"dthetamat", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dtheta3", " ", "=", 
      RowBox[{"Flatten", "[", " ", 
       RowBox[{"dthetamat", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", "3"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ListLinePlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "theta1", ",", "theta2", ",", "theta3", ",", "dtheta1", ",", 
         "dtheta2", ",", "dtheta3"}], "}"}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<theta1\>\"", ",", "\"\<theta2\>\"", ",", "\"\<theta3\>\"", ",", 
          "\"\<dtheta1\>\"", ",", "\"\<dtheta2\>\"", ",", "\"\<dtheta3\>\""}],
          "}"}]}], ",", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<Time\>\"", ",", "\"\<Joint Angles/Velocities\>\""}], 
         "}"}]}], ",", 
       RowBox[{
       "PlotLabel", "\[Rule]", 
        "\"\<Plot of Joint Angles and Joint Velocities\>\""}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "Full"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ForwardDynamicsTrajectory", "[", 
     RowBox[{
     "thetalist_", ",", "dthetalist_", ",", "taumat_", ",", "g_", ",", 
      "Ftipmat_", ",", "Mlist_", ",", "Glist_", ",", "Slist_", ",", "dt_", 
      ",", "intRes_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"taumatt", "=", 
         RowBox[{"taumat", "\[Transpose]"}]}], ",", 
        RowBox[{"Ftipmatt", "=", 
         RowBox[{"Ftipmat", "\[Transpose]"}]}], ",", "thetamat", ",", 
        "dthetamat", ",", "ddthetanext", ",", 
        RowBox[{"thetanext", "=", "thetalist"}], ",", 
        RowBox[{"dthetanext", "=", "dthetalist"}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"thetamat", "=", "taumatt"}], ";", 
       RowBox[{"dthetamat", "=", "taumatt"}], ";", 
       RowBox[{
        RowBox[{"thetamat", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", "1"}], "]"}], "]"}], "=", "thetanext"}], ";", 
       RowBox[{
        RowBox[{"dthetamat", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", "1"}], "]"}], "]"}], "=", "dthetanext"}], ";", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ddthetanext", "=", 
              RowBox[{"ForwardDynamics", "[", 
               RowBox[{"thetanext", ",", "dthetanext", ",", 
                RowBox[{"taumatt", "[", 
                 RowBox[{"[", 
                  RowBox[{";;", ",", "i"}], "]"}], "]"}], ",", "g", ",", 
                RowBox[{"Ftipmatt", "[", 
                 RowBox[{"[", 
                  RowBox[{";;", ",", "i"}], "]"}], "]"}], ",", "Mlist", ",", 
                "Glist", ",", "Slist"}], "]"}]}], ";", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"thetanext", ",", "dthetanext"}], "}"}], "=", 
              RowBox[{"EulerStep", "[", 
               RowBox[{
               "thetanext", ",", "dthetanext", ",", "ddthetanext", ",", 
                RowBox[{"dt", "/", "intRes"}]}], "]"}]}]}], ",", "intRes"}], 
           "]"}], ";", 
          RowBox[{
           RowBox[{"thetamat", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", 
              RowBox[{"i", "+", "1"}]}], "]"}], "]"}], "=", "thetanext"}], 
          ";", 
          RowBox[{
           RowBox[{"dthetamat", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", 
              RowBox[{"i", "+", "1"}]}], "]"}], "]"}], "=", "dthetanext"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Dimensions", "[", "taumatt", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", "1"}]}], "}"}]}], "]"}], 
       ";", 
       RowBox[{"thetamat", "=", 
        RowBox[{"thetamat", "\[Transpose]"}]}], ";", 
       RowBox[{"dthetamat", "=", 
        RowBox[{"dthetamat", "\[Transpose]"}]}], ";", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"thetamat", ",", "dthetamat"}], "}"}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.658273872689763*^9, 3.658273988902459*^9}, {
   3.658274157743518*^9, 3.6582741742369556`*^9}, {3.65827421723704*^9, 
   3.6582742187327127`*^9}, {3.6582742677636137`*^9, 3.658274330534523*^9}, {
   3.658274365312026*^9, 3.6582744138260403`*^9}, {3.658274810942898*^9, 
   3.658274859112701*^9}, {3.658275033847995*^9, 3.658275109340135*^9}, {
   3.658275161547172*^9, 3.6582752536631193`*^9}, {3.65827533442001*^9, 
   3.658275354865328*^9}, {3.6582755590331087`*^9, 3.658275644746291*^9}, {
   3.658275839400229*^9, 3.6582758455265408`*^9}, {3.6582758973266172`*^9, 
   3.658276032713943*^9}, {3.658276065782716*^9, 3.6582762151364822`*^9}, {
   3.658276271302123*^9, 3.6582763371711683`*^9}, 3.658276384203477*^9, {
   3.658276429293391*^9, 3.658276729581854*^9}, {3.658276847155965*^9, 
   3.6582768822910967`*^9}, 3.658277078361019*^9, {3.658277454514134*^9, 
   3.65827755246841*^9}, {3.658277707616706*^9, 3.658277724793824*^9}, {
   3.658277775557291*^9, 3.658277790046358*^9}, {3.6582778408966618`*^9, 
   3.658277880321537*^9}, {3.658277965874803*^9, 3.658278001723259*^9}, {
   3.658278068864526*^9, 3.658278122465324*^9}, {3.6582782743035307`*^9, 
   3.658278463989525*^9}, {3.658278495324057*^9, 3.6582785116036882`*^9}, {
   3.6582787258401527`*^9, 3.6582787620388193`*^9}, {3.658278813660791*^9, 
   3.658278890779448*^9}, {3.658278981426128*^9, 3.6582789851507807`*^9}, {
   3.658279023852993*^9, 3.658279071286935*^9}, {3.6582792891814613`*^9, 
   3.6582793220434237`*^9}, {3.658279596716886*^9, 3.658279661442956*^9}, {
   3.658279700093648*^9, 3.658279706815292*^9}, {3.658279792551382*^9, 
   3.658279815830398*^9}, {3.658279878622261*^9, 3.658279897713276*^9}, {
   3.658279959320986*^9, 3.658279968167665*^9}, {3.658280159539792*^9, 
   3.658280259153908*^9}, {3.658280389314715*^9, 3.658280492142959*^9}, {
   3.65828054504196*^9, 3.6582806104625673`*^9}, {3.658280703485147*^9, 
   3.6582807265634003`*^9}, {3.658280783403376*^9, 3.658280995068233*^9}, {
   3.658332125643222*^9, 3.658332285669385*^9}, {3.658332356434971*^9, 
   3.658332432532056*^9}, {3.6583324694681797`*^9, 3.658332536889868*^9}, {
   3.6583325787135487`*^9, 3.658332603918232*^9}, {3.658332777986459*^9, 
   3.658332831919935*^9}, {3.6583329211917048`*^9, 3.6583329244763107`*^9}, {
   3.65833298690902*^9, 3.6583329940420103`*^9}, {3.658333033513297*^9, 
   3.658333041965459*^9}, {3.658333140934991*^9, 3.6583331410849524`*^9}, {
   3.658333260874716*^9, 3.658333325111835*^9}, {3.6583333640450163`*^9, 
   3.658333602194475*^9}, {3.658333866428316*^9, 3.658333876484424*^9}, {
   3.6583340410637217`*^9, 3.658334041446103*^9}, {3.658334239767832*^9, 
   3.658334256853527*^9}, {3.658334325290709*^9, 3.658334328931733*^9}, {
   3.658334454601124*^9, 3.658334541125682*^9}, {3.658334583676895*^9, 
   3.658334664745475*^9}, {3.658334705147303*^9, 3.6583347127203903`*^9}, {
   3.658334814800128*^9, 3.658334905957917*^9}, {3.658334952676396*^9, 
   3.658334989092309*^9}, {3.658335053255745*^9, 3.658335071690804*^9}, {
   3.658335129550527*^9, 3.658335241594574*^9}, {3.6583353167377977`*^9, 
   3.658335317096506*^9}, {3.658335384569755*^9, 3.658335396679709*^9}, {
   3.658335459752262*^9, 3.658335474398382*^9}, {3.658335569564763*^9, 
   3.6583356135466957`*^9}, {3.658335963702228*^9, 3.6583360118223963`*^9}, {
   3.6583361961257257`*^9, 3.658336324493081*^9}, {3.658336387471901*^9, 
   3.658336413286467*^9}, {3.6583364883081408`*^9, 3.658336518027725*^9}, {
   3.6583497860827847`*^9, 3.658349831490996*^9}, {3.658349861737459*^9, 
   3.658349862153501*^9}, {3.658349942786976*^9, 3.658349965329233*^9}, {
   3.6583500320501423`*^9, 3.658350038684167*^9}, {3.6583500726428823`*^9, 
   3.658350074339263*^9}, {3.658350117777423*^9, 3.658350161383792*^9}, {
   3.6583501955208597`*^9, 3.658350234542882*^9}, {3.6583502755982323`*^9, 
   3.658350338283965*^9}, {3.658350380319613*^9, 3.6583503814310093`*^9}, {
   3.658350450869604*^9, 3.658350549946392*^9}, {3.658350685268361*^9, 
   3.6583506855161467`*^9}, {3.658350727058009*^9, 3.6583507290251617`*^9}, {
   3.658350771093258*^9, 3.658350847603608*^9}, {3.658350951089933*^9, 
   3.658350961855956*^9}, {3.658351021399521*^9, 3.658351021591137*^9}, {
   3.6583511160719757`*^9, 3.658351121390588*^9}, {3.658351310629883*^9, 
   3.658351330581682*^9}, {3.658351453089098*^9, 3.6583514579767447`*^9}, {
   3.6583514969183617`*^9, 3.6583514999993277`*^9}, {3.658351570635014*^9, 
   3.658351577593944*^9}, {3.6583516106406183`*^9, 3.658351657352182*^9}, {
   3.658351766088022*^9, 3.658351770343424*^9}, {3.658351890506502*^9, 
   3.658351904164137*^9}, {3.6583519453391848`*^9, 3.65835200222512*^9}, {
   3.658352444511814*^9, 3.6583524450885687`*^9}, {3.65835945210156*^9, 
   3.658359582160754*^9}, {3.6583597573611526`*^9, 3.658359895421398*^9}, {
   3.6583600200459547`*^9, 3.658360209087796*^9}, {3.6583604062023983`*^9, 
   3.658360556362865*^9}, {3.658369386717368*^9, 3.658369415920825*^9}, {
   3.658369495583129*^9, 3.658369511397794*^9}, {3.658369604058823*^9, 
   3.6583698687217712`*^9}, {3.658369905522255*^9, 3.658370289459115*^9}, {
   3.658435473074052*^9, 3.65843549562414*^9}, {3.658435606368175*^9, 
   3.658435611544252*^9}, {3.6584356461976643`*^9, 3.6584356582216187`*^9}, {
   3.65843569293461*^9, 3.658435693127248*^9}, {3.6584357386455507`*^9, 
   3.6584357504379663`*^9}, {3.658437328158703*^9, 3.658437328842226*^9}, {
   3.658451386320923*^9, 3.658451396416233*^9}, {3.6584514558014927`*^9, 
   3.658451498437763*^9}, {3.65845176533173*^9, 3.658451769500102*^9}, {
   3.658451827834752*^9, 3.658451828192766*^9}, {3.6584518628797626`*^9, 
   3.658451915580929*^9}, {3.658451961311802*^9, 3.658451961463069*^9}, {
   3.658452686235773*^9, 3.658452689778323*^9}, {3.6584528065184526`*^9, 
   3.658452806708708*^9}, {3.6586220651258087`*^9, 3.658622180449822*^9}, {
   3.658622217313324*^9, 3.658622381467565*^9}, {3.658622437008402*^9, 
   3.658622500999549*^9}, {3.658623683248323*^9, 3.6586241287979918`*^9}, {
   3.658624240472498*^9, 3.658624332091518*^9}, {3.6586243934910803`*^9, 
   3.6586246606532173`*^9}, {3.677407880850321*^9, 3.6774079492889233`*^9}, 
   3.677414022557517*^9, {3.6774140684385967`*^9, 3.677414075630186*^9}, {
   3.677414335095175*^9, 3.6774144298603773`*^9}, {3.677414470492803*^9, 
   3.6774146091155233`*^9}, {3.67741468942129*^9, 3.6774147932681417`*^9}, {
   3.67741491149364*^9, 3.677414922353374*^9}, {3.67741498492174*^9, 
   3.6774151635455713`*^9}, {3.677415203976342*^9, 3.677415224900571*^9}, {
   3.6774152627756023`*^9, 3.6774153898486433`*^9}, {3.677415447679756*^9, 
   3.677415479578895*^9}, {3.677415510129551*^9, 3.6774155189848757`*^9}, {
   3.677415563853796*^9, 3.677415658868799*^9}, {3.6774156922934237`*^9, 
   3.677415750725058*^9}, 3.677415816213516*^9, 3.677415995234165*^9, {
   3.677416164828886*^9, 3.677416172065155*^9}, 3.6774162123220577`*^9, 
   3.6774162696380577`*^9, {3.677416302219317*^9, 3.6774163049989634`*^9}, {
   3.677416378172185*^9, 3.677416424224967*^9}, {3.677416454762212*^9, 
   3.677416495972261*^9}, {3.6774165285301943`*^9, 3.677416609497998*^9}, {
   3.6774167079897223`*^9, 3.677416809355668*^9}, {3.677417011496028*^9, 
   3.6774171391385193`*^9}, 3.677417196932665*^9, {3.6774905052362013`*^9, 
   3.67749050537529*^9}, {3.678096405086987*^9, 3.6780964104728518`*^9}, {
   3.678452887470743*^9, 3.678452964874299*^9}, {3.6784530534763193`*^9, 
   3.678453091013393*^9}, {3.678453126802677*^9, 3.6784531289330797`*^9}, {
   3.678453439478467*^9, 3.678453592963132*^9}, {3.67845373611872*^9, 
   3.678453765205407*^9}, {3.6784538527604933`*^9, 3.678453869490027*^9}, {
   3.6784538995984297`*^9, 3.678453940309951*^9}, {3.6784540141405973`*^9, 
   3.678454036151272*^9}, {3.681455189340788*^9, 3.6814552018036423`*^9}, {
   3.6814552579394627`*^9, 3.681455263407737*^9}, {3.681455819481369*^9, 
   3.681455824984709*^9}, {3.6891225723446455`*^9, 3.689122614646705*^9}, {
   3.691203050525611*^9, 3.6912030748460536`*^9}, {3.691203265665589*^9, 
   3.6912033941630144`*^9}, {3.6912034373126907`*^9, 3.691203441072297*^9}, {
   3.691203499135599*^9, 3.691203713417575*^9}, {3.6912038389353957`*^9, 
   3.6912038410725994`*^9}, {3.691204128861905*^9, 3.691204181340397*^9}, {
   3.6912042895265875`*^9, 3.6912043103058233`*^9}, {3.6912043426134806`*^9, 
   3.691204396449175*^9}, {3.691204556536656*^9, 3.691204561575465*^9}, {
   3.691204653662427*^9, 3.691204739852578*^9}, {3.691205211789407*^9, 
   3.6912052409302583`*^9}, {3.6912052895399437`*^9, 3.69120530434437*^9}, {
   3.6924780729568796`*^9, 3.6924782185882096`*^9}, {3.692478258881514*^9, 
   3.6924783828486047`*^9}, {3.6924784140933914`*^9, 3.692478416578534*^9}, {
   3.6924786162319536`*^9, 3.692478667775902*^9}, {3.6931539666946783`*^9, 
   3.6931539707350855`*^9}},ExpressionUUID->"7f70e6a1-8f2f-4b8c-8861-\
d2d712d3c90f"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["CHAPTER  9: TRAJECTORY GENERATION",
 FontSize->24,
 FontWeight->"Bold",
 FontColor->RGBColor[0, 0, 1]]], "Title",
 CellChangeTimes->{{3.6755319110417843`*^9, 3.675531927048277*^9}, {
  3.675531958735077*^9, 3.67553201284205*^9}, {3.675607857109823*^9, 
  3.6756079117244864`*^9}, {3.6756821024917507`*^9, 3.6756821283850946`*^9}, {
  3.6757648758196497`*^9, 3.675764892595064*^9}, {3.6767235712710247`*^9, 
  3.676723593007389*^9}},ExpressionUUID->"f0bd19a2-573e-4c14-b17d-\
871f7845c532"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"CubicTimeScaling", "[", 
      RowBox[{"Tf_", ",", "t_"}], "]"}], ":", "\[IndentingNewLine]", "   ", 
     RowBox[{"Takes", " ", "Tf"}], ":", " ", 
     RowBox[{
     "Total", " ", "time", " ", "of", " ", "the", " ", "motion", " ", "in", 
      " ", "seconds", " ", "from", " ", "rest", " ", "to", " ", "rest"}]}], 
    ",", "\[IndentingNewLine]", "          ", 
    RowBox[{
     RowBox[{"t", ":", " ", 
      RowBox[{
       RowBox[{
       "The", " ", "current", " ", "time", " ", "t", " ", "satisfying", " ", 
        "0"}], "<", "t", "<", 
       RowBox[{
        RowBox[{"Tf", ".", "\[IndentingNewLine]", "Returns"}], " ", "s"}]}], 
      ":", " ", 
      RowBox[{
       RowBox[{"The", " ", "path", " ", "parameter", " ", "s", 
        RowBox[{"(", "t", ")"}], " ", "corresponding", " ", "to", " ", "a", 
        " ", "third"}], "-", 
       RowBox[{
       "order", " ", "polynomial", " ", "motion", " ", "that", " ", "begins", 
        " ", "and", " ", "ends", " ", "at", " ", "zero", " ", 
        RowBox[{"velocity", "."}]}]}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Example", ":", "\[IndentingNewLine]", "Input", ":", 
       "\[IndentingNewLine]", "Tf"}], "=", "2"}], ";", "\n", "  ", 
     RowBox[{"t", "=", "0.6"}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"s", " ", "=", " ", 
      RowBox[{
       RowBox[{"CubicTimeScaling", "[", 
        RowBox[{"Tf", ",", "t"}], "]"}], "\[IndentingNewLine]", 
       RowBox[{
       "Output", ":", "\[IndentingNewLine]", "0.21600000000000003"}]}]}]}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CubicTimeScaling", "[", 
     RowBox[{"Tf_", ",", "t_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"3", "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"t", "/", "Tf"}], ")"}], "^", "2"}]}], "-", 
     RowBox[{"2", "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"t", "/", "Tf"}], ")"}], "^", "3"}]}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654107438701495*^9, 3.6541075770931664`*^9}, {
   3.6541076103152647`*^9, 3.654107726674172*^9}, {3.654107800327899*^9, 
   3.654107805926005*^9}, {3.654107842157054*^9, 3.654107956534466*^9}, {
   3.6541080276373253`*^9, 3.654108039845397*^9}, {3.654108208328875*^9, 
   3.654108267778264*^9}, {3.654108316603101*^9, 3.65410832858707*^9}, {
   3.654122072990996*^9, 3.654122200142358*^9}, {3.654122232524707*^9, 
   3.6541222637488813`*^9}, {3.654122372486209*^9, 3.65412253592478*^9}, {
   3.654122571686759*^9, 3.654122685636675*^9}, {3.654122740902017*^9, 
   3.6541228215630703`*^9}, {3.654122865671712*^9, 3.654122935620612*^9}, {
   3.654123032181581*^9, 3.6541230914473333`*^9}, {3.654123152783122*^9, 
   3.6541232043612537`*^9}, {3.654123304611115*^9, 3.654123341073502*^9}, {
   3.654123502235703*^9, 3.654123578362132*^9}, {3.654123664279245*^9, 
   3.654123683195951*^9}, {3.6541237878998413`*^9, 3.6541238249788847`*^9}, {
   3.654123940392714*^9, 3.654123947510108*^9}, {3.654124026309593*^9, 
   3.654124026885428*^9}, 3.6541241152729683`*^9, 3.654124170343902*^9, {
   3.6541246995439568`*^9, 3.654124712871656*^9}, {3.6541251843297157`*^9, 
   3.654125231518578*^9}, {3.6541254856851683`*^9, 3.65412548908077*^9}, {
   3.654125547742125*^9, 3.654125551165526*^9}, {3.654125930807577*^9, 
   3.654126007244483*^9}, {3.654126127665163*^9, 3.654126191634789*^9}, {
   3.654126236482831*^9, 3.654126250153975*^9}, {3.6541262848658533`*^9, 
   3.654126288991514*^9}, {3.654126323055903*^9, 3.654126399729628*^9}, {
   3.654126435349374*^9, 3.654126447266036*^9}, {3.654126530077552*^9, 
   3.6541265937421*^9}, {3.654126679867402*^9, 3.6541267650289497`*^9}, {
   3.6541267969631968`*^9, 3.654126798410089*^9}, {3.654126829860013*^9, 
   3.654126881359337*^9}, {3.6541269393824577`*^9, 3.654126959132009*^9}, {
   3.654127079773924*^9, 3.654127194954756*^9}, {3.654127229244482*^9, 
   3.654127253953713*^9}, {3.6541278694900227`*^9, 3.654127878663176*^9}, {
   3.654127969775614*^9, 3.6541279938293123`*^9}, {3.654128051763153*^9, 
   3.654128134016169*^9}, {3.654128326830834*^9, 3.654128326972948*^9}, {
   3.654182305132535*^9, 3.654182317491791*^9}, {3.65418238746202*^9, 
   3.654182511491269*^9}, {3.654182551115921*^9, 3.654182559209998*^9}, {
   3.6541826265390177`*^9, 3.654182732425318*^9}, {3.654182795218339*^9, 
   3.654182802306821*^9}, {3.654182858360195*^9, 3.654182976637673*^9}, {
   3.65418309291822*^9, 3.6541831115452337`*^9}, {3.654183280620055*^9, 
   3.654183381285778*^9}, {3.6541834216733217`*^9, 3.65418343026462*^9}, {
   3.65418347398075*^9, 3.654183479016459*^9}, {3.654183517743698*^9, 
   3.654183590244978*^9}, {3.654183629340012*^9, 3.654183659551435*^9}, {
   3.654183828746057*^9, 3.654183869187777*^9}, {3.654183918271063*^9, 
   3.6541839184304667`*^9}, {3.654206461375032*^9, 3.6542064948942213`*^9}, {
   3.6542065261576433`*^9, 3.654206710642645*^9}, {3.65420685898112*^9, 
   3.654206859498214*^9}, {3.654206912388175*^9, 3.6542069199221067`*^9}, {
   3.654206956850091*^9, 3.654206957769821*^9}, {3.6542070885864773`*^9, 
   3.6542070905801163`*^9}, {3.6542071861274023`*^9, 3.654207197287834*^9}, {
   3.654207355631957*^9, 3.65420737546005*^9}, {3.654207422116619*^9, 
   3.6542074295958633`*^9}, {3.654207513008601*^9, 3.654207622631179*^9}, {
   3.6542077902321663`*^9, 3.6542079082040863`*^9}, {3.654208112675095*^9, 
   3.6542082406765347`*^9}, {3.654208390436673*^9, 3.654208437282127*^9}, {
   3.654208729398788*^9, 3.6542088242969923`*^9}, {3.654208875181876*^9, 
   3.6542089105814543`*^9}, {3.654209036563011*^9, 3.654209042056604*^9}, {
   3.654209131808134*^9, 3.654209211748107*^9}, {3.654277910558556*^9, 
   3.654277962902483*^9}, {3.6542785554956903`*^9, 3.654278555764879*^9}, {
   3.6542801407928543`*^9, 3.654280145647377*^9}, {3.654280336511973*^9, 
   3.654280388661951*^9}, {3.654735519742467*^9, 3.654735526212496*^9}, {
   3.654736711632904*^9, 3.654736744359725*^9}, {3.654736840726715*^9, 
   3.6547369027091503`*^9}, {3.6547369619155817`*^9, 3.65473711893006*^9}, 
   3.654737215212165*^9, {3.6547372623430433`*^9, 3.654737301717353*^9}, {
   3.654737434898181*^9, 3.654737445769989*^9}, {3.654737593349925*^9, 
   3.654737893647337*^9}, {3.654737938282483*^9, 3.654737939560112*^9}, {
   3.654737995469615*^9, 3.65473804382544*^9}, {3.65473814244207*^9, 
   3.65473826286047*^9}, {3.654738473301898*^9, 3.654738519313912*^9}, {
   3.654738551955141*^9, 3.654738559351729*^9}, {3.654738599129403*^9, 
   3.654738599566987*^9}, {3.654738653005966*^9, 3.654738704434928*^9}, {
   3.654738885183668*^9, 3.654738922018218*^9}, {3.654739011880048*^9, 
   3.65473910917871*^9}, {3.654739159170903*^9, 3.654739162120161*^9}, {
   3.6547393230277576`*^9, 3.6547393764227123`*^9}, {3.654739415181912*^9, 
   3.65473942023728*^9}, {3.654739453135948*^9, 3.654739679965816*^9}, {
   3.654739718627033*^9, 3.6547397334487553`*^9}, {3.654739765385715*^9, 
   3.654739851694334*^9}, {3.654739889466123*^9, 3.654740005071364*^9}, {
   3.6547400491757*^9, 3.654740154008595*^9}, 3.654740216700787*^9, {
   3.654740314399178*^9, 3.6547403286014967`*^9}, 3.6547403850818996`*^9, {
   3.654740521314966*^9, 3.654740541208376*^9}, {3.65474063388687*^9, 
   3.654740654515286*^9}, {3.654740701345427*^9, 3.654740810460566*^9}, {
   3.654740848239312*^9, 3.654741082783293*^9}, {3.654741274225429*^9, 
   3.65474127713437*^9}, 3.654741426789631*^9, {3.6547414571147537`*^9, 
   3.654741569824174*^9}, {3.654741604551594*^9, 3.65474161887015*^9}, {
   3.6547416933496304`*^9, 3.654741709459137*^9}, {3.654741935230948*^9, 
   3.654741945307493*^9}, {3.6547830386167917`*^9, 3.654783105454197*^9}, {
   3.6547832406606083`*^9, 3.6547832525310373`*^9}, {3.654783794511154*^9, 
   3.654783837663447*^9}, {3.65478390359721*^9, 3.654783909803577*^9}, {
   3.654783989474423*^9, 3.654784403124803*^9}, {3.654784520313846*^9, 
   3.654784622329711*^9}, {3.6547847231449842`*^9, 3.654784727983326*^9}, {
   3.654785122876478*^9, 3.654785187751635*^9}, {3.654785255283667*^9, 
   3.654785472044736*^9}, {3.654785554330287*^9, 3.6547855634367*^9}, {
   3.6547858133842907`*^9, 3.654785842420493*^9}, {3.654785988696732*^9, 
   3.654785999313698*^9}, {3.654786083383224*^9, 3.654786083827299*^9}, {
   3.654799998454865*^9, 3.654800009014682*^9}, 3.654800058896707*^9, {
   3.6548001027328*^9, 3.654800173381201*^9}, {3.654800206111162*^9, 
   3.654800346038969*^9}, {3.654800415767541*^9, 3.654800685527397*^9}, {
   3.654800717895743*^9, 3.6548007259529123`*^9}, {3.6548007560240192`*^9, 
   3.654800892868227*^9}, {3.654800961067473*^9, 3.6548010443125353`*^9}, {
   3.654801144205307*^9, 3.6548013970409203`*^9}, {3.654801447723054*^9, 
   3.6548014700938597`*^9}, {3.654801562889327*^9, 3.6548017505389137`*^9}, {
   3.6548017965315866`*^9, 3.654801838591158*^9}, {3.654801925163512*^9, 
   3.654801957336872*^9}, {3.654802037838778*^9, 3.654802097667626*^9}, {
   3.6548021338675137`*^9, 3.654802151746142*^9}, {3.6548021938035927`*^9, 
   3.65480226557542*^9}, {3.6548023434469347`*^9, 3.6548024564595747`*^9}, {
   3.654802493167995*^9, 3.654802498462143*^9}, {3.654802632969117*^9, 
   3.654802636326886*^9}, {3.6548026864101667`*^9, 3.6548027624957323`*^9}, {
   3.654802812209731*^9, 3.6548030159498*^9}, {3.6548066359524317`*^9, 
   3.654806720935005*^9}, {3.654806751992766*^9, 3.6548067587144833`*^9}, {
   3.654806821497799*^9, 3.654806889382121*^9}, {3.654807006283039*^9, 
   3.654807210369132*^9}, {3.654807340425975*^9, 3.6548074184588003`*^9}, {
   3.6548074913193197`*^9, 3.654807699931301*^9}, 3.6548078200861998`*^9, {
   3.654807890939335*^9, 3.65480791502777*^9}, {3.654807960842239*^9, 
   3.6548080712336483`*^9}, {3.654808128338978*^9, 3.6548081799548407`*^9}, {
   3.6548101758929577`*^9, 3.654810330104765*^9}, {3.654810401423953*^9, 
   3.654810408457419*^9}, {3.6548104718702717`*^9, 3.6548106690676603`*^9}, {
   3.6548107121438303`*^9, 3.6548108463298893`*^9}, {3.654810878513033*^9, 
   3.6548109250220337`*^9}, {3.654810973064028*^9, 3.6548109963255377`*^9}, {
   3.654811065383171*^9, 3.65481111435124*^9}, {3.6548111568410273`*^9, 
   3.654811165569319*^9}, {3.654811202562601*^9, 3.654811649746052*^9}, {
   3.657067656153129*^9, 3.657067660941557*^9}, {3.6570766750689*^9, 
   3.657076677028944*^9}, {3.658274451899232*^9, 3.6582744912918463`*^9}, {
   3.6583703518545094`*^9, 3.65837035300604*^9}, {3.675682824450754*^9, 
   3.6756828836706333`*^9}, {3.6756829858535852`*^9, 3.675683093476144*^9}, {
   3.675683163431617*^9, 3.675683301926485*^9}, {3.6756834458193197`*^9, 
   3.675683520674423*^9}, {3.675683569012762*^9, 3.675683584065415*^9}, 
   3.675683635500771*^9, {3.675684508273862*^9, 3.675684520687911*^9}, {
   3.675764977565001*^9, 3.675764979617189*^9}, {3.6757662451157312`*^9, 
   3.675766254498831*^9}, {3.675766317871736*^9, 3.675766345394107*^9}, {
   3.6757664078898573`*^9, 3.675766419041957*^9}, {3.6757665260531073`*^9, 
   3.6757665599652433`*^9}, {3.675766688881428*^9, 3.675766693414764*^9}, {
   3.675766760364307*^9, 3.675766898736827*^9}, {3.675766931380547*^9, 
   3.675766932915333*^9}, 3.675767022524777*^9, 3.675767053903921*^9, {
   3.675767094663486*^9, 3.675767157353602*^9}, {3.6757672038039017`*^9, 
   3.67576720815028*^9}, {3.675767263478516*^9, 3.675767302851701*^9}, {
   3.6757673469407463`*^9, 3.6757675158730087`*^9}, {3.675767609117689*^9, 
   3.6757676149377613`*^9}, 3.676110621848937*^9, {3.676110673192341*^9, 
   3.676110708132433*^9}, {3.676110758266004*^9, 3.676110779724792*^9}, {
   3.676110837502541*^9, 3.676110924302658*^9}, {3.676111015370205*^9, 
   3.676111023652515*^9}, {3.676111616884136*^9, 3.676111619101164*^9}, {
   3.67611165132108*^9, 3.67611182175666*^9}, 3.6761124388093357`*^9, {
   3.6761125310577183`*^9, 3.676112535417371*^9}, {3.67611278534865*^9, 
   3.676112852293083*^9}, {3.6761129469420633`*^9, 3.6761129566090517`*^9}, {
   3.6761133261675377`*^9, 3.6761133851728067`*^9}, {3.6761134570078707`*^9, 
   3.6761134886549597`*^9}, {3.676113519585043*^9, 3.676113581404831*^9}, {
   3.676113994051722*^9, 3.6761140495138607`*^9}, {3.67611471759483*^9, 
   3.676114727326268*^9}, {3.676114788083909*^9, 3.676114788267289*^9}, {
   3.67611493328951*^9, 3.6761149644016867`*^9}, {3.6761149993051443`*^9, 
   3.676115038096011*^9}, {3.676115419194528*^9, 3.676115484935451*^9}, {
   3.6761155900865583`*^9, 3.676115605985518*^9}, {3.676115760093829*^9, 
   3.676115778909306*^9}, {3.676115982499289*^9, 3.676116037133542*^9}, {
   3.6761161990700502`*^9, 3.676116233908482*^9}, {3.676116286507206*^9, 
   3.676116286712512*^9}, {3.67611639463448*^9, 3.676116464258135*^9}, {
   3.6761165873897543`*^9, 3.676116602580727*^9}, {3.6761174556753473`*^9, 
   3.67611745672952*^9}, {3.676117506535368*^9, 3.6761175229462357`*^9}, {
   3.676117600215383*^9, 3.6761176442364273`*^9}, {3.676117677849012*^9, 
   3.6761177082717953`*^9}, {3.67611812248459*^9, 3.6761181278825502`*^9}, {
   3.676118580166224*^9, 3.67611860485815*^9}, {3.676118651876894*^9, 
   3.6761187537386017`*^9}, {3.676118838160269*^9, 3.676118838374693*^9}, {
   3.67611887610327*^9, 3.676118940213615*^9}, {3.6761191096213007`*^9, 
   3.676119140757559*^9}, {3.6761192665343122`*^9, 3.676119273783136*^9}, {
   3.67611936142714*^9, 3.676119363325075*^9}, {3.676119488561606*^9, 
   3.676119492487294*^9}, {3.6761200703687267`*^9, 3.6761200707356052`*^9}, {
   3.6761202104386873`*^9, 3.676120268289008*^9}, {3.676120410677075*^9, 
   3.676120443293746*^9}, {3.676120474583932*^9, 3.676120475526285*^9}, {
   3.6761206125852633`*^9, 3.6761206205196333`*^9}, {3.6761234586125507`*^9, 
   3.676123489461384*^9}, {3.6761235483793917`*^9, 3.676123569634534*^9}, {
   3.676124493441423*^9, 3.676124518157651*^9}, {3.676124553443336*^9, 
   3.676124582966502*^9}, {3.6761246820730133`*^9, 3.676124716437358*^9}, {
   3.67612487549886*^9, 3.676124882235661*^9}, {3.676124956893395*^9, 
   3.676124958216114*^9}, {3.6761249904362507`*^9, 3.676124994364197*^9}, {
   3.676125048497746*^9, 3.676125189073619*^9}, {3.676125219923954*^9, 
   3.6761253767254953`*^9}, {3.6761261361020412`*^9, 3.676126180304117*^9}, {
   3.6761262318219957`*^9, 3.676126312208794*^9}, {3.6761263690337877`*^9, 
   3.6761264446350737`*^9}, {3.676126475578731*^9, 3.676126485467072*^9}, {
   3.676126538828438*^9, 3.676126562090301*^9}, {3.676126633785634*^9, 
   3.6761266365895157`*^9}, 3.6761268247458773`*^9, 3.676126912241247*^9, {
   3.676126960168599*^9, 3.676126960170166*^9}, {3.676127961375718*^9, 
   3.676127975299335*^9}, {3.676128268770321*^9, 3.676128269338847*^9}, 
   3.676128811729394*^9, 3.676723618051702*^9, {3.6767236778209963`*^9, 
   3.676723719771995*^9}, {3.676723979458334*^9, 3.676724090604282*^9}, {
   3.676724127937508*^9, 3.6767241297457438`*^9}, {3.676724160436442*^9, 
   3.676724221011488*^9}, {3.676724251830257*^9, 3.67672438224609*^9}, {
   3.676724439849156*^9, 3.676724475037467*^9}, 3.6767483498529*^9, 
   3.6780964291715813`*^9, {3.6911754904044347`*^9, 3.691175566060762*^9}, {
   3.6924786857669306`*^9, 3.6924787359268*^9}, {3.6931540241963797`*^9, 
   3.6931540282211866`*^9}},ExpressionUUID->"4e7f1485-9b69-42b2-b750-\
f02d90141382"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"QuinticTimeScaling", "[", 
      RowBox[{"Tf_", ",", "t_"}], "]"}], ":", "\[IndentingNewLine]", "   ", 
     RowBox[{"Takes", " ", "Tf"}], ":", " ", 
     RowBox[{
     "Total", " ", "time", " ", "of", " ", "the", " ", "motion", " ", "in", 
      " ", "seconds", " ", "from", " ", "rest", " ", "to", " ", "rest"}]}], 
    ",", "\[IndentingNewLine]", "          ", 
    RowBox[{
     RowBox[{"t", ":", " ", 
      RowBox[{
       RowBox[{
       "The", " ", "current", " ", "time", " ", "t", " ", "satisfying", " ", 
        "0"}], "<", "t", "<", 
       RowBox[{
        RowBox[{"Tf", ".", "\[IndentingNewLine]", "Returns"}], " ", "s"}]}], 
      ":", " ", 
      RowBox[{
       RowBox[{"The", " ", "path", " ", "parameter", " ", "s", 
        RowBox[{"(", "t", ")"}], " ", "corresponding", " ", "to", " ", "a", 
        " ", "fifth"}], "-", 
       RowBox[{
       "order", " ", "polynomial", " ", "motion", " ", "that", " ", "begins", 
        " ", "and", " ", "ends", " ", "at", " ", "zero", " ", "velocity", " ",
         "and", " ", "zero", " ", 
        RowBox[{"acceleration", "."}]}]}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Example", ":", "\[IndentingNewLine]", "Input", ":", 
       "\[IndentingNewLine]", "Tf"}], "=", "2"}], ";", "\n", "  ", 
     RowBox[{"t", "=", "0.6"}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"s", " ", "=", " ", 
      RowBox[{
       RowBox[{"QuinticTimeScaling", "[", 
        RowBox[{"Tf", ",", "t"}], "]"}], "\[IndentingNewLine]", 
       RowBox[{"Output", ":", "\[IndentingNewLine]", "0.16308"}]}]}]}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"QuinticTimeScaling", "[", 
     RowBox[{"Tf_", ",", "t_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"10", "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"t", "/", "Tf"}], ")"}], "^", "3"}]}], "-", 
     RowBox[{"15", "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"t", "/", "Tf"}], ")"}], "^", "4"}]}], "+", 
     RowBox[{"6", "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"t", "/", "Tf"}], ")"}], "^", "5"}]}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6767251794253798`*^9, 3.676725236664359*^9}, {
   3.676725277944274*^9, 3.67672530444382*^9}, {3.676725421409651*^9, 
   3.6767254615354853`*^9}, {3.676725541834879*^9, 3.67672557969561*^9}, {
   3.676725634863492*^9, 3.67672567485637*^9}, {3.676725730380808*^9, 
   3.676725775670374*^9}, 3.6780964362059727`*^9, {3.6911766132276564`*^9, 
   3.6911766747101727`*^9}, {3.6924787156806417`*^9, 3.692478737600895*^9}, {
   3.6931540326047945`*^9, 
   3.693154036801202*^9}},ExpressionUUID->"fa932f5a-3894-409a-a875-\
d3671de900a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"JointTrajectory", "[", 
      RowBox[{
      "thetastart_", ",", "thetaend_", ",", "Tf_", ",", "N_", ",", 
       "method_"}], "]"}], ":", "\[IndentingNewLine]", "     ", 
     RowBox[{"Takes", " ", "thetastart"}], ":", " ", 
     RowBox[{"The", " ", "initial", " ", "joint", " ", "variables"}]}], ",", 
    "\[IndentingNewLine]", "            ", 
    RowBox[{"thetaend", ":", " ", 
     RowBox[{"The", " ", "final", " ", "joint", " ", "variables"}]}], ",", 
    RowBox[{"Tf", ":", 
     RowBox[{
     "Total", " ", "time", " ", "of", " ", "the", " ", "motion", " ", "in", 
      " ", "seconds", " ", "from", " ", "rest", " ", "to", " ", "rest"}]}], 
    ",", "                                                                    \
     ", "\[IndentingNewLine]", "            ", 
    RowBox[{"N", ":", " ", 
     RowBox[{
      RowBox[{"The", " ", "number", " ", "of", " ", "points", " ", "N"}], ">", 
      RowBox[{"1", " ", 
       RowBox[{"(", 
        RowBox[{"Start", " ", "and", " ", "stop"}], ")"}], " ", "in", " ", 
       "the", " ", "discrete", " ", "representation", " ", "of", " ", "the", 
       " ", "trajectory"}]}]}], ",", "\[IndentingNewLine]", "            ", 
    RowBox[{"method", ":", " ", 
     RowBox[{
      RowBox[{"The", " ", "time"}], "-", 
      RowBox[{"scaling", " ", "method"}]}]}], ",", 
    RowBox[{"where", " ", "3", " ", "indicates", " ", "cubic", " ", 
     RowBox[{"(", 
      RowBox[{"third", "-", 
       RowBox[{"order", " ", "polynomial"}]}], ")"}], " ", "time", " ", 
     "scaling", " ", "and", " ", "5", " ", "indicates", " ", "quintic", " ", 
     RowBox[{"(", 
      RowBox[{"fifth", "-", 
       RowBox[{"order", " ", "polynomial"}]}], ")"}], " ", "time", " ", 
     RowBox[{"scaling", ".", "\[IndentingNewLine]", "    ", "Returns"}], " ", 
     
     RowBox[{"traj", ":", " ", 
      RowBox[{
      "A", " ", "trajectory", " ", "as", " ", "an", " ", "N", " ", "x", " ", 
       "n", " ", "matrix"}]}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "where", " ", "each", " ", "row", " ", "is", " ", "an", " ", "n"}], "-", 
      RowBox[{
      "vector", " ", "of", " ", "joint", " ", "variables", " ", "at", " ", 
       "an", " ", "instant", " ", "in", " ", 
       RowBox[{"time", ".", "The"}], " ", "first", " ", "row", " ", "is", " ",
        "thetastart", " ", "and", " ", "the", " ", "Nth", " ", "row", " ", 
       "is", " ", 
       RowBox[{"thetaend", ".", "The"}], " ", "elapsed", " ", "time", " ", 
       "between", " ", "each", " ", "row", " ", "is", " ", 
       RowBox[{"Tf", "/", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"N", "-", "1"}], ")"}], ".", "\[IndentingNewLine]", 
         "The"}]}], " ", "returned", " ", "trajectory", " ", "is", " ", "a", 
       " ", "straight"}], "-", 
      RowBox[{"line", " ", "motion", " ", "in", " ", "joint", " ", 
       RowBox[{"space", "."}]}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Example", ":", "\[IndentingNewLine]", "Input", ":", 
       "\[IndentingNewLine]", "thetastart"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
         "1", ",", "0", ",", "0", ",", "1", ",", "1", ",", "0.2", ",", "0", 
          ",", "1"}], "}"}], "}"}], "\[Transpose]"}]}], ";", "\n", 
     RowBox[{"thetaend", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
         "1.2", ",", "0.5", ",", "0.6", ",", "1.1", ",", "2", ",", "2", ",", 
          "0.9", ",", "1"}], "}"}], "}"}], "\[Transpose]"}]}], ";", "\n", 
     RowBox[{"Tf", "=", "4"}], ";", "\n", 
     RowBox[{"Np", "=", "6"}], ";", "\n", 
     RowBox[{"method", "=", "3"}], ";", "\[IndentingNewLine]", 
     RowBox[{"traj", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"JointTrajectory", "[", 
         RowBox[{
         "thetastart", ",", "thetaend", ",", "Tf", ",", "Np", ",", "method"}],
          "]"}], "//", "MatrixForm"}], "//", 
       RowBox[{"N", "\[IndentingNewLine]", 
        RowBox[{"Output", ":", "\[IndentingNewLine]", 
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"1.", "0.", "0.", "1.", "1.", "0.2", "0.", "1."},
             {"1.0208", "0.052", "0.0624", "1.0104", "1.104", "0.3872", 
              "0.0936", "1."},
             {"1.0704", "0.176", "0.21119999999999997", "1.0352000000000001", 
              "1.352", "0.8335999999999999", "0.31679999999999997", "1."},
             {"1.1296", "0.324", "0.3888", "1.0648", "1.648", "1.3664", 
              "0.5832", "1."},
             {"1.1792", "0.448", "0.5376", "1.0896000000000001", "1.896", 
              "1.8128", "0.8064", "1."},
             {"1.2", "0.5", "0.6", "1.1", "2.", "2.", "0.9", "1."}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]]}]}]}]}]}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"JointTrajectory", "[", 
     RowBox[{
     "thetastart_", ",", "thetaend_", ",", "Tf_", ",", "Num_", ",", 
      "method_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Numb", "=", 
         RowBox[{"Round", "[", "Num", "]"}]}], ",", "timegap", ",", "traj", 
        ",", "s"}], "}"}], ",", 
      RowBox[{
       RowBox[{"timegap", "=", 
        RowBox[{"Tf", "/", 
         RowBox[{"(", 
          RowBox[{"Numb", "-", "1"}], ")"}]}]}], ";", 
       RowBox[{"traj", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Length", "[", "thetastart", "]"}], ",", "Numb"}], 
           "}"}]}], "]"}]}], ";", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"method", " ", "\[Equal]", " ", "3"}], ",", 
            RowBox[{"s", "=", 
             RowBox[{"CubicTimeScaling", "[", 
              RowBox[{"Tf", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"i", "-", "1"}], ")"}], "*", "timegap"}]}], "]"}]}], 
            ",", 
            RowBox[{"s", "=", " ", 
             RowBox[{"QuinticTimeScaling", "[", 
              RowBox[{"Tf", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"i", "-", "1"}], ")"}], "*", "timegap"}]}], 
              "]"}]}]}], "]"}], ";", 
          RowBox[{
           RowBox[{"traj", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", "i"}], "]"}], "]"}], "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{"thetastart", " ", "+", 
             RowBox[{"s", "*", 
              RowBox[{"(", 
               RowBox[{"thetaend", "-", "thetastart"}], ")"}]}]}], "]"}]}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "Numb"}], "}"}]}], "]"}], ";", 
       RowBox[{"traj", "=", 
        RowBox[{"traj", "\[Transpose]"}]}], ";", 
       RowBox[{"Return", "[", "traj", "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654107438701495*^9, 3.6541075770931664`*^9}, {
   3.6541076103152647`*^9, 3.654107726674172*^9}, {3.654107800327899*^9, 
   3.654107805926005*^9}, {3.654107842157054*^9, 3.654107956534466*^9}, {
   3.6541080276373253`*^9, 3.654108039845397*^9}, {3.654108208328875*^9, 
   3.654108267778264*^9}, {3.654108316603101*^9, 3.65410832858707*^9}, {
   3.654122072990996*^9, 3.654122200142358*^9}, {3.654122232524707*^9, 
   3.6541222637488813`*^9}, {3.654122372486209*^9, 3.65412253592478*^9}, {
   3.654122571686759*^9, 3.654122685636675*^9}, {3.654122740902017*^9, 
   3.6541228215630703`*^9}, {3.654122865671712*^9, 3.654122935620612*^9}, {
   3.654123032181581*^9, 3.6541230914473333`*^9}, {3.654123152783122*^9, 
   3.6541232043612537`*^9}, {3.654123304611115*^9, 3.654123341073502*^9}, {
   3.654123502235703*^9, 3.654123578362132*^9}, {3.654123664279245*^9, 
   3.654123683195951*^9}, {3.6541237878998413`*^9, 3.6541238249788847`*^9}, {
   3.654123940392714*^9, 3.654123947510108*^9}, {3.654124026309593*^9, 
   3.654124026885428*^9}, 3.6541241152729683`*^9, 3.654124170343902*^9, {
   3.6541246995439568`*^9, 3.654124712871656*^9}, {3.6541251843297157`*^9, 
   3.654125231518578*^9}, {3.6541254856851683`*^9, 3.65412548908077*^9}, {
   3.654125547742125*^9, 3.654125551165526*^9}, {3.654125930807577*^9, 
   3.654126007244483*^9}, {3.654126127665163*^9, 3.654126191634789*^9}, {
   3.654126236482831*^9, 3.654126250153975*^9}, {3.6541262848658533`*^9, 
   3.654126288991514*^9}, {3.654126323055903*^9, 3.654126399729628*^9}, {
   3.654126435349374*^9, 3.654126447266036*^9}, {3.654126530077552*^9, 
   3.6541265937421*^9}, {3.654126679867402*^9, 3.6541267650289497`*^9}, {
   3.6541267969631968`*^9, 3.654126798410089*^9}, {3.654126829860013*^9, 
   3.654126881359337*^9}, {3.6541269393824577`*^9, 3.654126959132009*^9}, {
   3.654127079773924*^9, 3.654127194954756*^9}, {3.654127229244482*^9, 
   3.654127253953713*^9}, {3.6541278694900227`*^9, 3.654127878663176*^9}, {
   3.654127969775614*^9, 3.6541279938293123`*^9}, {3.654128051763153*^9, 
   3.654128134016169*^9}, {3.654128326830834*^9, 3.654128326972948*^9}, {
   3.654182305132535*^9, 3.654182317491791*^9}, {3.65418238746202*^9, 
   3.654182511491269*^9}, {3.654182551115921*^9, 3.654182559209998*^9}, {
   3.6541826265390177`*^9, 3.654182732425318*^9}, {3.654182795218339*^9, 
   3.654182802306821*^9}, {3.654182858360195*^9, 3.654182976637673*^9}, {
   3.65418309291822*^9, 3.6541831115452337`*^9}, {3.654183280620055*^9, 
   3.654183381285778*^9}, {3.6541834216733217`*^9, 3.65418343026462*^9}, {
   3.65418347398075*^9, 3.654183479016459*^9}, {3.654183517743698*^9, 
   3.654183590244978*^9}, {3.654183629340012*^9, 3.654183659551435*^9}, {
   3.654183828746057*^9, 3.654183869187777*^9}, {3.654183918271063*^9, 
   3.6541839184304667`*^9}, {3.654206461375032*^9, 3.6542064948942213`*^9}, {
   3.6542065261576433`*^9, 3.654206710642645*^9}, {3.65420685898112*^9, 
   3.654206859498214*^9}, {3.654206912388175*^9, 3.6542069199221067`*^9}, {
   3.654206956850091*^9, 3.654206957769821*^9}, {3.6542070885864773`*^9, 
   3.6542070905801163`*^9}, {3.6542071861274023`*^9, 3.654207197287834*^9}, {
   3.654207355631957*^9, 3.65420737546005*^9}, {3.654207422116619*^9, 
   3.6542074295958633`*^9}, {3.654207513008601*^9, 3.654207622631179*^9}, {
   3.6542077902321663`*^9, 3.6542079082040863`*^9}, {3.654208112675095*^9, 
   3.6542082406765347`*^9}, {3.654208390436673*^9, 3.654208437282127*^9}, {
   3.654208729398788*^9, 3.6542088242969923`*^9}, {3.654208875181876*^9, 
   3.6542089105814543`*^9}, {3.654209036563011*^9, 3.654209042056604*^9}, {
   3.654209131808134*^9, 3.654209211748107*^9}, {3.654277910558556*^9, 
   3.654277962902483*^9}, {3.6542785554956903`*^9, 3.654278555764879*^9}, {
   3.6542801407928543`*^9, 3.654280145647377*^9}, {3.654280336511973*^9, 
   3.654280388661951*^9}, {3.654735519742467*^9, 3.654735526212496*^9}, {
   3.654736711632904*^9, 3.654736744359725*^9}, {3.654736840726715*^9, 
   3.6547369027091503`*^9}, {3.6547369619155817`*^9, 3.65473711893006*^9}, 
   3.654737215212165*^9, {3.6547372623430433`*^9, 3.654737301717353*^9}, {
   3.654737434898181*^9, 3.654737445769989*^9}, {3.654737593349925*^9, 
   3.654737893647337*^9}, {3.654737938282483*^9, 3.654737939560112*^9}, {
   3.654737995469615*^9, 3.65473804382544*^9}, {3.65473814244207*^9, 
   3.65473826286047*^9}, {3.654738473301898*^9, 3.654738519313912*^9}, {
   3.654738551955141*^9, 3.654738559351729*^9}, {3.654738599129403*^9, 
   3.654738599566987*^9}, {3.654738653005966*^9, 3.654738704434928*^9}, {
   3.654738885183668*^9, 3.654738922018218*^9}, {3.654739011880048*^9, 
   3.65473910917871*^9}, {3.654739159170903*^9, 3.654739162120161*^9}, {
   3.6547393230277576`*^9, 3.6547393764227123`*^9}, {3.654739415181912*^9, 
   3.65473942023728*^9}, {3.654739453135948*^9, 3.654739679965816*^9}, {
   3.654739718627033*^9, 3.6547397334487553`*^9}, {3.654739765385715*^9, 
   3.654739851694334*^9}, {3.654739889466123*^9, 3.654740005071364*^9}, {
   3.6547400491757*^9, 3.654740154008595*^9}, 3.654740216700787*^9, {
   3.654740314399178*^9, 3.6547403286014967`*^9}, 3.6547403850818996`*^9, {
   3.654740521314966*^9, 3.654740541208376*^9}, {3.65474063388687*^9, 
   3.654740654515286*^9}, {3.654740701345427*^9, 3.654740810460566*^9}, {
   3.654740848239312*^9, 3.654741082783293*^9}, {3.654741274225429*^9, 
   3.65474127713437*^9}, 3.654741426789631*^9, {3.6547414571147537`*^9, 
   3.654741569824174*^9}, {3.654741604551594*^9, 3.65474161887015*^9}, {
   3.6547416933496304`*^9, 3.654741709459137*^9}, {3.654741935230948*^9, 
   3.654741945307493*^9}, {3.6547830386167917`*^9, 3.654783105454197*^9}, {
   3.6547832406606083`*^9, 3.6547832525310373`*^9}, {3.654783794511154*^9, 
   3.654783837663447*^9}, {3.65478390359721*^9, 3.654783909803577*^9}, {
   3.654783989474423*^9, 3.654784403124803*^9}, {3.654784520313846*^9, 
   3.654784622329711*^9}, {3.6547847231449842`*^9, 3.654784727983326*^9}, {
   3.654785122876478*^9, 3.654785187751635*^9}, {3.654785255283667*^9, 
   3.654785472044736*^9}, {3.654785554330287*^9, 3.6547855634367*^9}, {
   3.6547858133842907`*^9, 3.654785842420493*^9}, {3.654785988696732*^9, 
   3.654785999313698*^9}, {3.654786083383224*^9, 3.654786083827299*^9}, {
   3.654799998454865*^9, 3.654800009014682*^9}, 3.654800058896707*^9, {
   3.6548001027328*^9, 3.654800173381201*^9}, {3.654800206111162*^9, 
   3.654800346038969*^9}, {3.654800415767541*^9, 3.654800685527397*^9}, {
   3.654800717895743*^9, 3.6548007259529123`*^9}, {3.6548007560240192`*^9, 
   3.654800892868227*^9}, {3.654800961067473*^9, 3.6548010443125353`*^9}, {
   3.654801144205307*^9, 3.6548013970409203`*^9}, {3.654801447723054*^9, 
   3.6548014700938597`*^9}, {3.654801562889327*^9, 3.6548017505389137`*^9}, {
   3.6548017965315866`*^9, 3.654801838591158*^9}, {3.654801925163512*^9, 
   3.654801957336872*^9}, {3.654802037838778*^9, 3.654802097667626*^9}, {
   3.6548021338675137`*^9, 3.654802151746142*^9}, {3.6548021938035927`*^9, 
   3.65480226557542*^9}, {3.6548023434469347`*^9, 3.6548024564595747`*^9}, {
   3.654802493167995*^9, 3.654802498462143*^9}, {3.654802632969117*^9, 
   3.654802636326886*^9}, {3.6548026864101667`*^9, 3.6548027624957323`*^9}, {
   3.654802812209731*^9, 3.6548030159498*^9}, {3.6548066359524317`*^9, 
   3.654806720935005*^9}, {3.654806751992766*^9, 3.6548067587144833`*^9}, {
   3.654806821497799*^9, 3.654806889382121*^9}, {3.654807006283039*^9, 
   3.654807210369132*^9}, {3.654807340425975*^9, 3.6548074184588003`*^9}, {
   3.6548074913193197`*^9, 3.654807699931301*^9}, 3.6548078200861998`*^9, {
   3.654807890939335*^9, 3.65480791502777*^9}, {3.654807960842239*^9, 
   3.6548080712336483`*^9}, {3.654808128338978*^9, 3.6548081799548407`*^9}, {
   3.6548101758929577`*^9, 3.654810330104765*^9}, {3.654810401423953*^9, 
   3.654810408457419*^9}, {3.6548104718702717`*^9, 3.6548106690676603`*^9}, {
   3.6548107121438303`*^9, 3.6548108463298893`*^9}, {3.654810878513033*^9, 
   3.6548109250220337`*^9}, {3.654810973064028*^9, 3.6548109963255377`*^9}, {
   3.654811065383171*^9, 3.65481111435124*^9}, {3.6548111568410273`*^9, 
   3.654811165569319*^9}, {3.654811202562601*^9, 3.654811649746052*^9}, {
   3.657067656153129*^9, 3.657067660941557*^9}, {3.6570766750689*^9, 
   3.657076677028944*^9}, {3.658274451899232*^9, 3.6582744912918463`*^9}, {
   3.6583703518545094`*^9, 3.65837035300604*^9}, {3.67672532250014*^9, 
   3.676725326694919*^9}, {3.676726238098218*^9, 3.6767262868714447`*^9}, {
   3.67672632351712*^9, 3.676726328872868*^9}, {3.6767269746668167`*^9, 
   3.676726982754202*^9}, {3.676727016189947*^9, 3.6767270198275414`*^9}, {
   3.676727056006617*^9, 3.676727061995698*^9}, {3.676727162429737*^9, 
   3.676727252326495*^9}, {3.676727300513076*^9, 3.6767274904689007`*^9}, {
   3.6767382395189667`*^9, 3.676738245456195*^9}, 3.676743247626157*^9, {
   3.676748358463169*^9, 3.6767483602563457`*^9}, 3.678096441208591*^9, {
   3.6911891462586484`*^9, 3.6911891500962553`*^9}, {3.6911892163339715`*^9, 
   3.691189307765732*^9}, {3.6911893792941775`*^9, 3.691189661283306*^9}, 
   3.6911897134022875`*^9, {3.6911897779439793`*^9, 3.6911899073293796`*^9}, {
   3.69119374391782*^9, 3.691193824151409*^9}, {3.691194316052544*^9, 
   3.691194321015828*^9}, {3.6912399841067915`*^9, 3.691239985105193*^9}, {
   3.6912402595382757`*^9, 3.6912403230645876`*^9}, {3.6912403553742447`*^9, 
   3.691240444876602*^9}, {3.691240612846568*^9, 3.691240682956092*^9}, 
   3.6912407187289543`*^9, {3.6924745037041683`*^9, 3.692474615545565*^9}, {
   3.692474647572397*^9, 3.6924748587114735`*^9}, {3.6931540449912157`*^9, 
   3.6931540481112213`*^9}, {3.693162697432002*^9, 
   3.693162699008605*^9}},ExpressionUUID->"108455ec-984d-4e4a-8086-\
3e93d8891e56"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"ScrewTrajectory", "[", 
      RowBox[{
      "Xstart_", ",", "Xend_", ",", "Tf_", ",", "N_", ",", "method_"}], "]"}],
      ":", "\[IndentingNewLine]", "   ", 
     RowBox[{"Takes", " ", "Xstart"}], ":", " ", 
     RowBox[{
      RowBox[{"The", " ", "initial", " ", "end"}], "-", 
      RowBox[{"effector", " ", "configuration"}]}]}], ",", 
    RowBox[{"Xend", ":", 
     RowBox[{
      RowBox[{"The", " ", "final", " ", "end"}], "-", 
      RowBox[{"effector", " ", "configuration"}]}]}], ",", 
    RowBox[{"Tf", ":", 
     RowBox[{
     "Total", " ", "time", " ", "of", " ", "the", " ", "motion", " ", "in", 
      " ", "seconds", " ", "from", " ", "rest", " ", "to", " ", "rest"}]}], 
    ",", "   ", "\[IndentingNewLine]", "          ", 
    RowBox[{"N", ":", " ", 
     RowBox[{
      RowBox[{"The", " ", "number", " ", "of", " ", "points", " ", "N"}], ">", 
      RowBox[{"1", " ", 
       RowBox[{"(", 
        RowBox[{"Start", " ", "and", " ", "stop"}], ")"}], " ", "in", " ", 
       "the", " ", "discrete", " ", "representation", " ", "of", " ", "the", 
       " ", "trajectory"}]}]}], ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"method", ":", " ", 
     RowBox[{
      RowBox[{"The", " ", "time"}], "-", 
      RowBox[{"scaling", " ", "method"}]}]}], ",", " ", 
    RowBox[{
     RowBox[{"where", " ", "3", " ", "indicates", " ", "cubic", " ", 
      RowBox[{"(", 
       RowBox[{"third", "-", 
        RowBox[{"order", " ", "polynomial"}]}], ")"}], " ", "time", " ", 
      "scaling", " ", "and", " ", "5", " ", "indicates", " ", "quintic", " ", 
      
      RowBox[{"(", 
       RowBox[{"fifth", "-", 
        RowBox[{"order", " ", "polynomial"}]}], ")"}], " ", "time", " ", 
      RowBox[{"scaling", ".", "\[IndentingNewLine]", "  ", "Returns"}], " ", 
      RowBox[{"traj", ":", " ", 
       RowBox[{
       "The", " ", "discretized", " ", "trajectory", " ", "as", " ", "a", " ",
         "list", " ", "of", " ", "N", " ", "matrices", " ", "in", " ", "SE", 
        RowBox[{"(", "3", ")"}], " ", "separated", " ", "in", " ", "time", 
        " ", "by", " ", 
        RowBox[{"Tf", "/", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}], ".", "The"}]}], " ", "first", " ", 
        "in", " ", "the", " ", "list", " ", "is", " ", "Xstart", " ", "and", 
        " ", "the", " ", "Nth", " ", "is", " ", 
        RowBox[{"Xend", ".", "\[IndentingNewLine]", "This"}], " ", "function",
         " ", "calculates", " ", "a", " ", "trajectory", " ", "corresponding",
         " ", "to", " ", "the", " ", "screw", " ", "motion", " ", "about", 
        " ", "a", " ", "space", " ", "screw", " ", 
        RowBox[{"axis", "."}]}]}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Example", ":", "\[IndentingNewLine]", "Input", ":", 
       "\[IndentingNewLine]", "Xstart"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\n", "  ", 
     RowBox[{"Xend", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "4.1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\n", "  ", 
     RowBox[{"Tf", "=", "5"}], ";", "\n", "  ", 
     RowBox[{"Np", "=", "4"}], ";", "\n", "  ", 
     RowBox[{"method", "=", "3"}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"traj", " ", "=", " ", 
      RowBox[{"ScrewTrajectory", "[", 
       RowBox[{"Xstart", ",", "Xend", ",", "Tf", ",", "Np", ",", "method"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"traj", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "//", 
         RowBox[{"MatrixForm", "\[IndentingNewLine]", 
          RowBox[{"traj", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "//", 
        RowBox[{"MatrixForm", "\[IndentingNewLine]", 
         RowBox[{"traj", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}]}], "//", 
       RowBox[{"MatrixForm", "\[IndentingNewLine]", 
        RowBox[{"traj", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}]}], "//", 
      RowBox[{"MatrixForm", "\[IndentingNewLine]", 
       RowBox[{"Output", ":", "\[IndentingNewLine]", " ", 
        RowBox[{
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"1.", "0.", "0.", "1."},
             {"0.", "1.", "0.", "0."},
             {"0.", "0.", "1.", "1."},
             {"0.", "0.", "0.", "1."}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]], "\[IndentingNewLine]", 
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"0.904", 
              RowBox[{"-", "0.25"}], "0.346", "0.441"},
             {"0.346", "0.904", 
              RowBox[{"-", "0.25"}], "0.529"},
             {
              RowBox[{"-", "0.25"}], "0.346", "0.904", "1.601"},
             {"0.", "0.", "0.", "1."}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]], "\[IndentingNewLine]", 
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"0.346", 
              RowBox[{"-", "0.25"}], "0.904", 
              RowBox[{"-", "0.117"}]},
             {"0.904", "0.346", 
              RowBox[{"-", "0.25"}], "0.473"},
             {
              RowBox[{"-", "0.25"}], "0.904", "0.346", "3.274"},
             {"0.", "0.", "0.", "1."}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]], "\[IndentingNewLine]", 
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"0.", "0.", "1.", "0.1"},
             {"1.", "0.", "0.", "0."},
             {"0.", "1.", "0.", "4.1"},
             {"0.", "0.", "0.", "1."}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]]}]}]}]}]}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ScrewTrajectory", "[", 
     RowBox[{"Xstart_", ",", "Xend_", ",", "Tf_", ",", "N_", ",", "method_"}],
      "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"timegap", "=", 
         RowBox[{"Tf", "/", 
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}]}]}], ",", 
        RowBox[{"traj", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"Null", ",", "N"}], "]"}]}], ",", "s"}], "}"}], ",", 
      RowBox[{
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"method", " ", "\[Equal]", " ", "3"}], ",", 
            RowBox[{"s", "=", 
             RowBox[{"CubicTimeScaling", "[", 
              RowBox[{"Tf", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"i", "-", "1"}], ")"}], "*", "timegap"}]}], "]"}]}], 
            ",", 
            RowBox[{"s", "=", " ", 
             RowBox[{"QuinticTimeScaling", "[", 
              RowBox[{"Tf", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"i", "-", "1"}], ")"}], "*", "timegap"}]}], 
              "]"}]}]}], "]"}], ";", 
          RowBox[{
           RowBox[{"traj", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{"Xstart", ".", 
            RowBox[{"MatrixExp6", "[", 
             RowBox[{
              RowBox[{"MatrixLog6", "[", 
               RowBox[{
                RowBox[{"TransInv", "[", "Xstart", "]"}], ".", "Xend"}], 
               "]"}], "*", "s"}], "]"}]}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "N"}], "}"}]}], "]"}], ";", 
       RowBox[{"Return", "[", "traj", "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654107438701495*^9, 3.6541075770931664`*^9}, {
   3.6541076103152647`*^9, 3.654107726674172*^9}, {3.654107800327899*^9, 
   3.654107805926005*^9}, {3.654107842157054*^9, 3.654107956534466*^9}, {
   3.6541080276373253`*^9, 3.654108039845397*^9}, {3.654108208328875*^9, 
   3.654108267778264*^9}, {3.654108316603101*^9, 3.65410832858707*^9}, {
   3.654122072990996*^9, 3.654122200142358*^9}, {3.654122232524707*^9, 
   3.6541222637488813`*^9}, {3.654122372486209*^9, 3.65412253592478*^9}, {
   3.654122571686759*^9, 3.654122685636675*^9}, {3.654122740902017*^9, 
   3.6541228215630703`*^9}, {3.654122865671712*^9, 3.654122935620612*^9}, {
   3.654123032181581*^9, 3.6541230914473333`*^9}, {3.654123152783122*^9, 
   3.6541232043612537`*^9}, {3.654123304611115*^9, 3.654123341073502*^9}, {
   3.654123502235703*^9, 3.654123578362132*^9}, {3.654123664279245*^9, 
   3.654123683195951*^9}, {3.6541237878998413`*^9, 3.6541238249788847`*^9}, {
   3.654123940392714*^9, 3.654123947510108*^9}, {3.654124026309593*^9, 
   3.654124026885428*^9}, 3.6541241152729683`*^9, 3.654124170343902*^9, {
   3.6541246995439568`*^9, 3.654124712871656*^9}, {3.6541251843297157`*^9, 
   3.654125231518578*^9}, {3.6541254856851683`*^9, 3.65412548908077*^9}, {
   3.654125547742125*^9, 3.654125551165526*^9}, {3.654125930807577*^9, 
   3.654126007244483*^9}, {3.654126127665163*^9, 3.654126191634789*^9}, {
   3.654126236482831*^9, 3.654126250153975*^9}, {3.6541262848658533`*^9, 
   3.654126288991514*^9}, {3.654126323055903*^9, 3.654126399729628*^9}, {
   3.654126435349374*^9, 3.654126447266036*^9}, {3.654126530077552*^9, 
   3.6541265937421*^9}, {3.654126679867402*^9, 3.6541267650289497`*^9}, {
   3.6541267969631968`*^9, 3.654126798410089*^9}, {3.654126829860013*^9, 
   3.654126881359337*^9}, {3.6541269393824577`*^9, 3.654126959132009*^9}, {
   3.654127079773924*^9, 3.654127194954756*^9}, {3.654127229244482*^9, 
   3.654127253953713*^9}, {3.6541278694900227`*^9, 3.654127878663176*^9}, {
   3.654127969775614*^9, 3.6541279938293123`*^9}, {3.654128051763153*^9, 
   3.654128134016169*^9}, {3.654128326830834*^9, 3.654128326972948*^9}, {
   3.654182305132535*^9, 3.654182317491791*^9}, {3.65418238746202*^9, 
   3.654182511491269*^9}, {3.654182551115921*^9, 3.654182559209998*^9}, {
   3.6541826265390177`*^9, 3.654182732425318*^9}, {3.654182795218339*^9, 
   3.654182802306821*^9}, {3.654182858360195*^9, 3.654182976637673*^9}, {
   3.65418309291822*^9, 3.6541831115452337`*^9}, {3.654183280620055*^9, 
   3.654183381285778*^9}, {3.6541834216733217`*^9, 3.65418343026462*^9}, {
   3.65418347398075*^9, 3.654183479016459*^9}, {3.654183517743698*^9, 
   3.654183590244978*^9}, {3.654183629340012*^9, 3.654183659551435*^9}, {
   3.654183828746057*^9, 3.654183869187777*^9}, {3.654183918271063*^9, 
   3.6541839184304667`*^9}, {3.654206461375032*^9, 3.6542064948942213`*^9}, {
   3.6542065261576433`*^9, 3.654206710642645*^9}, {3.65420685898112*^9, 
   3.654206859498214*^9}, {3.654206912388175*^9, 3.6542069199221067`*^9}, {
   3.654206956850091*^9, 3.654206957769821*^9}, {3.6542070885864773`*^9, 
   3.6542070905801163`*^9}, {3.6542071861274023`*^9, 3.654207197287834*^9}, {
   3.654207355631957*^9, 3.65420737546005*^9}, {3.654207422116619*^9, 
   3.6542074295958633`*^9}, {3.654207513008601*^9, 3.654207622631179*^9}, {
   3.6542077902321663`*^9, 3.6542079082040863`*^9}, {3.654208112675095*^9, 
   3.6542082406765347`*^9}, {3.654208390436673*^9, 3.654208437282127*^9}, {
   3.654208729398788*^9, 3.6542088242969923`*^9}, {3.654208875181876*^9, 
   3.6542089105814543`*^9}, {3.654209036563011*^9, 3.654209042056604*^9}, {
   3.654209131808134*^9, 3.654209211748107*^9}, {3.654277910558556*^9, 
   3.654277962902483*^9}, {3.6542785554956903`*^9, 3.654278555764879*^9}, {
   3.6542801407928543`*^9, 3.654280145647377*^9}, {3.654280336511973*^9, 
   3.654280388661951*^9}, {3.654735519742467*^9, 3.654735526212496*^9}, {
   3.654736711632904*^9, 3.654736744359725*^9}, {3.654736840726715*^9, 
   3.6547369027091503`*^9}, {3.6547369619155817`*^9, 3.65473711893006*^9}, 
   3.654737215212165*^9, {3.6547372623430433`*^9, 3.654737301717353*^9}, {
   3.654737434898181*^9, 3.654737445769989*^9}, {3.654737593349925*^9, 
   3.654737893647337*^9}, {3.654737938282483*^9, 3.654737939560112*^9}, {
   3.654737995469615*^9, 3.65473804382544*^9}, {3.65473814244207*^9, 
   3.65473826286047*^9}, {3.654738473301898*^9, 3.654738519313912*^9}, {
   3.654738551955141*^9, 3.654738559351729*^9}, {3.654738599129403*^9, 
   3.654738599566987*^9}, {3.654738653005966*^9, 3.654738704434928*^9}, {
   3.654738885183668*^9, 3.654738922018218*^9}, {3.654739011880048*^9, 
   3.65473910917871*^9}, {3.654739159170903*^9, 3.654739162120161*^9}, {
   3.6547393230277576`*^9, 3.6547393764227123`*^9}, {3.654739415181912*^9, 
   3.65473942023728*^9}, {3.654739453135948*^9, 3.654739679965816*^9}, {
   3.654739718627033*^9, 3.6547397334487553`*^9}, {3.654739765385715*^9, 
   3.654739851694334*^9}, {3.654739889466123*^9, 3.654740005071364*^9}, {
   3.6547400491757*^9, 3.654740154008595*^9}, 3.654740216700787*^9, {
   3.654740314399178*^9, 3.6547403286014967`*^9}, 3.6547403850818996`*^9, {
   3.654740521314966*^9, 3.654740541208376*^9}, {3.65474063388687*^9, 
   3.654740654515286*^9}, {3.654740701345427*^9, 3.654740810460566*^9}, {
   3.654740848239312*^9, 3.654741082783293*^9}, {3.654741274225429*^9, 
   3.65474127713437*^9}, 3.654741426789631*^9, {3.6547414571147537`*^9, 
   3.654741569824174*^9}, {3.654741604551594*^9, 3.65474161887015*^9}, {
   3.6547416933496304`*^9, 3.654741709459137*^9}, {3.654741935230948*^9, 
   3.654741945307493*^9}, {3.6547830386167917`*^9, 3.654783105454197*^9}, {
   3.6547832406606083`*^9, 3.6547832525310373`*^9}, {3.654783794511154*^9, 
   3.654783837663447*^9}, {3.65478390359721*^9, 3.654783909803577*^9}, {
   3.654783989474423*^9, 3.654784403124803*^9}, {3.654784520313846*^9, 
   3.654784622329711*^9}, {3.6547847231449842`*^9, 3.654784727983326*^9}, {
   3.654785122876478*^9, 3.654785187751635*^9}, {3.654785255283667*^9, 
   3.654785472044736*^9}, {3.654785554330287*^9, 3.6547855634367*^9}, {
   3.6547858133842907`*^9, 3.654785842420493*^9}, {3.654785988696732*^9, 
   3.654785999313698*^9}, {3.654786083383224*^9, 3.654786083827299*^9}, {
   3.654799998454865*^9, 3.654800009014682*^9}, 3.654800058896707*^9, {
   3.6548001027328*^9, 3.654800173381201*^9}, {3.654800206111162*^9, 
   3.654800346038969*^9}, {3.654800415767541*^9, 3.654800685527397*^9}, {
   3.654800717895743*^9, 3.6548007259529123`*^9}, {3.6548007560240192`*^9, 
   3.654800892868227*^9}, {3.654800961067473*^9, 3.6548010443125353`*^9}, {
   3.654801144205307*^9, 3.6548013970409203`*^9}, {3.654801447723054*^9, 
   3.6548014700938597`*^9}, {3.654801562889327*^9, 3.6548017505389137`*^9}, {
   3.6548017965315866`*^9, 3.654801838591158*^9}, {3.654801925163512*^9, 
   3.654801957336872*^9}, {3.654802037838778*^9, 3.654802097667626*^9}, {
   3.6548021338675137`*^9, 3.654802151746142*^9}, {3.6548021938035927`*^9, 
   3.65480226557542*^9}, {3.6548023434469347`*^9, 3.6548024564595747`*^9}, {
   3.654802493167995*^9, 3.654802498462143*^9}, {3.654802632969117*^9, 
   3.654802636326886*^9}, {3.6548026864101667`*^9, 3.6548027624957323`*^9}, {
   3.654802812209731*^9, 3.6548030159498*^9}, {3.6548066359524317`*^9, 
   3.654806720935005*^9}, {3.654806751992766*^9, 3.6548067587144833`*^9}, {
   3.654806821497799*^9, 3.654806889382121*^9}, {3.654807006283039*^9, 
   3.654807210369132*^9}, {3.654807340425975*^9, 3.6548074184588003`*^9}, {
   3.6548074913193197`*^9, 3.654807699931301*^9}, 3.6548078200861998`*^9, {
   3.654807890939335*^9, 3.65480791502777*^9}, {3.654807960842239*^9, 
   3.6548080712336483`*^9}, {3.654808128338978*^9, 3.6548081799548407`*^9}, {
   3.6548101758929577`*^9, 3.654810330104765*^9}, {3.654810401423953*^9, 
   3.654810408457419*^9}, {3.6548104718702717`*^9, 3.6548106690676603`*^9}, {
   3.6548107121438303`*^9, 3.6548108463298893`*^9}, {3.654810878513033*^9, 
   3.6548109250220337`*^9}, {3.654810973064028*^9, 3.6548109963255377`*^9}, {
   3.654811065383171*^9, 3.65481111435124*^9}, {3.6548111568410273`*^9, 
   3.654811165569319*^9}, {3.654811202562601*^9, 3.654811649746052*^9}, {
   3.657067656153129*^9, 3.657067660941557*^9}, {3.6570766750689*^9, 
   3.657076677028944*^9}, {3.658274451899232*^9, 3.6582744912918463`*^9}, {
   3.6583703518545094`*^9, 3.65837035300604*^9}, {3.6767384630832443`*^9, 
   3.6767384852301083`*^9}, {3.676738544986739*^9, 3.676738607109634*^9}, {
   3.676739097041395*^9, 3.676739116485881*^9}, {3.6767393261296473`*^9, 
   3.676739361702149*^9}, {3.6767396930954237`*^9, 3.676739694812849*^9}, 
   3.676739769624935*^9, {3.676739804626966*^9, 3.676739852892261*^9}, {
   3.676741390075983*^9, 3.676741723511598*^9}, 3.6774898932912083`*^9, 
   3.678096448832265*^9, 3.691191530784236*^9, {3.691191616929163*^9, 
   3.6911916893663063`*^9}, {3.691191734550891*^9, 3.691191924737769*^9}, {
   3.691193832070862*^9, 3.691193855746216*^9}, {3.691194328297244*^9, 
   3.6911943322294693`*^9}, {3.692478748282506*^9, 3.692478847255167*^9}, 
   3.692486566709695*^9, {3.6931540553652344`*^9, 
   3.6931540619016457`*^9}},ExpressionUUID->"11a7c85e-9c0a-4b1e-b8b9-\
7f9041111f11"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"CartesianTrajectory", "[", 
      RowBox[{
      "Xstart_", ",", "Xend_", ",", "Tf_", ",", "N_", ",", "method_"}], "]"}],
      ":", "\[IndentingNewLine]", "   ", 
     RowBox[{"Takes", " ", "Xstart"}], ":", " ", 
     RowBox[{
      RowBox[{"The", " ", "initial", " ", "end"}], "-", 
      RowBox[{"effector", " ", "configuration"}]}]}], ",", 
    RowBox[{"Xend", ":", 
     RowBox[{
      RowBox[{"The", " ", "final", " ", "end"}], "-", 
      RowBox[{"effector", " ", "configuration"}]}]}], ",", 
    RowBox[{"Tf", ":", 
     RowBox[{
     "Total", " ", "time", " ", "of", " ", "the", " ", "motion", " ", "in", 
      " ", "seconds", " ", "from", " ", "rest", " ", "to", " ", "rest"}]}], 
    ",", " ", "\[IndentingNewLine]", "          ", 
    RowBox[{"N", ":", 
     RowBox[{
      RowBox[{"The", " ", "number", " ", "of", " ", "points", " ", "N"}], ">", 
      RowBox[{"1", " ", 
       RowBox[{"(", 
        RowBox[{"Start", " ", "and", " ", "stop"}], ")"}], " ", "in", " ", 
       "the", " ", "discrete", " ", "representation", " ", "of", " ", "the", 
       " ", "trajectory"}]}]}], ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"method", ":", 
     RowBox[{
      RowBox[{"The", " ", "time"}], "-", 
      RowBox[{"scaling", " ", "method"}]}]}], ",", 
    RowBox[{"where", " ", "3", " ", "indicates", " ", "cubic", " ", 
     RowBox[{"(", 
      RowBox[{"third", "-", 
       RowBox[{"order", " ", "polynomial"}]}], ")"}], " ", "time", " ", 
     "scaling", " ", "and", " ", "5", " ", "indicates", " ", "quintic", " ", 
     RowBox[{"(", 
      RowBox[{"fifth", "-", 
       RowBox[{"order", " ", "polynomial"}]}], ")"}], " ", "time", " ", 
     RowBox[{"scaling", ".", "\[IndentingNewLine]", "  ", "Returns"}], " ", 
     RowBox[{"traj", ":", " ", 
      RowBox[{
      "The", " ", "discretized", " ", "trajectory", " ", "as", " ", "a", " ", 
       "list", " ", "of", " ", "N", " ", "matrices", " ", "in", " ", "SE", 
       RowBox[{"(", "3", ")"}], " ", "separated", " ", "in", " ", "time", " ",
        "by", " ", 
       RowBox[{"Tf", "/", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"N", "-", "1"}], ")"}], ".", "The"}]}], " ", "first", " ", 
       "in", " ", "the", " ", "list", " ", "is", " ", "Xstart", " ", "and", 
       " ", "the", " ", "Nth", " ", "is", " ", 
       RowBox[{"Xend", ".", " ", "\[IndentingNewLine]", "This"}], " ", 
       "function", " ", "is", " ", "similar", " ", "to", " ", 
       "ScrewTrajectory"}]}]}], ",", 
    RowBox[{
     RowBox[{
     "except", " ", "the", " ", "origin", " ", "of", " ", "the", " ", "end"}],
      "-", 
     RowBox[{
     "effector", " ", "frame", " ", "follows", " ", "a", " ", "straight", " ",
       "line"}]}], ",", 
    RowBox[{
     RowBox[{"decoupled", " ", "from", " ", "the", " ", "rotational", " ", 
      RowBox[{"motion", "."}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Example", ":", "\[IndentingNewLine]", "Input", ":", 
       "\[IndentingNewLine]", "Xstart"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\n", "  ", 
     RowBox[{"Xend", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "4.1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\n", "  ", 
     RowBox[{"Tf", "=", "5"}], ";", "\n", "  ", 
     RowBox[{"Np", "=", "4"}], ";", "\n", "  ", 
     RowBox[{"method", "=", "5"}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"traj", " ", "=", " ", 
      RowBox[{"CartesianTrajectory", "[", 
       RowBox[{"Xstart", ",", "Xend", ",", "Tf", ",", "Np", ",", "method"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"traj", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "//", "MatrixForm"}], "//", 
            RowBox[{"N", "\[IndentingNewLine]", 
             RowBox[{"traj", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "//", "MatrixForm"}], "//", 
          
          RowBox[{"N", "\[IndentingNewLine]", 
           RowBox[{"traj", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]}], "//", "MatrixForm"}], "//", 
        RowBox[{"N", "\[IndentingNewLine]", 
         RowBox[{"traj", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}]}], "//", "MatrixForm"}], "//", 
      RowBox[{"N", "\[IndentingNewLine]", 
       RowBox[{"Output", ":", "\[IndentingNewLine]", 
        RowBox[{
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"1.", "0.", "0.", "1."},
             {"0.", "1.", "0.", "0."},
             {"0.", "0.", "1.", "1."},
             {"0.", "0.", "0.", "1."}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]], "\n", 
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"0.937", 
              RowBox[{"-", "0.214"}], "0.277", "0.811"},
             {"0.277", "0.937", 
              RowBox[{"-", "0.214"}], "0."},
             {
              RowBox[{"-", "0.214"}], "0.277", "0.937", "1.651"},
             {"0.`", "0.", "0.", "1."}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]], "\n", 
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"0.277", 
              RowBox[{"-", "0.214"}], "0.937", "0.289"},
             {"0.937", "0.277", 
              RowBox[{"-", "0.214"}], "0."},
             {
              RowBox[{"-", "0.214"}], "0.937", "0.277", "3.449"},
             {"0.", "0.", "0.", "1."}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]], "\n", 
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"0.", "0.", "1.", "0.1"},
             {"1.", "0.", "0.", "0."},
             {"0.", "1.", "0.", "4.1"},
             {"0.", "0.", "0.", "1."}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]]}]}]}]}]}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CartesianTrajectory", "[", 
     RowBox[{"Xstart_", ",", "Xend_", ",", "Tf_", ",", "N_", ",", "method_"}],
      "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"timegap", "=", 
         RowBox[{"Tf", "/", 
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}]}]}], ",", 
        RowBox[{"traj", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"Null", ",", "N"}], "]"}]}], ",", "s", ",", "Rstart", ",", 
        "pstart", ",", "Rend", ",", "pend"}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Rstart", ",", "pstart"}], "}"}], "=", 
        RowBox[{"TransToRp", "[", "Xstart", "]"}]}], ";", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Rend", ",", "pend"}], "}"}], "=", 
        RowBox[{"TransToRp", "[", "Xend", "]"}]}], ";", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"method", " ", "\[Equal]", " ", "3"}], ",", 
            RowBox[{"s", "=", 
             RowBox[{"CubicTimeScaling", "[", 
              RowBox[{"Tf", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"i", "-", "1"}], ")"}], "*", "timegap"}]}], "]"}]}], 
            ",", 
            RowBox[{"s", "=", " ", 
             RowBox[{"QuinticTimeScaling", "[", 
              RowBox[{"Tf", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"i", "-", "1"}], ")"}], "*", "timegap"}]}], 
              "]"}]}]}], "]"}], ";", 
          RowBox[{
           RowBox[{"traj", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{"ArrayFlatten", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Rstart", ".", 
                 RowBox[{"MatrixExp3", "[", 
                  RowBox[{
                   RowBox[{"MatrixLog3", "[", 
                    RowBox[{
                    RowBox[{"Rstart", "\[Transpose]"}], ".", "Rend"}], "]"}], 
                   "*", "s"}], "]"}]}], ",", 
                RowBox[{"pstart", "+", 
                 RowBox[{"s", "*", 
                  RowBox[{"(", 
                   RowBox[{"pend", "-", "pstart"}], ")"}]}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "N"}], "}"}]}], "]"}], ";", 
       RowBox[{"Return", "[", "traj", "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654107438701495*^9, 3.6541075770931664`*^9}, {
   3.6541076103152647`*^9, 3.654107726674172*^9}, {3.654107800327899*^9, 
   3.654107805926005*^9}, {3.654107842157054*^9, 3.654107956534466*^9}, {
   3.6541080276373253`*^9, 3.654108039845397*^9}, {3.654108208328875*^9, 
   3.654108267778264*^9}, {3.654108316603101*^9, 3.65410832858707*^9}, {
   3.654122072990996*^9, 3.654122200142358*^9}, {3.654122232524707*^9, 
   3.6541222637488813`*^9}, {3.654122372486209*^9, 3.65412253592478*^9}, {
   3.654122571686759*^9, 3.654122685636675*^9}, {3.654122740902017*^9, 
   3.6541228215630703`*^9}, {3.654122865671712*^9, 3.654122935620612*^9}, {
   3.654123032181581*^9, 3.6541230914473333`*^9}, {3.654123152783122*^9, 
   3.6541232043612537`*^9}, {3.654123304611115*^9, 3.654123341073502*^9}, {
   3.654123502235703*^9, 3.654123578362132*^9}, {3.654123664279245*^9, 
   3.654123683195951*^9}, {3.6541237878998413`*^9, 3.6541238249788847`*^9}, {
   3.654123940392714*^9, 3.654123947510108*^9}, {3.654124026309593*^9, 
   3.654124026885428*^9}, 3.6541241152729683`*^9, 3.654124170343902*^9, {
   3.6541246995439568`*^9, 3.654124712871656*^9}, {3.6541251843297157`*^9, 
   3.654125231518578*^9}, {3.6541254856851683`*^9, 3.65412548908077*^9}, {
   3.654125547742125*^9, 3.654125551165526*^9}, {3.654125930807577*^9, 
   3.654126007244483*^9}, {3.654126127665163*^9, 3.654126191634789*^9}, {
   3.654126236482831*^9, 3.654126250153975*^9}, {3.6541262848658533`*^9, 
   3.654126288991514*^9}, {3.654126323055903*^9, 3.654126399729628*^9}, {
   3.654126435349374*^9, 3.654126447266036*^9}, {3.654126530077552*^9, 
   3.6541265937421*^9}, {3.654126679867402*^9, 3.6541267650289497`*^9}, {
   3.6541267969631968`*^9, 3.654126798410089*^9}, {3.654126829860013*^9, 
   3.654126881359337*^9}, {3.6541269393824577`*^9, 3.654126959132009*^9}, {
   3.654127079773924*^9, 3.654127194954756*^9}, {3.654127229244482*^9, 
   3.654127253953713*^9}, {3.6541278694900227`*^9, 3.654127878663176*^9}, {
   3.654127969775614*^9, 3.6541279938293123`*^9}, {3.654128051763153*^9, 
   3.654128134016169*^9}, {3.654128326830834*^9, 3.654128326972948*^9}, {
   3.654182305132535*^9, 3.654182317491791*^9}, {3.65418238746202*^9, 
   3.654182511491269*^9}, {3.654182551115921*^9, 3.654182559209998*^9}, {
   3.6541826265390177`*^9, 3.654182732425318*^9}, {3.654182795218339*^9, 
   3.654182802306821*^9}, {3.654182858360195*^9, 3.654182976637673*^9}, {
   3.65418309291822*^9, 3.6541831115452337`*^9}, {3.654183280620055*^9, 
   3.654183381285778*^9}, {3.6541834216733217`*^9, 3.65418343026462*^9}, {
   3.65418347398075*^9, 3.654183479016459*^9}, {3.654183517743698*^9, 
   3.654183590244978*^9}, {3.654183629340012*^9, 3.654183659551435*^9}, {
   3.654183828746057*^9, 3.654183869187777*^9}, {3.654183918271063*^9, 
   3.6541839184304667`*^9}, {3.654206461375032*^9, 3.6542064948942213`*^9}, {
   3.6542065261576433`*^9, 3.654206710642645*^9}, {3.65420685898112*^9, 
   3.654206859498214*^9}, {3.654206912388175*^9, 3.6542069199221067`*^9}, {
   3.654206956850091*^9, 3.654206957769821*^9}, {3.6542070885864773`*^9, 
   3.6542070905801163`*^9}, {3.6542071861274023`*^9, 3.654207197287834*^9}, {
   3.654207355631957*^9, 3.65420737546005*^9}, {3.654207422116619*^9, 
   3.6542074295958633`*^9}, {3.654207513008601*^9, 3.654207622631179*^9}, {
   3.6542077902321663`*^9, 3.6542079082040863`*^9}, {3.654208112675095*^9, 
   3.6542082406765347`*^9}, {3.654208390436673*^9, 3.654208437282127*^9}, {
   3.654208729398788*^9, 3.6542088242969923`*^9}, {3.654208875181876*^9, 
   3.6542089105814543`*^9}, {3.654209036563011*^9, 3.654209042056604*^9}, {
   3.654209131808134*^9, 3.654209211748107*^9}, {3.654277910558556*^9, 
   3.654277962902483*^9}, {3.6542785554956903`*^9, 3.654278555764879*^9}, {
   3.6542801407928543`*^9, 3.654280145647377*^9}, {3.654280336511973*^9, 
   3.654280388661951*^9}, {3.654735519742467*^9, 3.654735526212496*^9}, {
   3.654736711632904*^9, 3.654736744359725*^9}, {3.654736840726715*^9, 
   3.6547369027091503`*^9}, {3.6547369619155817`*^9, 3.65473711893006*^9}, 
   3.654737215212165*^9, {3.6547372623430433`*^9, 3.654737301717353*^9}, {
   3.654737434898181*^9, 3.654737445769989*^9}, {3.654737593349925*^9, 
   3.654737893647337*^9}, {3.654737938282483*^9, 3.654737939560112*^9}, {
   3.654737995469615*^9, 3.65473804382544*^9}, {3.65473814244207*^9, 
   3.65473826286047*^9}, {3.654738473301898*^9, 3.654738519313912*^9}, {
   3.654738551955141*^9, 3.654738559351729*^9}, {3.654738599129403*^9, 
   3.654738599566987*^9}, {3.654738653005966*^9, 3.654738704434928*^9}, {
   3.654738885183668*^9, 3.654738922018218*^9}, {3.654739011880048*^9, 
   3.65473910917871*^9}, {3.654739159170903*^9, 3.654739162120161*^9}, {
   3.6547393230277576`*^9, 3.6547393764227123`*^9}, {3.654739415181912*^9, 
   3.65473942023728*^9}, {3.654739453135948*^9, 3.654739679965816*^9}, {
   3.654739718627033*^9, 3.6547397334487553`*^9}, {3.654739765385715*^9, 
   3.654739851694334*^9}, {3.654739889466123*^9, 3.654740005071364*^9}, {
   3.6547400491757*^9, 3.654740154008595*^9}, 3.654740216700787*^9, {
   3.654740314399178*^9, 3.6547403286014967`*^9}, 3.6547403850818996`*^9, {
   3.654740521314966*^9, 3.654740541208376*^9}, {3.65474063388687*^9, 
   3.654740654515286*^9}, {3.654740701345427*^9, 3.654740810460566*^9}, {
   3.654740848239312*^9, 3.654741082783293*^9}, {3.654741274225429*^9, 
   3.65474127713437*^9}, 3.654741426789631*^9, {3.6547414571147537`*^9, 
   3.654741569824174*^9}, {3.654741604551594*^9, 3.65474161887015*^9}, {
   3.6547416933496304`*^9, 3.654741709459137*^9}, {3.654741935230948*^9, 
   3.654741945307493*^9}, {3.6547830386167917`*^9, 3.654783105454197*^9}, {
   3.6547832406606083`*^9, 3.6547832525310373`*^9}, {3.654783794511154*^9, 
   3.654783837663447*^9}, {3.65478390359721*^9, 3.654783909803577*^9}, {
   3.654783989474423*^9, 3.654784403124803*^9}, {3.654784520313846*^9, 
   3.654784622329711*^9}, {3.6547847231449842`*^9, 3.654784727983326*^9}, {
   3.654785122876478*^9, 3.654785187751635*^9}, {3.654785255283667*^9, 
   3.654785472044736*^9}, {3.654785554330287*^9, 3.6547855634367*^9}, {
   3.6547858133842907`*^9, 3.654785842420493*^9}, {3.654785988696732*^9, 
   3.654785999313698*^9}, {3.654786083383224*^9, 3.654786083827299*^9}, {
   3.654799998454865*^9, 3.654800009014682*^9}, 3.654800058896707*^9, {
   3.6548001027328*^9, 3.654800173381201*^9}, {3.654800206111162*^9, 
   3.654800346038969*^9}, {3.654800415767541*^9, 3.654800685527397*^9}, {
   3.654800717895743*^9, 3.6548007259529123`*^9}, {3.6548007560240192`*^9, 
   3.654800892868227*^9}, {3.654800961067473*^9, 3.6548010443125353`*^9}, {
   3.654801144205307*^9, 3.6548013970409203`*^9}, {3.654801447723054*^9, 
   3.6548014700938597`*^9}, {3.654801562889327*^9, 3.6548017505389137`*^9}, {
   3.6548017965315866`*^9, 3.654801838591158*^9}, {3.654801925163512*^9, 
   3.654801957336872*^9}, {3.654802037838778*^9, 3.654802097667626*^9}, {
   3.6548021338675137`*^9, 3.654802151746142*^9}, {3.6548021938035927`*^9, 
   3.65480226557542*^9}, {3.6548023434469347`*^9, 3.6548024564595747`*^9}, {
   3.654802493167995*^9, 3.654802498462143*^9}, {3.654802632969117*^9, 
   3.654802636326886*^9}, {3.6548026864101667`*^9, 3.6548027624957323`*^9}, {
   3.654802812209731*^9, 3.6548030159498*^9}, {3.6548066359524317`*^9, 
   3.654806720935005*^9}, {3.654806751992766*^9, 3.6548067587144833`*^9}, {
   3.654806821497799*^9, 3.654806889382121*^9}, {3.654807006283039*^9, 
   3.654807210369132*^9}, {3.654807340425975*^9, 3.6548074184588003`*^9}, {
   3.6548074913193197`*^9, 3.654807699931301*^9}, 3.6548078200861998`*^9, {
   3.654807890939335*^9, 3.65480791502777*^9}, {3.654807960842239*^9, 
   3.6548080712336483`*^9}, {3.654808128338978*^9, 3.6548081799548407`*^9}, {
   3.6548101758929577`*^9, 3.654810330104765*^9}, {3.654810401423953*^9, 
   3.654810408457419*^9}, {3.6548104718702717`*^9, 3.6548106690676603`*^9}, {
   3.6548107121438303`*^9, 3.6548108463298893`*^9}, {3.654810878513033*^9, 
   3.6548109250220337`*^9}, {3.654810973064028*^9, 3.6548109963255377`*^9}, {
   3.654811065383171*^9, 3.65481111435124*^9}, {3.6548111568410273`*^9, 
   3.654811165569319*^9}, {3.654811202562601*^9, 3.654811649746052*^9}, {
   3.657067656153129*^9, 3.657067660941557*^9}, {3.6570766750689*^9, 
   3.657076677028944*^9}, {3.658274451899232*^9, 3.6582744912918463`*^9}, {
   3.6583703518545094`*^9, 3.65837035300604*^9}, {3.67673963558117*^9, 
   3.6767396395269127`*^9}, {3.676743278578334*^9, 3.676743282140527*^9}, {
   3.676743329578144*^9, 3.676743332931324*^9}, {3.676743375759927*^9, 
   3.676743393331377*^9}, {3.676743579279604*^9, 3.676743610992496*^9}, {
   3.676743696815421*^9, 3.676743702063456*^9}, {3.676743797327611*^9, 
   3.676743802367258*^9}, {3.676743844436429*^9, 3.676743923034832*^9}, {
   3.676744067943886*^9, 3.676744101485681*^9}, {3.676745202969133*^9, 
   3.676745215144767*^9}, {3.676745254062787*^9, 3.676745307013712*^9}, {
   3.6767453632225313`*^9, 3.676745371103043*^9}, 3.676745427635807*^9, 
   3.676745643761804*^9, {3.6767456813682833`*^9, 3.676745685052404*^9}, {
   3.676745890112192*^9, 3.676745904905205*^9}, {3.676745949389865*^9, 
   3.676746003820777*^9}, {3.676746191330016*^9, 3.676746202180275*^9}, {
   3.6767463628997517`*^9, 3.6767463680370293`*^9}, {3.6767464041150723`*^9, 
   3.6767464065122213`*^9}, {3.676746447029583*^9, 3.676746538635809*^9}, {
   3.67674660560835*^9, 3.676746624390595*^9}, {3.676746756856359*^9, 
   3.676746788930705*^9}, {3.67674687514357*^9, 3.6767469138687143`*^9}, {
   3.676746954576331*^9, 3.67674698750915*^9}, 3.676747020885099*^9, {
   3.6767472587172203`*^9, 3.676747387781352*^9}, {3.676748382220996*^9, 
   3.676748383415188*^9}, 3.678096454219871*^9, {3.6911935162898006`*^9, 
   3.6911935321347065`*^9}, {3.69119360668097*^9, 3.6911937260087957`*^9}, {
   3.6911938706650696`*^9, 3.691194004824743*^9}, {3.6911940559916697`*^9, 
   3.691194175012477*^9}, {3.6911943422920446`*^9, 3.6911943657793884`*^9}, {
   3.692486572990054*^9, 3.692486637770759*^9}, {3.693154068375657*^9, 
   3.6931540714176626`*^9}, {3.693162708174821*^9, 3.693162708518022*^9}, 
   3.6931627959226713`*^9},ExpressionUUID->"43e1b53b-9f44-4eb2-a4b6-\
10dbac7bceb2"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["CHAPTER  11: ROBOT CONTROL",
 FontSize->24,
 FontWeight->"Bold",
 FontColor->RGBColor[0, 0, 1]]], "Title",
 CellChangeTimes->{{3.6755319110417843`*^9, 3.675531927048277*^9}, {
  3.675531958735077*^9, 3.67553201284205*^9}, {3.675607857109823*^9, 
  3.6756079117244864`*^9}, {3.6756821024917507`*^9, 3.6756821283850946`*^9}, {
  3.6757648758196497`*^9, 3.675764892595064*^9}, {3.677861669528915*^9, 
  3.677861687077693*^9}},ExpressionUUID->"326e1d25-e6f2-4414-bbc5-\
f7990b093e8f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"ComputedTorque", "[", 
      RowBox[{
      "thetalist_", ",", "dthetalist_", ",", "eint_", ",", "g_", ",", 
       "Mlist_", ",", "Glist_", ",", "Slist_", ",", "thetalistd_", ",", 
       "dthetalistd_", ",", "ddthetalistd_", ",", "Kp_", ",", "Ki_", ",", 
       "Kd_"}], "]"}], ":", "\[IndentingNewLine]", "  ", 
     RowBox[{"Takes", " ", "thetalist"}], ":", " ", 
     RowBox[{"n", "-", 
      RowBox[{"vector", " ", "of", " ", "joint", " ", "variables"}]}]}], ",", 
    "\[IndentingNewLine]", "         ", 
    RowBox[{"dthetalist", ":", " ", 
     RowBox[{"n", "-", 
      RowBox[{"vector", " ", "of", " ", "joint", " ", "rates"}]}]}], ",", 
    "\[IndentingNewLine]", "         ", 
    RowBox[{"eint", ":", " ", 
     RowBox[{"n", "-", 
      RowBox[{"vector", " ", "of", " ", "the", " ", "time"}], "-", 
      RowBox[{"integral", " ", "of", " ", "joint", " ", "errors"}]}]}], ",", 
    "\[IndentingNewLine]", "         ", 
    RowBox[{"g", ":", " ", 
     RowBox[{"Gravity", " ", "vector", " ", "g"}]}], ",", 
    "\[IndentingNewLine]", "         ", 
    RowBox[{"Mlist", ":", " ", 
     RowBox[{"List", " ", "of", " ", "link", " ", "frames", " ", 
      RowBox[{"{", "i", "}"}], " ", "relative", " ", "to", " ", 
      RowBox[{"{", 
       RowBox[{"i", "-", "1"}], "}"}], " ", "at", " ", "the", " ", "home", 
      " ", "position"}]}], ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"Glist", ":", " ", 
     RowBox[{
     "Spatial", " ", "inertia", " ", "matrices", " ", "Gi", " ", "of", " ", 
      "the", " ", "links"}]}], ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"Slist", ":", " ", 
     RowBox[{
     "Screw", " ", "axes", " ", "Si", " ", "of", " ", "the", " ", "joints", 
      " ", "in", " ", "a", " ", "space", " ", "frame"}]}], ",", 
    "\[IndentingNewLine]", "         ", 
    RowBox[{"thetalistd", ":", " ", 
     RowBox[{"n", "-", 
      RowBox[{
      "vector", " ", "of", " ", "reference", " ", "joint", " ", 
       "variables"}]}]}], ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"dthetalistd", ":", " ", 
     RowBox[{"n", "-", 
      RowBox[{
      "vector", " ", "of", " ", "reference", " ", "joint", " ", 
       "velocities"}]}]}], ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"ddthetalistd", ":", " ", 
     RowBox[{"n", "-", 
      RowBox[{
      "vector", " ", "of", " ", "reference", " ", "joint", " ", 
       "accelerations"}]}]}], ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"Kp", ":", " ", 
     RowBox[{"The", " ", "feedback", " ", "proportional", " ", "gain", " ", 
      RowBox[{"(", 
       RowBox[{"identical", " ", "for", " ", "each", " ", "joint"}], 
       ")"}]}]}], ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"Ki", ":", " ", 
     RowBox[{"The", " ", "feedback", " ", "integral", " ", "gain", " ", 
      RowBox[{"(", 
       RowBox[{"identical", " ", "for", " ", "each", " ", "joint"}], 
       ")"}]}]}], ",", "\[IndentingNewLine]", "         ", 
    RowBox[{
     RowBox[{"Kd", ":", " ", 
      RowBox[{"The", " ", "feedback", " ", "derivative", " ", "gain", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"identical", " ", "for", " ", "each", " ", "joint"}], ")"}], 
        ".", "\[IndentingNewLine]", "Returns"}], " ", "taulist"}], ":", " ", 
      RowBox[{"The", " ", "vector", " ", "of", " ", "joint", " ", 
       RowBox[{"forces", "/", "torques"}], " ", "computed", " ", "by", " ", 
       "the", " ", "feedback", " ", "linearizing", " ", "controller", " ", 
       "at", " ", "the", " ", "current", " ", 
       RowBox[{"instant", "."}]}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Exapmle", ":", "\[IndentingNewLine]", "Input", ":", 
       "\[IndentingNewLine]", "thetalist"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", "0.1", ",", "0.1"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\n", "  ", 
     RowBox[{"dthetalist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", "0.2", ",", "0.3"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\n", "  ", 
     RowBox[{"eint", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.2", ",", "0.2", ",", "0.2"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\n", "  ", 
     RowBox[{"g", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"-", "9.8"}]}], "}"}], "}"}], "\[Transpose]"}]}], ";", "\n",
      "  ", 
     RowBox[{"M01", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.089159"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M12", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.28"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0.13585"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M23", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", 
          RowBox[{"-", "0.1197"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.395"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M34", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.14225"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"G1", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.010267", ",", "0.010267", ",", "0.00666", ",", "3.7", ",", "3.7", 
         ",", "3.7"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"G2", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.22689", ",", "0.22689", ",", "0.0151074", ",", "8.393", ",", 
         "8.393", ",", "8.393"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "  ", 
     RowBox[{"G3", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.0494433", ",", "0.0494433", ",", "0.004095", ",", "2.275", ",", 
         "2.275", ",", "2.275"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "  ", 
     RowBox[{"Glist", "=", 
      RowBox[{"{", 
       RowBox[{"G1", ",", "G2", ",", "G3"}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Mlist", "=", 
      RowBox[{"{", 
       RowBox[{"M01", ",", "M12", ",", "M23", ",", "M34"}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Slist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0.425"}], "}"}]}], "}"}], 
       "\[Transpose]"}]}], ";", "\n", "  ", 
     RowBox[{"thetalistd", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1"}], "}"}], "}"}], "\[Transpose]"}]}], 
     ";", "\n", "  ", 
     RowBox[{"dthetalistd", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"2", ",", "1.2", ",", "2"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\n", "  ", 
     RowBox[{"ddthetalistd", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", "0.1", ",", "0.1"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"Kp", "=", "1.3"}], ";", "\n", "  ", 
     RowBox[{"Ki", "=", "1.2"}], ";", "\n", "  ", 
     RowBox[{"Kd", "=", "1.1"}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"taulist", " ", "=", " ", 
      RowBox[{
       RowBox[{"ComputedTorque", "[", 
        RowBox[{
        "thetalist", ",", "dthetalist", ",", "eint", ",", "g", ",", "Mlist", 
         ",", "Glist", ",", "Slist", ",", "thetalistd", ",", "dthetalistd", 
         ",", "ddthetalistd", ",", "Kp", ",", "Ki", ",", "Kd"}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Ouput", ":", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "133.0052524649953", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"-", "29.942233243760633"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"-", "3.0327685616172406"}], "}"}]}], "}"}]}]}]}]}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ComputedTorque", "[", 
     RowBox[{
     "thetalist_", ",", "dthetalist_", ",", "eint_", ",", "g_", ",", "Mlist_",
       ",", "Glist_", ",", "Slist_", ",", "thetalistd_", ",", "dthetalistd_", 
      ",", "ddthetalistd_", ",", "Kp_", ",", "Ki_", ",", "Kd_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"e", "=", 
        RowBox[{"thetalistd", "-", "thetalist"}]}], "}"}], ",", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"MassMatrix", "[", 
          RowBox[{"thetalist", ",", "Mlist", ",", "Glist", ",", "Slist"}], 
          "]"}], ".", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Kp", "*", "e"}], "+", 
           RowBox[{"Ki", "*", 
            RowBox[{"(", 
             RowBox[{"eint", "+", "e"}], ")"}]}], "+", 
           RowBox[{"Kd", "*", 
            RowBox[{"(", 
             RowBox[{"dthetalistd", "-", "dthetalist"}], ")"}]}]}], ")"}]}], 
        "+", 
        RowBox[{"InverseDynamics", "[", 
         RowBox[{
         "thetalist", ",", "dthetalist", ",", "ddthetalistd", ",", "g", ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
             "}"}], "}"}], "\[Transpose]"}], ",", "Mlist", ",", "Glist", ",", 
          "Slist"}], "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654107438701495*^9, 3.6541075770931664`*^9}, {
   3.6541076103152647`*^9, 3.654107726674172*^9}, {3.654107800327899*^9, 
   3.654107805926005*^9}, {3.654107842157054*^9, 3.654107956534466*^9}, {
   3.6541080276373253`*^9, 3.654108039845397*^9}, {3.654108208328875*^9, 
   3.654108267778264*^9}, {3.654108316603101*^9, 3.65410832858707*^9}, {
   3.654122072990996*^9, 3.654122200142358*^9}, {3.654122232524707*^9, 
   3.6541222637488813`*^9}, {3.654122372486209*^9, 3.65412253592478*^9}, {
   3.654122571686759*^9, 3.654122685636675*^9}, {3.654122740902017*^9, 
   3.6541228215630703`*^9}, {3.654122865671712*^9, 3.654122935620612*^9}, {
   3.654123032181581*^9, 3.6541230914473333`*^9}, {3.654123152783122*^9, 
   3.6541232043612537`*^9}, {3.654123304611115*^9, 3.654123341073502*^9}, {
   3.654123502235703*^9, 3.654123578362132*^9}, {3.654123664279245*^9, 
   3.654123683195951*^9}, {3.6541237878998413`*^9, 3.6541238249788847`*^9}, {
   3.654123940392714*^9, 3.654123947510108*^9}, {3.654124026309593*^9, 
   3.654124026885428*^9}, 3.6541241152729683`*^9, 3.654124170343902*^9, {
   3.6541246995439568`*^9, 3.654124712871656*^9}, {3.6541251843297157`*^9, 
   3.654125231518578*^9}, {3.6541254856851683`*^9, 3.65412548908077*^9}, {
   3.654125547742125*^9, 3.654125551165526*^9}, {3.654125930807577*^9, 
   3.654126007244483*^9}, {3.654126127665163*^9, 3.654126191634789*^9}, {
   3.654126236482831*^9, 3.654126250153975*^9}, {3.6541262848658533`*^9, 
   3.654126288991514*^9}, {3.654126323055903*^9, 3.654126399729628*^9}, {
   3.654126435349374*^9, 3.654126447266036*^9}, {3.654126530077552*^9, 
   3.6541265937421*^9}, {3.654126679867402*^9, 3.6541267650289497`*^9}, {
   3.6541267969631968`*^9, 3.654126798410089*^9}, {3.654126829860013*^9, 
   3.654126881359337*^9}, {3.6541269393824577`*^9, 3.654126959132009*^9}, {
   3.654127079773924*^9, 3.654127194954756*^9}, {3.654127229244482*^9, 
   3.654127253953713*^9}, {3.6541278694900227`*^9, 3.654127878663176*^9}, {
   3.654127969775614*^9, 3.6541279938293123`*^9}, {3.654128051763153*^9, 
   3.654128134016169*^9}, {3.654128326830834*^9, 3.654128326972948*^9}, {
   3.654182305132535*^9, 3.654182317491791*^9}, {3.65418238746202*^9, 
   3.654182511491269*^9}, {3.654182551115921*^9, 3.654182559209998*^9}, {
   3.6541826265390177`*^9, 3.654182732425318*^9}, {3.654182795218339*^9, 
   3.654182802306821*^9}, {3.654182858360195*^9, 3.654182976637673*^9}, {
   3.65418309291822*^9, 3.6541831115452337`*^9}, {3.654183280620055*^9, 
   3.654183381285778*^9}, {3.6541834216733217`*^9, 3.65418343026462*^9}, {
   3.65418347398075*^9, 3.654183479016459*^9}, {3.654183517743698*^9, 
   3.654183590244978*^9}, {3.654183629340012*^9, 3.654183659551435*^9}, {
   3.654183828746057*^9, 3.654183869187777*^9}, {3.654183918271063*^9, 
   3.6541839184304667`*^9}, {3.654206461375032*^9, 3.6542064948942213`*^9}, {
   3.6542065261576433`*^9, 3.654206710642645*^9}, {3.65420685898112*^9, 
   3.654206859498214*^9}, {3.654206912388175*^9, 3.6542069199221067`*^9}, {
   3.654206956850091*^9, 3.654206957769821*^9}, {3.6542070885864773`*^9, 
   3.6542070905801163`*^9}, {3.6542071861274023`*^9, 3.654207197287834*^9}, {
   3.654207355631957*^9, 3.65420737546005*^9}, {3.654207422116619*^9, 
   3.6542074295958633`*^9}, {3.654207513008601*^9, 3.654207622631179*^9}, {
   3.6542077902321663`*^9, 3.6542079082040863`*^9}, {3.654208112675095*^9, 
   3.6542082406765347`*^9}, {3.654208390436673*^9, 3.654208437282127*^9}, {
   3.654208729398788*^9, 3.6542088242969923`*^9}, {3.654208875181876*^9, 
   3.6542089105814543`*^9}, {3.654209036563011*^9, 3.654209042056604*^9}, {
   3.654209131808134*^9, 3.654209211748107*^9}, {3.654277910558556*^9, 
   3.654277962902483*^9}, {3.6542785554956903`*^9, 3.654278555764879*^9}, {
   3.6542801407928543`*^9, 3.654280145647377*^9}, {3.654280336511973*^9, 
   3.654280388661951*^9}, {3.654735519742467*^9, 3.654735526212496*^9}, {
   3.654736711632904*^9, 3.654736744359725*^9}, {3.654736840726715*^9, 
   3.6547369027091503`*^9}, {3.6547369619155817`*^9, 3.65473711893006*^9}, 
   3.654737215212165*^9, {3.6547372623430433`*^9, 3.654737301717353*^9}, {
   3.654737434898181*^9, 3.654737445769989*^9}, {3.654737593349925*^9, 
   3.654737893647337*^9}, {3.654737938282483*^9, 3.654737939560112*^9}, {
   3.654737995469615*^9, 3.65473804382544*^9}, {3.65473814244207*^9, 
   3.65473826286047*^9}, {3.654738473301898*^9, 3.654738519313912*^9}, {
   3.654738551955141*^9, 3.654738559351729*^9}, {3.654738599129403*^9, 
   3.654738599566987*^9}, {3.654738653005966*^9, 3.654738704434928*^9}, {
   3.654738885183668*^9, 3.654738922018218*^9}, {3.654739011880048*^9, 
   3.65473910917871*^9}, {3.654739159170903*^9, 3.654739162120161*^9}, {
   3.6547393230277576`*^9, 3.6547393764227123`*^9}, {3.654739415181912*^9, 
   3.65473942023728*^9}, {3.654739453135948*^9, 3.654739679965816*^9}, {
   3.654739718627033*^9, 3.6547397334487553`*^9}, {3.654739765385715*^9, 
   3.654739851694334*^9}, {3.654739889466123*^9, 3.654740005071364*^9}, {
   3.6547400491757*^9, 3.654740154008595*^9}, 3.654740216700787*^9, {
   3.654740314399178*^9, 3.6547403286014967`*^9}, 3.6547403850818996`*^9, {
   3.654740521314966*^9, 3.654740541208376*^9}, {3.65474063388687*^9, 
   3.654740654515286*^9}, {3.654740701345427*^9, 3.654740810460566*^9}, {
   3.654740848239312*^9, 3.654741082783293*^9}, {3.654741274225429*^9, 
   3.65474127713437*^9}, 3.654741426789631*^9, {3.6547414571147537`*^9, 
   3.654741569824174*^9}, {3.654741604551594*^9, 3.65474161887015*^9}, {
   3.6547416933496304`*^9, 3.654741709459137*^9}, {3.654741935230948*^9, 
   3.654741945307493*^9}, {3.6547830386167917`*^9, 3.654783105454197*^9}, {
   3.6547832406606083`*^9, 3.6547832525310373`*^9}, {3.654783794511154*^9, 
   3.654783837663447*^9}, {3.65478390359721*^9, 3.654783909803577*^9}, {
   3.654783989474423*^9, 3.654784403124803*^9}, {3.654784520313846*^9, 
   3.654784622329711*^9}, {3.6547847231449842`*^9, 3.654784727983326*^9}, {
   3.654785122876478*^9, 3.654785187751635*^9}, {3.654785255283667*^9, 
   3.654785472044736*^9}, {3.654785554330287*^9, 3.6547855634367*^9}, {
   3.6547858133842907`*^9, 3.654785842420493*^9}, {3.654785988696732*^9, 
   3.654785999313698*^9}, {3.654786083383224*^9, 3.654786083827299*^9}, {
   3.654799998454865*^9, 3.654800009014682*^9}, 3.654800058896707*^9, {
   3.6548001027328*^9, 3.654800173381201*^9}, {3.654800206111162*^9, 
   3.654800346038969*^9}, {3.654800415767541*^9, 3.654800685527397*^9}, {
   3.654800717895743*^9, 3.6548007259529123`*^9}, {3.6548007560240192`*^9, 
   3.654800892868227*^9}, {3.654800961067473*^9, 3.6548010443125353`*^9}, {
   3.654801144205307*^9, 3.6548013970409203`*^9}, {3.654801447723054*^9, 
   3.6548014700938597`*^9}, {3.654801562889327*^9, 3.6548017505389137`*^9}, {
   3.6548017965315866`*^9, 3.654801838591158*^9}, {3.654801925163512*^9, 
   3.654801957336872*^9}, {3.654802037838778*^9, 3.654802097667626*^9}, {
   3.6548021338675137`*^9, 3.654802151746142*^9}, {3.6548021938035927`*^9, 
   3.65480226557542*^9}, {3.6548023434469347`*^9, 3.6548024564595747`*^9}, {
   3.654802493167995*^9, 3.654802498462143*^9}, {3.654802632969117*^9, 
   3.654802636326886*^9}, {3.6548026864101667`*^9, 3.6548027624957323`*^9}, {
   3.654802812209731*^9, 3.6548030159498*^9}, {3.6548066359524317`*^9, 
   3.654806720935005*^9}, {3.654806751992766*^9, 3.6548067587144833`*^9}, {
   3.654806821497799*^9, 3.654806889382121*^9}, {3.654807006283039*^9, 
   3.654807210369132*^9}, {3.654807340425975*^9, 3.6548074184588003`*^9}, {
   3.6548074913193197`*^9, 3.654807699931301*^9}, 3.6548078200861998`*^9, {
   3.654807890939335*^9, 3.65480791502777*^9}, {3.654807960842239*^9, 
   3.6548080712336483`*^9}, {3.654808128338978*^9, 3.6548081799548407`*^9}, {
   3.6548101758929577`*^9, 3.654810330104765*^9}, {3.654810401423953*^9, 
   3.654810408457419*^9}, {3.6548104718702717`*^9, 3.6548106690676603`*^9}, {
   3.6548107121438303`*^9, 3.6548108463298893`*^9}, {3.654810878513033*^9, 
   3.6548109250220337`*^9}, {3.654810973064028*^9, 3.6548109963255377`*^9}, {
   3.654811065383171*^9, 3.65481111435124*^9}, {3.6548111568410273`*^9, 
   3.654811165569319*^9}, {3.654811202562601*^9, 3.654811649746052*^9}, {
   3.657067656153129*^9, 3.657067660941557*^9}, {3.6570766750689*^9, 
   3.657076677028944*^9}, {3.658274451899232*^9, 3.6582744912918463`*^9}, {
   3.6583703518545094`*^9, 3.65837035300604*^9}, {3.675682824450754*^9, 
   3.6756828836706333`*^9}, {3.6756829858535852`*^9, 3.675683093476144*^9}, {
   3.675683163431617*^9, 3.675683301926485*^9}, {3.6756834458193197`*^9, 
   3.675683520674423*^9}, {3.675683569012762*^9, 3.675683584065415*^9}, 
   3.675683635500771*^9, {3.675684508273862*^9, 3.675684520687911*^9}, {
   3.675764977565001*^9, 3.675764979617189*^9}, {3.6757662451157312`*^9, 
   3.675766254498831*^9}, {3.675766317871736*^9, 3.675766345394107*^9}, {
   3.6757664078898573`*^9, 3.675766419041957*^9}, {3.6757665260531073`*^9, 
   3.6757665599652433`*^9}, {3.675766688881428*^9, 3.675766693414764*^9}, {
   3.675766760364307*^9, 3.675766898736827*^9}, {3.675766931380547*^9, 
   3.675766932915333*^9}, 3.675767022524777*^9, 3.675767053903921*^9, {
   3.675767094663486*^9, 3.675767157353602*^9}, {3.6757672038039017`*^9, 
   3.67576720815028*^9}, {3.675767263478516*^9, 3.675767302851701*^9}, {
   3.6757673469407463`*^9, 3.6757675158730087`*^9}, {3.675767609117689*^9, 
   3.6757676149377613`*^9}, 3.676110621848937*^9, {3.676110673192341*^9, 
   3.676110708132433*^9}, {3.676110758266004*^9, 3.676110779724792*^9}, {
   3.676110837502541*^9, 3.676110924302658*^9}, {3.676111015370205*^9, 
   3.676111023652515*^9}, {3.676111616884136*^9, 3.676111619101164*^9}, {
   3.67611165132108*^9, 3.67611182175666*^9}, 3.6761124388093357`*^9, {
   3.6761125310577183`*^9, 3.676112535417371*^9}, {3.67611278534865*^9, 
   3.676112852293083*^9}, {3.6761129469420633`*^9, 3.6761129566090517`*^9}, {
   3.6761133261675377`*^9, 3.6761133851728067`*^9}, {3.6761134570078707`*^9, 
   3.6761134886549597`*^9}, {3.676113519585043*^9, 3.676113581404831*^9}, {
   3.676113994051722*^9, 3.6761140495138607`*^9}, {3.67611471759483*^9, 
   3.676114727326268*^9}, {3.676114788083909*^9, 3.676114788267289*^9}, {
   3.67611493328951*^9, 3.6761149644016867`*^9}, {3.6761149993051443`*^9, 
   3.676115038096011*^9}, {3.676115419194528*^9, 3.676115484935451*^9}, {
   3.6761155900865583`*^9, 3.676115605985518*^9}, {3.676115760093829*^9, 
   3.676115778909306*^9}, {3.676115982499289*^9, 3.676116037133542*^9}, {
   3.6761161990700502`*^9, 3.676116233908482*^9}, {3.676116286507206*^9, 
   3.676116286712512*^9}, {3.67611639463448*^9, 3.676116464258135*^9}, {
   3.6761165873897543`*^9, 3.676116602580727*^9}, {3.6761174556753473`*^9, 
   3.67611745672952*^9}, {3.676117506535368*^9, 3.6761175229462357`*^9}, {
   3.676117600215383*^9, 3.6761176442364273`*^9}, {3.676117677849012*^9, 
   3.6761177082717953`*^9}, {3.67611812248459*^9, 3.6761181278825502`*^9}, {
   3.676118580166224*^9, 3.67611860485815*^9}, {3.676118651876894*^9, 
   3.6761187537386017`*^9}, {3.676118838160269*^9, 3.676118838374693*^9}, {
   3.67611887610327*^9, 3.676118940213615*^9}, {3.6761191096213007`*^9, 
   3.676119140757559*^9}, {3.6761192665343122`*^9, 3.676119273783136*^9}, {
   3.67611936142714*^9, 3.676119363325075*^9}, {3.676119488561606*^9, 
   3.676119492487294*^9}, {3.6761200703687267`*^9, 3.6761200707356052`*^9}, {
   3.6761202104386873`*^9, 3.676120268289008*^9}, {3.676120410677075*^9, 
   3.676120443293746*^9}, {3.676120474583932*^9, 3.676120475526285*^9}, {
   3.6761206125852633`*^9, 3.6761206205196333`*^9}, {3.6761234586125507`*^9, 
   3.676123489461384*^9}, {3.6761235483793917`*^9, 3.676123569634534*^9}, {
   3.676124493441423*^9, 3.676124518157651*^9}, {3.676124553443336*^9, 
   3.676124582966502*^9}, {3.6761246820730133`*^9, 3.676124716437358*^9}, {
   3.67612487549886*^9, 3.676124882235661*^9}, {3.676124956893395*^9, 
   3.676124958216114*^9}, {3.6761249904362507`*^9, 3.676124994364197*^9}, {
   3.676125048497746*^9, 3.676125189073619*^9}, {3.676125219923954*^9, 
   3.6761253767254953`*^9}, {3.6761261361020412`*^9, 3.676126180304117*^9}, {
   3.6761262318219957`*^9, 3.676126312208794*^9}, {3.6761263690337877`*^9, 
   3.6761264446350737`*^9}, {3.676126475578731*^9, 3.676126485467072*^9}, {
   3.676126538828438*^9, 3.676126562090301*^9}, {3.676126633785634*^9, 
   3.6761266365895157`*^9}, 3.6761268247458773`*^9, 3.676126912241247*^9, {
   3.676126960168599*^9, 3.676126960170166*^9}, {3.676127961375718*^9, 
   3.676127975299335*^9}, {3.676128268770321*^9, 3.676128269338847*^9}, 
   3.676128811729394*^9, {3.677836754519267*^9, 3.6778367717532873`*^9}, {
   3.6778617429809027`*^9, 3.677861778150968*^9}, {3.677861811363162*^9, 
   3.677861883641371*^9}, {3.677861923205984*^9, 3.677861958483556*^9}, {
   3.677862045631447*^9, 3.6778620815532303`*^9}, {3.677862112947032*^9, 
   3.6778621629685993`*^9}, {3.677922443289874*^9, 3.677922623758004*^9}, 
   3.677923019588035*^9, {3.677923068363806*^9, 3.677923083545373*^9}, {
   3.6779231196089497`*^9, 3.677923586617464*^9}, {3.677923629777021*^9, 
   3.6779236499633503`*^9}, {3.677924129538789*^9, 3.677924181633729*^9}, {
   3.677924307517605*^9, 3.677924330024685*^9}, {3.677924381606667*^9, 
   3.677924497028296*^9}, {3.677924555410111*^9, 3.677924576632324*^9}, 
   3.678027718232277*^9, {3.678096470512413*^9, 3.678096475556388*^9}, 
   3.6784491986905737`*^9, 3.6814510240805492`*^9, {3.682637744857705*^9, 
   3.682637756820936*^9}, 3.6912198213910027`*^9, {3.691219860796672*^9, 
   3.6912199797156806`*^9}, {3.691220025969762*^9, 3.691220107479905*^9}, {
   3.6912201427983675`*^9, 3.6912202540733624`*^9}, {3.692486659326992*^9, 
   3.6924868074064617`*^9}, {3.693154101837716*^9, 
   3.6931541075005255`*^9}},ExpressionUUID->"69857569-8b2e-4428-896c-\
067e7e49cbbb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"SimulateControl", "[", 
      RowBox[{
      "thetalist_", ",", "dthetalist_", ",", "g_", ",", "Ftipmat_", ",", 
       "Mlist_", ",", "Glist_", ",", "Slist_", ",", "thetamatd_", ",", 
       "dthetamatd_", ",", "ddthetamatd_", ",", "gtilde_", ",", "Mtildelist_",
        ",", "Gtildelist_", ",", "Kp_", ",", "Ki_", ",", "Kd_", ",", "dt_", 
       ",", "intRes_"}], "]"}], ":", "\[IndentingNewLine]", "  ", 
     RowBox[{"Takes", " ", "thetalist"}], ":", " ", 
     RowBox[{"n", "-", 
      RowBox[{
      "vector", " ", "of", " ", "initial", " ", "joint", " ", 
       "variables"}]}]}], ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"dthetalist", ":", " ", 
     RowBox[{"n", "-", 
      RowBox[{
      "vector", " ", "of", " ", "initial", " ", "joint", " ", 
       "velocities"}]}]}], ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"g", ":", " ", 
     RowBox[{"Actual", " ", "gravity", " ", "vector", " ", "g"}]}], ",", 
    "\[IndentingNewLine]", "         ", 
    RowBox[{"Ftipmat", ":", " ", 
     RowBox[{
      RowBox[{
      "An", " ", "N", " ", "x", " ", "6", " ", "matrix", " ", "of", " ", 
       "spatial", " ", "forces", " ", "applied", " ", "by", " ", "the", " ", 
       "end"}], "-", 
      RowBox[{"effector", " ", 
       RowBox[{"(", 
        RowBox[{
        "If", " ", "there", " ", "are", " ", "no", " ", "tip", " ", "forces", 
         " ", "the", " ", "user", " ", "should", " ", "input", " ", "a", " ", 
         "zero", " ", "and", " ", "a", " ", "zero", " ", "matrix", " ", 
         "will", " ", "be", " ", "used"}], ")"}]}]}]}], ",", 
    "\[IndentingNewLine]", "         ", 
    RowBox[{"Mlist", ":", " ", 
     RowBox[{
      RowBox[{
      "Actual", " ", "list", " ", "of", " ", "link", " ", "frames", " ", "i", 
       " ", "relative", " ", "to", " ", "i"}], "-", 
      RowBox[{"1", " ", "at", " ", "the", " ", "home", " ", "position"}]}]}], 
    ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"Glist", ":", " ", 
     RowBox[{
     "Actual", " ", "spatial", " ", "inertia", " ", "matrices", " ", "Gi", 
      " ", "of", " ", "the", " ", "links"}]}], ",", "\[IndentingNewLine]", 
    "         ", 
    RowBox[{"Slist", ":", " ", 
     RowBox[{
     "Screw", " ", "axes", " ", "Si", " ", "of", " ", "the", " ", "joints", 
      " ", "in", " ", "a", " ", "space", " ", "frame"}]}], ",", 
    "\[IndentingNewLine]", "         ", 
    RowBox[{"thetamatd", ":", " ", 
     RowBox[{
     "An", " ", "Nxn", " ", "matrix", " ", "of", " ", "desired", " ", "joint",
       " ", "variables", " ", "from", " ", "the", " ", "reference", " ", 
      "trajectory"}]}], ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"dthetamatd", ":", " ", 
     RowBox[{
     "An", " ", "Nxn", " ", "matrix", " ", "of", " ", "desired", " ", "joint",
       " ", "velocities"}]}], ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"ddthetamatd", ":", " ", 
     RowBox[{
     "An", " ", "Nxn", " ", "matrix", " ", "of", " ", "desired", " ", "joint",
       " ", "accelerations"}]}], ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"gtilde", ":", " ", 
     RowBox[{
     "The", " ", "gravity", " ", "vector", " ", "based", " ", "on", " ", 
      "the", " ", "model", " ", "of", " ", "the", " ", "actual", " ", "robot",
       " ", 
      RowBox[{"(", 
       RowBox[{"actual", " ", "values", " ", "given", " ", "above"}], 
       ")"}]}]}], ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"Mtildelist", ":", " ", 
     RowBox[{
     "The", " ", "link", " ", "frame", " ", "locations", " ", "based", " ", 
      "on", " ", "the", " ", "model", " ", "of", " ", "the", " ", "actual", 
      " ", "robot", " ", 
      RowBox[{"(", 
       RowBox[{"actual", " ", "values", " ", "given", " ", "above"}], 
       ")"}]}]}], ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"Gtildelist", ":", " ", 
     RowBox[{
     "The", " ", "link", " ", "spatial", " ", "inertias", " ", "based", " ", 
      "on", " ", "the", " ", "model", " ", "of", " ", "the", " ", "actual", 
      " ", "robot", " ", 
      RowBox[{"(", 
       RowBox[{"actual", " ", "values", " ", "given", " ", "above"}], 
       ")"}]}]}], ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"Kp", ":", " ", 
     RowBox[{"The", " ", "feedback", " ", "proportional", " ", "gain", " ", 
      RowBox[{"(", 
       RowBox[{"identical", " ", "for", " ", "each", " ", "joint"}], 
       ")"}]}]}], ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"Ki", ":", " ", 
     RowBox[{"The", " ", "feedback", " ", "integral", " ", "gain", " ", 
      RowBox[{"(", 
       RowBox[{"identical", " ", "for", " ", "each", " ", "joint"}], 
       ")"}]}]}], ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"Kd", ":", " ", 
     RowBox[{"The", " ", "feedback", " ", "derivative", " ", "gain", " ", 
      RowBox[{"(", 
       RowBox[{"identical", " ", "for", " ", "each", " ", "joint"}], 
       ")"}]}]}], ",", 
    RowBox[{"dt", ":", 
     RowBox[{
     "The", " ", "timestep", " ", "between", " ", "points", " ", "on", " ", 
      "the", " ", "reference", " ", "trajectory"}]}], ",", 
    "\[IndentingNewLine]", "         ", 
    RowBox[{"intRes", ":", " ", 
     RowBox[{
     "Integration", " ", "resolution", " ", "is", " ", "the", " ", "number", 
      " ", "of", " ", "times", " ", "integration", " ", 
      RowBox[{"(", "Euler", ")"}], " ", "takes", " ", "places", " ", 
      "between", " ", "each", " ", "time", " ", 
      RowBox[{"step", ".", "Must"}], " ", "be", " ", "an", " ", "integer", 
      " ", "value", " ", "greater", " ", "than", " ", "or", " ", "equal", " ",
       "to", " ", "1.", "\[IndentingNewLine]", " ", "Returns", " ", 
      "taumat"}], ":", " ", 
     RowBox[{
     "An", " ", "Nxn", " ", "matrix", " ", "of", " ", "the", " ", 
      "controllers", " ", "commanded", " ", "joint", " ", 
      RowBox[{"forces", "/", "torques"}]}]}], ",", 
    RowBox[{"where", " ", "each", " ", "row", " ", "of", " ", "n", " ", 
     RowBox[{"forces", "/", "torques"}], " ", "corresponds", " ", "to", " ", 
     "a", " ", "single", " ", "time", " ", "instant"}], ",", "           ", 
    "\[IndentingNewLine]", "           ", 
    RowBox[{
     RowBox[{"thetamat", ":", " ", 
      RowBox[{
      "An", " ", "Nxn", " ", "matrix", " ", "of", " ", "actual", " ", "joint",
        " ", 
       RowBox[{"angles", ".", "\[IndentingNewLine]", "The"}], " ", "end", " ",
        "of", " ", "this", " ", "function", " ", "plots", " ", "all", " ", 
       "the", " ", "actual", " ", "and", " ", "desired", " ", "joint", " ", 
       RowBox[{"angles", "."}]}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Exapmle", ":", "\[IndentingNewLine]", "Input", ":", 
       "\[IndentingNewLine]", "thetalist"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", "0.1", ",", "0.1"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\n", "  ", 
     RowBox[{"dthetalist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", "0.2", ",", "0.3"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"(*", 
      RowBox[{"Initialize", " ", "robot", " ", "description", " ", 
       RowBox[{"(", 
        RowBox[{"Example", " ", "with", " ", "3", " ", "links"}], ")"}]}], 
      "*)"}], "\n", "  ", 
     RowBox[{"g", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"-", "9.8"}]}], "}"}], "}"}], "\[Transpose]"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M01", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.089159"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "  ", "\[IndentingNewLine]", "  ", 
     RowBox[{"M12", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.28"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0.13585"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M23", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", 
          RowBox[{"-", "0.1197"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.395"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M34", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.14225"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"G1", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.010267", ",", "0.010267", ",", "0.00666", ",", "3.7", ",", "3.7", 
         ",", "3.7"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"G2", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.22689", ",", "0.22689", ",", "0.0151074", ",", "8.393", ",", 
         "8.393", ",", "8.393"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "  ", 
     RowBox[{"G3", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.0494433", ",", "0.0494433", ",", "0.004095", ",", "2.275", ",", 
         "2.275", ",", "2.275"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "  ", 
     RowBox[{"Glist", "=", 
      RowBox[{"{", 
       RowBox[{"G1", ",", "G2", ",", "G3"}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Mlist", "=", 
      RowBox[{"{", 
       RowBox[{"M01", ",", "M12", ",", "M23", ",", "M34"}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Slist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0.425"}], "}"}]}], "}"}], 
       "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"dt", " ", "=", "0.01"}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"(*", 
      RowBox[{
      "Create", " ", "a", " ", "trajectory", " ", "to", " ", "follow"}], 
      "*)"}], "\[IndentingNewLine]", "  ", 
     RowBox[{"thetaend", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Pi", "/", "2"}], ",", "Pi", ",", 
          RowBox[{"1.5", "*", "Pi"}]}], "}"}], "}"}], "\[Transpose]"}]}], ";",
      "\n", "  ", 
     RowBox[{"Tf", "=", "1"}], ";", "\n", "  ", 
     RowBox[{"No", "=", 
      RowBox[{"Tf", "/", "dt"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"method", "=", "5"}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"traj", "=", 
      RowBox[{"JointTrajectory", "[", 
       RowBox[{
       "thetalist", ",", "thetaend", ",", "Tf", ",", "No", ",", "method"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"thetamatd", "=", "traj"}], ";", "\n", "  ", 
     RowBox[{"dthetamatd", "=", "traj"}], ";", "\n", "  ", 
     RowBox[{"ddthetamatd", "=", "traj"}], ";", "\n", "  ", 
     RowBox[{"dt", "=", 
      RowBox[{"Tf", "/", 
       RowBox[{"(", 
        RowBox[{"No", "-", "1.0"}], ")"}]}]}], ";", "\n", "  ", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"dthetamatd", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", ";;"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"thetamatd", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", ";;"}], "]"}], "]"}], "-", 
            RowBox[{"thetamatd", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"i", "-", "1"}], ",", ";;"}], "]"}], "]"}]}], ")"}], 
          "/", "dt"}]}], ";", 
        RowBox[{
         RowBox[{"ddthetamatd", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", ";;"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"dthetamatd", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", ";;"}], "]"}], "]"}], "-", 
            RowBox[{"dthetamatd", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"i", "-", "1"}], ",", ";;"}], "]"}], "]"}]}], ")"}], 
          "/", "dt"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "traj", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"(*", 
      RowBox[{"Possibly", " ", "wrong", " ", "robot", " ", "description", " ", 
       RowBox[{"(", 
        RowBox[{"Example", " ", "with", " ", "3", " ", "links"}], ")"}]}], 
      "*)"}], "\n", "  ", 
     RowBox[{"gtilde", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.8", ",", "0.2", ",", 
          RowBox[{"-", "8.8"}]}], "}"}], "}"}], "\[Transpose]"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Mhat01", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "  ", "\[IndentingNewLine]", "  ", 
     RowBox[{"Mhat12", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0.2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Mhat23", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", 
          RowBox[{"-", "0.2"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Mhat34", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Ghat1", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{"0.1", ",", "0.1", ",", "0.1", ",", "4", ",", "4", ",", "4"}],
         "}"}], "]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"Ghat2", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{"0.3", ",", "0.3", ",", "0.1", ",", "9", ",", "9", ",", "9"}],
         "}"}], "]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"Ghat3", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{"0.1", ",", "0.1", ",", "0.1", ",", "3", ",", "3", ",", "3"}],
         "}"}], "]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"Gtildelist", "=", 
      RowBox[{"{", 
       RowBox[{"Ghat1", ",", "Ghat2", ",", "Ghat3"}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Mtildelist", "=", 
      RowBox[{"{", 
       RowBox[{"Mhat01", ",", "Mhat12", ",", "Mhat23", ",", "Mhat34"}], 
       "}"}]}], ";", "\n", "  ", 
     RowBox[{"Ftipmat", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"1", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Dimensions", "[", "traj", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "6"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Kp", "=", "20"}], ";", "\n", "  ", 
     RowBox[{"Ki", "=", "10"}], ";", "\n", "  ", 
     RowBox[{"Kd", "=", "18"}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"intRes", "=", "8"}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"taumat", ",", "thetamat"}], "}"}], " ", "=", " ", 
      RowBox[{"SimulateControl", "[", 
       RowBox[{
       "thetalist", ",", "dthetalist", ",", "g", ",", "Ftipmat", ",", "Mlist",
         ",", "Glist", ",", "Slist", ",", "thetamatd", ",", "dthetamatd", ",",
         "ddthetamatd", ",", "gtilde", ",", "Mtildelist", ",", "Gtildelist", 
        ",", "Kp", ",", "Ki", ",", "Kd", ",", "dt", ",", "intRes"}], "]"}]}], 
     ";"}]}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SimulateControl", "[", 
     RowBox[{
     "thetalist_", ",", "dthetalist_", ",", "g_", ",", "Ftipmat_", ",", 
      "Mlist_", ",", "Glist_", ",", "Slist_", ",", "thetamatd_", ",", 
      "dthetamatd_", ",", "ddthetamatd_", ",", "gtilde_", ",", "Mtildelist_", 
      ",", "Gtildelist_", ",", "Kp_", ",", "Ki_", ",", "Kd_", ",", "dt_", ",",
       "intRes_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Ftipmatt", "=", 
         RowBox[{"Ftipmat", "\[Transpose]"}]}], ",", 
        RowBox[{"thetamatdt", "=", 
         RowBox[{"thetamatd", "\[Transpose]"}]}], ",", 
        RowBox[{"dthetamatdt", "=", 
         RowBox[{"dthetamatd", "\[Transpose]"}]}], ",", 
        RowBox[{"ddthetamatdt", "=", 
         RowBox[{"ddthetamatd", "\[Transpose]"}]}], ",", "taumat", ",", 
        "thetamat", ",", "n", ",", "thetacurrent", ",", " ", "dthetacurrent", 
        ",", " ", "eint", ",", " ", "taulist", ",", "ddthetalist", ",", 
        "links", ",", " ", "plotAngles", ",", " ", "labels", ",", "style", 
        ",", "col"}], "}"}], ",", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{
         RowBox[{"Dimensions", "[", "thetamatdt", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", 
       RowBox[{"thetamat", "=", "thetamatdt"}], ";", 
       RowBox[{"taumat", "=", "thetamatdt"}], ";", "\[IndentingNewLine]", 
       RowBox[{"thetacurrent", "=", "thetalist"}], ";", "\n", 
       RowBox[{"dthetacurrent", "=", "dthetalist"}], ";", "\n", 
       RowBox[{"eint", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Dimensions", "[", "thetamatdt", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "}"}]}], "]"}]}], 
       ";", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"taulist", "=", 
           RowBox[{"ComputedTorque", "[", 
            RowBox[{
            "thetacurrent", ",", "dthetacurrent", ",", "eint", ",", "gtilde", 
             ",", "Mtildelist", ",", "Gtildelist", ",", "Slist", ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"thetamatdt", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", "i"}], "]"}], "]"}], "}"}], 
              "\[Transpose]"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"dthetamatdt", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", "i"}], "]"}], "]"}], "}"}], 
              "\[Transpose]"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"ddthetamatdt", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", "i"}], "]"}], "]"}], "}"}], 
              "\[Transpose]"}], ",", "Kp", ",", "Ki", ",", "Kd"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ddthetalist", "=", 
              RowBox[{"ForwardDynamics", "[", 
               RowBox[{
               "thetacurrent", ",", "dthetacurrent", ",", "taulist", ",", "g",
                 ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"Ftipmatt", "[", 
                   RowBox[{"[", 
                    RowBox[{";;", ",", "i"}], "]"}], "]"}], "}"}], 
                 "\[Transpose]"}], ",", "Mlist", ",", "Glist", ",", "Slist"}],
                "]"}]}], ";", "\n", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"thetacurrent", ",", "dthetacurrent"}], "}"}], "=", 
              RowBox[{"EulerStep", "[", 
               RowBox[{
               "thetacurrent", ",", "dthetacurrent", ",", "ddthetalist", ",", 
                
                RowBox[{"(", 
                 RowBox[{"dt", "/", "intRes"}], ")"}]}], "]"}]}]}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "intRes"}], "}"}]}], "]"}], ";", 
          RowBox[{
           RowBox[{"taumat", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", "i"}], "]"}], "]"}], "=", "taulist"}], ";", 
          RowBox[{
           RowBox[{"thetamat", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", "i"}], "]"}], "]"}], "=", "thetacurrent"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"eint", "=", 
           RowBox[{"eint", "+", 
            RowBox[{"(", 
             RowBox[{"dt", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"thetamatdt", "[", 
                 RowBox[{"[", 
                  RowBox[{";;", ",", "i"}], "]"}], "]"}], "-", 
                "thetacurrent"}], ")"}]}], ")"}]}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Output", " ", "plotting"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"links", "=", 
        RowBox[{
         RowBox[{"Dimensions", "[", "thetamat", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", 
       RowBox[{"plotAngles", " ", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"labels", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"style", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"plotAngles", ",", " ", 
            RowBox[{"Flatten", "[", 
             RowBox[{"thetamat", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", ";;"}], "]"}], "]"}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"plotAngles", ",", " ", 
            RowBox[{"Flatten", "[", 
             RowBox[{"thetamatdt", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", ";;"}], "]"}], "]"}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"labels", ",", " ", 
            RowBox[{"StringJoin", "[", 
             RowBox[{"\"\<ActualTheta\>\"", ",", 
              RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"labels", ",", " ", 
            RowBox[{"StringJoin", "[", 
             RowBox[{"\"\<DesiredTheta\>\"", ",", 
              RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"col", " ", "=", " ", 
           RowBox[{"RandomColor", "[", "]"}]}], ";", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"style", ",", " ", "col"}], "]"}], ";", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"style", ",", " ", 
            RowBox[{"{", 
             RowBox[{"col", ",", "Dashed"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "links"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{"plotAngles", ",", 
          RowBox[{"PlotLegends", "\[Rule]", "labels"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", "style"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<Time\>\"", ",", "\"\<Joint Angles\>\""}], "}"}]}], 
          ",", 
          RowBox[{
          "PlotLabel", "\[Rule]", 
           "\"\<Plot of Actual and Desired Joint Angles\>\""}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "Full"}]}], "]"}], "]"}], ";", 
       RowBox[{"taumat", "=", 
        RowBox[{"taumat", "\[Transpose]"}]}], ";", 
       RowBox[{"thetamat", "=", 
        RowBox[{"thetamat", "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"taumat", ",", "thetamat"}], "}"}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{
  3.677924853965807*^9, 3.6779251590971527`*^9, {3.677925359632638*^9, 
   3.677925494612109*^9}, {3.677925600073634*^9, 3.677925626646657*^9}, {
   3.6779257311273537`*^9, 3.677925754253189*^9}, {3.677925821586344*^9, 
   3.6779258481817217`*^9}, {3.6779273195920897`*^9, 3.677927355304405*^9}, {
   3.6779277973487988`*^9, 3.6779278021979847`*^9}, {3.67792783288631*^9, 
   3.677928121348311*^9}, {3.6779281661484547`*^9, 3.6779281914512463`*^9}, {
   3.677928236881343*^9, 3.677928274073283*^9}, {3.677932699269586*^9, 
   3.677932700327119*^9}, {3.677934027976076*^9, 3.67793404625205*^9}, {
   3.677934083734558*^9, 3.677934088566362*^9}, {3.677934163992302*^9, 
   3.677934185281588*^9}, {3.677934364550599*^9, 3.677934419897183*^9}, {
   3.6779344508362417`*^9, 3.677934451566586*^9}, {3.677934492157349*^9, 
   3.677934494681019*^9}, {3.677934527031344*^9, 3.677934527237537*^9}, {
   3.677934575273864*^9, 3.677934644837254*^9}, {3.677934691786611*^9, 
   3.677934817811751*^9}, {3.6779349436710033`*^9, 3.677934985204653*^9}, {
   3.677937983500269*^9, 3.677937984977446*^9}, {3.6779381257429047`*^9, 
   3.677938133660923*^9}, {3.677938202196999*^9, 3.677938227703239*^9}, 
   3.677938377314639*^9, {3.677938438157711*^9, 3.677938576047544*^9}, {
   3.678096486746469*^9, 3.678096488807798*^9}, {3.678458049947278*^9, 
   3.678458060952914*^9}, 3.6784581253393917`*^9, 3.678458183955419*^9, {
   3.6784582141901493`*^9, 3.678458265956141*^9}, {3.6784583117105293`*^9, 
   3.678458357793298*^9}, {3.6814552043709087`*^9, 3.6814552145069237`*^9}, {
   3.681455255663412*^9, 3.6814552687776537`*^9}, {3.682527789069289*^9, 
   3.68252787877598*^9}, {3.6826377575249643`*^9, 3.682637758148562*^9}, {
   3.682637818965764*^9, 3.682637876057115*^9}, {3.68263799461088*^9, 
   3.6826380144271793`*^9}, {3.682638200804899*^9, 3.682638250258004*^9}, {
   3.682638491207387*^9, 3.682638509228066*^9}, {3.682638631917736*^9, 
   3.682638693519517*^9}, {3.682638745721383*^9, 3.682638747825354*^9}, {
   3.682638856341588*^9, 3.6826388905407257`*^9}, {3.682640381499113*^9, 
   3.6826403886003857`*^9}, {3.683217656988469*^9, 3.6832176852212048`*^9}, {
   3.683217744924802*^9, 3.683217766049675*^9}, {3.683217920478265*^9, 
   3.683217969778751*^9}, {3.683218016468755*^9, 3.683218027518409*^9}, {
   3.683218299683257*^9, 3.683218343811051*^9}, {3.6832294792369823`*^9, 
   3.6832295082177353`*^9}, {3.683229548795042*^9, 3.683229601725254*^9}, {
   3.6832296530608*^9, 3.683229663552986*^9}, {3.683230807268846*^9, 
   3.683230812968185*^9}, {3.683231175975581*^9, 3.683231188638826*^9}, {
   3.6832842444241858`*^9, 3.6832842861726007`*^9}, {3.68328437230928*^9, 
   3.683284428369204*^9}, {3.683284725151619*^9, 3.683284747446712*^9}, {
   3.683284795412685*^9, 3.683284800591009*^9}, {3.683284836456174*^9, 
   3.6832849599694633`*^9}, {3.6832850755968657`*^9, 3.683285079362492*^9}, {
   3.683285131777463*^9, 3.6832851358839684`*^9}, {3.683285170074172*^9, 
   3.683285181469409*^9}, {3.6832852291753883`*^9, 3.683285255535644*^9}, {
   3.68328532480322*^9, 3.683285387297305*^9}, {3.683293799303421*^9, 
   3.683293808848403*^9}, {3.683293900157916*^9, 3.6832939365266323`*^9}, {
   3.683294004515588*^9, 3.683294015304785*^9}, {3.6832940532275763`*^9, 
   3.6832940548821487`*^9}, {3.683294119846901*^9, 3.683294124792877*^9}, {
   3.683294201505858*^9, 3.683294206793943*^9}, {3.683294527397341*^9, 
   3.683294536674127*^9}, {3.68329459453303*^9, 3.6832946335870047`*^9}, {
   3.683294675202341*^9, 3.68329467563385*^9}, {3.683294828461928*^9, 
   3.683294843524208*^9}, {3.683295063325433*^9, 3.683295096414126*^9}, {
   3.6832951835909977`*^9, 3.68329518390718*^9}, {3.683295296841012*^9, 
   3.6832953163258457`*^9}, {3.683295372115971*^9, 3.683295388765071*^9}, {
   3.683295527674631*^9, 3.683295532339222*^9}, {3.683295569113285*^9, 
   3.683295606563596*^9}, 3.683295882014827*^9, {3.683296409908462*^9, 
   3.68329642375393*^9}, {3.683296552745085*^9, 3.683296592250246*^9}, {
   3.683296653009379*^9, 3.683296669019459*^9}, {3.683296989986912*^9, 
   3.683297034939659*^9}, {3.683298384693363*^9, 3.68329838977964*^9}, {
   3.683298428043923*^9, 3.6832984401731453`*^9}, {3.683298491152433*^9, 
   3.683298544421233*^9}, {3.683298597144882*^9, 3.683298646838909*^9}, {
   3.683298685695128*^9, 3.683298691211185*^9}, 3.6832988974154367`*^9, 
   3.6833032529549294`*^9, 3.683303395645307*^9, {3.6833040545975246`*^9, 
   3.683304084731357*^9}, {3.683307930454728*^9, 3.6833079832892313`*^9}, {
   3.683308115214395*^9, 3.683308196130604*^9}, {3.6890470361422048`*^9, 
   3.6890470388812103`*^9}, {3.6891123699780474`*^9, 3.689112372338051*^9}, {
   3.691238468892124*^9, 3.6912384810445457`*^9}, {3.691238519391413*^9, 
   3.691238560359085*^9}, {3.6912385973985505`*^9, 3.691238753935226*^9}, {
   3.6912388138745317`*^9, 3.691238883784254*^9}, {3.6912390413973317`*^9, 
   3.6912390540821543`*^9}, {3.6912391147224607`*^9, 3.691239358017889*^9}, {
   3.691239391667148*^9, 3.691239399311161*^9}, {3.6912394351152244`*^9, 
   3.691239440233033*^9}, {3.6912395186427712`*^9, 3.6912395261307845`*^9}, {
   3.6912396178483458`*^9, 3.691239629298766*^9}, {3.6912397575233917`*^9, 
   3.6912397579289923`*^9}, {3.6912398155272937`*^9, 
   3.6912398167128954`*^9}, {3.691239848133752*^9, 3.6912399032906494`*^9}, {
   3.691240733580181*^9, 3.6912407517240124`*^9}, {3.691240781871266*^9, 
   3.691240790166881*^9}, {3.691240822398538*^9, 3.691240839324568*^9}, {
   3.691240904942283*^9, 3.69124098820463*^9}, {3.691241221936241*^9, 
   3.6912412912667627`*^9}, {3.691241341265851*^9, 3.691241353121872*^9}, {
   3.691241384745127*^9, 3.6912414460094347`*^9}, {3.6912415506282187`*^9, 
   3.6912415601442356`*^9}, {3.691241609224922*^9, 3.691241611346526*^9}, 
   3.6912416772334423`*^9, {3.691241709542099*^9, 3.691241722053321*^9}, {
   3.6912417533645763`*^9, 3.6912417645653954`*^9}, 3.692486815324915*^9, {
   3.692487068665405*^9, 3.6924873955661025`*^9}, {3.6924875142908936`*^9, 
   3.69248752279338*^9}, {3.692487617276784*^9, 3.6924876211690063`*^9}, {
   3.692487750765419*^9, 3.6924880706777167`*^9}, {3.6931541227261524`*^9, 
   3.6931541304325657`*^9}, {3.693164676347744*^9, 
   3.6931647434622774`*^9}},ExpressionUUID->"96452019-eb03-4d11-8fe2-\
e6a38169415d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Final Assignment", "Title",
 CellChangeTimes->{{3.720829956890471*^9, 3.7208299571717377`*^9}, {
  3.7215904868073072`*^9, 
  3.7215904929634256`*^9}},ExpressionUUID->"dbf8f5a8-10a3-400c-8313-\
fd5d85dd9991"],

Cell[CellGroupData[{

Cell["Part {c}", "Section",
 CellChangeTimes->{{3.7209856004232492`*^9, 
  3.7209856056397133`*^9}},ExpressionUUID->"2ec7cc55-19e3-431d-a43a-\
7d11ac893925"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Blist", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", 
        RowBox[{"0.1662", "+", "0.0330"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", "0.0330", ",", "0"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"\[Minus]", "1"}], ",", "0", ",", 
        RowBox[{"\[Minus]", "0.5076"}], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}], ",", "0", ",", 
        RowBox[{"\[Minus]", "0.3526"}], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}], ",", "0", ",", 
        RowBox[{"\[Minus]", "0.2176"}], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], 
       "}"}]}], "}"}], "\[Transpose]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"  ", 
  RowBox[{
   RowBox[{"M", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", 
        RowBox[{"0.1662", "+", "0.0330"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", 
        RowBox[{"0.0963", "+", "0.0026", "+", "0.6546"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{"  ", 
  RowBox[{
   RowBox[{"T", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}], ",", "0", ",", "0.4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
   ";"}]}], "\[IndentingNewLine]", 
 RowBox[{"  ", 
  RowBox[{
   RowBox[{"thetalist0", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        RowBox[{
         RowBox[{"-", "Pi"}], "/", "2"}], ",", "0", ",", "0"}], "}"}], "}"}], 
     "\[Transpose]"}]}], ";"}]}], "\[IndentingNewLine]", 
 RowBox[{"  ", 
  RowBox[{
   RowBox[{"eomg", "=", "0.001"}], ";"}]}], "\n", 
 RowBox[{"  ", 
  RowBox[{
   RowBox[{"ev", "=", "0.001"}], ";"}]}], "\[IndentingNewLine]", 
 RowBox[{"  ", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"thetalist", ",", "success"}], "}"}], " ", "=", " ", 
    RowBox[{"IKinBody", "[", 
     RowBox[{
     "Blist", ",", "M", ",", "T", ",", "thetalist0", ",", "eomg", ",", "ev"}],
      "]"}]}], ";"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<The configuration obtained is :\>\"", ",", "thetalist"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
  "\"\<The transformation of end effector with respect to the above \
configuration is: \>\"", ",", " ", 
   RowBox[{
    RowBox[{"Chop", "[", 
     RowBox[{
      RowBox[{"FKinBody", "[", 
       RowBox[{"M", ",", "Blist", ",", "thetalist"}], "]"}], ",", "0.01"}], 
     "]"}], "//", "MatrixForm"}], ",", 
   "\"\< whih is the same as the desired trasformation.\>\""}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.7209790632287636`*^9, {3.7209806130479603`*^9, 3.7209806134832754`*^9}, {
   3.72098477534529*^9, 3.72098477628692*^9}, 3.720985042466528*^9, {
   3.721238170755191*^9, 3.7212381783784533`*^9}, {3.7212384087101183`*^9, 
   3.721238451798972*^9}, {3.7212384839608107`*^9, 3.7212385036967583`*^9}, {
   3.721238560969195*^9, 3.7212385638570557`*^9}, {3.7215902572458534`*^9, 
   3.721590383575251*^9}, 3.7215904436274242`*^9, 
   3.721590527366439*^9},ExpressionUUID->"b7cb6ab5-bc72-45e1-b693-\
83dad68e03c3"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"The configuration obtained is :\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0.9100568009445401`", "}"}], ",", 
     RowBox[{"{", "0.44788586362807553`", "}"}], ",", 
     RowBox[{"{", "0.4773215512947791`", "}"}], ",", 
     RowBox[{"{", "0.6607394732150949`", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"-", "0.7137851255082963`"}], "}"}], ",", 
     RowBox[{"{", "2.0074808534793895`", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"-", "2.8644920509265916`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"-", "1.5707962741596349`"}], "}"}]}], "}"}]}],
  SequenceForm[
  "The configuration obtained is :", {{0.9100568009445401}, {
   0.44788586362807553`}, {0.4773215512947791}, {
   0.6607394732150949}, {-0.7137851255082963}, {
   2.0074808534793895`}, {-2.8644920509265916`}, {-1.5707962741596349`}}],
  Editable->False]], "Print",
 CellChangeTimes->{3.721590384895134*^9, 3.7215904443899336`*^9, 
  3.721590527975854*^9},ExpressionUUID->"88a4c236-1c3d-4ea7-8927-\
6f6fd77511ca"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"The transformation of end effector with respect to the above \
configuration is: \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.9999999999999972`", "0", "0", "0"},
       {"0", "0", "0.9999999999999987`", "1.0000054872093482`"},
       {"0", 
        RowBox[{"-", "0.9999999999999986`"}], "0", "0.3999945039749065`"},
       {"0", "0", "0", "1.`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], 
   "\[InvisibleSpace]", "\<\" whih is the same as the desired \
trasformation.\"\>"}],
  SequenceForm[
  "The transformation of end effector with respect to the above configuration \
is: ", 
   MatrixForm[{{0.9999999999999972, 0, 0, 0}, {
     0, 0, 0.9999999999999987, 1.0000054872093482`}, {
     0, -0.9999999999999986, 0, 0.3999945039749065}, {0, 0, 0, 1.}}], 
   " whih is the same as the desired trasformation."],
  Editable->False]], "Print",
 CellChangeTimes->{3.721590384895134*^9, 3.7215904443899336`*^9, 
  3.7215905279838524`*^9},ExpressionUUID->"29e13b8b-040b-4c28-8b9b-\
25114e2ce291"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Part {d}", "Section",
 CellChangeTimes->{{3.720985620460145*^9, 
  3.720985625776595*^9}},ExpressionUUID->"93ccdc0a-248d-4699-b6fd-\
108a39db1f46"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"s", "[", "t_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"3", "/", "25"}], "*", 
    SuperscriptBox["t", "2"]}], "-", 
   RowBox[{
    RowBox[{"2", "/", "125"}], "*", 
    SuperscriptBox["t", "3"]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xdes", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"s", "[", "t", "]"}], "*", 
         RowBox[{"Pi", "/", "2"}]}], "]"}], ",", "0", ",", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"s", "[", "t", "]"}], "*", 
         RowBox[{"Pi", "/", "2"}]}], "]"}], ",", 
       RowBox[{"s", "[", "t", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"s", "[", "t", "]"}], "*", 
          RowBox[{"Pi", "/", "2"}]}], "]"}]}], ",", "0", ",", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"s", "[", "t", "]"}], "*", 
         RowBox[{"Pi", "/", "2"}]}], "]"}], ",", " ", "0.491"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vdesbox", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Inverse", "[", "xdes", "]"}], ".", 
     RowBox[{"D", "[", 
      RowBox[{"xdes", ",", "t"}], "]"}]}], " ", "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vdes", "=", 
   RowBox[{"se3ToVec", "[", "vdesbox", "]"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tsbt", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
        RowBox[{"-", 
         RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", "0", ",", "x"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Phi]", "]"}], ",", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", "0", ",", "y"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0.0963"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Blist", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", "0.0330", ",", "0"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"\[Minus]", "1"}], ",", "0", ",", 
        RowBox[{"\[Minus]", "0.5076"}], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}], ",", "0", ",", 
        RowBox[{"\[Minus]", "0.3526"}], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}], ",", "0", ",", 
        RowBox[{"\[Minus]", "0.2176"}], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], 
       "}"}]}], "}"}], "\[Transpose]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"  ", 
  RowBox[{
   RowBox[{"M", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", 
        RowBox[{"0.1662", "+", "0.0330"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", 
        RowBox[{"0.0963", "+", "0.0026", "+", "0.6546"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{"   ", 
  RowBox[{
   RowBox[{"eomg", "=", "0.01"}], ";"}]}], "\n", 
 RowBox[{"  ", 
  RowBox[{
   RowBox[{"ev", "=", "0.001"}], ";"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"timestep", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dt", "=", "0"}], ";", 
  RowBox[{"xdesmat", "=", 
   RowBox[{"List", "[", "]"}]}], ";", 
  RowBox[{"vdesmat", "=", 
   RowBox[{"List", "[", "]"}]}], ";", 
  RowBox[{"thetalistmat", "=", 
   RowBox[{"List", "[", "]"}]}], ";", 
  RowBox[{"dthetalistmat", "=", 
   RowBox[{"List", "[", "]"}]}], ";", 
  RowBox[{"umat", "=", 
   RowBox[{"List", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"velmat", "=", 
   RowBox[{"List", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"velmethod2mat", "=", 
   RowBox[{"List", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"csv", "=", 
   RowBox[{"List", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xerrmat", "=", 
   RowBox[{"List", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kprop", "=", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kint", "=", "50"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"q00", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "Pi"}], "/", "8"}], ",", 
        RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}], "}"}], "\[Transpose]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"q00", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "0.526"}], ",", "0"}], "}"}], "}"}], "\[Transpose]"}]}],
     ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"thetalist0", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{
         RowBox[{"-", "Pi"}], "/", "4"}], ",", 
        RowBox[{"Pi", "/", "4"}], ",", 
        RowBox[{
         RowBox[{"-", "Pi"}], "/", "2"}], ",", "0"}], "}"}], "}"}], 
     "\[Transpose]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Moe", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0.0330"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0.6546"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";"}], 
  " ", "\[IndentingNewLine]", " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "=", "0.0475"}], ";", 
  RowBox[{"l", "=", " ", 
   RowBox[{"0.47", "/", "2"}]}], ";", " ", 
  RowBox[{"w", "=", 
   RowBox[{"0.3", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "=", 
    RowBox[{
     RowBox[{"r", "/", "4"}], "*", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "/", 
          RowBox[{"(", 
           RowBox[{"l", "+", "w"}], ")"}]}], ",", 
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"l", "+", "w"}], ")"}]}], ",", 
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"l", "+", "w"}], ")"}]}], ",", 
         RowBox[{
          RowBox[{"-", "1"}], "/", 
          RowBox[{"(", 
           RowBox[{"l", "+", "w"}], ")"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1", ",", 
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", 
    RowBox[{"vupdated", "=", 
     RowBox[{"List", "[", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"wheelangle", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", "4"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"qnew", "=", "q00"}], ";", "\[IndentingNewLine]", 
    RowBox[{"cumerr", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", "6"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"i", "\[LessEqual]", "500"}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "1", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xdesnow", "=", 
     RowBox[{
      RowBox[{"xdes", "/.", 
       RowBox[{"t", "\[Rule]", " ", "dt"}]}], " ", "//", "FullSimplify"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"xdesmat", "=", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"xdesmat", ",", 
       RowBox[{"xdesnow", " ", "//", "Chop"}]}], "]"}]}], " ", ";", 
    "\[IndentingNewLine]", 
    RowBox[{"vdesboxi", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Inverse", "[", "xdes", "]"}], ".", 
        RowBox[{"D", "[", 
         RowBox[{"xdes", ",", "t"}], "]"}]}], " ", "/.", 
       RowBox[{"t", "\[Rule]", " ", "dt"}]}], "//", "FullSimplify"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"vdesi", "=", 
     RowBox[{
      RowBox[{"se3ToVec", "[", "vdesboxi", "]"}], " ", "//", "Chop"}]}], " ", 
    ";", "\[IndentingNewLine]", 
    RowBox[{"vdesmat", "=", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"vdesmat", ",", "vdesi"}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", "2", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Tsbn", "=", 
     RowBox[{"Tsbt", " ", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Phi]", "\[Rule]", 
         RowBox[{"qnew", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"x", "\[Rule]", 
         RowBox[{"qnew", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"y", "\[Rule]", 
         RowBox[{"qnew", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}]}]}], "}"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Tbo", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0", ",", "0.1662"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1", ",", "0.0026"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Toe", " ", "=", " ", 
     RowBox[{
      RowBox[{"FKinBody", "[", 
       RowBox[{"Moe", ",", "Blist", ",", "thetalist0"}], "]"}], "//", 
      "Chop"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"xnew", "=", 
     RowBox[{"Tsbn", ".", "Tbo", ".", "Toe"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"xerr", "=", 
     RowBox[{"se3ToVec", "[", 
      RowBox[{"MatrixLog6", "[", 
       RowBox[{
        RowBox[{"Inverse", "[", "xnew", "]"}], ".", "xdesnow"}], "]"}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"xerrmat", "=", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"xerrmat", ",", "xerr"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"cumerr", "+=", 
     RowBox[{"timestep", "*", 
      RowBox[{"xerr", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", "3", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"vupdated", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Adjoint", "[", 
           RowBox[{
            RowBox[{"Inverse", "[", "xnew", "]"}], ".", "xdesnow"}], "]"}], 
          ".", "vdesi"}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], "+", 
       RowBox[{"kprop", "*", 
        RowBox[{"xerr", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "+", 
       RowBox[{"kint", "*", "cumerr"}]}], "//", "Chop"}]}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{"control", " ", "law"}], "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", "4", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Jbase", "=", 
     RowBox[{
      RowBox[{"Adjoint", "[", 
       RowBox[{
        RowBox[{"Inverse", "[", "Toe", "]"}], ".", 
        RowBox[{"Inverse", "[", "Tbo", "]"}]}], "]"}], ".", "f"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Jarm", "=", 
     RowBox[{"JacobianBody", "[", 
      RowBox[{"Blist", ",", "thetalist0"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Jbmethod2", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Jbase", "\[Transpose]"}], ",", 
         RowBox[{"Jarm", "\[Transpose]"}]}], "]"}], "\[Transpose]"}], " ", "//",
       "Chop"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"dthetalist", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"PseudoInverse", "[", "Jbmethod2", "]"}], ".", "vupdated"}], "//",
       "Chop"}]}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"u", " ", "and", " ", "dtheta"}], "*)"}], "\[IndentingNewLine]", 
    
    RowBox[{"dthetalistmat", "=", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"dthetalistmat", ",", "dthetalist"}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", "5", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"wheelchange", "=", 
     RowBox[{"timestep", "*", 
      RowBox[{"dthetalist", "[", 
       RowBox[{"[", 
        RowBox[{";;", "4"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"wheelangle", "+=", "wheelchange"}], ";", "\[IndentingNewLine]", 
    RowBox[{"vbase", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"r", "/", "4"}], "*", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "1"}], "/", 
             RowBox[{"(", 
              RowBox[{"l", "+", "w"}], ")"}]}], ",", 
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{"l", "+", "w"}], ")"}]}], ",", 
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{"l", "+", "w"}], ")"}]}], ",", 
            RowBox[{
             RowBox[{"-", "1"}], "/", 
             RowBox[{"(", 
              RowBox[{"l", "+", "w"}], ")"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1", ",", 
            RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], ".", 
        "wheelchange"}]}], " ", "//", "Chop"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"vbase", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dphi", "=", "0"}], ";", 
       RowBox[{"dx", "=", 
        RowBox[{"vbase", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", 
       RowBox[{"dy", "=", 
        RowBox[{"vbase", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dphi", "=", 
        RowBox[{"vbase", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", 
       RowBox[{"dx", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"vbase", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "*", 
            RowBox[{"Sin", "[", 
             RowBox[{"vbase", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"vbase", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"vbase", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "1"}], ")"}]}]}], 
          ")"}], "/", 
         RowBox[{"vbase", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dy", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"vbase", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "*", 
            RowBox[{"Sin", "[", 
             RowBox[{"vbase", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"vbase", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"vbase", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "1"}], ")"}]}]}], 
          ")"}], "/", 
         RowBox[{"vbase", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}]}]}], "]"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"dq", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"Cos", "[", 
           RowBox[{"qnew", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"Sin", "[", 
            RowBox[{"qnew", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"Sin", "[", 
           RowBox[{"qnew", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"Cos", "[", 
           RowBox[{"qnew", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], "}"}], 
      ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "dphi", "}"}], ",", 
        RowBox[{"{", "dx", "}"}], ",", 
        RowBox[{"{", "dy", "}"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"qnew", "=", 
     RowBox[{"qnew", "+", "dq"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"qcsv", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"qnew", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"qnew", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{"qnew", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";", "\[IndentingNewLine]",
     "\[IndentingNewLine]", 
    RowBox[{"thetalist0", "+=", 
     RowBox[{"timestep", "*", 
      RowBox[{"dthetalist", "[", 
       RowBox[{"[", 
        RowBox[{"5", ";;"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"csv", "=", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"csv", ",", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"qcsv", "\[Transpose]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"thetalist0", "\[Transpose]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "wheelangle"}], "]"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"dt", "+=", "timestep"}]}]}], "]"}], "\n", 
 RowBox[{
  RowBox[{"name", "=", "\"\<kp20_ki50\>\""}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"xerrmat", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], "\[Transpose]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"xerrmat", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "2"}], "]"}], "]"}], "\[Transpose]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"xerrmat", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "3"}], "]"}], "]"}], "\[Transpose]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"xerrmat", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "4"}], "]"}], "]"}], "\[Transpose]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"e", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"xerrmat", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "5"}], "]"}], "]"}], "\[Transpose]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"xerrmat", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "6"}], "]"}], "]"}], "\[Transpose]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "f"}], "}"}], 
   ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<wx\>\"", ",", "\"\<wy\>\"", ",", "\"\<wz\>\"", ",", "\"\<vx\>\"", 
      ",", "\"\<vy\>\"", ",", "\"\<vz\>\""}], "}"}]}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", "name"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"name", "<>", "\"\<.gif\>\""}], ",", "%", ",", 
   RowBox[{"ImageResolution", "\[Rule]", " ", "500"}], ",", 
   RowBox[{"ImageFormattingWidth", "\[Rule]", " ", "1000"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"name", "<>", "\"\<.csv\>\""}], ",", "csv"}], "]"}]}], "Input",
 CellChangeTimes->{{3.720974695769087*^9, 3.7209747637816043`*^9}, {
   3.720974859059655*^9, 3.720975084041689*^9}, {3.7209751188261404`*^9, 
   3.7209751543565893`*^9}, {3.7209752223320627`*^9, 3.720975301450877*^9}, {
   3.7209753331085653`*^9, 3.7209754451120367`*^9}, {3.7209797673773146`*^9, 
   3.7209798204299984`*^9}, {3.7209799008494463`*^9, 
   3.7209799314760036`*^9}, {3.720980549453785*^9, 3.720980553557396*^9}, {
   3.720980843547366*^9, 3.720980880588963*^9}, {3.7209828055604525`*^9, 
   3.7209828657474737`*^9}, 3.7209828970976954`*^9, {3.7209829434425707`*^9, 
   3.720982968977685*^9}, {3.7209830322626824`*^9, 3.720983069387573*^9}, {
   3.720983128301289*^9, 3.7209832024476166`*^9}, {3.7209832445401793`*^9, 
   3.720983281298842*^9}, {3.720983325921372*^9, 3.720983326277484*^9}, {
   3.720983370160657*^9, 3.7209833934225082`*^9}, {3.7209834409781237`*^9, 
   3.720983441545015*^9}, {3.7209835137299004`*^9, 3.7209836235613146`*^9}, {
   3.7209836999802876`*^9, 3.7209837849562535`*^9}, {3.7209838483055463`*^9, 
   3.7209838666578054`*^9}, {3.7209840305041323`*^9, 3.720984170080349*^9}, {
   3.720984202616141*^9, 3.72098430627133*^9}, {3.720984466588726*^9, 
   3.720984467051036*^9}, {3.72098454787595*^9, 3.72098455225325*^9}, {
   3.7209845844540143`*^9, 3.7209846371016626`*^9}, {3.720984685618991*^9, 
   3.7209846968848505`*^9}, {3.720984876226859*^9, 3.720984980306723*^9}, {
   3.7209850641548147`*^9, 3.7209850829904194`*^9}, {3.720985264100506*^9, 
   3.7209852776484613`*^9}, {3.720985457956959*^9, 3.720985473011875*^9}, {
   3.7209855476018453`*^9, 3.7209855511736374`*^9}, {3.7209856714101734`*^9, 
   3.7209857706597347`*^9}, {3.720985843190339*^9, 3.7209858560851927`*^9}, {
   3.7209859280931816`*^9, 3.720986045839029*^9}, {3.7209863288397846`*^9, 
   3.720986329402194*^9}, {3.7209863631043763`*^9, 3.720986407246428*^9}, {
   3.720986448548724*^9, 3.720986448707033*^9}, {3.7209865818359284`*^9, 
   3.7209865858300633`*^9}, {3.7209881694125443`*^9, 3.720988178637858*^9}, {
   3.720988661279785*^9, 3.720988686015001*^9}, {3.720988789293276*^9, 
   3.7209889903483305`*^9}, {3.720991123468376*^9, 3.7209911510192213`*^9}, {
   3.720991222635482*^9, 3.720991261255472*^9}, {3.7209913406264915`*^9, 
   3.7209913423811245`*^9}, {3.7209934380550685`*^9, 3.720993455286357*^9}, {
   3.7209935969427214`*^9, 3.720993599358584*^9}, {3.7209946290647*^9, 
   3.72099477167642*^9}, {3.7209948061423874`*^9, 3.720994972947747*^9}, {
   3.7209954839309206`*^9, 3.7209954861601143`*^9}, {3.7209956347840943`*^9, 
   3.7209956386195545`*^9}, {3.7209956693957987`*^9, 
   3.7209956731873446`*^9}, {3.72099598315117*^9, 3.720996011821018*^9}, {
   3.7209961391508656`*^9, 3.720996149444649*^9}, {3.72099619489578*^9, 
   3.720996209454317*^9}, {3.7209981003698983`*^9, 3.720998102814208*^9}, 
   3.720998174774102*^9, {3.7209985000433607`*^9, 3.720998532488959*^9}, {
   3.72099880030556*^9, 3.720998820711067*^9}, {3.7209989896808004`*^9, 
   3.7209990000807066`*^9}, {3.720999619231596*^9, 3.7209997614419436`*^9}, {
   3.7209998532544584`*^9, 3.7209998885360904`*^9}, {3.721001706064694*^9, 
   3.721001740864233*^9}, {3.7210017743845816`*^9, 3.721001781732506*^9}, {
   3.7210018518467054`*^9, 3.721001864975668*^9}, {3.721001940806985*^9, 
   3.7210020114455185`*^9}, {3.7210024416706395`*^9, 3.721002454640174*^9}, 
   3.721002520086478*^9, {3.72100283759842*^9, 3.7210028850781417`*^9}, {
   3.7210030928112617`*^9, 3.721003106519456*^9}, {3.721062828743232*^9, 
   3.721062853439143*^9}, {3.721063161321429*^9, 3.7210632841526375`*^9}, {
   3.721063317683889*^9, 3.721063345812543*^9}, {3.721063413409644*^9, 
   3.721063605678602*^9}, {3.721063683533615*^9, 3.7210637866600275`*^9}, {
   3.721063825535057*^9, 3.7210638575102673`*^9}, 3.7210639249809513`*^9, {
   3.7210639589013705`*^9, 3.7210639804876785`*^9}, {3.721064032043748*^9, 
   3.7210640525480437`*^9}, {3.7210643459995203`*^9, 
   3.7210643471342745`*^9}, {3.7210645502156444`*^9, 
   3.7210646044366035`*^9}, {3.7210648190251927`*^9, 3.721064847907312*^9}, {
   3.7210648968806233`*^9, 3.721064903312139*^9}, {3.721065010486869*^9, 
   3.7210650139516535`*^9}, {3.721065737168042*^9, 3.721065744919377*^9}, 
   3.7210659220243163`*^9, {3.7210659703732944`*^9, 3.7210660831691256`*^9}, {
   3.721066444754381*^9, 3.721066471618579*^9}, {3.7210665987682486`*^9, 
   3.721066606265937*^9}, 3.721066642695117*^9, 3.721079846574545*^9, {
   3.7210804293750677`*^9, 3.721080447185153*^9}, {3.721088731415575*^9, 
   3.7210887582584066`*^9}, {3.721088898053502*^9, 3.7210889054484825`*^9}, {
   3.7210891350272846`*^9, 3.72108914314824*^9}, {3.7210914803829937`*^9, 
   3.7210914827540984`*^9}, {3.72109263138922*^9, 3.721092649162654*^9}, {
   3.7210927414244547`*^9, 3.721092761241129*^9}, {3.72113735406382*^9, 
   3.721137362020632*^9}, {3.721138555848981*^9, 3.721138556562071*^9}, {
   3.721151261398904*^9, 3.7211512778055177`*^9}, 3.721151907540892*^9, {
   3.7211521012419024`*^9, 3.721152138077873*^9}, {3.721152245091504*^9, 
   3.7211523494170604`*^9}, {3.721152380060057*^9, 3.721152386812915*^9}, {
   3.7211526271038685`*^9, 3.721152794254667*^9}, {3.721152836649841*^9, 
   3.72115288274524*^9}, {3.7211542947157984`*^9, 3.7211543417748594`*^9}, {
   3.721154381020456*^9, 3.72115448052221*^9}, {3.7211545237551413`*^9, 
   3.721154546683912*^9}, {3.7211546054322166`*^9, 3.721154611680744*^9}, {
   3.7211546520531297`*^9, 3.721154709056649*^9}, {3.721154773171813*^9, 
   3.7211548261493053`*^9}, 3.7211562622576942`*^9, {3.721156601324605*^9, 
   3.7211567266896667`*^9}, {3.7211567780954685`*^9, 
   3.7211567892907343`*^9}, {3.7211568405656195`*^9, 
   3.7211569182606955`*^9}, {3.7211570953847513`*^9, 
   3.7211571440209618`*^9}, {3.7211572391514316`*^9, 
   3.7211572889670424`*^9}, {3.7211573256753244`*^9, 
   3.7211573280268946`*^9}, {3.721157475553095*^9, 3.7211574796985207`*^9}, {
   3.721157514654248*^9, 3.7211578121435347`*^9}, {3.7211578490983505`*^9, 
   3.7211581022042522`*^9}, {3.7211581374230366`*^9, 
   3.7211581648505807`*^9}, {3.721158195348426*^9, 3.7211583618608923`*^9}, {
   3.7211584118924437`*^9, 3.7211584553911886`*^9}, {3.7211585799272337`*^9, 
   3.7211585900646753`*^9}, {3.7211588727248783`*^9, 3.721158960663841*^9}, {
   3.721159053877784*^9, 3.721159078942623*^9}, {3.721159121785948*^9, 
   3.721159187435957*^9}, {3.7211597240343957`*^9, 3.7211597322227573`*^9}, {
   3.7211597929235134`*^9, 3.7211597977678022`*^9}, {3.721159846678568*^9, 
   3.7211598498110576`*^9}, {3.7211599895153313`*^9, 3.721160031385194*^9}, 
   3.7211602104826527`*^9, {3.7211603663197527`*^9, 3.7211603921687627`*^9}, {
   3.7211604987828207`*^9, 3.721160513087637*^9}, {3.721160570182317*^9, 
   3.7211605706724296`*^9}, {3.721160635014448*^9, 3.7211606494319487`*^9}, 
   3.7211610658772717`*^9, {3.721161194651013*^9, 3.7211611972735133`*^9}, {
   3.721161434500609*^9, 3.721161434651737*^9}, {3.7211615137903514`*^9, 
   3.7211615142703085`*^9}, {3.7211615805332165`*^9, 3.721161649875993*^9}, {
   3.7211617499550676`*^9, 3.7211617508106112`*^9}, {3.721161976962226*^9, 
   3.7211619865819893`*^9}, {3.7211620601690807`*^9, 3.721162063722747*^9}, {
   3.7211621289734936`*^9, 3.7211621355341597`*^9}, {3.721162216742467*^9, 
   3.7211622372971563`*^9}, {3.721162278859419*^9, 3.721162297090695*^9}, {
   3.721162876474043*^9, 3.7211628960501814`*^9}, {3.721163121919675*^9, 
   3.721163164079892*^9}, 3.721163488333953*^9, {3.7211635497964163`*^9, 
   3.7211636803938446`*^9}, {3.7211637165652013`*^9, 
   3.7211637279860544`*^9}, {3.7211637592495146`*^9, 
   3.7211637611447763`*^9}, {3.7211641025758553`*^9, 
   3.7211641746104684`*^9}, {3.7211642518215303`*^9, 
   3.7211642603732204`*^9}, {3.721164295087677*^9, 3.721164333521616*^9}, {
   3.7211644223955436`*^9, 3.721164438361373*^9}, {3.721164486085924*^9, 
   3.7211645664749746`*^9}, {3.721164695922261*^9, 3.7211647373116207`*^9}, {
   3.7211647730389376`*^9, 3.7211648066833363`*^9}, {3.721164918817577*^9, 
   3.7211649429165087`*^9}, {3.7211652476932487`*^9, 3.721165251820637*^9}, {
   3.721165934459196*^9, 3.7211659434764585`*^9}, {3.721166143565262*^9, 
   3.7211662058455863`*^9}, {3.721166248671315*^9, 3.7211662681232357`*^9}, {
   3.7211663380038204`*^9, 3.721166340027897*^9}, {3.7211670185168695`*^9, 
   3.7211670440350313`*^9}, {3.72116707967499*^9, 3.721167090512043*^9}, {
   3.721167130006442*^9, 3.7211671319829664`*^9}, {3.721167219936146*^9, 
   3.7211672238225975`*^9}, {3.7211673551800203`*^9, 3.721167358227093*^9}, 
   3.721167594784525*^9, {3.721167647840621*^9, 3.7211676904594927`*^9}, {
   3.721168108902266*^9, 3.7211681118015604`*^9}, {3.7211681605490866`*^9, 
   3.721168268961731*^9}, {3.721168326122121*^9, 3.7211683480007734`*^9}, {
   3.721168461020036*^9, 3.7211684743714247`*^9}, {3.7211685273670874`*^9, 
   3.7211685390735283`*^9}, {3.7211689635361724`*^9, 
   3.7211689900170946`*^9}, {3.721169622684369*^9, 3.7211696364780636`*^9}, {
   3.721169989999257*^9, 3.72116999939382*^9}, {3.721170737571944*^9, 
   3.721170737833181*^9}, {3.721170817113283*^9, 3.721170817499542*^9}, {
   3.7211712557944655`*^9, 3.721171260501832*^9}, {3.72117159526987*^9, 
   3.721171599763795*^9}, {3.721171737134886*^9, 3.721171747535062*^9}, {
   3.721171807077544*^9, 3.721171898161061*^9}, {3.7211719324780974`*^9, 
   3.721171948645438*^9}, {3.7211719942866907`*^9, 3.7211719984478607`*^9}, {
   3.721172076605173*^9, 3.7211720926534224`*^9}, {3.721172589369811*^9, 
   3.721172610833125*^9}, {3.721174738047596*^9, 3.7211747429886885`*^9}, 
   3.7211748077125387`*^9, {3.721178874411438*^9, 3.7211788745674887`*^9}, {
   3.721222736570126*^9, 3.7212227383254676`*^9}, 3.7212227946640053`*^9, {
   3.7212228328339376`*^9, 3.7212228807399635`*^9}, 3.7212229518652477`*^9, {
   3.721227745385238*^9, 3.7212277479944854`*^9}, {3.7212279562272716`*^9, 
   3.7212279627104883`*^9}, {3.721228019618043*^9, 3.7212281182286897`*^9}, {
   3.721228158937361*^9, 3.721228161024253*^9}, {3.721228207926126*^9, 
   3.721228224549423*^9}, 3.7212291006333475`*^9, {3.721229135877643*^9, 
   3.721229167181512*^9}, {3.721229206088098*^9, 3.7212292062672048`*^9}, {
   3.72122967565868*^9, 3.721229680941234*^9}, {3.7212297273461404`*^9, 
   3.7212297287524085`*^9}, {3.721229898354252*^9, 3.721229899966016*^9}, {
   3.7212299444677677`*^9, 3.7212299721285095`*^9}, {3.721230071185166*^9, 
   3.721230144070589*^9}, {3.721230185226329*^9, 3.7212302042257104`*^9}, {
   3.7212304975982513`*^9, 3.7212304981205854`*^9}, {3.7212305465226183`*^9, 
   3.7212306006462507`*^9}, {3.7212307952116885`*^9, 3.721230821344631*^9}, 
   3.721230916344452*^9, {3.721231358711813*^9, 3.7212313625152607`*^9}, 
   3.721231456243475*^9, {3.721231518257586*^9, 3.7212315962201643`*^9}, 
   3.721231793084034*^9, {3.7212318342057295`*^9, 3.721231909474666*^9}, {
   3.7212319826601706`*^9, 3.721231983185829*^9}, {3.721232018662262*^9, 
   3.7212320526229315`*^9}, {3.721232087509257*^9, 3.721232092960846*^9}, {
   3.7212321305073867`*^9, 3.7212321566347504`*^9}, {3.721232191053808*^9, 
   3.721232279709839*^9}, {3.7212323125222845`*^9, 3.72123232240954*^9}, {
   3.721232407961247*^9, 3.72123242826099*^9}, {3.72123257185295*^9, 
   3.721232592186952*^9}, {3.7212326516086855`*^9, 3.721232668494182*^9}, {
   3.7212327521558785`*^9, 3.7212328496606493`*^9}, {3.721233055590228*^9, 
   3.7212330586819024`*^9}, {3.7212332347150836`*^9, 3.721233306455007*^9}, {
   3.721233400927908*^9, 3.7212334198666973`*^9}, {3.7212334629897523`*^9, 
   3.7212334851901984`*^9}, {3.721233549137929*^9, 3.7212335968371706`*^9}, 
   3.721233688626363*^9, {3.721233776044874*^9, 3.7212337868574305`*^9}, {
   3.721233821581105*^9, 3.7212338229950385`*^9}, {3.7212339300518*^9, 
   3.721233961117034*^9}, {3.7212341012197866`*^9, 3.7212341844493465`*^9}, {
   3.7212347810028553`*^9, 3.721234781106926*^9}, {3.721234945346343*^9, 
   3.721234947523294*^9}, {3.72123507228642*^9, 3.721235090552396*^9}, {
   3.7212353429206676`*^9, 3.7212354550519514`*^9}, {3.72123553163968*^9, 
   3.7212355334516954`*^9}, {3.721235606102995*^9, 3.7212356975352216`*^9}, {
   3.7212358422139215`*^9, 3.7212358612457952`*^9}, {3.7212359011897497`*^9, 
   3.721236090920703*^9}, {3.7212361827154355`*^9, 3.721236355189038*^9}, {
   3.7212364478828754`*^9, 3.721236519325486*^9}, {3.721236577163907*^9, 
   3.721236591573444*^9}, {3.72123664722964*^9, 3.7212367236694193`*^9}, {
   3.7212367663589306`*^9, 3.7212369037505503`*^9}, {3.721237023169218*^9, 
   3.7212370364621058`*^9}, {3.7212399647159853`*^9, 
   3.7212400006591263`*^9}, {3.7212400526639576`*^9, 
   3.7212400534926963`*^9}, {3.721240088737406*^9, 3.7212400924420795`*^9}, {
   3.7212408085351067`*^9, 3.721240809920603*^9}, {3.721241073692192*^9, 
   3.7212410943891387`*^9}, {3.7212416987178764`*^9, 3.721241721093422*^9}, {
   3.721242111742702*^9, 3.7212421152436943`*^9}, {3.721242177191656*^9, 
   3.7212422185238934`*^9}, {3.721242368854661*^9, 3.7212423704142075`*^9}, {
   3.7212425451767554`*^9, 3.7212425487232428`*^9}, {3.7212425817645407`*^9, 
   3.7212426217250547`*^9}, {3.7212427765510178`*^9, 3.72124279938803*^9}, {
   3.7212428495876102`*^9, 3.7212428680417404`*^9}, {3.721242913064692*^9, 
   3.721242925664877*^9}, {3.721243092668611*^9, 3.7212431699783363`*^9}, {
   3.7212434309860215`*^9, 3.7212435785879908`*^9}, {3.7212436108652635`*^9, 
   3.721243702798376*^9}, {3.72124375134597*^9, 3.721243787828189*^9}, {
   3.7212438313074217`*^9, 3.721243834231309*^9}, {3.721243902432437*^9, 
   3.7212439218082147`*^9}, {3.7212439942847347`*^9, 
   3.7212441744275837`*^9}, {3.7212442110345016`*^9, 3.721244294455821*^9}, {
   3.7212443410595207`*^9, 3.7212446130441236`*^9}, 3.721244651583005*^9, {
   3.721244687139922*^9, 3.72124470498674*^9}, {3.7212447998504076`*^9, 
   3.72124484059361*^9}, {3.7212449340006447`*^9, 3.7212450257315035`*^9}, {
   3.721245231073451*^9, 
   3.7212452571400337`*^9}},ExpressionUUID->"3e8b2e85-99cf-46d6-9246-\
537e8c05013e"],

Cell[BoxData["\<\"kp20_ki50\"\>"], "Output",
 CellChangeTimes->{{3.7212335808940763`*^9, 3.7212336033071117`*^9}, 
   3.7212336947391453`*^9, 3.7212337927683563`*^9, 3.7212338285448813`*^9, {
   3.721233950824439*^9, 3.721233967457926*^9}, 3.72123415860876*^9, 
   3.7212341903009777`*^9, 3.7212348995838127`*^9, 3.721234953012788*^9, 
   3.7212350974888997`*^9, 3.7212354083389673`*^9, 3.721235463464717*^9, 
   3.721235539290451*^9, 3.721235705166097*^9, 3.7212358680425324`*^9, {
   3.721235906606803*^9, 3.721235953367099*^9}, {3.721236010104391*^9, 
   3.7212360290643725`*^9}, 3.721236063062812*^9, 3.721236096280732*^9, 
   3.721236214749363*^9, 3.7212362508782215`*^9, 3.7212362868748026`*^9, {
   3.721236332151003*^9, 3.721236361343519*^9}, 3.72123661177227*^9, 
   3.7212366926463537`*^9, 3.7212367295704055`*^9, {3.7212368158881674`*^9, 
   3.721236854372281*^9}, {3.7212368896190557`*^9, 3.7212369103160543`*^9}, 
   3.721237043677514*^9, 3.721238324524824*^9, {3.7212399968856816`*^9, 
   3.7212400092418756`*^9}, 3.721240058429979*^9, 3.72124009982108*^9, 
   3.721241456816403*^9, 3.7212421936909676`*^9, 3.7212422240890245`*^9, 
   3.721242376075283*^9, {3.721242562161561*^9, 3.7212426278398733`*^9}, 
   3.7212428730519643`*^9, 3.7212431800404854`*^9, 3.72124344928131*^9, {
   3.721243483880862*^9, 3.721243513746776*^9}, 3.7212435550731306`*^9, 
   3.7212435874843483`*^9, {3.7212436196574106`*^9, 3.7212436359825964`*^9}, {
   3.721243667474886*^9, 3.7212437111126437`*^9}, {3.721243758384021*^9, 
   3.721243793653286*^9}, 3.7212438391979685`*^9, {3.721243908725525*^9, 
   3.721243926915286*^9}, 3.72124402457608*^9, 3.7212440557899117`*^9, {
   3.7212441028317847`*^9, 3.7212441297039633`*^9}, {3.7212441678723545`*^9, 
   3.7212441798929996`*^9}, {3.7212442164074306`*^9, 3.721244267238963*^9}, 
   3.72124430099498*^9, {3.721244380495067*^9, 3.721244618325021*^9}, 
   3.7212446568226857`*^9, {3.7212446925563354`*^9, 3.7212447111667233`*^9}, {
   3.7212448072388377`*^9, 3.7212448463266897`*^9}, {3.7212449415457993`*^9, 
   3.7212450314649825`*^9}, 3.7212452634885473`*^9, 
   3.7215902325233154`*^9},ExpressionUUID->"f7586988-5be4-4f7e-bb9b-\
cf4a4b88cec7"],

Cell[BoxData[
 TemplateBox[{GraphicsBox[{{}, {{{}, {}, {
        Hue[0.67, 0.6, 0.6], 
        Directive[
         PointSize[0.006944444444444445], 
         RGBColor[0.368417, 0.506779, 0.709798], 
         AbsoluteThickness[1.6]], 
        LineBox[CompressedData["
1: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
PwHeym2+x+30rf4HkUFn7g==
         "]]}, {
        Hue[0.9060679774997897, 0.6, 0.6], 
        Directive[
         PointSize[0.006944444444444445], 
         RGBColor[0.880722, 0.611041, 0.142051], 
         AbsoluteThickness[1.6]], 
        LineBox[CompressedData["
1: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
AvhRm15xRgJWzRwf9j//HyR1RTw=
         "]]}, {
        Hue[0.1421359549995791, 0.6, 0.6], 
        Directive[
         PointSize[0.006944444444444445], 
         RGBColor[0.560181, 0.691569, 0.194885], 
         AbsoluteThickness[1.6]], 
        LineBox[CompressedData["
1:eJxV13lYjPv/x/GJrCWlZIlMWSKVkBLhJbSS9tJm2veaaZmmaRvRRpKKRDLC
KZHTsWaJSUnJSUiyZVQUWcKxJPT1u3rPH7/+6Xpcn97zmec9933PnZpXuK3v
MAaD8Z8Ug/F/v4d++lYx/v8Pthg2h5j+Vb9yiKNx50qWe+30arI8tttv1dGL
Lr86ZCV82VdRssbmPnkyTLI+HlXJeUGehst7T9SoHukhM+Eb8Hud5ub3ZHWc
7a7YsszyI3kWXloHMl8c/USeA86FR583WX4mz4W7L4+r5SCxJu4Zc2WmP5X8
vRZOOaS1WP6QvJ4OZl9VyeDU95F1kZr7u+v6Rcn+C2HpU7NGbW8veRG6B9Sz
X5tI3u9i3Et1eafX3UXWQ5DDsj2VmZK+JdheNIV5KvspWR+9Fv6DiRtayQbQ
2KPfOtWrmbwU48e/dUs+d4NsiLFKUkkYOE9ehiV+HhOuqewmL8fj5pnVDazj
dPyN4B43/PuBT5fJKxAw/t1x05u15JVYpaZxYMztW+RVeHBKQXXPmGYywJ23
xL3Y/t6QBUDJrI2xlza00PpqhHjklvEGHtD6avDP2Hd4+DykdWNk1fYJLma1
0boxKk72+OwQPKL1NbD29j4hWPWY1tdgYPrRS6+ayYy1OP7ENbDU8Amtr4WC
r5f5hkQyYx187WE+UCxZX4fgBV0j+Sck6yZIkz1sZXBAsm6CJ0lW7uujJeum
+HG0OHerkWTdFBbHClw9Pkv2N0NK/AF5lULJ+zODWkPozUtLJevmuDZG+9nI
RuoRmGO2TorRXntJnwXkh++0utcq6bdAxs8DuwdsyQxLrBz59r72LTpeAkto
5osm+KyQHL/1WJq/hxFf3krr6+E11VffUIXM2IARTVVKZmmS478Br0p0XPBJ
8vlY4ap0YVSJG1lgheuD+rmf6u7T+ka4NVclpi8kCzZi7T6bFTWF9HkzrKGc
rp72cTQZ1lA1qJB35t6lv7eG39xxfy96SeeLyBpn/lrncs5Bcv7YYK568Myp
2Xdo3gb9s2ZZVvOaaN4GF7uq7xb7/kvzNqjp6C385nib5m1h0aHc/WF9I83b
4kGYkd5ZUzpfBbYomzBC08+0geZt8a3/rJXaesn9yA7bx1ieHnC4SfN2MFst
s22kbx3N2+EOXzvfKvYGzdthxPiitqc5kuvDHvOlKi+c/6eG5u2xw5i3tf3B
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
d1Z/rfofFHEUFg==
         "]]}, {
        Hue[0.37820393249936934`, 0.6, 0.6], 
        Directive[
         PointSize[0.006944444444444445], 
         RGBColor[0.922526, 0.385626, 0.209179], 
         AbsoluteThickness[1.6]], 
        LineBox[CompressedData["
1:eJw11nk4lG0bBvBRKaWknUqEpF20lzpJ2su+ZZns2WbGWAZjTGmjTZGWt0WL
VkJv+zqWUklZitCbURSShJRKfX2H6/aP4+ee6zmf83nuOW5j3XlWXj04HE67
Aofz/9/dPy2LOGY76lbY4j79Ab2TTmTYeVqRleAbcb45O8qVrIrRIyry+yt5
k4fi1NnHAVN0gshq6HH+peBVuIA8GttnJfMN7ALJWrhvfKFYKPQha+OW97g7
jv3dyboYNX/gC7WB68h6OIzCJl66NVkfyzcUTHa0W0meiHftvNIRSSbkyRjw
vmzYQycj8lSM3mZUbR0wkmyAuJim5U+GDFjU7elw/VpdnXdiPNkQeXcsxJVr
DMlGyDNc0+DkN5s8Azobw30TPeaTZ+LMjlpDe95C8iysOXg1f7czyLORtfym
oY2hCXkOfHufM8nMZ54La2WD5bf0TcnzcI0rve3uxjwfglEDY14ImRfg5Qv1
EQ8CmI3xbv+d09fWMi9EpvKFRVPHMi9CTM6Kq/JalgekGFpwy4+SpUD7THPJ
7jVs3QS/xckTVDrp/qUmOHM3qPH3MdbHFF1btc/cMmHrppiWc177at4iWl+M
eq1VDlt6kqWLMfCwN8/OhD0fM1T1VFKwjDGmdTP8stm7z/3eAlpfgvhRreOX
/aHnK12CmzGPviebsudtjmeLREdyt8+jdXO0HBK0ji+ZS+tLYWV6+k8fTbJ0
KdR0B7Ts582h9WWobVH0+JpL71O6DGppU7UXjmbvdzkCfaa5SESzaH05ig1a
Y+68mknrK/CfaNLV7wvI0hWY1K9WZ2rqDFpfCYdYvXbrQWTpSnwuLdJ13WhE
66swo6Ng3sKvtL+kqyBbHFH0LoDtt9X4srGtn3H9dFpfjbiQ/M5ZPmTOGszz
7Ki922BA62tQH7Vh510embMWl6yqr5m2TqP1tbCOfql7XpnMsUCcZ0XR5klT
uw0LbB8TtirNcgp93gIntJ6Hd0RP7rbMAosvtp2alzmJ5i2xUPNzukX9RJq3
RNLz90MG6ZGllmhQcFW03TCB5i3Rrzia15GlT/NWiD6k2bvoD33fYIWJF6et
uGtFllrha2vdrsMX9GjeCksC5n8z60PmWKN23GfpYd9xNG+NnFL3HxHPdGne
Gqo2sb1z55Bl1qgpb1G3O6tD8zaIjY0TDR1Jhg0MeCJDeYI2zdtg05R3WkeU
yTIbjGxc+XZS/Fiat0XcjRtlwv5k2OLUxMujHPdp0bwtNDq1t2ePIstsUT9z
mcV4S02at4NleLQgUDCG5v96s9XScQc1aN4OyVNUOjQfjKZ5O6hMc2mc9n0U
zdvjxp6vRfrTybDHlVyL3dW8kTRvj5Lz8bMmXlGneXvoH1mvKO9So3kHrJjs
ZlexigwHjGjRP/o5ZQTNOyBi1i+Xrs7hNO+ALCU7vTf2ZI4jHvXP3xJ0axjN
O2LRvdbeO8eSpY54f/+e/rBdQ2neEf2VL9g3/BpC804IjLH6UM8nwwm+tnr9
v9YPpnknDJht/PKzJ1nmhGS5i96d2kE0vw6fCiZeNvYlYx301CLaHT6r0vw6
TNhTMLktgixbB9X5HQ6tfcgcZ3iMfOoWaTiQ5p0xaqr63LB1KjTvjFjeW8G5
eDofZM6YOvrBvrf3+9O8C95L9/G+/VCmeRd8mz1vzO35ZKkLDlxr+9RjUz+a
d8GmjydcUwv70rwrJlmI1CLHkOEK4/Syd44hSjTvivQktxNjnveheVfEWpqb
nppK5rhBrFIiy93Xm+bd8MVGTd3lpyLNu+Gf2A8mq33JMjc03q8ZJ6zoRfNc
bJUXHbm0hqzFxY3LGl7y/J50PS7GrJNoNJqRuVxMMXy68NKDHnR9Lrb8Uhqu
uoKcwoUjN/5eW7EC5XFhPsJq9EIXspyL1107yl585FD+evilGFodiyZrrccr
rzdpGweTsR56Ag9eoc2fhd356+H1T02tf/zvbkvXI3UYb0DWg65up6xHWlLq
Vn5vsmw9dhiLpsWs+tVt+XpETvTR/PfAz25z3DHzU9vRdx9+dFvLHcUJliMb
FpDhDo9D1jpHkzsp3/3v89zjVtn+nfLdUaYg2yK2J6e4Y80tW1vuvW+U7w6V
xYv3eEwgy93x+7/2Zs+DHZTvgdyQnTpmymQtD6y1Nnxcs/Er5Xsg8N0ld81f
7ZTvgRtn9KyrI8hSDyR96fGq1882yveAf12/niExZJkHsv1OXBnUhyz3QMZH
o+Tcva2U74niwtyhfE2ylif6pJ9b9zvjC+V7wnIYb63dYjLXE45dxdu5FS2U
74kmWfPa3sHkFE/sHbXtwPQBZJknBpvXtByy/Uz5nrDZbO60bX8z5Xvh+YdH
I3tWfqJ8L2T9VB/6XpsML3wo/2XZj99E+V7ISV7aY2X2R8r3wosCvcDNw8kp
XpgRdexTIq+R8r2wWHVFo/3TBsr3wqGXE59lTCZzvCEMkCuIE+op3xun8l7U
Hv32gfK9sSup+OG39WSuN25aHqgJeP6e8r2xbsJdq5pF5BRvlH+/NGzev3WU
740K89Iu5wlkuTfsF9RnGpyspXwfVB6NOHFEg6zlg55LdvSN++cd5fug/ZBd
3ZtRZK4PNHYtaN527C3l+2Da3hf7g3TIKT5oTdJUkFyooXwfbIx+0fOkEVnu
g+CUN6Py78kp3xfL79UFVK4ka/liR2dbeOLVasr3hX7u+7Le5W8o3xfXD8V/
avr5H+X7ov3D5P90dckpvuh783DD7rWvKd8Xh6fIBP0lVZTvi/hgvfqYjErK
34CEWf8VPH1XQfl/nRJ0onwkGRuw9KFh0xabV5S/AZNOSsbfSyin/A1I7LdS
5vO8jPI3YLX+WxV/VbJsA2wCz1hkWb+k/A1Q6z/rpO6hF5Tvh+ZA/84MeSnl
++HHxGuaiyaS4Yc26YG0e6EllO+H2CeqnNG5xZTvh7oOvvGSweQUP4QpjDSf
4FFE+X6YVpLvy/N/Tvl+GGQRnJ495Bnl+yPDPs520v2nlO+PvEMWWXsCCyjf
H9t35TqXjnlC+f7Q4Z6Z9brkEeX7Y1Ldbvu9cfmU74+h29b0rTJ9SPn+uD57
072Tv/Mo3x+G69f2K72TS/kByC5betA+OofyA/DkgYOuBrIpPwBbz7oIBynK
KD8A5h5OyeYH71J+wN/9d6ts88TblB8A45ps5fuyG5QfgH0bH/FeOV2j/AAk
n32leO37v5QfiFehkTsWHs6i/EAUytzKr0guUX4gknT7enx4fp7yA3Hs9KSO
j+NTKT8Qy0tmVB7ZmkL5gajWjD94qfwA5QciP8gl6ZPLLsoPhGfjMiXuyjDK
D4Jmslw07IP/ve78IKTkZY0p4cR1G0FYOVujvi58f7e5QVicf8kwxuNYt6VB
cJgC7YsnTnU7JQiFQzp/5Sqf67bs77xaBH84P63b8iBwxhs52PlkdpvDg2Yv
n4j8xMuUz8Po2IXZ6+9eoXwe/nnW02987TXK5+Fiq9pTdaWblM+D3ZfrPnMn
3KZ8HnzLSz5tWXqX8nnQKa5a/tv9PuX/zTve37borozy+fj91s/s6qPsbqvy
oTtzk9Pkkhy6Hz6qVg9NN6rM7bYBH8/G1fR6LM+j++Mj58+qmoa6B9224OOU
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
MC/f2nv/AwiPShk=
         "]]}, {
        Hue[0.6142719099991583, 0.6, 0.6], 
        Directive[
         PointSize[0.006944444444444445], 
         RGBColor[0.528488, 0.470624, 0.701351], 
         AbsoluteThickness[1.6]], 
        LineBox[CompressedData["
1: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
uT8NxocHq1dH0kjD63tNA0+9PDPr/wA6BXyN
         "]]}, {
        Hue[0.8503398874989481, 0.6, 0.6], 
        Directive[
         PointSize[0.006944444444444445], 
         RGBColor[0.772079, 0.431554, 0.102387], 
         AbsoluteThickness[1.6]], 
        LineBox[CompressedData["
1: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
ZKTgdPatQfGBGy3+B0GFTOM=
         "]]}}}, {}, {}, {}, {}}, {
    DisplayFunction -> Identity, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.05], 
        Scaled[0.05]}}, AxesOrigin -> {0, 0}, 
     PlotRange -> {{0, 500.}, {-0.39269908169872414`, 0.07211338217955884}}, 
     PlotRangeClipping -> True, ImagePadding -> All, DisplayFunction -> 
     Identity, AspectRatio -> NCache[GoldenRatio^(-1), 0.6180339887498948], 
     Axes -> {True, True}, AxesLabel -> {None, None}, AxesOrigin -> {0, 0}, 
     DisplayFunction :> Identity, Frame -> {{False, False}, {False, False}}, 
     FrameLabel -> {{None, None}, {None, None}}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], 
     Method -> {"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
           (Identity[#]& )[
            Part[#, 1]], 
           (Identity[#]& )[
            Part[#, 2]]}& ), "CopiedValueFunction" -> ({
           (Identity[#]& )[
            Part[#, 1]], 
           (Identity[#]& )[
            Part[#, 2]]}& )}}, PlotLabel -> 
     FormBox["\"kp20_ki50\"", TraditionalForm], 
     PlotRange -> {{0, 500.}, {-0.39269908169872414`, 0.07211338217955884}}, 
     PlotRangeClipping -> True, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.05], 
        Scaled[0.05]}}, Ticks -> {Automatic, Automatic}}],FormBox[
    FormBox[
     TemplateBox[{"\"wx\"", "\"wy\"", "\"wz\"", "\"vx\"", "\"vy\"", "\"vz\""},
       "LineLegend", DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.125], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.125], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.125], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.125], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #2}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.125], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.125], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #3}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.125], 
                    RGBColor[0.922526, 0.385626, 0.209179], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.125], 
                    RGBColor[0.922526, 0.385626, 0.209179], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #4}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.125], 
                    RGBColor[0.528488, 0.470624, 0.701351], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.125], 
                    RGBColor[0.528488, 0.470624, 0.701351], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #5}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.125], 
                    RGBColor[0.772079, 0.431554, 0.102387], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.125], 
                    RGBColor[0.772079, 0.431554, 0.102387], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #6}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"LineLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.006944444444444445`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[
                    0.24561133333333335`, 0.3378526666666667, 
                    0.4731986666666667], FrameTicks -> None, PlotRangePadding -> 
                    None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "RGBColor[0.368417, 0.506779, 0.709798]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.368417, 0.506779, 0.709798]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.368417, 0.506779, 0.709798], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.006944444444444445`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[
                    0.587148, 0.40736066666666665`, 0.09470066666666668], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "RGBColor[0.880722, 0.611041, 0.142051]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.880722, 0.611041, 0.142051]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.880722, 0.611041, 0.142051], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.006944444444444445`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[
                    0.37345400000000006`, 0.461046, 0.12992333333333334`], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "RGBColor[0.560181, 0.691569, 0.194885]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.560181, 0.691569, 0.194885]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.560181, 0.691569, 0.194885], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.006944444444444445`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.922526, 0.385626, 0.209179], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[
                    0.6150173333333333, 0.25708400000000003`, 
                    0.13945266666666667`], FrameTicks -> None, 
                    PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "RGBColor[0.922526, 0.385626, 0.209179]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.922526, 0.385626, 0.209179]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.922526, 0.385626, 0.209179], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.006944444444444445`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.528488, 0.470624, 0.701351], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[
                    0.3523253333333333, 0.3137493333333333, 
                    0.46756733333333333`], FrameTicks -> None, 
                    PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "RGBColor[0.528488, 0.470624, 0.701351]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.528488, 0.470624, 0.701351]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.528488, 0.470624, 0.701351], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.006944444444444445`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.772079, 0.431554, 0.102387], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[
                    0.5147193333333333, 0.28770266666666666`, 
                    0.06825800000000001], FrameTicks -> None, 
                    PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "RGBColor[0.772079, 0.431554, 0.102387]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.772079, 0.431554, 0.102387]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.772079, 0.431554, 0.102387], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}]}],
              "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2, ",", #3, ",", #4, ",", #5, ",", #6}], "}"}], 
           ",", 
           RowBox[{"LegendMarkers", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"Joined", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{
                "True", ",", "True", ",", "True", ",", "True", ",", "True", 
                 ",", "True"}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
      Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{{3.7212335808940763`*^9, 3.7212336033071117`*^9}, 
   3.7212336947391453`*^9, 3.7212337927683563`*^9, 3.7212338285448813`*^9, {
   3.721233950824439*^9, 3.721233967457926*^9}, 3.72123415860876*^9, 
   3.7212341903009777`*^9, 3.7212348995838127`*^9, 3.721234953012788*^9, 
   3.7212350974888997`*^9, 3.7212354083389673`*^9, 3.721235463464717*^9, 
   3.721235539290451*^9, 3.721235705166097*^9, 3.7212358680425324`*^9, {
   3.721235906606803*^9, 3.721235953367099*^9}, {3.721236010104391*^9, 
   3.7212360290643725`*^9}, 3.721236063062812*^9, 3.721236096280732*^9, 
   3.721236214749363*^9, 3.7212362508782215`*^9, 3.7212362868748026`*^9, {
   3.721236332151003*^9, 3.721236361343519*^9}, 3.72123661177227*^9, 
   3.7212366926463537`*^9, 3.7212367295704055`*^9, {3.7212368158881674`*^9, 
   3.721236854372281*^9}, {3.7212368896190557`*^9, 3.7212369103160543`*^9}, 
   3.721237043677514*^9, 3.721238324524824*^9, {3.7212399968856816`*^9, 
   3.7212400092418756`*^9}, 3.721240058429979*^9, 3.72124009982108*^9, 
   3.721241456816403*^9, 3.7212421936909676`*^9, 3.7212422240890245`*^9, 
   3.721242376075283*^9, {3.721242562161561*^9, 3.7212426278398733`*^9}, 
   3.7212428730519643`*^9, 3.7212431800404854`*^9, 3.72124344928131*^9, {
   3.721243483880862*^9, 3.721243513746776*^9}, 3.7212435550731306`*^9, 
   3.7212435874843483`*^9, {3.7212436196574106`*^9, 3.7212436359825964`*^9}, {
   3.721243667474886*^9, 3.7212437111126437`*^9}, {3.721243758384021*^9, 
   3.721243793653286*^9}, 3.7212438391979685`*^9, {3.721243908725525*^9, 
   3.721243926915286*^9}, 3.72124402457608*^9, 3.7212440557899117`*^9, {
   3.7212441028317847`*^9, 3.7212441297039633`*^9}, {3.7212441678723545`*^9, 
   3.7212441798929996`*^9}, {3.7212442164074306`*^9, 3.721244267238963*^9}, 
   3.72124430099498*^9, {3.721244380495067*^9, 3.721244618325021*^9}, 
   3.7212446568226857`*^9, {3.7212446925563354`*^9, 3.7212447111667233`*^9}, {
   3.7212448072388377`*^9, 3.7212448463266897`*^9}, {3.7212449415457993`*^9, 
   3.7212450314649825`*^9}, 3.7212452634885473`*^9, 
   3.7215902332668133`*^9},ExpressionUUID->"8fa32280-3ccb-466d-8cc7-\
38d931a41151"],

Cell[BoxData["\<\"kp20_ki50.gif\"\>"], "Output",
 CellChangeTimes->{{3.7212335808940763`*^9, 3.7212336033071117`*^9}, 
   3.7212336947391453`*^9, 3.7212337927683563`*^9, 3.7212338285448813`*^9, {
   3.721233950824439*^9, 3.721233967457926*^9}, 3.72123415860876*^9, 
   3.7212341903009777`*^9, 3.7212348995838127`*^9, 3.721234953012788*^9, 
   3.7212350974888997`*^9, 3.7212354083389673`*^9, 3.721235463464717*^9, 
   3.721235539290451*^9, 3.721235705166097*^9, 3.7212358680425324`*^9, {
   3.721235906606803*^9, 3.721235953367099*^9}, {3.721236010104391*^9, 
   3.7212360290643725`*^9}, 3.721236063062812*^9, 3.721236096280732*^9, 
   3.721236214749363*^9, 3.7212362508782215`*^9, 3.7212362868748026`*^9, {
   3.721236332151003*^9, 3.721236361343519*^9}, 3.72123661177227*^9, 
   3.7212366926463537`*^9, 3.7212367295704055`*^9, {3.7212368158881674`*^9, 
   3.721236854372281*^9}, {3.7212368896190557`*^9, 3.7212369103160543`*^9}, 
   3.721237043677514*^9, 3.721238324524824*^9, {3.7212399968856816`*^9, 
   3.7212400092418756`*^9}, 3.721240058429979*^9, 3.72124009982108*^9, 
   3.721241456816403*^9, 3.7212421936909676`*^9, 3.7212422240890245`*^9, 
   3.721242376075283*^9, {3.721242562161561*^9, 3.7212426278398733`*^9}, 
   3.7212428730519643`*^9, 3.7212431800404854`*^9, 3.72124344928131*^9, {
   3.721243483880862*^9, 3.721243513746776*^9}, 3.7212435550731306`*^9, 
   3.7212435874843483`*^9, {3.7212436196574106`*^9, 3.7212436359825964`*^9}, {
   3.721243667474886*^9, 3.7212437111126437`*^9}, {3.721243758384021*^9, 
   3.721243793653286*^9}, 3.7212438391979685`*^9, {3.721243908725525*^9, 
   3.721243926915286*^9}, 3.72124402457608*^9, 3.7212440557899117`*^9, {
   3.7212441028317847`*^9, 3.7212441297039633`*^9}, {3.7212441678723545`*^9, 
   3.7212441798929996`*^9}, {3.7212442164074306`*^9, 3.721244267238963*^9}, 
   3.72124430099498*^9, {3.721244380495067*^9, 3.721244618325021*^9}, 
   3.7212446568226857`*^9, {3.7212446925563354`*^9, 3.7212447111667233`*^9}, {
   3.7212448072388377`*^9, 3.7212448463266897`*^9}, {3.7212449415457993`*^9, 
   3.7212450314649825`*^9}, 3.7212452634885473`*^9, 
   3.7215902359816303`*^9},ExpressionUUID->"f968196d-e529-4379-a179-\
affa53e54e07"],

Cell[BoxData["\<\"kp20_ki50.csv\"\>"], "Output",
 CellChangeTimes->{{3.7212335808940763`*^9, 3.7212336033071117`*^9}, 
   3.7212336947391453`*^9, 3.7212337927683563`*^9, 3.7212338285448813`*^9, {
   3.721233950824439*^9, 3.721233967457926*^9}, 3.72123415860876*^9, 
   3.7212341903009777`*^9, 3.7212348995838127`*^9, 3.721234953012788*^9, 
   3.7212350974888997`*^9, 3.7212354083389673`*^9, 3.721235463464717*^9, 
   3.721235539290451*^9, 3.721235705166097*^9, 3.7212358680425324`*^9, {
   3.721235906606803*^9, 3.721235953367099*^9}, {3.721236010104391*^9, 
   3.7212360290643725`*^9}, 3.721236063062812*^9, 3.721236096280732*^9, 
   3.721236214749363*^9, 3.7212362508782215`*^9, 3.7212362868748026`*^9, {
   3.721236332151003*^9, 3.721236361343519*^9}, 3.72123661177227*^9, 
   3.7212366926463537`*^9, 3.7212367295704055`*^9, {3.7212368158881674`*^9, 
   3.721236854372281*^9}, {3.7212368896190557`*^9, 3.7212369103160543`*^9}, 
   3.721237043677514*^9, 3.721238324524824*^9, {3.7212399968856816`*^9, 
   3.7212400092418756`*^9}, 3.721240058429979*^9, 3.72124009982108*^9, 
   3.721241456816403*^9, 3.7212421936909676`*^9, 3.7212422240890245`*^9, 
   3.721242376075283*^9, {3.721242562161561*^9, 3.7212426278398733`*^9}, 
   3.7212428730519643`*^9, 3.7212431800404854`*^9, 3.72124344928131*^9, {
   3.721243483880862*^9, 3.721243513746776*^9}, 3.7212435550731306`*^9, 
   3.7212435874843483`*^9, {3.7212436196574106`*^9, 3.7212436359825964`*^9}, {
   3.721243667474886*^9, 3.7212437111126437`*^9}, {3.721243758384021*^9, 
   3.721243793653286*^9}, 3.7212438391979685`*^9, {3.721243908725525*^9, 
   3.721243926915286*^9}, 3.72124402457608*^9, 3.7212440557899117`*^9, {
   3.7212441028317847`*^9, 3.7212441297039633`*^9}, {3.7212441678723545`*^9, 
   3.7212441798929996`*^9}, {3.7212442164074306`*^9, 3.721244267238963*^9}, 
   3.72124430099498*^9, {3.721244380495067*^9, 3.721244618325021*^9}, 
   3.7212446568226857`*^9, {3.7212446925563354`*^9, 3.7212447111667233`*^9}, {
   3.7212448072388377`*^9, 3.7212448463266897`*^9}, {3.7212449415457993`*^9, 
   3.7212450314649825`*^9}, 3.7212452634885473`*^9, 
   3.7215902363578806`*^9},ExpressionUUID->"1a04b728-3cca-4371-84de-\
6f8681f16f8d"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1920, 1037},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
Magnification:>1.1 Inherited,
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 863, 20, 149, "Title",ExpressionUUID->"e7cfe95e-298d-457d-957b-ff9911294e26"],
Cell[1446, 44, 1977, 38, 631, "Title",ExpressionUUID->"d2337993-7423-4e05-9447-abdfac8d7163"],
Cell[3426, 84, 953, 14, 49, "Input",ExpressionUUID->"bab12d50-9abb-4e85-a7da-39851997309e"]
}, Closed]],
Cell[CellGroupData[{
Cell[4416, 103, 428, 8, 48, "Title",ExpressionUUID->"224bb695-bf40-4c13-8525-133cad19cf77"],
Cell[4847, 113, 2160, 45, 280, "Input",ExpressionUUID->"b11b96a9-dd81-4951-b7a9-0e0d3045f55a"]
}, Closed]],
Cell[CellGroupData[{
Cell[7044, 163, 408, 8, 48, "Title",ExpressionUUID->"14fdbee6-d553-44d5-bcf8-0520985f8d0c"],
Cell[7455, 173, 2290, 53, 275, "Input",ExpressionUUID->"0ad70c06-facc-4d0a-af6d-a84a9c827263"],
Cell[9748, 228, 3262, 86, 275, "Input",ExpressionUUID->"e97ad251-9fef-48cf-81ac-5d5c66f5db15"],
Cell[13013, 316, 2717, 70, 275, "Input",ExpressionUUID->"bcd4406f-0d5f-4c93-a7c5-78e8b31e17a4"],
Cell[15733, 388, 2903, 64, 297, "Input",ExpressionUUID->"45d60fcc-3d47-4d05-9e09-870eba0440a4"],
Cell[18639, 454, 5846, 125, 382, "Input",ExpressionUUID->"11ebb8ac-f942-4e18-819a-593a4d888b21"],
Cell[24488, 581, 10433, 233, 429, "Input",ExpressionUUID->"3fb73430-e8c5-4a1c-bd0f-45ffc49a9eb7"],
Cell[34924, 816, 11599, 193, 340, "Input",ExpressionUUID->"5b0bdc63-0ffd-4a46-9d87-f0f901c02c48"],
Cell[46526, 1011, 11796, 199, 319, "Input",ExpressionUUID->"fa9443b0-6014-44bc-b671-11d2996df7a0"],
Cell[58325, 1212, 12306, 213, 384, "Input",ExpressionUUID->"0d5adffd-00b3-4fd2-a2d9-c7b72cbcf88d"],
Cell[70634, 1427, 11685, 200, 340, "Input",ExpressionUUID->"714eca3f-16a5-4ea7-8474-d28bf3a85bb8"],
Cell[82322, 1629, 11520, 193, 275, "Input",ExpressionUUID->"b112c66f-befc-41f6-b959-5661164488a3"],
Cell[93845, 1824, 11997, 204, 388, "Input",ExpressionUUID->"99a8bd6b-a8f6-456b-94e1-e0442a5ece6a"],
Cell[105845, 2030, 11644, 192, 319, "Input",ExpressionUUID->"30d59f5e-3f2d-45a8-afa3-2e0a8597e22e"],
Cell[117492, 2224, 12248, 208, 319, "Input",ExpressionUUID->"46db7d2d-b8e9-4083-8c2c-61972e8c645d"],
Cell[129743, 2434, 16533, 299, 406, "Input",ExpressionUUID->"eac75cf4-61fb-43ca-8d48-d6ed63b7ae73"],
Cell[146279, 2735, 15064, 273, 450, "Input",ExpressionUUID->"6d99f6b0-2774-4d69-a54b-d891268b0240"]
}, Closed]],
Cell[CellGroupData[{
Cell[161380, 3013, 358, 7, 48, "Title",ExpressionUUID->"adad6dd3-3cb5-44e7-a1be-a9b7c7dca95c"],
Cell[161741, 3022, 6970, 163, 516, "Input",ExpressionUUID->"21cf6a13-d1c1-4e39-a23b-bc44ac2c3c82"],
Cell[168714, 3187, 6410, 154, 516, "Input",ExpressionUUID->"6c1a71c3-00c6-4090-82d8-835019f90473"]
}, Closed]],
Cell[CellGroupData[{
Cell[175161, 3346, 424, 8, 48, "Title",ExpressionUUID->"8c456625-0100-4029-9a0c-290c6927b44f"],
Cell[175588, 3356, 15893, 284, 498, "Input",ExpressionUUID->"06bd328e-b430-4e7d-acba-f59582ec3386"],
Cell[191484, 3642, 14553, 258, 520, "Input",ExpressionUUID->"290b86ce-006f-452c-ad1d-c66502d93173"]
}, Closed]],
Cell[CellGroupData[{
Cell[206074, 3905, 462, 9, 48, "Title",ExpressionUUID->"aeb0f32d-f3a5-4448-95d9-5bcb1f965aee"],
Cell[206539, 3916, 23592, 423, 759, "Input",ExpressionUUID->"2019be37-8152-4806-8505-1ba3f9326729"],
Cell[230134, 4341, 23956, 430, 803, "Input",ExpressionUUID->"08ec95ce-ac90-49ad-8fd9-387f0b2a56f1"]
}, Closed]],
Cell[CellGroupData[{
Cell[254127, 4776, 510, 9, 48, "Title",ExpressionUUID->"08468a25-7661-4274-8149-e4e0ff06774a"],
Cell[254640, 4787, 10924, 193, 1191, "Input",ExpressionUUID->"a7283161-cdc0-498a-b163-e77b1dfae91b"],
Cell[265567, 4982, 31594, 639, 3296, "Input",ExpressionUUID->"1c0967b5-dc60-4e4c-a4a2-4d75440db633"],
Cell[297164, 5623, 17299, 346, 2258, "Input",ExpressionUUID->"8f203f6f-118c-4dfe-8134-e1707b0a8783"],
Cell[314466, 5971, 15490, 308, 1972, "Input",ExpressionUUID->"a0c7be14-9f77-4b01-b125-e243b43f9e52"],
Cell[329959, 6281, 14775, 294, 1853, "Input",ExpressionUUID->"19c57df1-dd43-496b-a6f0-c96a701c71d0"],
Cell[344737, 6577, 8557, 212, 1853, "Input",ExpressionUUID->"4123ea26-48e5-44da-8143-ee8d46f0bb0f"],
Cell[353297, 6791, 16482, 333, 2312, "Input",ExpressionUUID->"47a89191-6003-4b60-98e7-190c1275e8ec"],
Cell[369782, 7126, 10341, 186, 1228, "Input",ExpressionUUID->"47d60faa-97d7-4107-acdf-b11826f0060d"],
Cell[380126, 7314, 22281, 466, 3340, "Input",ExpressionUUID->"6e8a159e-54ad-4847-bf62-128cd2960b3c"],
Cell[402410, 7782, 25420, 528, 3682, "Input",ExpressionUUID->"7f70e6a1-8f2f-4b8c-8861-d2d712d3c90f"]
}, Closed]],
Cell[CellGroupData[{
Cell[427867, 8315, 513, 9, 48, "Title",ExpressionUUID->"f0bd19a2-573e-4c14-b17d-871f7845c532"],
Cell[428383, 8326, 15363, 235, 908, "Input",ExpressionUUID->"4e7f1485-9b69-42b2-b750-f02d90141382"],
Cell[443749, 8563, 2877, 69, 908, "Input",ExpressionUUID->"fa932f5a-3894-409a-a875-d3671de900a6"],
Cell[446629, 8634, 17443, 316, 2075, "Input",ExpressionUUID->"108455ec-984d-4e4a-8086-3e93d8891e56"],
Cell[464075, 8952, 19672, 379, 2746, "Input",ExpressionUUID->"11a7c85e-9c0a-4b1e-b8b9-7f9041111f11"],
Cell[483750, 9333, 21733, 422, 2857, "Input",ExpressionUUID->"43e1b53b-9f44-4eb2-a4b6-10dbac7bceb2"]
}, Closed]],
Cell[CellGroupData[{
Cell[505520, 9760, 504, 9, 48, "Title",ExpressionUUID->"326e1d25-e6f2-4414-bbc5-f7990b093e8f"],
Cell[506027, 9771, 25101, 464, 1964, "Input",ExpressionUUID->"69857569-8b2e-4428-896c-067e7e49cbbb"],
Cell[531131, 10237, 32728, 714, 4266, "Input",ExpressionUUID->"96452019-eb03-4d11-8fe2-e6a38169415d"]
}, Closed]],
Cell[CellGroupData[{
Cell[563896, 10956, 214, 4, 78, "Title",ExpressionUUID->"dbf8f5a8-10a3-400c-8313-fd5d85dd9991"],
Cell[CellGroupData[{
Cell[564135, 10964, 157, 3, 73, "Section",ExpressionUUID->"2ec7cc55-19e3-431d-a43a-7d11ac893925"],
Cell[CellGroupData[{
Cell[564317, 10971, 4216, 112, 231, "Input",ExpressionUUID->"b7cb6ab5-bc72-45e1-b693-83dad68e03c3"],
Cell[CellGroupData[{
Cell[568558, 11087, 1072, 24, 23, "Print",ExpressionUUID->"88a4c236-1c3d-4ea7-8927-6f6fd77511ca"],
Cell[569633, 11113, 1548, 36, 73, "Print",ExpressionUUID->"29e13b8b-040b-4c28-8b9b-25114e2ce291"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[571242, 11156, 153, 3, 73, "Section",ExpressionUUID->"93ccdc0a-248d-4699-b6fd-108a39db1f46"],
Cell[CellGroupData[{
Cell[571420, 11163, 36040, 815, 2213, "Input",ExpressionUUID->"3e8b2e85-99cf-46d6-9246-537e8c05013e"],
Cell[607463, 11980, 2187, 30, 36, "Output",ExpressionUUID->"f7586988-5be4-4f7e-bb9b-cf4a4b88cec7"],
Cell[609653, 12012, 69320, 1250, 272, "Output",ExpressionUUID->"8fa32280-3ccb-466d-8cc7-38d931a41151"],
Cell[678976, 13264, 2191, 30, 36, "Output",ExpressionUUID->"f968196d-e529-4379-a179-affa53e54e07"],
Cell[681170, 13296, 2191, 30, 36, "Output",ExpressionUUID->"1a04b728-3cca-4371-84de-6f8681f16f8d"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

